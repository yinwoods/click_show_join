16/12/06 16:12:26 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 16:12:28 INFO mapreduce.Job:  map 10% reduce 0%
:16/12/06 16:12:29 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 16:12:46 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 16:12:47 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 16:12:48 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 16:12:50 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 16:12:52 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 16:12:53 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 16:12:54 INFO mapreduce.Job:  map 27% reduce 0%
16/12/06 16:12:55 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 16:12:58 INFO mapreduce.Job:  map 29% reduce 0%
16/12/06 16:13:00 INFO mapreduce.Job:  map 30% reduce 0%
16/12/06 16:13:02 INFO mapreduce.Job:  map 35% reduce 0%
16/12/06 16:13:03 INFO mapreduce.Job:  map 39% reduce 0%
16/12/06 16:13:04 INFO mapreduce.Job:  map 43% reduce 0%
16/12/06 16:13:05 INFO mapreduce.Job:  map 49% reduce 0%
16/12/06 16:13:07 INFO mapreduce.Job:  map 56% reduce 0%
16/12/06 16:13:08 INFO mapreduce.Job:  map 62% reduce 0%
16/12/06 16:13:09 INFO mapreduce.Job:  map 65% reduce 0%
16/12/06 16:13:10 INFO mapreduce.Job:  map 67% reduce 0%
16/12/06 16:13:11 INFO mapreduce.Job:  map 70% reduce 0%
16/12/06 16:13:12 INFO mapreduce.Job:  map 74% reduce 0%
16/12/06 16:13:13 INFO mapreduce.Job:  map 77% reduce 1%
16/12/06 16:13:14 INFO mapreduce.Job:  map 78% reduce 2%
16/12/06 16:13:15 INFO mapreduce.Job:  map 81% reduce 4%
16/12/06 16:13:16 INFO mapreduce.Job:  map 81% reduce 8%
16/12/06 16:13:17 INFO mapreduce.Job:  map 82% reduce 9%
16/12/06 16:13:18 INFO mapreduce.Job:  map 83% reduce 9%
16/12/06 16:13:19 INFO mapreduce.Job:  map 83% reduce 12%
16/12/06 16:13:20 INFO mapreduce.Job:  map 84% reduce 19%
16/12/06 16:13:21 INFO mapreduce.Job:  map 84% reduce 22%
16/12/06 16:13:22 INFO mapreduce.Job:  map 84% reduce 24%
16/12/06 16:13:23 INFO mapreduce.Job:  map 85% reduce 24%
16/12/06 16:13:24 INFO mapreduce.Job:  map 86% reduce 24%
16/12/06 16:13:25 INFO mapreduce.Job:  map 87% reduce 24%
16/12/06 16:13:26 INFO mapreduce.Job:  map 88% reduce 24%
16/12/06 16:13:27 INFO mapreduce.Job:  map 90% reduce 24%
16/12/06 16:13:28 INFO mapreduce.Job:  map 90% reduce 26%
16/12/06 16:13:30 INFO mapreduce.Job:  map 92% reduce 26%
16/12/06 16:13:31 INFO mapreduce.Job:  map 93% reduce 27%
16/12/06 16:13:33 INFO mapreduce.Job:  map 94% reduce 27%
16/12/06 16:13:34 INFO mapreduce.Job:  map 96% reduce 29%
16/12/06 16:13:35 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 16:13:36 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 16:13:37 INFO mapreduce.Job:  map 99% reduce 33%
16/12/06 16:13:38 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 16:13:39 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 16:13:40 INFO mapreduce.Job:  map 100% reduce 49%
16/12/06 16:13:41 INFO mapreduce.Job:  map 100% reduce 61%
16/12/06 16:13:42 INFO mapreduce.Job:  map 100% reduce 81%
16/12/06 16:13:43 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 16:13:44 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 16:13:46 INFO mapreduce.Job: Job job_1480588584072_4649 completed successfully
16/12/06 16:13:47 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=304063370
		FILE: Number of bytes written=640508705
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=263584149
		WASB: Number of bytes written=138902311
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=23066116
		Total time spent by all reduces in occupied slots (ms)=2157788
		Total time spent by all map tasks (ms)=11533058
		Total time spent by all reduce tasks (ms)=1078894
		Total vcore-seconds taken by all map tasks=11533058
		Total vcore-seconds taken by all reduce tasks=1078894
		Total megabyte-seconds taken by all map tasks=11809851392
		Total megabyte-seconds taken by all reduce tasks=1104787456
	Map-Reduce Framework
		Map input records=864419
		Map output records=754374
		Map output bytes=301172197
		Map output materialized bytes=304086890
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=659483
		Reduce shuffle bytes=304086890
		Reduce input records=754374
		Reduce output records=419359
		Spilled Records=1508748
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=136244
		CPU time spent (ms)=758190
		Physical memory (bytes) snapshot=322413027328
		Virtual memory (bytes) snapshot=742348431360
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=260888145
	File Output Format Counters 
		Bytes Written=138902311
16/12/06 16:13:47 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/0500
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161201/201612012200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161201/201612012200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161201/201612012300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161201/201612012300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/0600 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161201/201612012200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161201/201612012300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/0600': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1441737579991135866.jar tmpDir=null
16/12/06 16:14:30 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:14:31 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:14:31 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 16:14:33 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 16:14:33 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 16:14:33 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4652
16/12/06 16:14:36 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4652
16/12/06 16:14:36 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4652/
16/12/06 16:14:36 INFO mapreduce.Job: Running job: job_1480588584072_4652
16/12/06 16:15:24 INFO mapreduce.Job: Job job_1480588584072_4652 running in uber mode : false
16/12/06 16:15:24 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 16:16:15 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 16:16:17 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 16:16:18 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 16:16:19 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 16:16:30 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 16:16:31 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 16:16:35 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 16:16:42 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 16:16:43 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 16:16:49 INFO mapreduce.Job:  map 10% reduce 1%
16/12/06 16:16:50 INFO mapreduce.Job:  map 11% reduce 1%
16/12/06 16:16:53 INFO mapreduce.Job:  map 12% reduce 1%
16/12/06 16:16:58 INFO mapreduce.Job:  map 14% reduce 1%
16/12/06 16:17:01 INFO mapreduce.Job:  map 15% reduce 1%
16/12/06 16:17:02 INFO mapreduce.Job:  map 16% reduce 1%
16/12/06 16:17:03 INFO mapreduce.Job:  map 17% reduce 1%
16/12/06 16:17:04 INFO mapreduce.Job:  map 19% reduce 1%
16/12/06 16:17:05 INFO mapreduce.Job:  map 21% reduce 1%
16/12/06 16:17:06 INFO mapreduce.Job:  map 23% reduce 2%
16/12/06 16:17:07 INFO mapreduce.Job:  map 25% reduce 2%
16/12/06 16:17:08 INFO mapreduce.Job:  map 28% reduce 2%
16/12/06 16:17:09 INFO mapreduce.Job:  map 31% reduce 2%
16/12/06 16:17:10 INFO mapreduce.Job:  map 34% reduce 2%
16/12/06 16:17:11 INFO mapreduce.Job:  map 36% reduce 3%
16/12/06 16:17:12 INFO mapreduce.Job:  map 42% reduce 3%
16/12/06 16:17:13 INFO mapreduce.Job:  map 46% reduce 3%
16/12/06 16:17:14 INFO mapreduce.Job:  map 49% reduce 4%
16/12/06 16:17:15 INFO mapreduce.Job:  map 52% reduce 4%
16/12/06 16:17:16 INFO mapreduce.Job:  map 54% reduce 4%
16/12/06 16:17:17 INFO mapreduce.Job:  map 56% reduce 4%
16/12/06 16:17:18 INFO mapreduce.Job:  map 57% reduce 4%
16/12/06 16:17:19 INFO mapreduce.Job:  map 61% reduce 6%
16/12/06 16:17:21 INFO mapreduce.Job:  map 64% reduce 6%
16/12/06 16:17:23 INFO mapreduce.Job:  map 66% reduce 7%
16/12/06 16:17:24 INFO mapreduce.Job:  map 68% reduce 7%
16/12/06 16:17:25 INFO mapreduce.Job:  map 69% reduce 7%
16/12/06 16:17:26 INFO mapreduce.Job:  map 71% reduce 8%
16/12/06 16:17:29 INFO mapreduce.Job:  map 73% reduce 8%
16/12/06 16:17:30 INFO mapreduce.Job:  map 73% reduce 9%
16/12/06 16:17:31 INFO mapreduce.Job:  map 73% reduce 10%
16/12/06 16:17:32 INFO mapreduce.Job:  map 74% reduce 11%
16/12/06 16:17:33 INFO mapreduce.Job:  map 77% reduce 11%
16/12/06 16:17:34 INFO mapreduce.Job:  map 78% reduce 11%
16/12/06 16:17:36 INFO mapreduce.Job:  map 79% reduce 11%
16/12/06 16:17:37 INFO mapreduce.Job:  map 80% reduce 12%
16/12/06 16:17:38 INFO mapreduce.Job:  map 81% reduce 12%
16/12/06 16:17:39 INFO mapreduce.Job:  map 81% reduce 13%
16/12/06 16:17:43 INFO mapreduce.Job:  map 82% reduce 13%
16/12/06 16:17:45 INFO mapreduce.Job:  map 83% reduce 13%
16/12/06 16:17:46 INFO mapreduce.Job:  map 83% reduce 14%
16/12/06 16:17:50 INFO mapreduce.Job:  map 83% reduce 18%
16/12/06 16:17:53 INFO mapreduce.Job:  map 84% reduce 18%
16/12/06 16:17:54 INFO mapreduce.Job:  map 84% reduce 19%
16/12/06 16:17:55 INFO mapreduce.Job:  map 84% reduce 21%
16/12/06 16:17:58 INFO mapreduce.Job:  map 84% reduce 22%
16/12/06 16:18:00 INFO mapreduce.Job:  map 85% reduce 22%
16/12/06 16:18:03 INFO mapreduce.Job:  map 85% reduce 24%
16/12/06 16:18:05 INFO mapreduce.Job:  map 86% reduce 25%
16/12/06 16:18:06 INFO mapreduce.Job:  map 87% reduce 25%
16/12/06 16:18:08 INFO mapreduce.Job:  map 88% reduce 27%
16/12/06 16:18:10 INFO mapreduce.Job:  map 90% reduce 27%
16/12/06 16:18:11 INFO mapreduce.Job:  map 91% reduce 28%
16/12/06 16:18:12 INFO mapreduce.Job:  map 91% reduce 29%
16/12/06 16:18:13 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 16:18:14 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 16:18:15 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 16:18:16 INFO mapreduce.Job:  map 98% reduce 31%
16/12/06 16:18:17 INFO mapreduce.Job:  map 99% reduce 31%
16/12/06 16:18:19 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 16:18:20 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 16:18:21 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 16:18:22 INFO mapreduce.Job:  map 100% reduce 38%
16/12/06 16:18:23 INFO mapreduce.Job:  map 100% reduce 46%
16/12/06 16:18:24 INFO mapreduce.Job:  map 100% reduce 55%
16/12/06 16:18:25 INFO mapreduce.Job:  map 100% reduce 66%
16/12/06 16:18:26 INFO mapreduce.Job:  map 100% reduce 79%
16/12/06 16:18:27 INFO mapreduce.Job:  map 100% reduce 83%
16/12/06 16:18:28 INFO mapreduce.Job:  map 100% reduce 84%
16/12/06 16:18:29 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 16:18:31 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 16:18:32 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 16:18:33 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 16:18:34 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 16:18:37 INFO mapreduce.Job: Job job_1480588584072_4652 completed successfully
16/12/06 16:18:37 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=382235173
		FILE: Number of bytes written=796852311
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=328994628
		WASB: Number of bytes written=177876350
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=23129706
		Total time spent by all reduces in occupied slots (ms)=4160510
		Total time spent by all map tasks (ms)=11564853
		Total time spent by all reduce tasks (ms)=2080255
		Total vcore-seconds taken by all map tasks=11564853
		Total vcore-seconds taken by all reduce tasks=2080255
		Total megabyte-seconds taken by all map tasks=11842409472
		Total megabyte-seconds taken by all reduce tasks=2130181120
	Map-Reduce Framework
		Map input records=1075579
		Map output records=945930
		Map output bytes=378605988
		Map output materialized bytes=382258693
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=826164
		Reduce shuffle bytes=382258693
		Reduce input records=945930
		Reduce output records=535444
		Spilled Records=1891860
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=124232
		CPU time spent (ms)=828150
		Physical memory (bytes) snapshot=323082850304
		Virtual memory (bytes) snapshot=741597843456
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=326298624
	File Output Format Counters 
		Bytes Written=177876350
16/12/06 16:18:37 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/0600
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161201/201612012300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161201/201612012300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/0700 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161201/201612012300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/0700': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7696852621627653572.jar tmpDir=null
16/12/06 16:19:16 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:19:16 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:19:17 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 16:19:18 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 16:19:19 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 16:19:19 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4657
16/12/06 16:19:20 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4657
16/12/06 16:19:20 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4657/
16/12/06 16:19:20 INFO mapreduce.Job: Running job: job_1480588584072_4657
16/12/06 16:20:14 INFO mapreduce.Job: Job job_1480588584072_4657 running in uber mode : false
16/12/06 16:20:14 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 16:20:50 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 16:20:53 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 16:20:54 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 16:20:56 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 16:20:58 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 16:21:00 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 16:21:01 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 16:21:02 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 16:21:03 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 16:21:16 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 16:21:18 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 16:21:20 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 16:21:21 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 16:21:22 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 16:21:23 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 16:21:24 INFO mapreduce.Job:  map 27% reduce 0%
16/12/06 16:21:25 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 16:21:26 INFO mapreduce.Job:  map 29% reduce 0%
16/12/06 16:21:27 INFO mapreduce.Job:  map 32% reduce 0%
16/12/06 16:21:28 INFO mapreduce.Job:  map 35% reduce 0%
16/12/06 16:21:31 INFO mapreduce.Job:  map 39% reduce 0%
16/12/06 16:21:34 INFO mapreduce.Job:  map 46% reduce 0%
16/12/06 16:21:38 INFO mapreduce.Job:  map 60% reduce 1%
16/12/06 16:21:39 INFO mapreduce.Job:  map 63% reduce 1%
16/12/06 16:21:41 INFO mapreduce.Job:  map 70% reduce 2%
16/12/06 16:21:42 INFO mapreduce.Job:  map 71% reduce 3%
16/12/06 16:21:43 INFO mapreduce.Job:  map 72% reduce 3%
16/12/06 16:21:45 INFO mapreduce.Job:  map 74% reduce 4%
16/12/06 16:21:47 INFO mapreduce.Job:  map 74% reduce 5%
16/12/06 16:21:48 INFO mapreduce.Job:  map 76% reduce 7%
16/12/06 16:21:49 INFO mapreduce.Job:  map 77% reduce 10%
16/12/06 16:21:50 INFO mapreduce.Job:  map 78% reduce 10%
16/12/06 16:21:51 INFO mapreduce.Job:  map 80% reduce 12%
16/12/06 16:21:52 INFO mapreduce.Job:  map 81% reduce 13%
16/12/06 16:21:53 INFO mapreduce.Job:  map 81% reduce 17%
16/12/06 16:21:54 INFO mapreduce.Job:  map 81% reduce 20%
16/12/06 16:21:55 INFO mapreduce.Job:  map 82% reduce 21%
16/12/06 16:21:56 INFO mapreduce.Job:  map 83% reduce 23%
16/12/06 16:21:57 INFO mapreduce.Job:  map 84% reduce 23%
16/12/06 16:21:59 INFO mapreduce.Job:  map 85% reduce 24%
16/12/06 16:22:00 INFO mapreduce.Job:  map 88% reduce 24%
16/12/06 16:22:01 INFO mapreduce.Job:  map 89% reduce 26%
16/12/06 16:22:04 INFO mapreduce.Job:  map 91% reduce 27%
16/12/06 16:22:05 INFO mapreduce.Job:  map 92% reduce 27%
16/12/06 16:22:06 INFO mapreduce.Job:  map 93% reduce 29%
16/12/06 16:22:07 INFO mapreduce.Job:  map 94% reduce 29%
16/12/06 16:22:08 INFO mapreduce.Job:  map 95% reduce 29%
16/12/06 16:22:09 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 16:22:12 INFO mapreduce.Job:  map 96% reduce 30%
16/12/06 16:22:13 INFO mapreduce.Job:  map 99% reduce 30%
16/12/06 16:22:14 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 16:22:15 INFO mapreduce.Job:  map 100% reduce 36%
16/12/06 16:22:16 INFO mapreduce.Job:  map 100% reduce 43%
16/12/06 16:22:17 INFO mapreduce.Job:  map 100% reduce 54%
16/12/06 16:22:18 INFO mapreduce.Job:  map 100% reduce 57%
16/12/06 16:22:19 INFO mapreduce.Job:  map 100% reduce 61%
16/12/06 16:22:20 INFO mapreduce.Job:  map 100% reduce 68%
16/12/06 16:22:21 INFO mapreduce.Job:  map 100% reduce 72%
16/12/06 16:22:22 INFO mapreduce.Job:  map 100% reduce 74%
16/12/06 16:22:23 INFO mapreduce.Job:  map 100% reduce 77%
16/12/06 16:22:24 INFO mapreduce.Job:  map 100% reduce 81%
16/12/06 16:22:25 INFO mapreduce.Job:  map 100% reduce 84%
16/12/06 16:22:26 INFO mapreduce.Job:  map 100% reduce 85%
16/12/06 16:22:27 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 16:22:28 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 16:22:29 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 16:22:30 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 16:22:31 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 16:22:32 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 16:22:33 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 16:22:34 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 16:22:41 INFO mapreduce.Job: Job job_1480588584072_4657 completed successfully
16/12/06 16:22:42 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=518196281
		FILE: Number of bytes written=1068774527
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=445791314
		WASB: Number of bytes written=258653724
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=19438750
		Total time spent by all reduces in occupied slots (ms)=2776882
		Total time spent by all map tasks (ms)=9719375
		Total time spent by all reduce tasks (ms)=1388441
		Total vcore-seconds taken by all map tasks=9719375
		Total vcore-seconds taken by all reduce tasks=1388441
		Total megabyte-seconds taken by all map tasks=9952640000
		Total megabyte-seconds taken by all reduce tasks=1421763584
	Map-Reduce Framework
		Map input records=1442612
		Map output records=1271126
		Map output bytes=513311994
		Map output materialized bytes=518219801
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1117420
		Reduce shuffle bytes=518219801
		Reduce input records=1271126
		Reduce output records=770406
		Spilled Records=2542252
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=116764
		CPU time spent (ms)=888340
		Physical memory (bytes) snapshot=323552002048
		Virtual memory (bytes) snapshot=742204071936
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=443095310
	File Output Format Counters 
		Bytes Written=258653724
16/12/06 16:22:42 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/0700
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020400 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/0800 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020400
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/0800': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4336464140042766910.jar tmpDir=null
16/12/06 16:23:21 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:23:21 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:23:22 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 16:23:23 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 16:23:24 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 16:23:24 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4661
16/12/06 16:23:25 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4661
16/12/06 16:23:25 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4661/
16/12/06 16:23:25 INFO mapreduce.Job: Running job: job_1480588584072_4661
16/12/06 16:24:12 INFO mapreduce.Job: Job job_1480588584072_4661 running in uber mode : false
16/12/06 16:24:12 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 16:24:35 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 16:24:57 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 16:24:59 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 16:25:02 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 16:25:05 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 16:25:08 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 16:25:09 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 16:25:11 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 16:25:12 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 16:25:14 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 16:25:15 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 16:25:16 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 16:25:17 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 16:25:18 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 16:25:19 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 16:25:20 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 16:25:21 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 16:25:23 INFO mapreduce.Job:  map 27% reduce 0%
16/12/06 16:25:24 INFO mapreduce.Job:  map 29% reduce 0%
16/12/06 16:25:25 INFO mapreduce.Job:  map 30% reduce 0%
16/12/06 16:25:26 INFO mapreduce.Job:  map 33% reduce 0%
16/12/06 16:25:27 INFO mapreduce.Job:  map 36% reduce 0%
16/12/06 16:25:28 INFO mapreduce.Job:  map 37% reduce 0%
16/12/06 16:25:29 INFO mapreduce.Job:  map 40% reduce 0%
16/12/06 16:25:30 INFO mapreduce.Job:  map 42% reduce 0%
16/12/06 16:25:31 INFO mapreduce.Job:  map 43% reduce 0%
16/12/06 16:25:32 INFO mapreduce.Job:  map 45% reduce 0%
16/12/06 16:25:33 INFO mapreduce.Job:  map 46% reduce 0%
16/12/06 16:25:35 INFO mapreduce.Job:  map 48% reduce 0%
16/12/06 16:25:37 INFO mapreduce.Job:  map 50% reduce 0%
16/12/06 16:25:38 INFO mapreduce.Job:  map 53% reduce 0%
16/12/06 16:25:39 INFO mapreduce.Job:  map 56% reduce 0%
16/12/06 16:25:40 INFO mapreduce.Job:  map 58% reduce 0%
16/12/06 16:25:41 INFO mapreduce.Job:  map 60% reduce 0%
16/12/06 16:25:42 INFO mapreduce.Job:  map 61% reduce 0%
16/12/06 16:25:43 INFO mapreduce.Job:  map 62% reduce 0%
16/12/06 16:25:44 INFO mapreduce.Job:  map 64% reduce 0%
16/12/06 16:25:45 INFO mapreduce.Job:  map 65% reduce 0%
16/12/06 16:25:46 INFO mapreduce.Job:  map 66% reduce 0%
16/12/06 16:25:48 INFO mapreduce.Job:  map 67% reduce 0%
16/12/06 16:25:50 INFO mapreduce.Job:  map 68% reduce 0%
16/12/06 16:25:51 INFO mapreduce.Job:  map 70% reduce 0%
16/12/06 16:26:08 INFO mapreduce.Job:  map 71% reduce 0%
16/12/06 16:26:30 INFO mapreduce.Job:  map 72% reduce 0%
16/12/06 16:26:51 INFO mapreduce.Job:  map 72% reduce 2%
16/12/06 16:26:53 INFO mapreduce.Job:  map 72% reduce 4%
16/12/06 16:26:57 INFO mapreduce.Job:  map 73% reduce 4%
16/12/06 16:26:59 INFO mapreduce.Job:  map 73% reduce 5%
16/12/06 16:27:00 INFO mapreduce.Job:  map 73% reduce 6%
16/12/06 16:27:01 INFO mapreduce.Job:  map 74% reduce 6%
16/12/06 16:27:02 INFO mapreduce.Job:  map 75% reduce 10%
16/12/06 16:27:03 INFO mapreduce.Job:  map 76% reduce 11%
16/12/06 16:27:04 INFO mapreduce.Job:  map 80% reduce 11%
16/12/06 16:27:05 INFO mapreduce.Job:  map 81% reduce 15%
16/12/06 16:27:06 INFO mapreduce.Job:  map 83% reduce 17%
16/12/06 16:27:07 INFO mapreduce.Job:  map 86% reduce 17%
16/12/06 16:27:08 INFO mapreduce.Job:  map 89% reduce 21%
16/12/06 16:27:09 INFO mapreduce.Job:  map 90% reduce 23%
16/12/06 16:27:10 INFO mapreduce.Job:  map 92% reduce 26%
16/12/06 16:27:11 INFO mapreduce.Job:  map 93% reduce 29%
16/12/06 16:27:12 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 16:27:13 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 16:27:14 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 16:27:16 INFO mapreduce.Job:  map 98% reduce 33%
16/12/06 16:27:17 INFO mapreduce.Job:  map 99% reduce 33%
16/12/06 16:27:19 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 16:27:21 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 16:27:22 INFO mapreduce.Job:  map 100% reduce 41%
16/12/06 16:27:23 INFO mapreduce.Job:  map 100% reduce 45%
16/12/06 16:27:24 INFO mapreduce.Job:  map 100% reduce 60%
16/12/06 16:27:25 INFO mapreduce.Job:  map 100% reduce 72%
16/12/06 16:27:26 INFO mapreduce.Job:  map 100% reduce 78%
16/12/06 16:27:27 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 16:27:28 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 16:27:29 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 16:27:30 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 16:27:31 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 16:27:32 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 16:27:34 INFO mapreduce.Job: Job job_1480588584072_4661 completed successfully
16/12/06 16:27:35 INFO mapreduce.Job: Counters: 50
	File System Counters
		FILE: Number of bytes read=619730689
		FILE: Number of bytes written=1271843343
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=530554290
		WASB: Number of bytes written=319931888
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Killed reduce tasks=11
		Launched map tasks=197
		Launched reduce tasks=31
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=16291528
		Total time spent by all reduces in occupied slots (ms)=2168504
		Total time spent by all map tasks (ms)=8145764
		Total time spent by all reduce tasks (ms)=1084252
		Total vcore-seconds taken by all map tasks=8145764
		Total vcore-seconds taken by all reduce tasks=1084252
		Total megabyte-seconds taken by all map tasks=8341262336
		Total megabyte-seconds taken by all reduce tasks=1110274048
	Map-Reduce Framework
		Map input records=1706693
		Map output records=1513872
		Map output bytes=613900017
		Map output materialized bytes=619754209
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1332972
		Reduce shuffle bytes=619754209
		Reduce input records=1513872
		Reduce output records=948309
		Spilled Records=3027744
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=147393
		CPU time spent (ms)=932210
		Physical memory (bytes) snapshot=323964018688
		Virtual memory (bytes) snapshot=742180069376
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=527858286
	File Output Format Counters 
		Bytes Written=319931888
16/12/06 16:27:35 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/0800
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020500 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/0900 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020500
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/0900': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob6610663796900934687.jar tmpDir=null
16/12/06 16:28:13 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:28:14 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:28:15 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 16:28:17 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 16:28:17 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 16:28:18 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4663
16/12/06 16:28:18 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4663
16/12/06 16:28:18 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4663/
16/12/06 16:28:18 INFO mapreduce.Job: Running job: job_1480588584072_4663
16/12/06 16:28:32 INFO mapreduce.Job: Job job_1480588584072_4663 running in uber mode : false
16/12/06 16:28:32 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 16:28:58 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 16:28:59 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 16:29:00 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 16:29:01 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 16:29:02 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 16:29:03 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 16:29:16 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 16:29:17 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 16:29:18 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 16:29:19 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 16:29:20 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 16:29:21 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 16:29:22 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 16:29:23 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 16:29:24 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 16:29:25 INFO mapreduce.Job:  map 27% reduce 0%
16/12/06 16:29:26 INFO mapreduce.Job:  map 30% reduce 0%
16/12/06 16:29:28 INFO mapreduce.Job:  map 31% reduce 0%
16/12/06 16:29:30 INFO mapreduce.Job:  map 34% reduce 0%
16/12/06 16:29:31 INFO mapreduce.Job:  map 36% reduce 0%
16/12/06 16:29:32 INFO mapreduce.Job:  map 38% reduce 0%
16/12/06 16:29:33 INFO mapreduce.Job:  map 38% reduce 1%
16/12/06 16:29:34 INFO mapreduce.Job:  map 39% reduce 1%
16/12/06 16:29:35 INFO mapreduce.Job:  map 40% reduce 1%
16/12/06 16:29:38 INFO mapreduce.Job:  map 42% reduce 1%
16/12/06 16:29:41 INFO mapreduce.Job:  map 43% reduce 1%
16/12/06 16:29:43 INFO mapreduce.Job:  map 44% reduce 1%
16/12/06 16:29:45 INFO mapreduce.Job:  map 45% reduce 3%
16/12/06 16:29:46 INFO mapreduce.Job:  map 47% reduce 4%
16/12/06 16:29:47 INFO mapreduce.Job:  map 47% reduce 6%
16/12/06 16:29:48 INFO mapreduce.Job:  map 50% reduce 8%
16/12/06 16:29:49 INFO mapreduce.Job:  map 52% reduce 9%
16/12/06 16:29:50 INFO mapreduce.Job:  map 52% reduce 12%
16/12/06 16:29:51 INFO mapreduce.Job:  map 56% reduce 13%
16/12/06 16:29:52 INFO mapreduce.Job:  map 59% reduce 15%
16/12/06 16:29:53 INFO mapreduce.Job:  map 63% reduce 17%
16/12/06 16:29:54 INFO mapreduce.Job:  map 65% reduce 18%
16/12/06 16:29:55 INFO mapreduce.Job:  map 66% reduce 20%
16/12/06 16:29:56 INFO mapreduce.Job:  map 68% reduce 21%
16/12/06 16:29:58 INFO mapreduce.Job:  map 70% reduce 22%
16/12/06 16:29:59 INFO mapreduce.Job:  map 72% reduce 22%
16/12/06 16:30:00 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 16:30:01 INFO mapreduce.Job:  map 75% reduce 23%
16/12/06 16:30:02 INFO mapreduce.Job:  map 76% reduce 24%
16/12/06 16:30:03 INFO mapreduce.Job:  map 77% reduce 24%
16/12/06 16:30:04 INFO mapreduce.Job:  map 79% reduce 25%
16/12/06 16:30:05 INFO mapreduce.Job:  map 80% reduce 25%
16/12/06 16:30:06 INFO mapreduce.Job:  map 81% reduce 26%
16/12/06 16:30:07 INFO mapreduce.Job:  map 82% reduce 26%
16/12/06 16:30:08 INFO mapreduce.Job:  map 82% reduce 27%
16/12/06 16:30:09 INFO mapreduce.Job:  map 83% reduce 27%
16/12/06 16:30:10 INFO mapreduce.Job:  map 84% reduce 27%
16/12/06 16:30:11 INFO mapreduce.Job:  map 84% reduce 28%
16/12/06 16:30:12 INFO mapreduce.Job:  map 85% reduce 28%
16/12/06 16:30:15 INFO mapreduce.Job:  map 86% reduce 28%
16/12/06 16:30:16 INFO mapreduce.Job:  map 87% reduce 28%
16/12/06 16:30:19 INFO mapreduce.Job:  map 89% reduce 28%
16/12/06 16:30:20 INFO mapreduce.Job:  map 91% reduce 29%
16/12/06 16:30:21 INFO mapreduce.Job:  map 93% reduce 29%
16/12/06 16:30:22 INFO mapreduce.Job:  map 94% reduce 29%
16/12/06 16:30:23 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 16:30:24 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 16:30:25 INFO mapreduce.Job:  map 98% reduce 31%
16/12/06 16:30:26 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 16:30:27 INFO mapreduce.Job:  map 99% reduce 33%
16/12/06 16:30:28 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 16:30:30 INFO mapreduce.Job:  map 100% reduce 40%
16/12/06 16:30:31 INFO mapreduce.Job:  map 100% reduce 46%
16/12/06 16:30:32 INFO mapreduce.Job:  map 100% reduce 50%
16/12/06 16:30:33 INFO mapreduce.Job:  map 100% reduce 59%
16/12/06 16:30:34 INFO mapreduce.Job:  map 100% reduce 68%
16/12/06 16:30:35 INFO mapreduce.Job:  map 100% reduce 71%
16/12/06 16:30:36 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 16:30:37 INFO mapreduce.Job:  map 100% reduce 80%
16/12/06 16:30:38 INFO mapreduce.Job:  map 100% reduce 84%
16/12/06 16:30:39 INFO mapreduce.Job:  map 100% reduce 88%
16/12/06 16:30:40 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 16:30:41 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 16:30:42 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 16:30:45 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 16:30:48 INFO mapreduce.Job: Job job_1480588584072_4663 completed successfully
16/12/06 16:30:48 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=633511192
		FILE: Number of bytes written=1299404349
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=547867425
		WASB: Number of bytes written=301438391
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=21683474
		Total time spent by all reduces in occupied slots (ms)=3171660
		Total time spent by all map tasks (ms)=10841737
		Total time spent by all reduce tasks (ms)=1585830
		Total vcore-seconds taken by all map tasks=10841737
		Total vcore-seconds taken by all reduce tasks=1585830
		Total megabyte-seconds taken by all map tasks=11101938688
		Total megabyte-seconds taken by all reduce tasks=1623889920
	Map-Reduce Framework
		Map input records=1775471
		Map output records=1550207
		Map output bytes=627523860
		Map output materialized bytes=633534712
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1350458
		Reduce shuffle bytes=633534712
		Reduce input records=1550207
		Reduce output records=891092
		Spilled Records=3100414
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=109324
		CPU time spent (ms)=939510
		Physical memory (bytes) snapshot=323659026432
		Virtual memory (bytes) snapshot=742203740160
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=545171421
	File Output Format Counters 
		Bytes Written=301438391
16/12/06 16:30:48 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/0900
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020600 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020600
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3680005214842919042.jar tmpDir=null
16/12/06 16:31:26 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:31:27 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:31:28 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 16:31:30 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 16:31:30 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 16:31:31 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4664
16/12/06 16:31:32 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4664
16/12/06 16:31:32 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4664/
16/12/06 16:31:32 INFO mapreduce.Job: Running job: job_1480588584072_4664
16/12/06 16:31:44 INFO mapreduce.Job: Job job_1480588584072_4664 running in uber mode : false
16/12/06 16:31:44 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 16:32:26 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 16:32:30 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 16:32:32 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 16:32:33 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 16:32:34 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 16:32:35 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 16:32:36 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 16:32:38 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 16:32:39 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 16:32:40 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 16:32:46 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 16:32:47 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 16:32:48 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 16:32:49 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 16:32:50 INFO mapreduce.Job:  map 27% reduce 0%
16/12/06 16:32:51 INFO mapreduce.Job:  map 32% reduce 0%
16/12/06 16:32:52 INFO mapreduce.Job:  map 38% reduce 0%
16/12/06 16:32:53 INFO mapreduce.Job:  map 39% reduce 0%
16/12/06 16:32:55 INFO mapreduce.Job:  map 42% reduce 0%
16/12/06 16:32:56 INFO mapreduce.Job:  map 44% reduce 0%
16/12/06 16:32:58 INFO mapreduce.Job:  map 45% reduce 0%
16/12/06 16:33:04 INFO mapreduce.Job:  map 51% reduce 1%
16/12/06 16:33:05 INFO mapreduce.Job:  map 54% reduce 1%
16/12/06 16:33:06 INFO mapreduce.Job:  map 58% reduce 2%
16/12/06 16:33:07 INFO mapreduce.Job:  map 61% reduce 2%
16/12/06 16:33:08 INFO mapreduce.Job:  map 63% reduce 4%
16/12/06 16:33:09 INFO mapreduce.Job:  map 64% reduce 11%
16/12/06 16:33:10 INFO mapreduce.Job:  map 65% reduce 11%
16/12/06 16:33:11 INFO mapreduce.Job:  map 69% reduce 12%
16/12/06 16:33:13 INFO mapreduce.Job:  map 70% reduce 13%
16/12/06 16:33:14 INFO mapreduce.Job:  map 71% reduce 15%
16/12/06 16:33:15 INFO mapreduce.Job:  map 75% reduce 20%
16/12/06 16:33:16 INFO mapreduce.Job:  map 77% reduce 22%
16/12/06 16:33:17 INFO mapreduce.Job:  map 79% reduce 23%
16/12/06 16:33:18 INFO mapreduce.Job:  map 81% reduce 25%
16/12/06 16:33:19 INFO mapreduce.Job:  map 81% reduce 26%
16/12/06 16:33:20 INFO mapreduce.Job:  map 83% reduce 26%
16/12/06 16:33:21 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 16:33:22 INFO mapreduce.Job:  map 86% reduce 27%
16/12/06 16:33:23 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 16:33:24 INFO mapreduce.Job:  map 91% reduce 29%
16/12/06 16:33:25 INFO mapreduce.Job:  map 92% reduce 29%
16/12/06 16:33:26 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 16:33:28 INFO mapreduce.Job:  map 93% reduce 31%
16/12/06 16:33:33 INFO mapreduce.Job:  map 94% reduce 31%
16/12/06 16:33:34 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 16:33:35 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 16:33:36 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 16:33:37 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 16:33:38 INFO mapreduce.Job:  map 99% reduce 33%
16/12/06 16:33:39 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 16:33:40 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 16:33:41 INFO mapreduce.Job:  map 100% reduce 39%
16/12/06 16:33:42 INFO mapreduce.Job:  map 100% reduce 47%
16/12/06 16:33:43 INFO mapreduce.Job:  map 100% reduce 54%
16/12/06 16:33:44 INFO mapreduce.Job:  map 100% reduce 65%
16/12/06 16:33:45 INFO mapreduce.Job:  map 100% reduce 68%
16/12/06 16:33:46 INFO mapreduce.Job:  map 100% reduce 71%
16/12/06 16:33:47 INFO mapreduce.Job:  map 100% reduce 74%
16/12/06 16:33:48 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 16:33:49 INFO mapreduce.Job:  map 100% reduce 79%
16/12/06 16:33:50 INFO mapreduce.Job:  map 100% reduce 82%
16/12/06 16:33:51 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 16:33:52 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 16:33:53 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 16:33:54 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 16:33:55 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 16:33:57 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 16:34:00 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 16:34:02 INFO mapreduce.Job: Job job_1480588584072_4664 completed successfully
16/12/06 16:34:02 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=814393542
		FILE: Number of bytes written=1661169049
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=693296743
		WASB: Number of bytes written=424349197
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=21471160
		Total time spent by all reduces in occupied slots (ms)=2612216
		Total time spent by all map tasks (ms)=10735580
		Total time spent by all reduce tasks (ms)=1306108
		Total vcore-seconds taken by all map tasks=10735580
		Total vcore-seconds taken by all reduce tasks=1306108
		Total megabyte-seconds taken by all map tasks=10993233920
		Total megabyte-seconds taken by all reduce tasks=1337454592
	Map-Reduce Framework
		Map input records=2220560
		Map output records=1982067
		Map output bytes=806745602
		Map output materialized bytes=814417062
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1740138
		Reduce shuffle bytes=814417062
		Reduce input records=1982067
		Reduce output records=1251945
		Spilled Records=3964134
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=91372
		CPU time spent (ms)=989090
		Physical memory (bytes) snapshot=324419833856
		Virtual memory (bytes) snapshot=742455578624
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=690600739
	File Output Format Counters 
		Bytes Written=424349197
16/12/06 16:34:02 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020700 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020700
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8285473565638093254.jar tmpDir=null
16/12/06 16:34:41 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:34:42 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:34:43 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 16:34:44 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 16:34:45 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 16:34:45 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4667
16/12/06 16:34:46 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4667
16/12/06 16:34:46 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4667/
16/12/06 16:34:46 INFO mapreduce.Job: Running job: job_1480588584072_4667
16/12/06 16:34:59 INFO mapreduce.Job: Job job_1480588584072_4667 running in uber mode : false
16/12/06 16:34:59 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 16:35:27 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 16:35:28 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 16:35:29 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 16:35:30 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 16:35:31 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 16:35:34 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 16:35:35 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 16:35:36 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 16:35:38 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 16:35:39 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 16:35:40 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 16:35:41 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 16:35:42 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 16:35:43 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 16:35:44 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 16:35:46 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 16:35:48 INFO mapreduce.Job:  map 27% reduce 0%
16/12/06 16:35:50 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 16:35:52 INFO mapreduce.Job:  map 30% reduce 0%
16/12/06 16:35:53 INFO mapreduce.Job:  map 32% reduce 0%
16/12/06 16:35:54 INFO mapreduce.Job:  map 33% reduce 0%
16/12/06 16:35:55 INFO mapreduce.Job:  map 37% reduce 0%
16/12/06 16:35:56 INFO mapreduce.Job:  map 40% reduce 0%
16/12/06 16:35:57 INFO mapreduce.Job:  map 42% reduce 0%
16/12/06 16:35:58 INFO mapreduce.Job:  map 43% reduce 0%
16/12/06 16:36:00 INFO mapreduce.Job:  map 44% reduce 0%
16/12/06 16:36:01 INFO mapreduce.Job:  map 44% reduce 1%
16/12/06 16:36:03 INFO mapreduce.Job:  map 44% reduce 2%
16/12/06 16:36:04 INFO mapreduce.Job:  map 44% reduce 3%
16/12/06 16:36:05 INFO mapreduce.Job:  map 45% reduce 3%
16/12/06 16:36:06 INFO mapreduce.Job:  map 45% reduce 5%
16/12/06 16:36:07 INFO mapreduce.Job:  map 47% reduce 7%
16/12/06 16:36:08 INFO mapreduce.Job:  map 49% reduce 11%
16/12/06 16:36:09 INFO mapreduce.Job:  map 51% reduce 15%
16/12/06 16:36:10 INFO mapreduce.Job:  map 55% reduce 16%
16/12/06 16:36:11 INFO mapreduce.Job:  map 58% reduce 17%
16/12/06 16:36:12 INFO mapreduce.Job:  map 59% reduce 18%
16/12/06 16:36:13 INFO mapreduce.Job:  map 63% reduce 19%
16/12/06 16:36:14 INFO mapreduce.Job:  map 66% reduce 19%
16/12/06 16:36:15 INFO mapreduce.Job:  map 69% reduce 21%
16/12/06 16:36:16 INFO mapreduce.Job:  map 70% reduce 21%
16/12/06 16:36:17 INFO mapreduce.Job:  map 70% reduce 23%
16/12/06 16:36:23 INFO mapreduce.Job:  map 71% reduce 23%
16/12/06 16:36:26 INFO mapreduce.Job:  map 72% reduce 23%
16/12/06 16:36:28 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 16:36:29 INFO mapreduce.Job:  map 74% reduce 24%
16/12/06 16:36:30 INFO mapreduce.Job:  map 76% reduce 24%
16/12/06 16:36:31 INFO mapreduce.Job:  map 77% reduce 24%
16/12/06 16:36:32 INFO mapreduce.Job:  map 79% reduce 25%
16/12/06 16:36:33 INFO mapreduce.Job:  map 81% reduce 25%
16/12/06 16:36:34 INFO mapreduce.Job:  map 81% reduce 26%
16/12/06 16:36:35 INFO mapreduce.Job:  map 82% reduce 27%
16/12/06 16:36:39 INFO mapreduce.Job:  map 83% reduce 27%
16/12/06 16:36:41 INFO mapreduce.Job:  map 84% reduce 27%
16/12/06 16:36:43 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 16:36:46 INFO mapreduce.Job:  map 86% reduce 27%
16/12/06 16:36:47 INFO mapreduce.Job:  map 87% reduce 28%
16/12/06 16:36:48 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 16:36:49 INFO mapreduce.Job:  map 89% reduce 28%
16/12/06 16:36:51 INFO mapreduce.Job:  map 90% reduce 28%
16/12/06 16:36:52 INFO mapreduce.Job:  map 92% reduce 28%
16/12/06 16:36:53 INFO mapreduce.Job:  map 92% reduce 29%
16/12/06 16:36:54 INFO mapreduce.Job:  map 94% reduce 29%
16/12/06 16:36:56 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 16:36:57 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 16:36:58 INFO mapreduce.Job:  map 98% reduce 31%
16/12/06 16:36:59 INFO mapreduce.Job:  map 99% reduce 31%
16/12/06 16:37:00 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 16:37:02 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 16:37:03 INFO mapreduce.Job:  map 100% reduce 39%
16/12/06 16:37:04 INFO mapreduce.Job:  map 100% reduce 48%
16/12/06 16:37:05 INFO mapreduce.Job:  map 100% reduce 55%
16/12/06 16:37:06 INFO mapreduce.Job:  map 100% reduce 61%
16/12/06 16:37:07 INFO mapreduce.Job:  map 100% reduce 67%
16/12/06 16:37:08 INFO mapreduce.Job:  map 100% reduce 69%
16/12/06 16:37:09 INFO mapreduce.Job:  map 100% reduce 72%
16/12/06 16:37:10 INFO mapreduce.Job:  map 100% reduce 75%
16/12/06 16:37:11 INFO mapreduce.Job:  map 100% reduce 77%
16/12/06 16:37:12 INFO mapreduce.Job:  map 100% reduce 81%
16/12/06 16:37:13 INFO mapreduce.Job:  map 100% reduce 84%
16/12/06 16:37:14 INFO mapreduce.Job:  map 100% reduce 88%
16/12/06 16:37:15 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 16:37:16 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 16:37:17 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 16:37:19 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 16:37:20 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 16:37:21 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 16:37:23 INFO mapreduce.Job: Job job_1480588584072_4667 completed successfully
16/12/06 16:37:23 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=754956656
		FILE: Number of bytes written=1542295277
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=649305711
		WASB: Number of bytes written=359827631
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=20613166
		Total time spent by all reduces in occupied slots (ms)=3855968
		Total time spent by all map tasks (ms)=10306583
		Total time spent by all reduce tasks (ms)=1927984
		Total vcore-seconds taken by all map tasks=10306583
		Total vcore-seconds taken by all reduce tasks=1927984
		Total megabyte-seconds taken by all map tasks=10553940992
		Total megabyte-seconds taken by all reduce tasks=1974255616
	Map-Reduce Framework
		Map input records=2102407
		Map output records=1846768
		Map output bytes=747818050
		Map output materialized bytes=754980176
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1601557
		Reduce shuffle bytes=754980176
		Reduce input records=1846768
		Reduce output records=1064797
		Spilled Records=3693536
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=121238
		CPU time spent (ms)=983950
		Physical memory (bytes) snapshot=324397162496
		Virtual memory (bytes) snapshot=742100131840
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=646609707
	File Output Format Counters 
		Bytes Written=359827631
16/12/06 16:37:23 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020800 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020800
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1378077789359798268.jar tmpDir=null
16/12/06 16:38:02 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:38:03 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:38:03 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 16:38:06 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 16:38:06 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 16:38:07 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4670
16/12/06 16:38:08 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4670
16/12/06 16:38:08 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4670/
16/12/06 16:38:08 INFO mapreduce.Job: Running job: job_1480588584072_4670
16/12/06 16:38:20 INFO mapreduce.Job: Job job_1480588584072_4670 running in uber mode : false
16/12/06 16:38:20 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 16:39:07 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 16:39:13 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 16:39:14 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 16:39:15 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 16:39:17 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 16:39:20 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 16:39:21 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 16:39:26 INFO mapreduce.Job:  map 27% reduce 0%
16/12/06 16:39:28 INFO mapreduce.Job:  map 31% reduce 0%
16/12/06 16:39:30 INFO mapreduce.Job:  map 33% reduce 0%
16/12/06 16:39:31 INFO mapreduce.Job:  map 41% reduce 0%
16/12/06 16:39:33 INFO mapreduce.Job:  map 42% reduce 0%
16/12/06 16:39:35 INFO mapreduce.Job:  map 45% reduce 0%
16/12/06 16:39:36 INFO mapreduce.Job:  map 49% reduce 0%
16/12/06 16:39:37 INFO mapreduce.Job:  map 51% reduce 0%
16/12/06 16:39:39 INFO mapreduce.Job:  map 54% reduce 0%
16/12/06 16:39:40 INFO mapreduce.Job:  map 58% reduce 0%
16/12/06 16:39:41 INFO mapreduce.Job:  map 60% reduce 0%
16/12/06 16:39:42 INFO mapreduce.Job:  map 62% reduce 0%
16/12/06 16:39:44 INFO mapreduce.Job:  map 66% reduce 0%
16/12/06 16:39:47 INFO mapreduce.Job:  map 69% reduce 0%
16/12/06 16:39:48 INFO mapreduce.Job:  map 72% reduce 0%
16/12/06 16:39:49 INFO mapreduce.Job:  map 79% reduce 0%
16/12/06 16:39:50 INFO mapreduce.Job:  map 82% reduce 0%
16/12/06 16:39:51 INFO mapreduce.Job:  map 84% reduce 0%
16/12/06 16:39:52 INFO mapreduce.Job:  map 85% reduce 0%
16/12/06 16:39:53 INFO mapreduce.Job:  map 85% reduce 3%
16/12/06 16:39:54 INFO mapreduce.Job:  map 86% reduce 9%
16/12/06 16:39:55 INFO mapreduce.Job:  map 88% reduce 12%
16/12/06 16:39:56 INFO mapreduce.Job:  map 89% reduce 14%
16/12/06 16:39:57 INFO mapreduce.Job:  map 89% reduce 16%
16/12/06 16:39:58 INFO mapreduce.Job:  map 91% reduce 16%
16/12/06 16:39:59 INFO mapreduce.Job:  map 93% reduce 19%
16/12/06 16:40:00 INFO mapreduce.Job:  map 93% reduce 20%
16/12/06 16:40:04 INFO mapreduce.Job:  map 94% reduce 23%
16/12/06 16:40:06 INFO mapreduce.Job:  map 95% reduce 23%
16/12/06 16:40:07 INFO mapreduce.Job:  map 96% reduce 26%
16/12/06 16:40:08 INFO mapreduce.Job:  map 97% reduce 30%
16/12/06 16:40:09 INFO mapreduce.Job:  map 99% reduce 30%
16/12/06 16:40:10 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 16:40:11 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 16:40:12 INFO mapreduce.Job:  map 100% reduce 39%
16/12/06 16:40:13 INFO mapreduce.Job:  map 100% reduce 46%
16/12/06 16:40:14 INFO mapreduce.Job:  map 100% reduce 56%
16/12/06 16:40:15 INFO mapreduce.Job:  map 100% reduce 66%
16/12/06 16:40:16 INFO mapreduce.Job:  map 100% reduce 71%
16/12/06 16:40:17 INFO mapreduce.Job:  map 100% reduce 75%
16/12/06 16:40:18 INFO mapreduce.Job:  map 100% reduce 78%
16/12/06 16:40:19 INFO mapreduce.Job:  map 100% reduce 83%
16/12/06 16:40:20 INFO mapreduce.Job:  map 100% reduce 88%
16/12/06 16:40:21 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 16:40:22 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 16:40:24 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 16:40:25 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 16:40:30 INFO mapreduce.Job: Job job_1480588584072_4670 completed successfully
16/12/06 16:40:30 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=941610397
		FILE: Number of bytes written=1915602759
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=798202388
		WASB: Number of bytes written=496176985
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=21739426
		Total time spent by all reduces in occupied slots (ms)=1912908
		Total time spent by all map tasks (ms)=10869713
		Total time spent by all reduce tasks (ms)=956454
		Total vcore-seconds taken by all map tasks=10869713
		Total vcore-seconds taken by all reduce tasks=956454
		Total megabyte-seconds taken by all map tasks=11130586112
		Total megabyte-seconds taken by all reduce tasks=979408896
	Map-Reduce Framework
		Map input records=2564411
		Map output records=2299764
		Map output bytes=932759707
		Map output materialized bytes=941633917
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2013245
		Reduce shuffle bytes=941633917
		Reduce input records=2299764
		Reduce output records=1476282
		Spilled Records=4599528
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=120320
		CPU time spent (ms)=1014790
		Physical memory (bytes) snapshot=325368700928
		Virtual memory (bytes) snapshot=742378205184
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=795506384
	File Output Format Counters 
		Bytes Written=496176985
16/12/06 16:40:30 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020900
16/12/06 16:41:10 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020900 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020900
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5638432041109486586.jar tmpDir=null
16/12/06 16:41:17 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:41:18 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:41:18 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 16:41:20 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 16:41:20 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 16:41:21 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4673
16/12/06 16:41:21 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4673
16/12/06 16:41:21 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4673/
16/12/06 16:41:21 INFO mapreduce.Job: Running job: job_1480588584072_4673
16/12/06 16:41:34 INFO mapreduce.Job: Job job_1480588584072_4673 running in uber mode : false
16/12/06 16:41:34 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 16:41:45 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 16:41:46 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 16:42:08 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 16:42:10 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 16:42:11 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 16:42:13 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 16:42:14 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 16:42:15 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 16:42:16 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 16:42:17 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 16:42:18 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 16:42:19 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 16:42:20 INFO mapreduce.Job:  map 27% reduce 0%
16/12/06 16:42:23 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 16:42:27 INFO mapreduce.Job:  map 29% reduce 0%
16/12/06 16:42:31 INFO mapreduce.Job:  map 30% reduce 0%
16/12/06 16:42:34 INFO mapreduce.Job:  map 32% reduce 0%
16/12/06 16:42:35 INFO mapreduce.Job:  map 33% reduce 0%
16/12/06 16:42:36 INFO mapreduce.Job:  map 34% reduce 1%
16/12/06 16:42:38 INFO mapreduce.Job:  map 36% reduce 1%
16/12/06 16:42:39 INFO mapreduce.Job:  map 37% reduce 2%
16/12/06 16:42:40 INFO mapreduce.Job:  map 39% reduce 3%
16/12/06 16:42:41 INFO mapreduce.Job:  map 41% reduce 5%
16/12/06 16:42:42 INFO mapreduce.Job:  map 43% reduce 8%
16/12/06 16:42:43 INFO mapreduce.Job:  map 44% reduce 8%
16/12/06 16:42:44 INFO mapreduce.Job:  map 46% reduce 10%
16/12/06 16:42:45 INFO mapreduce.Job:  map 47% reduce 12%
16/12/06 16:42:46 INFO mapreduce.Job:  map 50% reduce 13%
16/12/06 16:42:47 INFO mapreduce.Job:  map 53% reduce 14%
16/12/06 16:42:48 INFO mapreduce.Job:  map 57% reduce 16%
16/12/06 16:42:49 INFO mapreduce.Job:  map 62% reduce 17%
16/12/06 16:42:50 INFO mapreduce.Job:  map 65% reduce 19%
16/12/06 16:42:51 INFO mapreduce.Job:  map 69% reduce 20%
16/12/06 16:42:52 INFO mapreduce.Job:  map 70% reduce 21%
16/12/06 16:42:53 INFO mapreduce.Job:  map 71% reduce 22%
16/12/06 16:42:54 INFO mapreduce.Job:  map 71% reduce 23%
16/12/06 16:42:55 INFO mapreduce.Job:  map 72% reduce 23%
16/12/06 16:42:56 INFO mapreduce.Job:  map 72% reduce 24%
16/12/06 16:42:59 INFO mapreduce.Job:  map 73% reduce 24%
16/12/06 16:43:05 INFO mapreduce.Job:  map 74% reduce 24%
16/12/06 16:43:06 INFO mapreduce.Job:  map 75% reduce 24%
16/12/06 16:43:08 INFO mapreduce.Job:  map 76% reduce 24%
16/12/06 16:43:09 INFO mapreduce.Job:  map 76% reduce 25%
16/12/06 16:43:10 INFO mapreduce.Job:  map 78% reduce 25%
16/12/06 16:43:11 INFO mapreduce.Job:  map 79% reduce 25%
16/12/06 16:43:12 INFO mapreduce.Job:  map 82% reduce 26%
16/12/06 16:43:13 INFO mapreduce.Job:  map 83% reduce 26%
16/12/06 16:43:14 INFO mapreduce.Job:  map 86% reduce 26%
16/12/06 16:43:15 INFO mapreduce.Job:  map 87% reduce 27%
16/12/06 16:43:16 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 16:43:17 INFO mapreduce.Job:  map 89% reduce 28%
16/12/06 16:43:18 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 16:43:19 INFO mapreduce.Job:  map 91% reduce 29%
16/12/06 16:43:20 INFO mapreduce.Job:  map 92% reduce 29%
16/12/06 16:43:21 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 16:43:22 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 16:43:24 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 16:43:25 INFO mapreduce.Job:  map 98% reduce 31%
16/12/06 16:43:26 INFO mapreduce.Job:  map 99% reduce 31%
16/12/06 16:43:27 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 16:43:28 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 16:43:29 INFO mapreduce.Job:  map 100% reduce 37%
16/12/06 16:43:30 INFO mapreduce.Job:  map 100% reduce 46%
16/12/06 16:43:31 INFO mapreduce.Job:  map 100% reduce 51%
16/12/06 16:43:32 INFO mapreduce.Job:  map 100% reduce 56%
16/12/06 16:43:33 INFO mapreduce.Job:  map 100% reduce 64%
16/12/06 16:43:34 INFO mapreduce.Job:  map 100% reduce 67%
16/12/06 16:43:35 INFO mapreduce.Job:  map 100% reduce 68%
16/12/06 16:43:36 INFO mapreduce.Job:  map 100% reduce 71%
16/12/06 16:43:37 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 16:43:40 INFO mapreduce.Job:  map 100% reduce 79%
16/12/06 16:43:41 INFO mapreduce.Job:  map 100% reduce 85%
16/12/06 16:43:42 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 16:43:43 INFO mapreduce.Job:  map 100% reduce 88%
16/12/06 16:43:44 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 16:43:45 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 16:43:46 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 16:43:48 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 16:43:49 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 16:43:52 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 16:43:54 INFO mapreduce.Job: Job job_1480588584072_4673 completed successfully
16/12/06 16:43:54 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=935794816
		FILE: Number of bytes written=1903971597
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=798469853
		WASB: Number of bytes written=480231840
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=20189278
		Total time spent by all reduces in occupied slots (ms)=3503282
		Total time spent by all map tasks (ms)=10094639
		Total time spent by all reduce tasks (ms)=1751641
		Total vcore-seconds taken by all map tasks=10094639
		Total vcore-seconds taken by all reduce tasks=1751641
		Total megabyte-seconds taken by all map tasks=10336910336
		Total megabyte-seconds taken by all reduce tasks=1793680384
	Map-Reduce Framework
		Map input records=2562466
		Map output records=2279406
		Map output bytes=926998070
		Map output materialized bytes=935818336
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1986741
		Reduce shuffle bytes=935818336
		Reduce input records=2279406
		Reduce output records=1419040
		Spilled Records=4558812
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=117786
		CPU time spent (ms)=1043600
		Physical memory (bytes) snapshot=325244461056
		Virtual memory (bytes) snapshot=742121877504
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=795773849
	File Output Format Counters 
		Bytes Written=480231840
16/12/06 16:43:54 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1400 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1400': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1183848365962906705.jar tmpDir=null
16/12/06 16:44:31 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:44:32 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:44:32 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 16:44:34 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 16:44:34 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 16:44:35 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4676
16/12/06 16:44:36 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4676
16/12/06 16:44:36 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4676/
16/12/06 16:44:36 INFO mapreduce.Job: Running job: job_1480588584072_4676
16/12/06 16:44:55 INFO mapreduce.Job: Job job_1480588584072_4676 running in uber mode : false
16/12/06 16:44:55 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 16:45:18 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 16:45:22 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 16:45:24 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 16:45:26 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 16:45:27 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 16:45:28 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 16:45:41 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 16:45:43 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 16:45:44 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 16:45:46 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 16:45:47 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 16:45:49 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 16:45:50 INFO mapreduce.Job:  map 29% reduce 0%
16/12/06 16:45:51 INFO mapreduce.Job:  map 30% reduce 0%
16/12/06 16:45:52 INFO mapreduce.Job:  map 31% reduce 0%
16/12/06 16:45:53 INFO mapreduce.Job:  map 33% reduce 0%
16/12/06 16:45:54 INFO mapreduce.Job:  map 34% reduce 0%
16/12/06 16:45:55 INFO mapreduce.Job:  map 35% reduce 0%
16/12/06 16:45:56 INFO mapreduce.Job:  map 36% reduce 0%
16/12/06 16:45:58 INFO mapreduce.Job:  map 37% reduce 0%
16/12/06 16:45:59 INFO mapreduce.Job:  map 38% reduce 0%
16/12/06 16:46:00 INFO mapreduce.Job:  map 39% reduce 0%
16/12/06 16:46:01 INFO mapreduce.Job:  map 39% reduce 1%
16/12/06 16:46:02 INFO mapreduce.Job:  map 41% reduce 1%
16/12/06 16:46:03 INFO mapreduce.Job:  map 43% reduce 1%
16/12/06 16:46:04 INFO mapreduce.Job:  map 44% reduce 1%
16/12/06 16:46:06 INFO mapreduce.Job:  map 44% reduce 2%
16/12/06 16:46:07 INFO mapreduce.Job:  map 44% reduce 3%
16/12/06 16:46:08 INFO mapreduce.Job:  map 45% reduce 4%
16/12/06 16:46:09 INFO mapreduce.Job:  map 47% reduce 5%
16/12/06 16:46:10 INFO mapreduce.Job:  map 48% reduce 7%
16/12/06 16:46:11 INFO mapreduce.Job:  map 50% reduce 8%
16/12/06 16:46:12 INFO mapreduce.Job:  map 53% reduce 10%
16/12/06 16:46:13 INFO mapreduce.Job:  map 57% reduce 11%
16/12/06 16:46:14 INFO mapreduce.Job:  map 60% reduce 14%
16/12/06 16:46:15 INFO mapreduce.Job:  map 62% reduce 16%
16/12/06 16:46:16 INFO mapreduce.Job:  map 66% reduce 19%
16/12/06 16:46:17 INFO mapreduce.Job:  map 71% reduce 19%
16/12/06 16:46:18 INFO mapreduce.Job:  map 71% reduce 21%
16/12/06 16:46:19 INFO mapreduce.Job:  map 72% reduce 23%
16/12/06 16:46:21 INFO mapreduce.Job:  map 73% reduce 24%
16/12/06 16:46:24 INFO mapreduce.Job:  map 74% reduce 24%
16/12/06 16:46:26 INFO mapreduce.Job:  map 76% reduce 24%
16/12/06 16:46:27 INFO mapreduce.Job:  map 78% reduce 25%
16/12/06 16:46:28 INFO mapreduce.Job:  map 80% reduce 25%
16/12/06 16:46:29 INFO mapreduce.Job:  map 81% reduce 26%
16/12/06 16:46:31 INFO mapreduce.Job:  map 81% reduce 27%
16/12/06 16:46:34 INFO mapreduce.Job:  map 82% reduce 27%
16/12/06 16:46:35 INFO mapreduce.Job:  map 83% reduce 27%
16/12/06 16:46:36 INFO mapreduce.Job:  map 84% reduce 27%
16/12/06 16:46:37 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 16:46:38 INFO mapreduce.Job:  map 86% reduce 27%
16/12/06 16:46:39 INFO mapreduce.Job:  map 87% reduce 28%
16/12/06 16:46:40 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 16:46:41 INFO mapreduce.Job:  map 89% reduce 28%
16/12/06 16:46:43 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 16:46:45 INFO mapreduce.Job:  map 91% reduce 29%
16/12/06 16:46:46 INFO mapreduce.Job:  map 93% reduce 29%
16/12/06 16:46:47 INFO mapreduce.Job:  map 94% reduce 29%
16/12/06 16:46:48 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 16:46:49 INFO mapreduce.Job:  map 96% reduce 30%
16/12/06 16:46:50 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 16:46:51 INFO mapreduce.Job:  map 98% reduce 31%
16/12/06 16:46:52 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 16:46:54 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 16:46:56 INFO mapreduce.Job:  map 100% reduce 42%
16/12/06 16:46:57 INFO mapreduce.Job:  map 100% reduce 45%
16/12/06 16:46:58 INFO mapreduce.Job:  map 100% reduce 51%
16/12/06 16:46:59 INFO mapreduce.Job:  map 100% reduce 59%
16/12/06 16:47:00 INFO mapreduce.Job:  map 100% reduce 64%
16/12/06 16:47:01 INFO mapreduce.Job:  map 100% reduce 66%
16/12/06 16:47:02 INFO mapreduce.Job:  map 100% reduce 68%
16/12/06 16:47:03 INFO mapreduce.Job:  map 100% reduce 73%
16/12/06 16:47:05 INFO mapreduce.Job:  map 100% reduce 75%
16/12/06 16:47:06 INFO mapreduce.Job:  map 100% reduce 78%
16/12/06 16:47:07 INFO mapreduce.Job:  map 100% reduce 80%
16/12/06 16:47:08 INFO mapreduce.Job:  map 100% reduce 82%
16/12/06 16:47:09 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 16:47:10 INFO mapreduce.Job:  map 100% reduce 88%
16/12/06 16:47:11 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 16:47:12 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 16:47:13 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 16:47:14 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 16:47:15 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 16:47:17 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 16:47:20 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 16:47:24 INFO mapreduce.Job: Job job_1480588584072_4676 completed successfully
16/12/06 16:47:24 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=852047336
		FILE: Number of bytes written=1736476637
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=732675814
		WASB: Number of bytes written=413665251
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=22086772
		Total time spent by all reduces in occupied slots (ms)=3442402
		Total time spent by all map tasks (ms)=11043386
		Total time spent by all reduce tasks (ms)=1721201
		Total vcore-seconds taken by all map tasks=11043386
		Total vcore-seconds taken by all reduce tasks=1721201
		Total megabyte-seconds taken by all map tasks=11308427264
		Total megabyte-seconds taken by all reduce tasks=1762509824
	Map-Reduce Framework
		Map input records=2363810
		Map output records=2078834
		Map output bytes=844015890
		Map output materialized bytes=852070856
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1803031
		Reduce shuffle bytes=852070856
		Reduce input records=2078834
		Reduce output records=1221508
		Spilled Records=4157668
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=120325
		CPU time spent (ms)=1022510
		Physical memory (bytes) snapshot=324622114816
		Virtual memory (bytes) snapshot=742309822464
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=729979810
	File Output Format Counters 
		Bytes Written=413665251
16/12/06 16:47:24 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1400
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1500 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1500': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob439778472553362201.jar tmpDir=null
16/12/06 16:48:02 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:48:02 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:48:03 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 16:48:04 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 16:48:05 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 16:48:05 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4679
16/12/06 16:48:06 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4679
16/12/06 16:48:06 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4679/
16/12/06 16:48:06 INFO mapreduce.Job: Running job: job_1480588584072_4679
16/12/06 16:48:18 INFO mapreduce.Job: Job job_1480588584072_4679 running in uber mode : false
16/12/06 16:48:18 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 16:49:01 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 16:49:04 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 16:49:05 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 16:49:06 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 16:49:08 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 16:49:11 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 16:49:14 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 16:49:16 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 16:49:21 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 16:49:23 INFO mapreduce.Job:  map 29% reduce 0%
16/12/06 16:49:24 INFO mapreduce.Job:  map 30% reduce 0%
16/12/06 16:49:28 INFO mapreduce.Job:  map 37% reduce 0%
16/12/06 16:49:29 INFO mapreduce.Job:  map 40% reduce 0%
16/12/06 16:49:30 INFO mapreduce.Job:  map 57% reduce 0%
16/12/06 16:49:33 INFO mapreduce.Job:  map 65% reduce 0%
16/12/06 16:49:34 INFO mapreduce.Job:  map 68% reduce 0%
16/12/06 16:49:35 INFO mapreduce.Job:  map 70% reduce 0%
16/12/06 16:49:36 INFO mapreduce.Job:  map 72% reduce 0%
16/12/06 16:49:37 INFO mapreduce.Job:  map 73% reduce 0%
16/12/06 16:49:39 INFO mapreduce.Job:  map 75% reduce 0%
16/12/06 16:49:40 INFO mapreduce.Job:  map 77% reduce 0%
16/12/06 16:49:41 INFO mapreduce.Job:  map 81% reduce 0%
16/12/06 16:49:42 INFO mapreduce.Job:  map 83% reduce 0%
16/12/06 16:49:44 INFO mapreduce.Job:  map 85% reduce 0%
16/12/06 16:49:45 INFO mapreduce.Job:  map 87% reduce 0%
16/12/06 16:49:46 INFO mapreduce.Job:  map 88% reduce 1%
16/12/06 16:49:47 INFO mapreduce.Job:  map 90% reduce 1%
16/12/06 16:49:48 INFO mapreduce.Job:  map 91% reduce 4%
16/12/06 16:49:49 INFO mapreduce.Job:  map 91% reduce 8%
16/12/06 16:49:50 INFO mapreduce.Job:  map 92% reduce 8%
16/12/06 16:49:51 INFO mapreduce.Job:  map 92% reduce 11%
16/12/06 16:49:52 INFO mapreduce.Job:  map 92% reduce 12%
16/12/06 16:49:53 INFO mapreduce.Job:  map 93% reduce 14%
16/12/06 16:49:54 INFO mapreduce.Job:  map 94% reduce 14%
16/12/06 16:49:55 INFO mapreduce.Job:  map 94% reduce 16%
16/12/06 16:49:56 INFO mapreduce.Job:  map 95% reduce 17%
16/12/06 16:49:57 INFO mapreduce.Job:  map 95% reduce 20%
16/12/06 16:49:58 INFO mapreduce.Job:  map 96% reduce 25%
16/12/06 16:49:59 INFO mapreduce.Job:  map 96% reduce 28%
16/12/06 16:50:00 INFO mapreduce.Job:  map 97% reduce 29%
16/12/06 16:50:01 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 16:50:02 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 16:50:03 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 16:50:04 INFO mapreduce.Job:  map 100% reduce 43%
16/12/06 16:50:05 INFO mapreduce.Job:  map 100% reduce 49%
16/12/06 16:50:06 INFO mapreduce.Job:  map 100% reduce 58%
16/12/06 16:50:07 INFO mapreduce.Job:  map 100% reduce 65%
16/12/06 16:50:08 INFO mapreduce.Job:  map 100% reduce 71%
16/12/06 16:50:09 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 16:50:10 INFO mapreduce.Job:  map 100% reduce 79%
16/12/06 16:50:11 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 16:50:12 INFO mapreduce.Job:  map 100% reduce 88%
16/12/06 16:50:13 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 16:50:14 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 16:50:15 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 16:50:18 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 16:50:20 INFO mapreduce.Job: Job job_1480588584072_4679 completed successfully
16/12/06 16:50:20 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=919650052
		FILE: Number of bytes written=1871682069
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=786743629
		WASB: Number of bytes written=469891928
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=20546120
		Total time spent by all reduces in occupied slots (ms)=1623726
		Total time spent by all map tasks (ms)=10273060
		Total time spent by all reduce tasks (ms)=811863
		Total vcore-seconds taken by all map tasks=10273060
		Total vcore-seconds taken by all reduce tasks=811863
		Total megabyte-seconds taken by all map tasks=10519613440
		Total megabyte-seconds taken by all reduce tasks=831347712
	Map-Reduce Framework
		Map input records=2520187
		Map output records=2235057
		Map output bytes=911006125
		Map output materialized bytes=919673572
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1950832
		Reduce shuffle bytes=919673572
		Reduce input records=2235057
		Reduce output records=1381500
		Spilled Records=4470114
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=95027
		CPU time spent (ms)=979030
		Physical memory (bytes) snapshot=324803301376
		Virtual memory (bytes) snapshot=742522036224
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=784047625
	File Output Format Counters 
		Bytes Written=469891928
16/12/06 16:50:20 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1500
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1600 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1600': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2380022468228399459.jar tmpDir=null
16/12/06 16:50:57 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:50:58 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:50:58 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 16:51:00 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 16:51:00 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 16:51:00 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4681
16/12/06 16:51:01 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4681
16/12/06 16:51:01 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4681/
16/12/06 16:51:01 INFO mapreduce.Job: Running job: job_1480588584072_4681
16/12/06 16:51:13 INFO mapreduce.Job: Job job_1480588584072_4681 running in uber mode : false
16/12/06 16:51:13 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 16:51:51 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 16:52:01 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 16:52:04 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 16:52:06 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 16:52:07 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 16:52:09 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 16:52:10 INFO mapreduce.Job:  map 27% reduce 0%
16/12/06 16:52:12 INFO mapreduce.Job:  map 29% reduce 0%
16/12/06 16:52:13 INFO mapreduce.Job:  map 30% reduce 0%
16/12/06 16:52:15 INFO mapreduce.Job:  map 36% reduce 0%
16/12/06 16:52:16 INFO mapreduce.Job:  map 37% reduce 0%
16/12/06 16:52:17 INFO mapreduce.Job:  map 38% reduce 0%
16/12/06 16:52:18 INFO mapreduce.Job:  map 44% reduce 0%
16/12/06 16:52:20 INFO mapreduce.Job:  map 45% reduce 0%
16/12/06 16:52:21 INFO mapreduce.Job:  map 48% reduce 0%
16/12/06 16:52:22 INFO mapreduce.Job:  map 49% reduce 0%
16/12/06 16:52:24 INFO mapreduce.Job:  map 52% reduce 0%
16/12/06 16:52:25 INFO mapreduce.Job:  map 54% reduce 0%
16/12/06 16:52:26 INFO mapreduce.Job:  map 55% reduce 1%
16/12/06 16:52:27 INFO mapreduce.Job:  map 56% reduce 1%
16/12/06 16:52:28 INFO mapreduce.Job:  map 58% reduce 1%
16/12/06 16:52:29 INFO mapreduce.Job:  map 60% reduce 1%
16/12/06 16:52:30 INFO mapreduce.Job:  map 61% reduce 1%
16/12/06 16:52:31 INFO mapreduce.Job:  map 63% reduce 1%
16/12/06 16:52:32 INFO mapreduce.Job:  map 65% reduce 3%
16/12/06 16:52:33 INFO mapreduce.Job:  map 67% reduce 3%
16/12/06 16:52:34 INFO mapreduce.Job:  map 69% reduce 3%
16/12/06 16:52:35 INFO mapreduce.Job:  map 73% reduce 4%
16/12/06 16:52:36 INFO mapreduce.Job:  map 76% reduce 4%
16/12/06 16:52:37 INFO mapreduce.Job:  map 77% reduce 6%
16/12/06 16:52:38 INFO mapreduce.Job:  map 80% reduce 8%
16/12/06 16:52:39 INFO mapreduce.Job:  map 82% reduce 9%
16/12/06 16:52:40 INFO mapreduce.Job:  map 82% reduce 11%
16/12/06 16:52:42 INFO mapreduce.Job:  map 84% reduce 14%
16/12/06 16:52:43 INFO mapreduce.Job:  map 86% reduce 16%
16/12/06 16:52:44 INFO mapreduce.Job:  map 88% reduce 18%
16/12/06 16:52:45 INFO mapreduce.Job:  map 89% reduce 18%
16/12/06 16:52:46 INFO mapreduce.Job:  map 90% reduce 20%
16/12/06 16:52:47 INFO mapreduce.Job:  map 93% reduce 20%
16/12/06 16:52:48 INFO mapreduce.Job:  map 95% reduce 22%
16/12/06 16:52:49 INFO mapreduce.Job:  map 97% reduce 25%
16/12/06 16:52:50 INFO mapreduce.Job:  map 99% reduce 26%
16/12/06 16:52:51 INFO mapreduce.Job:  map 100% reduce 29%
16/12/06 16:52:52 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 16:52:53 INFO mapreduce.Job:  map 100% reduce 39%
16/12/06 16:52:54 INFO mapreduce.Job:  map 100% reduce 51%
16/12/06 16:52:55 INFO mapreduce.Job:  map 100% reduce 63%
16/12/06 16:52:56 INFO mapreduce.Job:  map 100% reduce 70%
16/12/06 16:52:57 INFO mapreduce.Job:  map 100% reduce 74%
16/12/06 16:52:58 INFO mapreduce.Job:  map 100% reduce 80%
16/12/06 16:52:59 INFO mapreduce.Job:  map 100% reduce 84%
16/12/06 16:53:00 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 16:53:01 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 16:53:02 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 16:53:03 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 16:53:07 INFO mapreduce.Job: Job job_1480588584072_4681 completed successfully
16/12/06 16:53:08 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=864189427
		FILE: Number of bytes written=1760760819
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=743075644
		WASB: Number of bytes written=418696909
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=20642998
		Total time spent by all reduces in occupied slots (ms)=1715682
		Total time spent by all map tasks (ms)=10321499
		Total time spent by all reduce tasks (ms)=857841
		Total vcore-seconds taken by all map tasks=10321499
		Total vcore-seconds taken by all reduce tasks=857841
		Total megabyte-seconds taken by all map tasks=10569214976
		Total megabyte-seconds taken by all reduce tasks=878429184
	Map-Reduce Framework
		Map input records=2394071
		Map output records=2105043
		Map output bytes=856041370
		Map output materialized bytes=864212947
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1827225
		Reduce shuffle bytes=864212947
		Reduce input records=2105043
		Reduce output records=1230100
		Spilled Records=4210086
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=102852
		CPU time spent (ms)=956850
		Physical memory (bytes) snapshot=324155002880
		Virtual memory (bytes) snapshot=742214762496
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=740379640
	File Output Format Counters 
		Bytes Written=418696909
16/12/06 16:53:08 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1600
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1700 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612020900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1700': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2983848238889398738.jar tmpDir=null
16/12/06 16:53:46 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:53:47 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:53:47 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 16:53:49 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 16:53:50 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 16:53:50 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4684
16/12/06 16:53:51 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4684
16/12/06 16:53:51 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4684/
16/12/06 16:53:51 INFO mapreduce.Job: Running job: job_1480588584072_4684
16/12/06 16:54:04 INFO mapreduce.Job: Job job_1480588584072_4684 running in uber mode : false
16/12/06 16:54:04 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 16:54:22 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 16:54:24 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 16:54:26 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 16:54:37 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 16:54:38 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 16:54:39 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 16:54:40 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 16:54:41 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 16:54:47 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 16:54:48 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 16:54:49 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 16:54:50 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 16:54:51 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 16:54:52 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 16:54:53 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 16:54:55 INFO mapreduce.Job:  map 27% reduce 0%
16/12/06 16:54:56 INFO mapreduce.Job:  map 29% reduce 0%
16/12/06 16:54:57 INFO mapreduce.Job:  map 31% reduce 0%
16/12/06 16:54:58 INFO mapreduce.Job:  map 32% reduce 0%
16/12/06 16:54:59 INFO mapreduce.Job:  map 33% reduce 0%
16/12/06 16:55:01 INFO mapreduce.Job:  map 37% reduce 0%
16/12/06 16:55:02 INFO mapreduce.Job:  map 38% reduce 0%
16/12/06 16:55:03 INFO mapreduce.Job:  map 39% reduce 0%
16/12/06 16:55:04 INFO mapreduce.Job:  map 40% reduce 0%
16/12/06 16:55:05 INFO mapreduce.Job:  map 41% reduce 0%
16/12/06 16:55:06 INFO mapreduce.Job:  map 41% reduce 1%
16/12/06 16:55:07 INFO mapreduce.Job:  map 42% reduce 1%
16/12/06 16:55:08 INFO mapreduce.Job:  map 43% reduce 1%
16/12/06 16:55:12 INFO mapreduce.Job:  map 44% reduce 2%
16/12/06 16:55:14 INFO mapreduce.Job:  map 45% reduce 4%
16/12/06 16:55:15 INFO mapreduce.Job:  map 46% reduce 6%
16/12/06 16:55:16 INFO mapreduce.Job:  map 48% reduce 9%
16/12/06 16:55:17 INFO mapreduce.Job:  map 52% reduce 10%
16/12/06 16:55:18 INFO mapreduce.Job:  map 54% reduce 13%
16/12/06 16:55:19 INFO mapreduce.Job:  map 55% reduce 15%
16/12/06 16:55:20 INFO mapreduce.Job:  map 57% reduce 15%
16/12/06 16:55:21 INFO mapreduce.Job:  map 58% reduce 17%
16/12/06 16:55:22 INFO mapreduce.Job:  map 60% reduce 18%
16/12/06 16:55:23 INFO mapreduce.Job:  map 63% reduce 19%
16/12/06 16:55:24 INFO mapreduce.Job:  map 66% reduce 20%
16/12/06 16:55:25 INFO mapreduce.Job:  map 69% reduce 20%
16/12/06 16:55:26 INFO mapreduce.Job:  map 70% reduce 21%
16/12/06 16:55:27 INFO mapreduce.Job:  map 70% reduce 22%
16/12/06 16:55:28 INFO mapreduce.Job:  map 70% reduce 23%
16/12/06 16:55:29 INFO mapreduce.Job:  map 71% reduce 23%
16/12/06 16:55:31 INFO mapreduce.Job:  map 72% reduce 24%
16/12/06 16:55:32 INFO mapreduce.Job:  map 73% reduce 24%
16/12/06 16:55:33 INFO mapreduce.Job:  map 74% reduce 24%
16/12/06 16:55:34 INFO mapreduce.Job:  map 75% reduce 24%
16/12/06 16:55:35 INFO mapreduce.Job:  map 76% reduce 24%
16/12/06 16:55:36 INFO mapreduce.Job:  map 78% reduce 25%
16/12/06 16:55:37 INFO mapreduce.Job:  map 79% reduce 25%
16/12/06 16:55:38 INFO mapreduce.Job:  map 81% reduce 26%
16/12/06 16:55:40 INFO mapreduce.Job:  map 81% reduce 27%
16/12/06 16:55:41 INFO mapreduce.Job:  map 82% reduce 27%
16/12/06 16:55:45 INFO mapreduce.Job:  map 83% reduce 27%
16/12/06 16:55:46 INFO mapreduce.Job:  map 84% reduce 27%
16/12/06 16:55:48 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 16:55:50 INFO mapreduce.Job:  map 86% reduce 27%
16/12/06 16:55:52 INFO mapreduce.Job:  map 87% reduce 27%
16/12/06 16:55:53 INFO mapreduce.Job:  map 88% reduce 27%
16/12/06 16:55:55 INFO mapreduce.Job:  map 89% reduce 28%
16/12/06 16:55:57 INFO mapreduce.Job:  map 90% reduce 28%
16/12/06 16:55:58 INFO mapreduce.Job:  map 91% reduce 28%
16/12/06 16:56:00 INFO mapreduce.Job:  map 92% reduce 29%
16/12/06 16:56:03 INFO mapreduce.Job:  map 93% reduce 29%
16/12/06 16:56:04 INFO mapreduce.Job:  map 94% reduce 29%
16/12/06 16:56:05 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 16:56:07 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 16:56:08 INFO mapreduce.Job:  map 96% reduce 30%
16/12/06 16:56:10 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 16:56:11 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 16:56:13 INFO mapreduce.Job:  map 98% reduce 31%
16/12/06 16:56:14 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 16:56:15 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 16:56:20 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 16:56:21 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 16:56:23 INFO mapreduce.Job:  map 100% reduce 36%
16/12/06 16:56:24 INFO mapreduce.Job:  map 100% reduce 47%
16/12/06 16:56:25 INFO mapreduce.Job:  map 100% reduce 49%
16/12/06 16:56:26 INFO mapreduce.Job:  map 100% reduce 58%
16/12/06 16:56:27 INFO mapreduce.Job:  map 100% reduce 62%
16/12/06 16:56:28 INFO mapreduce.Job:  map 100% reduce 67%
16/12/06 16:56:29 INFO mapreduce.Job:  map 100% reduce 70%
16/12/06 16:56:30 INFO mapreduce.Job:  map 100% reduce 74%
16/12/06 16:56:31 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 16:56:32 INFO mapreduce.Job:  map 100% reduce 78%
16/12/06 16:56:33 INFO mapreduce.Job:  map 100% reduce 80%
16/12/06 16:56:34 INFO mapreduce.Job:  map 100% reduce 81%
16/12/06 16:56:35 INFO mapreduce.Job:  map 100% reduce 84%
16/12/06 16:56:36 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 16:56:37 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 16:56:38 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 16:56:39 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 16:56:40 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 16:56:41 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 16:56:42 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 16:56:43 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 16:56:44 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 16:56:47 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 16:56:50 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 16:56:56 INFO mapreduce.Job: Job job_1480588584072_4684 completed successfully
16/12/06 16:56:56 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=903732515
		FILE: Number of bytes written=1839846995
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=775094532
		WASB: Number of bytes written=439855377
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=22138140
		Total time spent by all reduces in occupied slots (ms)=4339184
		Total time spent by all map tasks (ms)=11069070
		Total time spent by all reduce tasks (ms)=2169592
		Total vcore-seconds taken by all map tasks=11069070
		Total vcore-seconds taken by all reduce tasks=2169592
		Total megabyte-seconds taken by all map tasks=11334727680
		Total megabyte-seconds taken by all reduce tasks=2221662208
	Map-Reduce Framework
		Map input records=2504683
		Map output records=2206906
		Map output bytes=895205966
		Map output materialized bytes=903756035
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1918368
		Reduce shuffle bytes=903756035
		Reduce input records=2206906
		Reduce output records=1298024
		Spilled Records=4413812
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=130204
		CPU time spent (ms)=1046190
		Physical memory (bytes) snapshot=325446000640
		Virtual memory (bytes) snapshot=742222970880
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=772398528
	File Output Format Counters 
		Bytes Written=439855377
16/12/06 16:56:56 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1700
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/19.done
16/12/06 16:57:07 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021400 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1800 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021400
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1800': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8971316137088395511.jar tmpDir=null
16/12/06 16:57:34 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:57:34 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 16:57:35 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 16:57:37 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 16:57:37 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 16:57:37 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4687
16/12/06 16:57:38 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4687
16/12/06 16:57:38 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4687/
16/12/06 16:57:38 INFO mapreduce.Job: Running job: job_1480588584072_4687
16/12/06 16:58:15 INFO mapreduce.Job: Job job_1480588584072_4687 running in uber mode : false
16/12/06 16:58:15 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 16:58:52 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 16:58:55 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 16:58:57 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 16:58:58 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 16:59:14 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 16:59:16 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 16:59:17 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 16:59:19 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 16:59:22 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 16:59:23 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 16:59:26 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 16:59:29 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 16:59:48 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 16:59:49 INFO mapreduce.Job:  map 17% reduce 0%
d16/12/06 16:59:51 INFO mapreduce.Job:  map 19% reduce 1%
16/12/06 16:59:52 INFO mapreduce.Job:  map 21% reduce 1%
16/12/06 16:59:53 INFO mapreduce.Job:  map 22% reduce 1%
16/12/06 16:59:54 INFO mapreduce.Job:  map 23% reduce 1%
16/12/06 16:59:56 INFO mapreduce.Job:  map 24% reduce 1%
16/12/06 16:59:57 INFO mapreduce.Job:  map 25% reduce 1%
16/12/06 16:59:58 INFO mapreduce.Job:  map 25% reduce 2%
16/12/06 16:59:59 INFO mapreduce.Job:  map 26% reduce 2%
16/12/06 17:00:00 INFO mapreduce.Job:  map 27% reduce 2%
16/12/06 17:00:01 INFO mapreduce.Job:  map 28% reduce 2%
16/12/06 17:00:03 INFO mapreduce.Job:  map 30% reduce 3%
16/12/06 17:00:04 INFO mapreduce.Job:  map 31% reduce 4%
16/12/06 17:00:06 INFO mapreduce.Job:  map 34% reduce 4%
16/12/06 17:00:07 INFO mapreduce.Job:  map 36% reduce 5%
16/12/06 17:00:08 INFO mapreduce.Job:  map 39% reduce 6%
16/12/06 17:00:09 INFO mapreduce.Job:  map 40% reduce 6%
16/12/06 17:00:10 INFO mapreduce.Job:  map 43% reduce 7%
16/12/06 17:00:11 INFO mapreduce.Job:  map 45% reduce 7%
16/12/06 17:00:13 INFO mapreduce.Job:  map 47% reduce 8%
16/12/06 17:00:14 INFO mapreduce.Job:  map 48% reduce 10%
16/12/06 17:00:15 INFO mapreduce.Job:  map 50% reduce 10%
16/12/06 17:00:16 INFO mapreduce.Job:  map 51% reduce 10%
16/12/06 17:00:17 INFO mapreduce.Job:  map 51% reduce 11%
16/12/06 17:00:18 INFO mapreduce.Job:  map 53% reduce 11%
16/12/06 17:00:20 INFO mapreduce.Job:  map 54% reduce 12%
16/12/06 17:00:22 INFO mapreduce.Job:  map 55% reduce 12%
16/12/06 17:00:23 INFO mapreduce.Job:  map 57% reduce 13%
16/12/06 17:00:24 INFO mapreduce.Job:  map 58% reduce 14%
16/12/06 17:00:25 INFO mapreduce.Job:  map 58% reduce 15%
16/12/06 17:00:26 INFO mapreduce.Job:  map 61% reduce 15%
16/12/06 17:00:27 INFO mapreduce.Job:  map 66% reduce 15%
16/12/06 17:00:28 INFO mapreduce.Job:  map 68% reduce 16%
16/12/06 17:00:29 INFO mapreduce.Job:  map 69% reduce 17%
16/12/06 17:00:30 INFO mapreduce.Job:  map 72% reduce 19%
16/12/06 17:00:31 INFO mapreduce.Job:  map 75% reduce 20%
16/12/06 17:00:32 INFO mapreduce.Job:  map 78% reduce 21%
16/12/06 17:00:33 INFO mapreduce.Job:  map 81% reduce 22%
16/12/06 17:00:34 INFO mapreduce.Job:  map 84% reduce 22%
16/12/06 17:00:35 INFO mapreduce.Job:  map 86% reduce 24%
16/12/06 17:00:36 INFO mapreduce.Job:  map 87% reduce 24%
16/12/06 17:00:37 INFO mapreduce.Job:  map 87% reduce 26%
16/12/06 17:00:38 INFO mapreduce.Job:  map 88% reduce 27%
16/12/06 17:00:40 INFO mapreduce.Job:  map 88% reduce 29%
16/12/06 17:00:41 INFO mapreduce.Job:  map 89% reduce 29%
16/12/06 17:00:42 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 17:00:43 INFO mapreduce.Job:  map 91% reduce 29%
16/12/06 17:00:45 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 17:00:46 INFO mapreduce.Job:  map 97% reduce 30%
16/12/06 17:00:47 INFO mapreduce.Job:  map 99% reduce 31%
16/12/06 17:00:48 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 17:00:49 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 17:00:51 INFO mapreduce.Job:  map 100% reduce 42%
16/12/06 17:00:52 INFO mapreduce.Job:  map 100% reduce 52%
16/12/06 17:00:53 INFO mapreduce.Job:  map 100% reduce 61%
16/12/06 17:00:54 INFO mapreduce.Job:  map 100% reduce 73%
16/12/06 17:00:55 INFO mapreduce.Job:  map 100% reduce 77%
16/12/06 17:00:56 INFO mapreduce.Job:  map 100% reduce 82%
16/12/06 17:00:57 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 17:00:58 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 17:00:59 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 17:01:03 INFO mapreduce.Job: Job job_1480588584072_4687 completed successfully
16/12/06 17:01:03 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=861053578
		FILE: Number of bytes written=1754489121
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=738054207
		WASB: Number of bytes written=401891241
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=14834632
		Total time spent by all reduces in occupied slots (ms)=3365408
		Total time spent by all map tasks (ms)=7417316
		Total time spent by all reduce tasks (ms)=1682704
		Total vcore-seconds taken by all map tasks=7417316
		Total vcore-seconds taken by all reduce tasks=1682704
		Total megabyte-seconds taken by all map tasks=7595331584
		Total megabyte-seconds taken by all reduce tasks=1723088896
	Map-Reduce Framework
		Map input records=2395584
		Map output records=2107498
		Map output bytes=852901524
		Map output materialized bytes=861077098
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1820461
		Reduce shuffle bytes=861077098
		Reduce input records=2107498
		Reduce output records=1186049
		Spilled Records=4214996
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=98918
		CPU time spent (ms)=976020
		Physical memory (bytes) snapshot=324396388352
		Virtual memory (bytes) snapshot=742067908608
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=735358203
	File Output Format Counters 
		Bytes Written=401891241
16/12/06 17:01:03 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1800
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021500 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1900 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021500
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1900': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8578121233132552656.jar tmpDir=null
16/12/06 17:01:43 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:01:44 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:01:44 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 17:01:46 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 17:01:46 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 17:01:46 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4693
16/12/06 17:01:47 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4693
16/12/06 17:01:47 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4693/
16/12/06 17:01:47 INFO mapreduce.Job: Running job: job_1480588584072_4693
16/12/06 17:04:43 INFO mapreduce.Job: Job job_1480588584072_4693 running in uber mode : false
16/12/06 17:04:43 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 17:05:08 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 17:05:09 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 17:05:12 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 17:05:13 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 17:05:15 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 17:05:17 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 17:05:19 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 17:05:20 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 17:05:21 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 17:05:22 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 17:05:23 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 17:05:25 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 17:05:27 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 17:05:28 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 17:05:29 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 17:05:30 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 17:05:31 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 17:05:32 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 17:05:36 INFO mapreduce.Job:  map 25% reduce 1%
16/12/06 17:05:37 INFO mapreduce.Job:  map 25% reduce 3%
16/12/06 17:05:38 INFO mapreduce.Job:  map 26% reduce 3%
16/12/06 17:05:39 INFO mapreduce.Job:  map 27% reduce 3%
16/12/06 17:05:40 INFO mapreduce.Job:  map 28% reduce 4%
16/12/06 17:05:42 INFO mapreduce.Job:  map 28% reduce 5%
16/12/06 17:05:43 INFO mapreduce.Job:  map 28% reduce 6%
16/12/06 17:05:46 INFO mapreduce.Job:  map 29% reduce 7%
16/12/06 17:05:48 INFO mapreduce.Job:  map 30% reduce 7%
16/12/06 17:05:51 INFO mapreduce.Job:  map 31% reduce 8%
16/12/06 17:05:54 INFO mapreduce.Job:  map 31% reduce 9%
16/12/06 17:05:55 INFO mapreduce.Job:  map 32% reduce 9%
16/12/06 17:05:57 INFO mapreduce.Job:  map 33% reduce 10%
16/12/06 17:05:59 INFO mapreduce.Job:  map 34% reduce 10%
16/12/06 17:06:03 INFO mapreduce.Job:  map 35% reduce 11%
16/12/06 17:06:09 INFO mapreduce.Job:  map 35% reduce 12%
16/12/06 17:06:12 INFO mapreduce.Job:  map 36% reduce 12%
16/12/06 17:06:18 INFO mapreduce.Job:  map 37% reduce 12%
16/12/06 17:06:21 INFO mapreduce.Job:  map 38% reduce 12%
16/12/06 17:06:24 INFO mapreduce.Job:  map 38% reduce 13%
16/12/06 17:06:37 INFO mapreduce.Job:  map 39% reduce 13%
16/12/06 17:06:41 INFO mapreduce.Job:  map 40% reduce 13%
16/12/06 17:06:42 INFO mapreduce.Job:  map 41% reduce 13%
16/12/06 17:06:45 INFO mapreduce.Job:  map 42% reduce 13%
16/12/06 17:06:47 INFO mapreduce.Job:  map 43% reduce 13%
16/12/06 17:06:48 INFO mapreduce.Job:  map 44% reduce 13%
16/12/06 17:06:51 INFO mapreduce.Job:  map 45% reduce 13%
16/12/06 17:06:52 INFO mapreduce.Job:  map 46% reduce 13%
16/12/06 17:06:55 INFO mapreduce.Job:  map 47% reduce 13%
16/12/06 17:06:57 INFO mapreduce.Job:  map 48% reduce 13%
16/12/06 17:06:59 INFO mapreduce.Job:  map 49% reduce 13%
16/12/06 17:07:00 INFO mapreduce.Job:  map 50% reduce 14%
16/12/06 17:07:02 INFO mapreduce.Job:  map 50% reduce 15%
16/12/06 17:07:03 INFO mapreduce.Job:  map 50% reduce 16%
16/12/06 17:07:04 INFO mapreduce.Job:  map 51% reduce 16%
16/12/06 17:07:07 INFO mapreduce.Job:  map 52% reduce 16%
16/12/06 17:07:08 INFO mapreduce.Job:  map 53% reduce 16%
16/12/06 17:07:09 INFO mapreduce.Job:  map 54% reduce 16%
16/12/06 17:07:10 INFO mapreduce.Job:  map 55% reduce 16%
16/12/06 17:07:11 INFO mapreduce.Job:  map 56% reduce 16%
16/12/06 17:07:12 INFO mapreduce.Job:  map 56% reduce 17%
16/12/06 17:07:15 INFO mapreduce.Job:  map 57% reduce 18%
16/12/06 17:07:18 INFO mapreduce.Job:  map 57% reduce 19%
16/12/06 17:07:20 INFO mapreduce.Job:  map 58% reduce 19%
16/12/06 17:07:44 INFO mapreduce.Job:  map 60% reduce 19%
16/12/06 17:07:45 INFO mapreduce.Job:  map 62% reduce 20%
16/12/06 17:07:49 INFO mapreduce.Job:  map 62% reduce 21%
16/12/06 17:07:50 INFO mapreduce.Job:  map 64% reduce 21%
16/12/06 17:07:51 INFO mapreduce.Job:  map 66% reduce 21%
16/12/06 17:07:53 INFO mapreduce.Job:  map 68% reduce 21%
16/12/06 17:07:54 INFO mapreduce.Job:  map 69% reduce 22%
16/12/06 17:07:55 INFO mapreduce.Job:  map 70% reduce 22%
16/12/06 17:07:56 INFO mapreduce.Job:  map 71% reduce 23%
16/12/06 17:07:57 INFO mapreduce.Job:  map 72% reduce 23%
16/12/06 17:07:58 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 17:07:59 INFO mapreduce.Job:  map 77% reduce 23%
16/12/06 17:08:00 INFO mapreduce.Job:  map 78% reduce 24%
16/12/06 17:08:01 INFO mapreduce.Job:  map 81% reduce 25%
16/12/06 17:08:02 INFO mapreduce.Job:  map 81% reduce 26%
16/12/06 17:08:03 INFO mapreduce.Job:  map 83% reduce 26%
16/12/06 17:08:04 INFO mapreduce.Job:  map 86% reduce 27%
16/12/06 17:08:05 INFO mapreduce.Job:  map 90% reduce 27%
16/12/06 17:08:06 INFO mapreduce.Job:  map 92% reduce 28%
16/12/06 17:08:07 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 17:08:08 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 17:08:09 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 17:08:10 INFO mapreduce.Job:  map 98% reduce 31%
16/12/06 17:08:11 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 17:08:12 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 17:08:13 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 17:08:14 INFO mapreduce.Job:  map 100% reduce 39%
16/12/06 17:08:15 INFO mapreduce.Job:  map 100% reduce 48%
16/12/06 17:08:16 INFO mapreduce.Job:  map 100% reduce 65%
16/12/06 17:08:17 INFO mapreduce.Job:  map 100% reduce 71%
16/12/06 17:08:18 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 17:08:19 INFO mapreduce.Job:  map 100% reduce 82%
16/12/06 17:08:20 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 17:08:21 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 17:08:22 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 17:08:23 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 17:08:24 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 17:08:25 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 17:08:26 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 17:08:27 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 17:08:32 INFO mapreduce.Job: Job job_1480588584072_4693 completed successfully
16/12/06 17:08:32 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=873917933
		FILE: Number of bytes written=1780217831
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=745589751
		WASB: Number of bytes written=413145748
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=17649466
		Total time spent by all reduces in occupied slots (ms)=6871312
		Total time spent by all map tasks (ms)=8824733
		Total time spent by all reduce tasks (ms)=3435656
		Total vcore-seconds taken by all map tasks=8824733
		Total vcore-seconds taken by all reduce tasks=3435656
		Total megabyte-seconds taken by all map tasks=9036526592
		Total megabyte-seconds taken by all reduce tasks=3518111744
	Map-Reduce Framework
		Map input records=2418973
		Map output records=2140579
		Map output bytes=865641792
		Map output materialized bytes=873941453
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1854161
		Reduce shuffle bytes=873941453
		Reduce input records=2140579
		Reduce output records=1222307
		Spilled Records=4281158
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=105339
		CPU time spent (ms)=1060420
		Physical memory (bytes) snapshot=322309898240
		Virtual memory (bytes) snapshot=742629371904
		Total committed heap usage (bytes)=574380572672
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=742893747
	File Output Format Counters 
		Bytes Written=413145748
16/12/06 17:08:32 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/1900
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021600 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/2000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021600
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/2000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4068550568505319540.jar tmpDir=null
16/12/06 17:09:14 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:09:15 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:09:15 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 17:09:17 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 17:09:17 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 17:09:18 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4697
16/12/06 17:09:18 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4697
16/12/06 17:09:18 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4697/
16/12/06 17:09:18 INFO mapreduce.Job: Running job: job_1480588584072_4697
16/12/06 17:09:43 INFO mapreduce.Job: Job job_1480588584072_4697 running in uber mode : false
16/12/06 17:09:43 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 17:10:15 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 17:10:16 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 17:10:17 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 17:10:18 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 17:10:20 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 17:10:21 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 17:10:22 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 17:10:23 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 17:10:25 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 17:10:26 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 17:10:27 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 17:10:28 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 17:10:29 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 17:10:31 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 17:10:32 INFO mapreduce.Job:  map 30% reduce 0%
16/12/06 17:10:33 INFO mapreduce.Job:  map 31% reduce 0%
16/12/06 17:10:35 INFO mapreduce.Job:  map 32% reduce 0%
16/12/06 17:10:36 INFO mapreduce.Job:  map 35% reduce 0%
16/12/06 17:10:37 INFO mapreduce.Job:  map 36% reduce 0%
16/12/06 17:10:38 INFO mapreduce.Job:  map 36% reduce 1%
16/12/06 17:10:39 INFO mapreduce.Job:  map 37% reduce 1%
16/12/06 17:10:41 INFO mapreduce.Job:  map 37% reduce 2%
16/12/06 17:10:47 INFO mapreduce.Job:  map 39% reduce 2%
16/12/06 17:10:49 INFO mapreduce.Job:  map 40% reduce 4%
16/12/06 17:10:50 INFO mapreduce.Job:  map 42% reduce 4%
16/12/06 17:10:51 INFO mapreduce.Job:  map 43% reduce 5%
16/12/06 17:10:52 INFO mapreduce.Job:  map 45% reduce 6%
16/12/06 17:10:53 INFO mapreduce.Job:  map 46% reduce 7%
16/12/06 17:10:54 INFO mapreduce.Job:  map 46% reduce 8%
16/12/06 17:10:55 INFO mapreduce.Job:  map 47% reduce 9%
16/12/06 17:10:56 INFO mapreduce.Job:  map 48% reduce 10%
16/12/06 17:10:57 INFO mapreduce.Job:  map 50% reduce 12%
16/12/06 17:10:58 INFO mapreduce.Job:  map 50% reduce 14%
16/12/06 17:10:59 INFO mapreduce.Job:  map 51% reduce 15%
16/12/06 17:11:00 INFO mapreduce.Job:  map 52% reduce 16%
16/12/06 17:11:03 INFO mapreduce.Job:  map 54% reduce 17%
16/12/06 17:11:06 INFO mapreduce.Job:  map 55% reduce 17%
16/12/06 17:11:07 INFO mapreduce.Job:  map 57% reduce 17%
16/12/06 17:11:09 INFO mapreduce.Job:  map 57% reduce 18%
16/12/06 17:11:12 INFO mapreduce.Job:  map 57% reduce 19%
16/12/06 17:11:13 INFO mapreduce.Job:  map 58% reduce 19%
16/12/06 17:11:15 INFO mapreduce.Job:  map 59% reduce 19%
16/12/06 17:11:17 INFO mapreduce.Job:  map 60% reduce 19%
16/12/06 17:11:19 INFO mapreduce.Job:  map 60% reduce 20%
16/12/06 17:11:24 INFO mapreduce.Job:  map 61% reduce 20%
16/12/06 17:11:26 INFO mapreduce.Job:  map 63% reduce 20%
16/12/06 17:11:28 INFO mapreduce.Job:  map 63% reduce 21%
16/12/06 17:11:30 INFO mapreduce.Job:  map 64% reduce 21%
16/12/06 17:11:33 INFO mapreduce.Job:  map 66% reduce 21%
16/12/06 17:11:34 INFO mapreduce.Job:  map 67% reduce 21%
16/12/06 17:11:35 INFO mapreduce.Job:  map 68% reduce 21%
16/12/06 17:11:36 INFO mapreduce.Job:  map 70% reduce 21%
16/12/06 17:11:37 INFO mapreduce.Job:  map 71% reduce 21%
16/12/06 17:11:38 INFO mapreduce.Job:  map 71% reduce 22%
16/12/06 17:11:39 INFO mapreduce.Job:  map 72% reduce 22%
16/12/06 17:11:40 INFO mapreduce.Job:  map 74% reduce 22%
16/12/06 17:11:41 INFO mapreduce.Job:  map 76% reduce 22%
16/12/06 17:11:42 INFO mapreduce.Job:  map 77% reduce 23%
16/12/06 17:11:43 INFO mapreduce.Job:  map 79% reduce 23%
16/12/06 17:11:44 INFO mapreduce.Job:  map 82% reduce 24%
16/12/06 17:11:45 INFO mapreduce.Job:  map 84% reduce 24%
16/12/06 17:11:46 INFO mapreduce.Job:  map 84% reduce 25%
16/12/06 17:11:47 INFO mapreduce.Job:  map 85% reduce 26%
16/12/06 17:11:48 INFO mapreduce.Job:  map 88% reduce 26%
16/12/06 17:11:49 INFO mapreduce.Job:  map 89% reduce 27%
16/12/06 17:11:50 INFO mapreduce.Job:  map 90% reduce 27%
16/12/06 17:11:51 INFO mapreduce.Job:  map 91% reduce 27%
16/12/06 17:11:52 INFO mapreduce.Job:  map 92% reduce 28%
16/12/06 17:11:54 INFO mapreduce.Job:  map 93% reduce 29%
16/12/06 17:11:55 INFO mapreduce.Job:  map 94% reduce 29%
16/12/06 17:11:56 INFO mapreduce.Job:  map 95% reduce 29%
16/12/06 17:11:57 INFO mapreduce.Job:  map 96% reduce 30%
16/12/06 17:11:58 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 17:12:00 INFO mapreduce.Job:  map 98% reduce 31%
16/12/06 17:12:01 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 17:12:02 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 17:12:04 INFO mapreduce.Job:  map 99% reduce 33%
16/12/06 17:12:17 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 17:12:18 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 17:12:19 INFO mapreduce.Job:  map 100% reduce 48%
16/12/06 17:12:20 INFO mapreduce.Job:  map 100% reduce 56%
16/12/06 17:12:22 INFO mapreduce.Job:  map 100% reduce 59%
16/12/06 17:12:23 INFO mapreduce.Job:  map 100% reduce 68%
16/12/06 17:12:24 INFO mapreduce.Job:  map 100% reduce 71%
16/12/06 17:12:25 INFO mapreduce.Job:  map 100% reduce 73%
16/12/06 17:12:26 INFO mapreduce.Job:  map 100% reduce 78%
16/12/06 17:12:27 INFO mapreduce.Job:  map 100% reduce 83%
16/12/06 17:12:28 INFO mapreduce.Job:  map 100% reduce 85%
16/12/06 17:12:29 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 17:12:30 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 17:12:31 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 17:12:32 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 17:12:33 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 17:12:36 INFO mapreduce.Job: Job job_1480588584072_4697 completed successfully
16/12/06 17:12:36 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=955166890
		FILE: Number of bytes written=1942715745
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=805343348
		WASB: Number of bytes written=500478283
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=22127032
		Total time spent by all reduces in occupied slots (ms)=4828966
		Total time spent by all map tasks (ms)=11063516
		Total time spent by all reduce tasks (ms)=2414483
		Total vcore-seconds taken by all map tasks=11063516
		Total vcore-seconds taken by all reduce tasks=2414483
		Total megabyte-seconds taken by all map tasks=11329040384
		Total megabyte-seconds taken by all reduce tasks=2472430592
	Map-Reduce Framework
		Map input records=2579614
		Map output records=2327080
		Map output bytes=946181496
		Map output materialized bytes=955190410
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2030214
		Reduce shuffle bytes=955190410
		Reduce input records=2327080
		Reduce output records=1477230
		Spilled Records=4654160
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=144927
		CPU time spent (ms)=1088400
		Physical memory (bytes) snapshot=325084614656
		Virtual memory (bytes) snapshot=742242861056
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=802647344
	File Output Format Counters 
		Bytes Written=500478283
16/12/06 17:12:36 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/2000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021700 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/2100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021700
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/2100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob15921189410409093.jar tmpDir=null
16/12/06 17:13:14 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:13:15 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:13:15 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 17:13:18 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 17:13:18 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 17:13:19 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4700
16/12/06 17:13:19 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4700
16/12/06 17:13:19 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4700/
16/12/06 17:13:19 INFO mapreduce.Job: Running job: job_1480588584072_4700
16/12/06 17:14:13 INFO mapreduce.Job: Job job_1480588584072_4700 running in uber mode : false
16/12/06 17:14:13 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 17:14:29 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 17:14:35 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 17:14:37 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 17:14:48 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 17:14:49 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 17:14:50 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 17:14:51 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 17:14:52 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 17:14:53 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 17:14:55 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 17:14:56 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 17:14:58 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 17:14:59 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 17:15:01 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 17:15:03 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 17:15:05 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 17:15:07 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 17:15:08 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 17:15:09 INFO mapreduce.Job:  map 27% reduce 0%
16/12/06 17:15:10 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 17:15:11 INFO mapreduce.Job:  map 31% reduce 0%
16/12/06 17:15:12 INFO mapreduce.Job:  map 32% reduce 0%
16/12/06 17:15:13 INFO mapreduce.Job:  map 33% reduce 0%
16/12/06 17:15:14 INFO mapreduce.Job:  map 34% reduce 0%
16/12/06 17:15:15 INFO mapreduce.Job:  map 37% reduce 0%
16/12/06 17:15:16 INFO mapreduce.Job:  map 40% reduce 1%
16/12/06 17:15:17 INFO mapreduce.Job:  map 41% reduce 2%
16/12/06 17:15:18 INFO mapreduce.Job:  map 42% reduce 2%
16/12/06 17:15:20 INFO mapreduce.Job:  map 43% reduce 4%
16/12/06 17:15:21 INFO mapreduce.Job:  map 46% reduce 6%
16/12/06 17:15:22 INFO mapreduce.Job:  map 48% reduce 6%
16/12/06 17:15:23 INFO mapreduce.Job:  map 49% reduce 7%
16/12/06 17:15:24 INFO mapreduce.Job:  map 53% reduce 9%
16/12/06 17:15:25 INFO mapreduce.Job:  map 54% reduce 13%
16/12/06 17:15:26 INFO mapreduce.Job:  map 55% reduce 13%
16/12/06 17:15:27 INFO mapreduce.Job:  map 57% reduce 15%
16/12/06 17:15:28 INFO mapreduce.Job:  map 58% reduce 18%
16/12/06 17:15:29 INFO mapreduce.Job:  map 59% reduce 18%
16/12/06 17:15:30 INFO mapreduce.Job:  map 61% reduce 19%
16/12/06 17:15:31 INFO mapreduce.Job:  map 61% reduce 20%
16/12/06 17:15:32 INFO mapreduce.Job:  map 62% reduce 20%
16/12/06 17:15:33 INFO mapreduce.Job:  map 63% reduce 20%
16/12/06 17:15:34 INFO mapreduce.Job:  map 63% reduce 21%
16/12/06 17:15:36 INFO mapreduce.Job:  map 64% reduce 21%
16/12/06 17:15:37 INFO mapreduce.Job:  map 65% reduce 21%
16/12/06 17:15:38 INFO mapreduce.Job:  map 67% reduce 21%
16/12/06 17:15:39 INFO mapreduce.Job:  map 68% reduce 21%
16/12/06 17:15:40 INFO mapreduce.Job:  map 69% reduce 22%
16/12/06 17:15:41 INFO mapreduce.Job:  map 71% reduce 22%
16/12/06 17:15:42 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 17:15:43 INFO mapreduce.Job:  map 75% reduce 24%
16/12/06 17:15:44 INFO mapreduce.Job:  map 77% reduce 24%
16/12/06 17:15:45 INFO mapreduce.Job:  map 79% reduce 25%
16/12/06 17:15:46 INFO mapreduce.Job:  map 80% reduce 26%
16/12/06 17:15:48 INFO mapreduce.Job:  map 80% reduce 27%
16/12/06 17:15:58 INFO mapreduce.Job:  map 81% reduce 27%
16/12/06 17:16:00 INFO mapreduce.Job:  map 82% reduce 27%
16/12/06 17:16:01 INFO mapreduce.Job:  map 83% reduce 27%
16/12/06 17:16:02 INFO mapreduce.Job:  map 84% reduce 27%
16/12/06 17:16:04 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 17:16:05 INFO mapreduce.Job:  map 86% reduce 27%
16/12/06 17:16:06 INFO mapreduce.Job:  map 87% reduce 27%
16/12/06 17:16:08 INFO mapreduce.Job:  map 88% reduce 27%
16/12/06 17:16:09 INFO mapreduce.Job:  map 89% reduce 27%
16/12/06 17:16:10 INFO mapreduce.Job:  map 90% reduce 27%
16/12/06 17:16:11 INFO mapreduce.Job:  map 91% reduce 27%
16/12/06 17:16:16 INFO mapreduce.Job:  map 92% reduce 28%
16/12/06 17:16:17 INFO mapreduce.Job:  map 93% reduce 28%
16/12/06 17:16:18 INFO mapreduce.Job:  map 95% reduce 29%
16/12/06 17:16:20 INFO mapreduce.Job:  map 97% reduce 30%
16/12/06 17:16:21 INFO mapreduce.Job:  map 100% reduce 31%
16/12/06 17:16:22 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 17:16:23 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 17:16:24 INFO mapreduce.Job:  map 100% reduce 37%
16/12/06 17:16:25 INFO mapreduce.Job:  map 100% reduce 43%
16/12/06 17:16:26 INFO mapreduce.Job:  map 100% reduce 48%
16/12/06 17:16:27 INFO mapreduce.Job:  map 100% reduce 57%
16/12/06 17:16:28 INFO mapreduce.Job:  map 100% reduce 60%
16/12/06 17:16:29 INFO mapreduce.Job:  map 100% reduce 65%
16/12/06 17:16:30 INFO mapreduce.Job:  map 100% reduce 68%
16/12/06 17:16:31 INFO mapreduce.Job:  map 100% reduce 72%
16/12/06 17:16:32 INFO mapreduce.Job:  map 100% reduce 75%
16/12/06 17:16:33 INFO mapreduce.Job:  map 100% reduce 77%
16/12/06 17:16:34 INFO mapreduce.Job:  map 100% reduce 79%
16/12/06 17:16:35 INFO mapreduce.Job:  map 100% reduce 80%
16/12/06 17:16:36 INFO mapreduce.Job:  map 100% reduce 81%
16/12/06 17:16:37 INFO mapreduce.Job:  map 100% reduce 83%
16/12/06 17:16:39 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 17:16:40 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 17:16:41 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 17:16:42 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 17:16:43 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 17:16:44 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 17:16:45 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 17:16:46 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 17:16:47 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 17:16:50 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 17:16:56 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 17:17:00 INFO mapreduce.Job: Job job_1480588584072_4700 completed successfully
16/12/06 17:17:00 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=788699385
		FILE: Number of bytes written=1609780735
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=666792935
		WASB: Number of bytes written=403057605
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=21646130
		Total time spent by all reduces in occupied slots (ms)=4231816
		Total time spent by all map tasks (ms)=10823065
		Total time spent by all reduce tasks (ms)=2115908
		Total vcore-seconds taken by all map tasks=10823065
		Total vcore-seconds taken by all reduce tasks=2115908
		Total megabyte-seconds taken by all map tasks=11082818560
		Total megabyte-seconds taken by all reduce tasks=2166689792
	Map-Reduce Framework
		Map input records=2142417
		Map output records=1925132
		Map output bytes=781266019
		Map output materialized bytes=788722905
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1674729
		Reduce shuffle bytes=788722905
		Reduce input records=1925132
		Reduce output records=1191955
		Spilled Records=3850264
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=116546
		CPU time spent (ms)=1007960
		Physical memory (bytes) snapshot=322065518592
		Virtual memory (bytes) snapshot=742076334080
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=664096931
	File Output Format Counters 
		Bytes Written=403057605
16/12/06 17:17:00 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/2100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021800 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/2200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021800
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/2200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob6787310277683383021.jar tmpDir=null
16/12/06 17:17:41 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:17:42 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:17:42 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 17:17:44 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 17:17:44 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 17:17:45 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4705
16/12/06 17:17:45 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4705
16/12/06 17:17:46 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4705/
16/12/06 17:17:46 INFO mapreduce.Job: Running job: job_1480588584072_4705
16/12/06 17:18:00 INFO mapreduce.Job: Job job_1480588584072_4705 running in uber mode : false
16/12/06 17:18:00 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 17:18:41 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 17:18:42 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 17:18:48 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 17:18:49 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 17:18:51 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 17:18:52 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 17:18:54 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 17:18:56 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 17:18:57 INFO mapreduce.Job:  map 31% reduce 0%
16/12/06 17:19:00 INFO mapreduce.Job:  map 36% reduce 0%
16/12/06 17:19:02 INFO mapreduce.Job:  map 37% reduce 0%
16/12/06 17:19:04 INFO mapreduce.Job:  map 39% reduce 0%
16/12/06 17:19:05 INFO mapreduce.Job:  map 42% reduce 0%
16/12/06 17:19:06 INFO mapreduce.Job:  map 43% reduce 0%
16/12/06 17:19:08 INFO mapreduce.Job:  map 51% reduce 0%
16/12/06 17:19:09 INFO mapreduce.Job:  map 54% reduce 0%
16/12/06 17:19:10 INFO mapreduce.Job:  map 57% reduce 0%
16/12/06 17:19:11 INFO mapreduce.Job:  map 60% reduce 2%
16/12/06 17:19:12 INFO mapreduce.Job:  map 62% reduce 3%
16/12/06 17:19:14 INFO mapreduce.Job:  map 63% reduce 4%
16/12/06 17:19:15 INFO mapreduce.Job:  map 65% reduce 5%
16/12/06 17:19:16 INFO mapreduce.Job:  map 66% reduce 6%
16/12/06 17:19:17 INFO mapreduce.Job:  map 67% reduce 8%
16/12/06 17:19:18 INFO mapreduce.Job:  map 67% reduce 9%
16/12/06 17:19:19 INFO mapreduce.Job:  map 68% reduce 10%
16/12/06 17:19:21 INFO mapreduce.Job:  map 69% reduce 12%
16/12/06 17:19:22 INFO mapreduce.Job:  map 70% reduce 13%
16/12/06 17:19:23 INFO mapreduce.Job:  map 71% reduce 16%
16/12/06 17:19:25 INFO mapreduce.Job:  map 72% reduce 17%
16/12/06 17:19:27 INFO mapreduce.Job:  map 73% reduce 17%
16/12/06 17:19:28 INFO mapreduce.Job:  map 73% reduce 18%
16/12/06 17:19:30 INFO mapreduce.Job:  map 74% reduce 18%
16/12/06 17:19:32 INFO mapreduce.Job:  map 75% reduce 18%
16/12/06 17:19:33 INFO mapreduce.Job:  map 76% reduce 19%
16/12/06 17:19:34 INFO mapreduce.Job:  map 77% reduce 19%
16/12/06 17:19:36 INFO mapreduce.Job:  map 79% reduce 19%
16/12/06 17:19:37 INFO mapreduce.Job:  map 81% reduce 19%
16/12/06 17:19:38 INFO mapreduce.Job:  map 84% reduce 19%
16/12/06 17:19:41 INFO mapreduce.Job:  map 85% reduce 20%
16/12/06 17:19:42 INFO mapreduce.Job:  map 86% reduce 20%
16/12/06 17:19:43 INFO mapreduce.Job:  map 87% reduce 21%
16/12/06 17:19:44 INFO mapreduce.Job:  map 87% reduce 23%
16/12/06 17:19:45 INFO mapreduce.Job:  map 88% reduce 23%
16/12/06 17:19:48 INFO mapreduce.Job:  map 89% reduce 24%
16/12/06 17:19:50 INFO mapreduce.Job:  map 90% reduce 24%
16/12/06 17:19:52 INFO mapreduce.Job:  map 90% reduce 25%
16/12/06 17:19:53 INFO mapreduce.Job:  map 90% reduce 27%
16/12/06 17:19:54 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 17:19:57 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 17:20:01 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 17:20:02 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 17:20:03 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 17:20:04 INFO mapreduce.Job:  map 98% reduce 31%
16/12/06 17:20:05 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 17:20:06 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 17:20:07 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 17:20:08 INFO mapreduce.Job:  map 100% reduce 39%
16/12/06 17:20:09 INFO mapreduce.Job:  map 100% reduce 49%
16/12/06 17:20:10 INFO mapreduce.Job:  map 100% reduce 63%
16/12/06 17:20:11 INFO mapreduce.Job:  map 100% reduce 70%
16/12/06 17:20:12 INFO mapreduce.Job:  map 100% reduce 74%
16/12/06 17:20:13 INFO mapreduce.Job:  map 100% reduce 81%
16/12/06 17:20:14 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 17:20:15 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 17:20:16 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 17:20:17 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 17:20:19 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 17:20:20 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 17:20:21 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 17:20:22 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 17:20:23 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 17:20:26 INFO mapreduce.Job: Job job_1480588584072_4705 completed successfully
16/12/06 17:20:26 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=714867970
		FILE: Number of bytes written=1462117905
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=596170742
		WASB: Number of bytes written=400969529
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=18947388
		Total time spent by all reduces in occupied slots (ms)=2951198
		Total time spent by all map tasks (ms)=9473694
		Total time spent by all reduce tasks (ms)=1475599
		Total vcore-seconds taken by all map tasks=9473694
		Total vcore-seconds taken by all reduce tasks=1475599
		Total megabyte-seconds taken by all map tasks=9701062656
		Total megabyte-seconds taken by all reduce tasks=1511013376
	Map-Reduce Framework
		Map input records=1882828
		Map output records=1731278
		Map output bytes=708182248
		Map output materialized bytes=714891490
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1520730
		Reduce shuffle bytes=714891490
		Reduce input records=1731278
		Reduce output records=1178484
		Spilled Records=3462556
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=105861
		CPU time spent (ms)=928210
		Physical memory (bytes) snapshot=324109090816
		Virtual memory (bytes) snapshot=742396497920
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=593474738
	File Output Format Counters 
		Bytes Written=400969529
16/12/06 17:20:26 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/2200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021900 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/2300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161202/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021900
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/2300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1288016496812867471.jar tmpDir=null
16/12/06 17:21:11 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:21:12 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:21:12 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 17:21:14 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 17:21:15 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 17:21:15 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4711
16/12/06 17:21:16 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4711
16/12/06 17:21:16 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4711/
16/12/06 17:21:16 INFO mapreduce.Job: Running job: job_1480588584072_4711
16/12/06 17:22:35 INFO mapreduce.Job: Job job_1480588584072_4711 running in uber mode : false
16/12/06 17:22:35 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 17:23:02 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 17:23:20 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 17:23:58 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 17:24:10 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 17:24:12 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 17:24:15 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 17:24:16 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 17:24:18 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 17:24:20 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 17:24:22 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 17:24:25 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 17:24:26 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 17:24:28 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 17:24:31 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 17:24:32 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 17:24:33 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 17:24:34 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 17:24:37 INFO mapreduce.Job:  map 20% reduce 1%
16/12/06 17:24:38 INFO mapreduce.Job:  map 21% reduce 1%
16/12/06 17:24:39 INFO mapreduce.Job:  map 22% reduce 1%
16/12/06 17:24:41 INFO mapreduce.Job:  map 23% reduce 1%
16/12/06 17:24:42 INFO mapreduce.Job:  map 25% reduce 1%
16/12/06 17:24:49 INFO mapreduce.Job:  map 27% reduce 1%
16/12/06 17:24:51 INFO mapreduce.Job:  map 28% reduce 2%
16/12/06 17:24:52 INFO mapreduce.Job:  map 31% reduce 2%
16/12/06 17:24:53 INFO mapreduce.Job:  map 32% reduce 2%
16/12/06 17:24:54 INFO mapreduce.Job:  map 33% reduce 3%
16/12/06 17:24:56 INFO mapreduce.Job:  map 33% reduce 4%
16/12/06 17:25:02 INFO mapreduce.Job:  map 34% reduce 4%
16/12/06 17:25:03 INFO mapreduce.Job:  map 37% reduce 5%
16/12/06 17:25:04 INFO mapreduce.Job:  map 39% reduce 5%
16/12/06 17:25:06 INFO mapreduce.Job:  map 45% reduce 6%
16/12/06 17:25:07 INFO mapreduce.Job:  map 48% reduce 8%
16/12/06 17:25:09 INFO mapreduce.Job:  map 49% reduce 11%
16/12/06 17:25:10 INFO mapreduce.Job:  map 50% reduce 12%
16/12/06 17:25:11 INFO mapreduce.Job:  map 51% reduce 13%
16/12/06 17:25:12 INFO mapreduce.Job:  map 53% reduce 14%
16/12/06 17:25:13 INFO mapreduce.Job:  map 54% reduce 14%
16/12/06 17:25:15 INFO mapreduce.Job:  map 55% reduce 15%
16/12/06 17:25:16 INFO mapreduce.Job:  map 57% reduce 16%
16/12/06 17:25:17 INFO mapreduce.Job:  map 58% reduce 17%
16/12/06 17:25:18 INFO mapreduce.Job:  map 60% reduce 18%
16/12/06 17:25:19 INFO mapreduce.Job:  map 62% reduce 19%
16/12/06 17:25:20 INFO mapreduce.Job:  map 62% reduce 20%
16/12/06 17:25:21 INFO mapreduce.Job:  map 65% reduce 20%
16/12/06 17:25:22 INFO mapreduce.Job:  map 66% reduce 21%
16/12/06 17:25:23 INFO mapreduce.Job:  map 67% reduce 21%
16/12/06 17:25:24 INFO mapreduce.Job:  map 72% reduce 21%
16/12/06 17:25:25 INFO mapreduce.Job:  map 75% reduce 22%
16/12/06 17:25:27 INFO mapreduce.Job:  map 79% reduce 23%
16/12/06 17:25:28 INFO mapreduce.Job:  map 82% reduce 23%
16/12/06 17:25:29 INFO mapreduce.Job:  map 84% reduce 26%
16/12/06 17:25:30 INFO mapreduce.Job:  map 87% reduce 27%
16/12/06 17:25:31 INFO mapreduce.Job:  map 90% reduce 27%
16/12/06 17:25:32 INFO mapreduce.Job:  map 91% reduce 29%
16/12/06 17:25:33 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 17:25:41 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 17:25:44 INFO mapreduce.Job:  map 92% reduce 31%
16/12/06 17:25:45 INFO mapreduce.Job:  map 93% reduce 31%
16/12/06 17:25:47 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 17:25:48 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 17:25:49 INFO mapreduce.Job:  map 99% reduce 31%
16/12/06 17:25:50 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 17:25:51 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 17:25:52 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 17:25:53 INFO mapreduce.Job:  map 100% reduce 51%
16/12/06 17:25:54 INFO mapreduce.Job:  map 100% reduce 71%
16/12/06 17:25:55 INFO mapreduce.Job:  map 100% reduce 80%
16/12/06 17:25:56 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 17:25:57 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 17:25:58 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 17:25:59 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 17:26:02 INFO mapreduce.Job: Job job_1480588584072_4711 completed successfully
16/12/06 17:26:02 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=466302645
		FILE: Number of bytes written=964987255
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=392294580
		WASB: Number of bytes written=249457548
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=9100292
		Total time spent by all reduces in occupied slots (ms)=3025008
		Total time spent by all map tasks (ms)=4550146
		Total time spent by all reduce tasks (ms)=1512504
		Total vcore-seconds taken by all map tasks=4550146
		Total vcore-seconds taken by all reduce tasks=1512504
		Total megabyte-seconds taken by all map tasks=4659349504
		Total megabyte-seconds taken by all reduce tasks=1548804096
	Map-Reduce Framework
		Map input records=1241365
		Map output records=1130594
		Map output bytes=461931281
		Map output materialized bytes=466326165
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=991191
		Reduce shuffle bytes=466326165
		Reduce input records=1130594
		Reduce output records=731547
		Spilled Records=2261188
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=76110
		CPU time spent (ms)=787080
		Physical memory (bytes) snapshot=323144450048
		Virtual memory (bytes) snapshot=742712918016
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=389598576
	File Output Format Counters 
		Bytes Written=249457548
16/12/06 17:26:02 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161202/2300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161202/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2769968515371814520.jar tmpDir=null
16/12/06 17:26:43 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:26:44 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:26:45 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 17:26:47 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 17:26:47 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 17:26:47 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4715
16/12/06 17:26:48 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4715
16/12/06 17:26:48 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4715/
16/12/06 17:26:48 INFO mapreduce.Job: Running job: job_1480588584072_4715
16/12/06 17:27:04 INFO mapreduce.Job: Job job_1480588584072_4715 running in uber mode : false
16/12/06 17:27:04 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 17:27:29 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 17:27:30 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 17:27:33 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 17:27:34 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 17:27:35 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 17:27:36 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 17:27:38 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 17:27:39 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 17:27:40 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 17:27:44 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 17:27:52 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 17:27:53 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 17:27:54 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 17:27:55 INFO mapreduce.Job:  map 27% reduce 1%
16/12/06 17:27:57 INFO mapreduce.Job:  map 28% reduce 2%
16/12/06 17:27:58 INFO mapreduce.Job:  map 30% reduce 2%
16/12/06 17:27:59 INFO mapreduce.Job:  map 32% reduce 4%
16/12/06 17:28:00 INFO mapreduce.Job:  map 33% reduce 5%
16/12/06 17:28:01 INFO mapreduce.Job:  map 36% reduce 5%
16/12/06 17:28:02 INFO mapreduce.Job:  map 37% reduce 6%
16/12/06 17:28:04 INFO mapreduce.Job:  map 39% reduce 7%
16/12/06 17:28:05 INFO mapreduce.Job:  map 42% reduce 8%
16/12/06 17:28:06 INFO mapreduce.Job:  map 42% reduce 9%
16/12/06 17:28:07 INFO mapreduce.Job:  map 43% reduce 10%
16/12/06 17:28:09 INFO mapreduce.Job:  map 43% reduce 13%
16/12/06 17:28:10 INFO mapreduce.Job:  map 44% reduce 14%
16/12/06 17:28:11 INFO mapreduce.Job:  map 45% reduce 14%
16/12/06 17:28:12 INFO mapreduce.Job:  map 46% reduce 15%
16/12/06 17:28:13 INFO mapreduce.Job:  map 48% reduce 15%
16/12/06 17:28:15 INFO mapreduce.Job:  map 48% reduce 16%
16/12/06 17:28:16 INFO mapreduce.Job:  map 49% reduce 16%
16/12/06 17:28:17 INFO mapreduce.Job:  map 50% reduce 16%
16/12/06 17:28:18 INFO mapreduce.Job:  map 51% reduce 16%
16/12/06 17:28:19 INFO mapreduce.Job:  map 52% reduce 17%
16/12/06 17:28:20 INFO mapreduce.Job:  map 53% reduce 17%
16/12/06 17:28:21 INFO mapreduce.Job:  map 54% reduce 17%
16/12/06 17:28:22 INFO mapreduce.Job:  map 54% reduce 18%
16/12/06 17:28:24 INFO mapreduce.Job:  map 55% reduce 18%
16/12/06 17:28:25 INFO mapreduce.Job:  map 56% reduce 18%
16/12/06 17:28:28 INFO mapreduce.Job:  map 57% reduce 19%
16/12/06 17:28:29 INFO mapreduce.Job:  map 59% reduce 19%
16/12/06 17:28:31 INFO mapreduce.Job:  map 61% reduce 19%
16/12/06 17:28:32 INFO mapreduce.Job:  map 61% reduce 20%
16/12/06 17:28:33 INFO mapreduce.Job:  map 64% reduce 20%
16/12/06 17:28:34 INFO mapreduce.Job:  map 65% reduce 20%
16/12/06 17:28:35 INFO mapreduce.Job:  map 67% reduce 21%
16/12/06 17:28:36 INFO mapreduce.Job:  map 68% reduce 22%
16/12/06 17:28:37 INFO mapreduce.Job:  map 70% reduce 22%
16/12/06 17:28:38 INFO mapreduce.Job:  map 72% reduce 23%
16/12/06 17:28:40 INFO mapreduce.Job:  map 75% reduce 24%
16/12/06 17:28:41 INFO mapreduce.Job:  map 77% reduce 24%
16/12/06 17:28:42 INFO mapreduce.Job:  map 78% reduce 25%
16/12/06 17:28:43 INFO mapreduce.Job:  map 80% reduce 25%
16/12/06 17:28:44 INFO mapreduce.Job:  map 81% reduce 26%
16/12/06 17:28:46 INFO mapreduce.Job:  map 82% reduce 27%
16/12/06 17:28:52 INFO mapreduce.Job:  map 83% reduce 27%
16/12/06 17:28:53 INFO mapreduce.Job:  map 87% reduce 27%
16/12/06 17:28:54 INFO mapreduce.Job:  map 87% reduce 28%
16/12/06 17:28:55 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 17:28:56 INFO mapreduce.Job:  map 89% reduce 29%
16/12/06 17:28:57 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 17:28:59 INFO mapreduce.Job:  map 92% reduce 29%
16/12/06 17:29:00 INFO mapreduce.Job:  map 94% reduce 29%
16/12/06 17:29:01 INFO mapreduce.Job:  map 95% reduce 29%
16/12/06 17:29:02 INFO mapreduce.Job:  map 96% reduce 30%
16/12/06 17:29:03 INFO mapreduce.Job:  map 97% reduce 30%
16/12/06 17:29:04 INFO mapreduce.Job:  map 98% reduce 30%
16/12/06 17:29:05 INFO mapreduce.Job:  map 100% reduce 31%
16/12/06 17:29:06 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 17:29:07 INFO mapreduce.Job:  map 100% reduce 43%
16/12/06 17:29:09 INFO mapreduce.Job:  map 100% reduce 53%
16/12/06 17:29:10 INFO mapreduce.Job:  map 100% reduce 77%
16/12/06 17:29:11 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 17:29:12 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 17:29:13 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 17:29:14 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 17:29:16 INFO mapreduce.Job: Job job_1480588584072_4715 completed successfully
16/12/06 17:29:16 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=279454982
		FILE: Number of bytes written=591291929
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=234529250
		WASB: Number of bytes written=146128211
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=14234898
		Total time spent by all reduces in occupied slots (ms)=3473326
		Total time spent by all map tasks (ms)=7117449
		Total time spent by all reduce tasks (ms)=1736663
		Total vcore-seconds taken by all map tasks=7117449
		Total vcore-seconds taken by all reduce tasks=1736663
		Total megabyte-seconds taken by all map tasks=7288267776
		Total megabyte-seconds taken by all reduce tasks=1778342912
	Map-Reduce Framework
		Map input records=740740
		Map output records=679680
		Map output bytes=276826667
		Map output materialized bytes=279478502
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=597461
		Reduce shuffle bytes=279478502
		Reduce input records=679680
		Reduce output records=429497
		Spilled Records=1359360
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=70804
		CPU time spent (ms)=736250
		Physical memory (bytes) snapshot=322809958400
		Virtual memory (bytes) snapshot=742538940416
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=231833246
	File Output Format Counters 
		Bytes Written=146128211
16/12/06 17:29:16 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5934340291158239225.jar tmpDir=null
16/12/06 17:29:55 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:29:56 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:29:56 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 17:29:58 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 17:29:58 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 17:29:58 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4718
16/12/06 17:29:59 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4718
16/12/06 17:29:59 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4718/
16/12/06 17:29:59 INFO mapreduce.Job: Running job: job_1480588584072_4718
16/12/06 17:30:12 INFO mapreduce.Job: Job job_1480588584072_4718 running in uber mode : false
16/12/06 17:30:12 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 17:30:31 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 17:30:36 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 17:30:37 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 17:30:38 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 17:30:40 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 17:30:41 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 17:30:42 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 17:30:43 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 17:30:44 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 17:30:45 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 17:30:48 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 17:30:50 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 17:30:51 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 17:30:52 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 17:30:53 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 17:30:54 INFO mapreduce.Job:  map 27% reduce 0%
16/12/06 17:30:55 INFO mapreduce.Job:  map 29% reduce 0%
16/12/06 17:30:56 INFO mapreduce.Job:  map 30% reduce 0%
16/12/06 17:30:58 INFO mapreduce.Job:  map 30% reduce 1%
16/12/06 17:30:59 INFO mapreduce.Job:  map 30% reduce 2%
16/12/06 17:31:00 INFO mapreduce.Job:  map 32% reduce 4%
16/12/06 17:31:01 INFO mapreduce.Job:  map 34% reduce 4%
16/12/06 17:31:02 INFO mapreduce.Job:  map 35% reduce 5%
16/12/06 17:31:03 INFO mapreduce.Job:  map 35% reduce 6%
16/12/06 17:31:04 INFO mapreduce.Job:  map 38% reduce 8%
16/12/06 17:31:05 INFO mapreduce.Job:  map 40% reduce 9%
16/12/06 17:31:06 INFO mapreduce.Job:  map 42% reduce 11%
16/12/06 17:31:07 INFO mapreduce.Job:  map 42% reduce 12%
16/12/06 17:31:08 INFO mapreduce.Job:  map 44% reduce 14%
16/12/06 17:31:09 INFO mapreduce.Job:  map 46% reduce 14%
16/12/06 17:31:11 INFO mapreduce.Job:  map 49% reduce 15%
16/12/06 17:31:12 INFO mapreduce.Job:  map 52% reduce 16%
16/12/06 17:31:13 INFO mapreduce.Job:  map 54% reduce 16%
16/12/06 17:31:14 INFO mapreduce.Job:  map 54% reduce 17%
16/12/06 17:31:15 INFO mapreduce.Job:  map 55% reduce 18%
16/12/06 17:31:17 INFO mapreduce.Job:  map 56% reduce 18%
16/12/06 17:31:18 INFO mapreduce.Job:  map 57% reduce 18%
16/12/06 17:31:19 INFO mapreduce.Job:  map 59% reduce 19%
16/12/06 17:31:21 INFO mapreduce.Job:  map 60% reduce 19%
16/12/06 17:31:22 INFO mapreduce.Job:  map 63% reduce 20%
16/12/06 17:31:24 INFO mapreduce.Job:  map 64% reduce 21%
16/12/06 17:31:25 INFO mapreduce.Job:  map 65% reduce 21%
16/12/06 17:31:26 INFO mapreduce.Job:  map 65% reduce 22%
16/12/06 17:31:28 INFO mapreduce.Job:  map 66% reduce 22%
16/12/06 17:31:31 INFO mapreduce.Job:  map 67% reduce 22%
16/12/06 17:31:32 INFO mapreduce.Job:  map 68% reduce 22%
16/12/06 17:31:33 INFO mapreduce.Job:  map 72% reduce 22%
16/12/06 17:31:34 INFO mapreduce.Job:  map 73% reduce 22%
16/12/06 17:31:35 INFO mapreduce.Job:  map 75% reduce 23%
16/12/06 17:31:36 INFO mapreduce.Job:  map 81% reduce 23%
16/12/06 17:31:37 INFO mapreduce.Job:  map 85% reduce 25%
16/12/06 17:31:38 INFO mapreduce.Job:  map 88% reduce 26%
16/12/06 17:31:39 INFO mapreduce.Job:  map 90% reduce 27%
16/12/06 17:31:40 INFO mapreduce.Job:  map 93% reduce 29%
16/12/06 17:31:41 INFO mapreduce.Job:  map 96% reduce 30%
16/12/06 17:31:42 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 17:31:43 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 17:31:45 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 17:31:46 INFO mapreduce.Job:  map 100% reduce 37%
16/12/06 17:31:47 INFO mapreduce.Job:  map 100% reduce 44%
16/12/06 17:31:48 INFO mapreduce.Job:  map 100% reduce 54%
16/12/06 17:31:49 INFO mapreduce.Job:  map 100% reduce 70%
16/12/06 17:31:50 INFO mapreduce.Job:  map 100% reduce 78%
16/12/06 17:31:52 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 17:31:53 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 17:31:54 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 17:31:55 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 17:31:56 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 17:32:00 INFO mapreduce.Job: Job job_1480588584072_4718 completed successfully
16/12/06 17:32:00 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=186439589
		FILE: Number of bytes written=405261143
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=158081393
		WASB: Number of bytes written=94063790
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=11680256
		Total time spent by all reduces in occupied slots (ms)=2696290
		Total time spent by all map tasks (ms)=5840128
		Total time spent by all reduce tasks (ms)=1348145
		Total vcore-seconds taken by all map tasks=5840128
		Total vcore-seconds taken by all reduce tasks=1348145
		Total megabyte-seconds taken by all map tasks=5980291072
		Total megabyte-seconds taken by all reduce tasks=1380500480
	Map-Reduce Framework
		Map input records=499246
		Map output records=454687
		Map output bytes=184679761
		Map output materialized bytes=186463109
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=399131
		Reduce shuffle bytes=186463109
		Reduce input records=454687
		Reduce output records=276065
		Spilled Records=909374
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=62626
		CPU time spent (ms)=662850
		Physical memory (bytes) snapshot=321911287808
		Virtual memory (bytes) snapshot=742470504448
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=155385389
	File Output Format Counters 
		Bytes Written=94063790
16/12/06 17:32:00 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob840314515311273766.jar tmpDir=null
16/12/06 17:32:42 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:32:43 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:32:44 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 17:32:46 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 17:32:46 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 17:32:47 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4723
16/12/06 17:32:48 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4723
16/12/06 17:32:48 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4723/
16/12/06 17:32:48 INFO mapreduce.Job: Running job: job_1480588584072_4723
16/12/06 17:33:03 INFO mapreduce.Job: Job job_1480588584072_4723 running in uber mode : false
16/12/06 17:33:03 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 17:33:19 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 17:33:20 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 17:33:23 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 17:33:28 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 17:33:33 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 17:33:34 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 17:33:48 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 17:33:49 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 17:33:50 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 17:33:51 INFO mapreduce.Job:  map 15% reduce 1%
16/12/06 17:33:52 INFO mapreduce.Job:  map 16% reduce 1%
16/12/06 17:33:53 INFO mapreduce.Job:  map 19% reduce 1%
16/12/06 17:33:54 INFO mapreduce.Job:  map 21% reduce 1%
16/12/06 17:33:55 INFO mapreduce.Job:  map 22% reduce 1%
16/12/06 17:33:59 INFO mapreduce.Job:  map 23% reduce 1%
16/12/06 17:34:01 INFO mapreduce.Job:  map 24% reduce 2%
16/12/06 17:34:02 INFO mapreduce.Job:  map 25% reduce 2%
16/12/06 17:34:03 INFO mapreduce.Job:  map 27% reduce 2%
16/12/06 17:34:04 INFO mapreduce.Job:  map 27% reduce 3%
16/12/06 17:34:05 INFO mapreduce.Job:  map 27% reduce 4%
16/12/06 17:34:07 INFO mapreduce.Job:  map 28% reduce 4%
16/12/06 17:34:13 INFO mapreduce.Job:  map 29% reduce 5%
16/12/06 17:34:14 INFO mapreduce.Job:  map 29% reduce 7%
16/12/06 17:34:16 INFO mapreduce.Job:  map 29% reduce 8%
16/12/06 17:34:18 INFO mapreduce.Job:  map 31% reduce 8%
16/12/06 17:34:19 INFO mapreduce.Job:  map 34% reduce 8%
16/12/06 17:34:20 INFO mapreduce.Job:  map 35% reduce 8%
16/12/06 17:34:21 INFO mapreduce.Job:  map 36% reduce 9%
16/12/06 17:34:24 INFO mapreduce.Job:  map 38% reduce 10%
16/12/06 17:34:25 INFO mapreduce.Job:  map 39% reduce 11%
16/12/06 17:34:26 INFO mapreduce.Job:  map 41% reduce 12%
16/12/06 17:34:27 INFO mapreduce.Job:  map 43% reduce 13%
16/12/06 17:34:28 INFO mapreduce.Job:  map 44% reduce 13%
16/12/06 17:34:29 INFO mapreduce.Job:  map 45% reduce 14%
16/12/06 17:34:30 INFO mapreduce.Job:  map 46% reduce 15%
16/12/06 17:34:31 INFO mapreduce.Job:  map 47% reduce 15%
16/12/06 17:34:33 INFO mapreduce.Job:  map 47% reduce 16%
16/12/06 17:34:36 INFO mapreduce.Job:  map 48% reduce 16%
16/12/06 17:34:37 INFO mapreduce.Job:  map 49% reduce 16%
16/12/06 17:34:38 INFO mapreduce.Job:  map 51% reduce 16%
16/12/06 17:34:39 INFO mapreduce.Job:  map 52% reduce 16%
16/12/06 17:34:40 INFO mapreduce.Job:  map 52% reduce 17%
16/12/06 17:34:41 INFO mapreduce.Job:  map 53% reduce 17%
16/12/06 17:34:42 INFO mapreduce.Job:  map 54% reduce 17%
16/12/06 17:34:43 INFO mapreduce.Job:  map 56% reduce 17%
16/12/06 17:34:44 INFO mapreduce.Job:  map 58% reduce 18%
16/12/06 17:34:45 INFO mapreduce.Job:  map 59% reduce 18%
16/12/06 17:34:46 INFO mapreduce.Job:  map 59% reduce 19%
16/12/06 17:34:47 INFO mapreduce.Job:  map 62% reduce 19%
16/12/06 17:34:48 INFO mapreduce.Job:  map 65% reduce 20%
16/12/06 17:34:49 INFO mapreduce.Job:  map 69% reduce 20%
16/12/06 17:34:50 INFO mapreduce.Job:  map 72% reduce 21%
16/12/06 17:34:51 INFO mapreduce.Job:  map 75% reduce 22%
16/12/06 17:34:52 INFO mapreduce.Job:  map 78% reduce 23%
16/12/06 17:34:53 INFO mapreduce.Job:  map 80% reduce 24%
16/12/06 17:34:54 INFO mapreduce.Job:  map 80% reduce 25%
16/12/06 17:34:55 INFO mapreduce.Job:  map 82% reduce 25%
16/12/06 17:34:56 INFO mapreduce.Job:  map 84% reduce 26%
16/12/06 17:34:57 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 17:34:58 INFO mapreduce.Job:  map 87% reduce 27%
16/12/06 17:34:59 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 17:35:00 INFO mapreduce.Job:  map 88% reduce 29%
16/12/06 17:35:03 INFO mapreduce.Job:  map 89% reduce 29%
16/12/06 17:35:05 INFO mapreduce.Job:  map 90% reduce 30%
16/12/06 17:35:07 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 17:35:08 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 17:35:09 INFO mapreduce.Job:  map 94% reduce 31%
16/12/06 17:35:11 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 17:35:12 INFO mapreduce.Job:  map 95% reduce 32%
16/12/06 17:35:13 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 17:35:14 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 17:35:15 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 17:35:16 INFO mapreduce.Job:  map 100% reduce 39%
16/12/06 17:35:17 INFO mapreduce.Job:  map 100% reduce 51%
16/12/06 17:35:18 INFO mapreduce.Job:  map 100% reduce 83%
16/12/06 17:35:19 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 17:35:20 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 17:35:22 INFO mapreduce.Job: Job job_1480588584072_4723 completed successfully
16/12/06 17:35:22 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=150338182
		FILE: Number of bytes written=333058329
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=130060558
		WASB: Number of bytes written=64327171
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13862108
		Total time spent by all reduces in occupied slots (ms)=3408376
		Total time spent by all map tasks (ms)=6931054
		Total time spent by all reduce tasks (ms)=1704188
		Total vcore-seconds taken by all map tasks=6931054
		Total vcore-seconds taken by all reduce tasks=1704188
		Total megabyte-seconds taken by all map tasks=7097399296
		Total megabyte-seconds taken by all reduce tasks=1745088512
	Map-Reduce Framework
		Map input records=418599
		Map output records=371107
		Map output bytes=148902460
		Map output materialized bytes=150361702
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=322724
		Reduce shuffle bytes=150361702
		Reduce input records=371107
		Reduce output records=190422
		Spilled Records=742214
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=69745
		CPU time spent (ms)=649390
		Physical memory (bytes) snapshot=322498306048
		Virtual memory (bytes) snapshot=742601437184
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=127364554
	File Output Format Counters 
		Bytes Written=64327171
16/12/06 17:35:22 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612021900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3124551730377181822.jar tmpDir=null
16/12/06 17:36:04 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:36:05 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:36:05 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 17:36:07 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 17:36:08 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 17:36:08 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4727
16/12/06 17:36:09 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4727
16/12/06 17:36:09 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4727/
16/12/06 17:36:09 INFO mapreduce.Job: Running job: job_1480588584072_4727
16/12/06 17:36:22 INFO mapreduce.Job: Job job_1480588584072_4727 running in uber mode : false
16/12/06 17:36:22 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 17:36:32 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 17:36:33 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 17:36:44 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 17:36:45 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 17:36:46 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 17:36:52 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 17:36:58 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 17:36:59 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 17:37:02 INFO mapreduce.Job:  map 16% reduce 1%
16/12/06 17:37:10 INFO mapreduce.Job:  map 16% reduce 2%
16/12/06 17:37:11 INFO mapreduce.Job:  map 17% reduce 2%
16/12/06 17:37:13 INFO mapreduce.Job:  map 18% reduce 2%
16/12/06 17:37:14 INFO mapreduce.Job:  map 19% reduce 3%
16/12/06 17:37:15 INFO mapreduce.Job:  map 20% reduce 3%
16/12/06 17:37:16 INFO mapreduce.Job:  map 23% reduce 3%
16/12/06 17:37:18 INFO mapreduce.Job:  map 25% reduce 3%
16/12/06 17:37:20 INFO mapreduce.Job:  map 25% reduce 4%
16/12/06 17:37:29 INFO mapreduce.Job:  map 26% reduce 4%
16/12/06 17:37:40 INFO mapreduce.Job:  map 26% reduce 5%
16/12/06 17:37:43 INFO mapreduce.Job:  map 28% reduce 5%
16/12/06 17:37:44 INFO mapreduce.Job:  map 30% reduce 6%
16/12/06 17:37:46 INFO mapreduce.Job:  map 31% reduce 7%
16/12/06 17:37:47 INFO mapreduce.Job:  map 34% reduce 8%
16/12/06 17:37:48 INFO mapreduce.Job:  map 36% reduce 9%
16/12/06 17:37:49 INFO mapreduce.Job:  map 39% reduce 10%
16/12/06 17:37:51 INFO mapreduce.Job:  map 40% reduce 11%
16/12/06 17:37:52 INFO mapreduce.Job:  map 40% reduce 12%
16/12/06 17:37:53 INFO mapreduce.Job:  map 40% reduce 13%
16/12/06 17:37:54 INFO mapreduce.Job:  map 41% reduce 13%
16/12/06 17:37:55 INFO mapreduce.Job:  map 42% reduce 13%
16/12/06 17:37:56 INFO mapreduce.Job:  map 42% reduce 14%
16/12/06 17:37:57 INFO mapreduce.Job:  map 43% reduce 14%
16/12/06 17:37:58 INFO mapreduce.Job:  map 45% reduce 14%
16/12/06 17:37:59 INFO mapreduce.Job:  map 46% reduce 14%
16/12/06 17:38:00 INFO mapreduce.Job:  map 49% reduce 15%
16/12/06 17:38:01 INFO mapreduce.Job:  map 51% reduce 15%
16/12/06 17:38:02 INFO mapreduce.Job:  map 52% reduce 15%
16/12/06 17:38:03 INFO mapreduce.Job:  map 53% reduce 16%
16/12/06 17:38:04 INFO mapreduce.Job:  map 56% reduce 17%
16/12/06 17:38:05 INFO mapreduce.Job:  map 57% reduce 18%
16/12/06 17:38:06 INFO mapreduce.Job:  map 59% reduce 18%
16/12/06 17:38:07 INFO mapreduce.Job:  map 61% reduce 19%
16/12/06 17:38:09 INFO mapreduce.Job:  map 63% reduce 20%
16/12/06 17:38:10 INFO mapreduce.Job:  map 67% reduce 20%
16/12/06 17:38:11 INFO mapreduce.Job:  map 70% reduce 21%
16/12/06 17:38:12 INFO mapreduce.Job:  map 72% reduce 21%
16/12/06 17:38:13 INFO mapreduce.Job:  map 74% reduce 22%
16/12/06 17:38:15 INFO mapreduce.Job:  map 78% reduce 23%
16/12/06 17:38:16 INFO mapreduce.Job:  map 79% reduce 23%
16/12/06 17:38:17 INFO mapreduce.Job:  map 81% reduce 24%
16/12/06 17:38:18 INFO mapreduce.Job:  map 84% reduce 25%
16/12/06 17:38:19 INFO mapreduce.Job:  map 87% reduce 25%
16/12/06 17:38:20 INFO mapreduce.Job:  map 90% reduce 27%
16/12/06 17:38:21 INFO mapreduce.Job:  map 93% reduce 28%
16/12/06 17:38:22 INFO mapreduce.Job:  map 95% reduce 29%
16/12/06 17:38:23 INFO mapreduce.Job:  map 97% reduce 30%
16/12/06 17:38:24 INFO mapreduce.Job:  map 97% reduce 32%
16/12/06 17:38:27 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 17:38:28 INFO mapreduce.Job:  map 99% reduce 33%
16/12/06 17:38:29 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 17:38:30 INFO mapreduce.Job:  map 100% reduce 38%
16/12/06 17:38:31 INFO mapreduce.Job:  map 100% reduce 45%
16/12/06 17:38:32 INFO mapreduce.Job:  map 100% reduce 63%
16/12/06 17:38:33 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 17:38:34 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 17:38:35 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 17:38:39 INFO mapreduce.Job: Job job_1480588584072_4727 completed successfully
16/12/06 17:38:40 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=159954150
		FILE: Number of bytes written=352290265
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=139692158
		WASB: Number of bytes written=58903347
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=14452116
		Total time spent by all reduces in occupied slots (ms)=3344292
		Total time spent by all map tasks (ms)=7226058
		Total time spent by all reduce tasks (ms)=1672146
		Total vcore-seconds taken by all map tasks=7226058
		Total vcore-seconds taken by all reduce tasks=1672146
		Total megabyte-seconds taken by all map tasks=7399483392
		Total megabyte-seconds taken by all reduce tasks=1712277504
	Map-Reduce Framework
		Map input records=455970
		Map output records=397009
		Map output bytes=158416666
		Map output materialized bytes=159977670
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=342152
		Reduce shuffle bytes=159977670
		Reduce input records=397009
		Reduce output records=175077
		Spilled Records=794018
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=67749
		CPU time spent (ms)=667280
		Physical memory (bytes) snapshot=322560835584
		Virtual memory (bytes) snapshot=742721703936
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=136996154
	File Output Format Counters 
		Bytes Written=58903347
16/12/06 17:38:40 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0400 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0400': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1583262586636447812.jar tmpDir=null
16/12/06 17:39:22 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:39:23 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:39:23 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 17:39:26 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 17:39:26 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 17:39:27 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4732
16/12/06 17:39:27 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4732
16/12/06 17:39:28 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4732/
16/12/06 17:39:28 INFO mapreduce.Job: Running job: job_1480588584072_4732
16/12/06 17:39:57 INFO mapreduce.Job: Job job_1480588584072_4732 running in uber mode : false
16/12/06 17:39:57 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 17:40:06 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 17:40:11 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 17:40:12 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 17:40:15 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 17:40:18 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 17:40:19 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 17:40:20 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 17:40:21 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 17:40:24 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 17:40:26 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 17:40:27 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 17:40:28 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 17:40:30 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 17:40:31 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 17:40:32 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 17:40:33 INFO mapreduce.Job:  map 26% reduce 1%
16/12/06 17:40:35 INFO mapreduce.Job:  map 26% reduce 2%
16/12/06 17:40:39 INFO mapreduce.Job:  map 26% reduce 3%
16/12/06 17:40:40 INFO mapreduce.Job:  map 27% reduce 3%
16/12/06 17:40:41 INFO mapreduce.Job:  map 29% reduce 4%
16/12/06 17:40:42 INFO mapreduce.Job:  map 30% reduce 4%
16/12/06 17:40:43 INFO mapreduce.Job:  map 32% reduce 6%
16/12/06 17:40:44 INFO mapreduce.Job:  map 32% reduce 7%
16/12/06 17:40:46 INFO mapreduce.Job:  map 34% reduce 10%
16/12/06 17:40:47 INFO mapreduce.Job:  map 35% reduce 10%
16/12/06 17:40:48 INFO mapreduce.Job:  map 38% reduce 10%
16/12/06 17:40:49 INFO mapreduce.Job:  map 39% reduce 11%
16/12/06 17:40:50 INFO mapreduce.Job:  map 41% reduce 12%
16/12/06 17:40:51 INFO mapreduce.Job:  map 42% reduce 12%
16/12/06 17:40:52 INFO mapreduce.Job:  map 42% reduce 13%
16/12/06 17:40:53 INFO mapreduce.Job:  map 43% reduce 14%
16/12/06 17:40:57 INFO mapreduce.Job:  map 46% reduce 14%
16/12/06 17:40:58 INFO mapreduce.Job:  map 46% reduce 15%
16/12/06 17:41:01 INFO mapreduce.Job:  map 47% reduce 15%
16/12/06 17:41:03 INFO mapreduce.Job:  map 48% reduce 15%
16/12/06 17:41:04 INFO mapreduce.Job:  map 49% reduce 16%
16/12/06 17:41:07 INFO mapreduce.Job:  map 50% reduce 16%
16/12/06 17:41:09 INFO mapreduce.Job:  map 51% reduce 17%
16/12/06 17:41:10 INFO mapreduce.Job:  map 52% reduce 17%
16/12/06 17:41:11 INFO mapreduce.Job:  map 53% reduce 17%
16/12/06 17:41:13 INFO mapreduce.Job:  map 54% reduce 18%
16/12/06 17:41:15 INFO mapreduce.Job:  map 56% reduce 18%
16/12/06 17:41:16 INFO mapreduce.Job:  map 57% reduce 18%
16/12/06 17:41:17 INFO mapreduce.Job:  map 60% reduce 18%
16/12/06 17:41:18 INFO mapreduce.Job:  map 62% reduce 19%
16/12/06 17:41:19 INFO mapreduce.Job:  map 63% reduce 20%
16/12/06 17:41:20 INFO mapreduce.Job:  map 65% reduce 20%
16/12/06 17:41:21 INFO mapreduce.Job:  map 66% reduce 21%
16/12/06 17:41:23 INFO mapreduce.Job:  map 68% reduce 22%
16/12/06 17:41:24 INFO mapreduce.Job:  map 69% reduce 22%
16/12/06 17:41:25 INFO mapreduce.Job:  map 70% reduce 23%
16/12/06 17:41:26 INFO mapreduce.Job:  map 71% reduce 23%
16/12/06 17:41:27 INFO mapreduce.Job:  map 72% reduce 23%
16/12/06 17:41:28 INFO mapreduce.Job:  map 72% reduce 24%
16/12/06 17:41:32 INFO mapreduce.Job:  map 73% reduce 24%
16/12/06 17:41:36 INFO mapreduce.Job:  map 74% reduce 24%
16/12/06 17:41:38 INFO mapreduce.Job:  map 75% reduce 24%
16/12/06 17:41:39 INFO mapreduce.Job:  map 76% reduce 24%
16/12/06 17:41:40 INFO mapreduce.Job:  map 77% reduce 25%
16/12/06 17:41:42 INFO mapreduce.Job:  map 78% reduce 25%
16/12/06 17:41:43 INFO mapreduce.Job:  map 79% reduce 25%
16/12/06 17:41:44 INFO mapreduce.Job:  map 80% reduce 26%
16/12/06 17:41:45 INFO mapreduce.Job:  map 85% reduce 26%
16/12/06 17:41:46 INFO mapreduce.Job:  map 88% reduce 27%
16/12/06 17:41:47 INFO mapreduce.Job:  map 90% reduce 28%
16/12/06 17:41:48 INFO mapreduce.Job:  map 91% reduce 28%
16/12/06 17:41:49 INFO mapreduce.Job:  map 92% reduce 29%
16/12/06 17:41:50 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 17:41:51 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 17:41:52 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 17:41:53 INFO mapreduce.Job:  map 98% reduce 31%
16/12/06 17:41:54 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 17:41:55 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 17:41:56 INFO mapreduce.Job:  map 100% reduce 36%
16/12/06 17:41:57 INFO mapreduce.Job:  map 100% reduce 46%
16/12/06 17:41:58 INFO mapreduce.Job:  map 100% reduce 69%
16/12/06 17:41:59 INFO mapreduce.Job:  map 100% reduce 84%
16/12/06 17:42:00 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 17:42:01 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 17:42:04 INFO mapreduce.Job: Job job_1480588584072_4732 completed successfully
16/12/06 17:42:04 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=222314686
		FILE: Number of bytes written=477011337
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=191443784
		WASB: Number of bytes written=90083234
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=14184164
		Total time spent by all reduces in occupied slots (ms)=3671524
		Total time spent by all map tasks (ms)=7092082
		Total time spent by all reduce tasks (ms)=1835762
		Total vcore-seconds taken by all map tasks=7092082
		Total vcore-seconds taken by all reduce tasks=1835762
		Total megabyte-seconds taken by all map tasks=7262291968
		Total megabyte-seconds taken by all reduce tasks=1879820288
	Map-Reduce Framework
		Map input records=623757
		Map output records=550225
		Map output bytes=220189069
		Map output materialized bytes=222338206
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=474192
		Reduce shuffle bytes=222338206
		Reduce input records=550225
		Reduce output records=268512
		Spilled Records=1100450
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=73957
		CPU time spent (ms)=714080
		Physical memory (bytes) snapshot=322687066112
		Virtual memory (bytes) snapshot=742342348800
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=188747780
	File Output Format Counters 
		Bytes Written=90083234
16/12/06 17:42:04 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0400
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0500 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0500': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3977853828372764630.jar tmpDir=null
16/12/06 17:42:45 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:42:45 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:42:46 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 17:42:48 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 17:42:48 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 17:42:48 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4739
16/12/06 17:42:49 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4739
16/12/06 17:42:49 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4739/
16/12/06 17:42:49 INFO mapreduce.Job: Running job: job_1480588584072_4739
16/12/06 17:43:41 INFO mapreduce.Job: Job job_1480588584072_4739 running in uber mode : false
16/12/06 17:43:41 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 17:43:55 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 17:44:06 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 17:44:07 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 17:44:09 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 17:44:16 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 17:44:18 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 17:44:19 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 17:44:20 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 17:44:22 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 17:44:23 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 17:44:25 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 17:44:32 INFO mapreduce.Job:  map 17% reduce 1%
16/12/06 17:44:33 INFO mapreduce.Job:  map 18% reduce 1%
16/12/06 17:44:34 INFO mapreduce.Job:  map 19% reduce 1%
16/12/06 17:44:35 INFO mapreduce.Job:  map 21% reduce 1%
16/12/06 17:44:36 INFO mapreduce.Job:  map 24% reduce 2%
16/12/06 17:44:37 INFO mapreduce.Job:  map 25% reduce 2%
16/12/06 17:44:38 INFO mapreduce.Job:  map 25% reduce 3%
16/12/06 17:44:39 INFO mapreduce.Job:  map 27% reduce 3%
16/12/06 17:44:42 INFO mapreduce.Job:  map 27% reduce 4%
16/12/06 17:44:43 INFO mapreduce.Job:  map 29% reduce 4%
16/12/06 17:44:44 INFO mapreduce.Job:  map 30% reduce 4%
16/12/06 17:44:48 INFO mapreduce.Job:  map 30% reduce 6%
16/12/06 17:44:52 INFO mapreduce.Job:  map 32% reduce 6%
16/12/06 17:44:54 INFO mapreduce.Job:  map 33% reduce 6%
16/12/06 17:44:56 INFO mapreduce.Job:  map 33% reduce 8%
16/12/06 17:44:57 INFO mapreduce.Job:  map 33% reduce 9%
16/12/06 17:44:59 INFO mapreduce.Job:  map 37% reduce 10%
16/12/06 17:45:00 INFO mapreduce.Job:  map 39% reduce 10%
16/12/06 17:45:01 INFO mapreduce.Job:  map 40% reduce 11%
16/12/06 17:45:02 INFO mapreduce.Job:  map 40% reduce 12%
16/12/06 17:45:03 INFO mapreduce.Job:  map 41% reduce 13%
16/12/06 17:45:04 INFO mapreduce.Job:  map 43% reduce 13%
16/12/06 17:45:05 INFO mapreduce.Job:  map 45% reduce 14%
16/12/06 17:45:06 INFO mapreduce.Job:  map 46% reduce 14%
16/12/06 17:45:07 INFO mapreduce.Job:  map 48% reduce 15%
16/12/06 17:45:10 INFO mapreduce.Job:  map 49% reduce 16%
16/12/06 17:45:11 INFO mapreduce.Job:  map 50% reduce 16%
16/12/06 17:45:13 INFO mapreduce.Job:  map 51% reduce 16%
16/12/06 17:45:14 INFO mapreduce.Job:  map 52% reduce 16%
16/12/06 17:45:15 INFO mapreduce.Job:  map 54% reduce 17%
16/12/06 17:45:17 INFO mapreduce.Job:  map 56% reduce 17%
16/12/06 17:45:18 INFO mapreduce.Job:  map 58% reduce 18%
16/12/06 17:45:19 INFO mapreduce.Job:  map 59% reduce 18%
16/12/06 17:45:21 INFO mapreduce.Job:  map 62% reduce 19%
16/12/06 17:45:22 INFO mapreduce.Job:  map 64% reduce 19%
16/12/06 17:45:23 INFO mapreduce.Job:  map 66% reduce 19%
16/12/06 17:45:24 INFO mapreduce.Job:  map 67% reduce 20%
16/12/06 17:45:25 INFO mapreduce.Job:  map 68% reduce 21%
16/12/06 17:45:26 INFO mapreduce.Job:  map 70% reduce 22%
16/12/06 17:45:27 INFO mapreduce.Job:  map 72% reduce 22%
16/12/06 17:45:28 INFO mapreduce.Job:  map 74% reduce 23%
16/12/06 17:45:29 INFO mapreduce.Job:  map 74% reduce 24%
16/12/06 17:45:30 INFO mapreduce.Job:  map 75% reduce 24%
16/12/06 17:45:32 INFO mapreduce.Job:  map 77% reduce 24%
16/12/06 17:45:33 INFO mapreduce.Job:  map 77% reduce 25%
16/12/06 17:45:34 INFO mapreduce.Job:  map 78% reduce 25%
16/12/06 17:45:35 INFO mapreduce.Job:  map 82% reduce 25%
16/12/06 17:45:36 INFO mapreduce.Job:  map 83% reduce 26%
16/12/06 17:45:37 INFO mapreduce.Job:  map 83% reduce 27%
16/12/06 17:45:40 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 17:45:41 INFO mapreduce.Job:  map 86% reduce 28%
16/12/06 17:45:43 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 17:45:44 INFO mapreduce.Job:  map 89% reduce 29%
16/12/06 17:45:46 INFO mapreduce.Job:  map 89% reduce 30%
16/12/06 17:45:53 INFO mapreduce.Job:  map 90% reduce 30%
16/12/06 17:45:57 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 17:45:58 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 17:45:59 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 17:46:01 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 17:46:02 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 17:46:03 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 17:46:04 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 17:46:05 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 17:46:07 INFO mapreduce.Job:  map 99% reduce 33%
16/12/06 17:46:08 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 17:46:09 INFO mapreduce.Job:  map 100% reduce 38%
16/12/06 17:46:10 INFO mapreduce.Job:  map 100% reduce 41%
16/12/06 17:46:11 INFO mapreduce.Job:  map 100% reduce 55%
16/12/06 17:46:12 INFO mapreduce.Job:  map 100% reduce 83%
16/12/06 17:46:13 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 17:46:14 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 17:46:15 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 17:46:17 INFO mapreduce.Job: Job job_1480588584072_4739 completed successfully
16/12/06 17:46:17 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=349573059
		FILE: Number of bytes written=731528083
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=301198272
		WASB: Number of bytes written=160648268
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=11433156
		Total time spent by all reduces in occupied slots (ms)=4008936
		Total time spent by all map tasks (ms)=5716578
		Total time spent by all reduce tasks (ms)=2004468
		Total vcore-seconds taken by all map tasks=5716578
		Total vcore-seconds taken by all reduce tasks=2004468
		Total megabyte-seconds taken by all map tasks=5853775872
		Total megabyte-seconds taken by all reduce tasks=2052575232
	Map-Reduce Framework
		Map input records=971847
		Map output records=855973
		Map output bytes=346261718
		Map output materialized bytes=349596579
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=741471
		Reduce shuffle bytes=349596579
		Reduce input records=855973
		Reduce output records=473543
		Spilled Records=1711946
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=67977
		CPU time spent (ms)=791120
		Physical memory (bytes) snapshot=323252858880
		Virtual memory (bytes) snapshot=742871334912
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=298502268
	File Output Format Counters 
		Bytes Written=160648268
16/12/06 17:46:17 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0500
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0600 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0600': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5721150153766704343.jar tmpDir=null
16/12/06 17:46:56 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:46:57 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:46:57 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 17:46:59 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 17:46:59 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 17:47:00 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4745
16/12/06 17:47:01 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4745
16/12/06 17:47:01 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4745/
16/12/06 17:47:01 INFO mapreduce.Job: Running job: job_1480588584072_4745
16/12/06 17:48:15 INFO mapreduce.Job: Job job_1480588584072_4745 running in uber mode : false
16/12/06 17:48:15 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 17:48:40 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 17:48:42 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 17:48:43 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 17:48:50 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 17:48:53 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 17:48:54 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 17:48:56 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 17:48:57 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 17:48:58 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 17:49:02 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 17:49:04 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 17:49:05 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 17:49:06 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 17:49:07 INFO mapreduce.Job:  map 32% reduce 0%
16/12/06 17:49:08 INFO mapreduce.Job:  map 34% reduce 0%
16/12/06 17:49:09 INFO mapreduce.Job:  map 36% reduce 0%
16/12/06 17:49:11 INFO mapreduce.Job:  map 39% reduce 0%
16/12/06 17:49:12 INFO mapreduce.Job:  map 43% reduce 0%
16/12/06 17:49:13 INFO mapreduce.Job:  map 48% reduce 0%
16/12/06 17:49:16 INFO mapreduce.Job:  map 50% reduce 0%
16/12/06 17:49:17 INFO mapreduce.Job:  map 52% reduce 0%
16/12/06 17:49:18 INFO mapreduce.Job:  map 55% reduce 1%
16/12/06 17:49:19 INFO mapreduce.Job:  map 55% reduce 2%
16/12/06 17:49:21 INFO mapreduce.Job:  map 56% reduce 2%
16/12/06 17:49:23 INFO mapreduce.Job:  map 57% reduce 5%
16/12/06 17:49:24 INFO mapreduce.Job:  map 57% reduce 8%
16/12/06 17:49:25 INFO mapreduce.Job:  map 58% reduce 9%
16/12/06 17:49:26 INFO mapreduce.Job:  map 59% reduce 11%
16/12/06 17:49:27 INFO mapreduce.Job:  map 61% reduce 11%
16/12/06 17:49:28 INFO mapreduce.Job:  map 62% reduce 13%
16/12/06 17:49:29 INFO mapreduce.Job:  map 64% reduce 15%
16/12/06 17:49:30 INFO mapreduce.Job:  map 67% reduce 16%
16/12/06 17:49:31 INFO mapreduce.Job:  map 69% reduce 20%
16/12/06 17:49:32 INFO mapreduce.Job:  map 69% reduce 21%
16/12/06 17:49:34 INFO mapreduce.Job:  map 70% reduce 22%
16/12/06 17:49:35 INFO mapreduce.Job:  map 72% reduce 23%
16/12/06 17:49:36 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 17:49:37 INFO mapreduce.Job:  map 74% reduce 24%
16/12/06 17:49:39 INFO mapreduce.Job:  map 76% reduce 24%
16/12/06 17:49:40 INFO mapreduce.Job:  map 78% reduce 25%
16/12/06 17:49:41 INFO mapreduce.Job:  map 81% reduce 25%
16/12/06 17:49:42 INFO mapreduce.Job:  map 85% reduce 26%
16/12/06 17:49:43 INFO mapreduce.Job:  map 92% reduce 27%
16/12/06 17:49:44 INFO mapreduce.Job:  map 95% reduce 28%
16/12/06 17:49:45 INFO mapreduce.Job:  map 97% reduce 30%
16/12/06 17:49:46 INFO mapreduce.Job:  map 99% reduce 31%
16/12/06 17:49:47 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 17:49:48 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 17:49:49 INFO mapreduce.Job:  map 100% reduce 39%
16/12/06 17:49:50 INFO mapreduce.Job:  map 100% reduce 47%
16/12/06 17:49:51 INFO mapreduce.Job:  map 100% reduce 54%
16/12/06 17:49:52 INFO mapreduce.Job:  map 100% reduce 63%
16/12/06 17:49:53 INFO mapreduce.Job:  map 100% reduce 68%
16/12/06 17:49:54 INFO mapreduce.Job:  map 100% reduce 74%
16/12/06 17:49:55 INFO mapreduce.Job:  map 100% reduce 77%
16/12/06 17:49:56 INFO mapreduce.Job:  map 100% reduce 79%
16/12/06 17:49:57 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 17:49:58 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 17:49:59 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 17:50:00 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 17:50:01 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 17:50:02 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 17:50:04 INFO mapreduce.Job: Job job_1480588584072_4745 completed successfully
16/12/06 17:50:04 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=436443483
		FILE: Number of bytes written=905268931
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=374893523
		WASB: Number of bytes written=203979968
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=10233390
		Total time spent by all reduces in occupied slots (ms)=2264700
		Total time spent by all map tasks (ms)=5116695
		Total time spent by all reduce tasks (ms)=1132350
		Total vcore-seconds taken by all map tasks=5116695
		Total vcore-seconds taken by all reduce tasks=1132350
		Total megabyte-seconds taken by all map tasks=5239495680
		Total megabyte-seconds taken by all reduce tasks=1159526400
	Map-Reduce Framework
		Map input records=1207939
		Map output records=1066011
		Map output bytes=432318734
		Map output materialized bytes=436467003
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=922225
		Reduce shuffle bytes=436467003
		Reduce input records=1066011
		Reduce output records=599705
		Spilled Records=2132022
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=68283
		CPU time spent (ms)=822510
		Physical memory (bytes) snapshot=323169263616
		Virtual memory (bytes) snapshot=742719803392
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=372197519
	File Output Format Counters 
		Bytes Written=203979968
16/12/06 17:50:04 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0600
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0700 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161202/201612022300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0700': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4026796995773960385.jar tmpDir=null
16/12/06 17:50:41 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:50:43 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:50:43 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 17:50:45 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 17:50:45 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 17:50:46 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4750
16/12/06 17:50:46 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4750
16/12/06 17:50:46 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4750/
16/12/06 17:50:46 INFO mapreduce.Job: Running job: job_1480588584072_4750
16/12/06 17:51:06 INFO mapreduce.Job: Job job_1480588584072_4750 running in uber mode : false
16/12/06 17:51:07 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 17:51:16 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 17:51:25 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 17:51:26 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 17:51:27 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 17:51:33 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 17:51:35 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 17:51:38 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 17:51:39 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 17:51:40 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 17:51:41 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 17:51:42 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 17:51:47 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 17:51:48 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 17:51:50 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 17:51:51 INFO mapreduce.Job:  map 32% reduce 0%
16/12/06 17:51:52 INFO mapreduce.Job:  map 35% reduce 0%
16/12/06 17:51:53 INFO mapreduce.Job:  map 40% reduce 3%
16/12/06 17:51:55 INFO mapreduce.Job:  map 42% reduce 4%
16/12/06 17:51:56 INFO mapreduce.Job:  map 43% reduce 5%
16/12/06 17:51:57 INFO mapreduce.Job:  map 44% reduce 5%
16/12/06 17:51:58 INFO mapreduce.Job:  map 45% reduce 5%
16/12/06 17:51:59 INFO mapreduce.Job:  map 46% reduce 6%
16/12/06 17:52:00 INFO mapreduce.Job:  map 47% reduce 6%
16/12/06 17:52:01 INFO mapreduce.Job:  map 48% reduce 6%
16/12/06 17:52:02 INFO mapreduce.Job:  map 49% reduce 7%
16/12/06 17:52:03 INFO mapreduce.Job:  map 51% reduce 8%
16/12/06 17:52:04 INFO mapreduce.Job:  map 54% reduce 10%
16/12/06 17:52:05 INFO mapreduce.Job:  map 55% reduce 13%
16/12/06 17:52:06 INFO mapreduce.Job:  map 56% reduce 15%
16/12/06 17:52:07 INFO mapreduce.Job:  map 57% reduce 15%
16/12/06 17:52:08 INFO mapreduce.Job:  map 59% reduce 15%
16/12/06 17:52:09 INFO mapreduce.Job:  map 59% reduce 16%
16/12/06 17:52:10 INFO mapreduce.Job:  map 60% reduce 16%
16/12/06 17:52:11 INFO mapreduce.Job:  map 60% reduce 17%
16/12/06 17:52:12 INFO mapreduce.Job:  map 61% reduce 17%
16/12/06 17:52:13 INFO mapreduce.Job:  map 62% reduce 17%
16/12/06 17:52:14 INFO mapreduce.Job:  map 62% reduce 18%
16/12/06 17:52:15 INFO mapreduce.Job:  map 64% reduce 20%
16/12/06 17:52:16 INFO mapreduce.Job:  map 64% reduce 21%
16/12/06 17:52:17 INFO mapreduce.Job:  map 66% reduce 21%
16/12/06 17:52:18 INFO mapreduce.Job:  map 69% reduce 22%
16/12/06 17:52:19 INFO mapreduce.Job:  map 70% reduce 22%
16/12/06 17:52:20 INFO mapreduce.Job:  map 72% reduce 23%
16/12/06 17:52:21 INFO mapreduce.Job:  map 75% reduce 23%
16/12/06 17:52:22 INFO mapreduce.Job:  map 76% reduce 24%
16/12/06 17:52:23 INFO mapreduce.Job:  map 78% reduce 25%
16/12/06 17:52:25 INFO mapreduce.Job:  map 78% reduce 26%
16/12/06 17:52:26 INFO mapreduce.Job:  map 80% reduce 26%
16/12/06 17:52:28 INFO mapreduce.Job:  map 83% reduce 26%
16/12/06 17:52:29 INFO mapreduce.Job:  map 84% reduce 27%
16/12/06 17:52:30 INFO mapreduce.Job:  map 87% reduce 27%
16/12/06 17:52:31 INFO mapreduce.Job:  map 90% reduce 28%
16/12/06 17:52:32 INFO mapreduce.Job:  map 94% reduce 29%
16/12/06 17:52:33 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 17:52:34 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 17:52:35 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 17:52:36 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 17:52:37 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 17:52:38 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 17:52:39 INFO mapreduce.Job:  map 100% reduce 41%
16/12/06 17:52:41 INFO mapreduce.Job:  map 100% reduce 49%
16/12/06 17:52:42 INFO mapreduce.Job:  map 100% reduce 62%
16/12/06 17:52:43 INFO mapreduce.Job:  map 100% reduce 77%
16/12/06 17:52:44 INFO mapreduce.Job:  map 100% reduce 79%
16/12/06 17:52:45 INFO mapreduce.Job:  map 100% reduce 84%
16/12/06 17:52:46 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 17:52:48 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 17:52:49 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 17:52:50 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 17:52:53 INFO mapreduce.Job: Job job_1480588584072_4750 completed successfully
16/12/06 17:52:53 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=504825301
		FILE: Number of bytes written=1042032567
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=435270292
		WASB: Number of bytes written=236862866
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=10296732
		Total time spent by all reduces in occupied slots (ms)=2558926
		Total time spent by all map tasks (ms)=5148366
		Total time spent by all reduce tasks (ms)=1279463
		Total vcore-seconds taken by all map tasks=5148366
		Total vcore-seconds taken by all reduce tasks=1279463
		Total megabyte-seconds taken by all map tasks=5271926784
		Total megabyte-seconds taken by all reduce tasks=1310170112
	Map-Reduce Framework
		Map input records=1406411
		Map output records=1234120
		Map output bytes=500050518
		Map output materialized bytes=504848821
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1068667
		Reduce shuffle bytes=504848821
		Reduce input records=1234120
		Reduce output records=698183
		Spilled Records=2468240
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=76937
		CPU time spent (ms)=852860
		Physical memory (bytes) snapshot=323246051328
		Virtual memory (bytes) snapshot=742146732032
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=432574288
	File Output Format Counters 
		Bytes Written=236862866
16/12/06 17:52:53 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0700
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030400 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0800 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030400
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0800': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8081722773114897595.jar tmpDir=null
16/12/06 17:53:31 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:53:31 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:53:32 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 17:53:33 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 17:53:34 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 17:53:34 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4755
16/12/06 17:53:35 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4755
16/12/06 17:53:35 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4755/
16/12/06 17:53:35 INFO mapreduce.Job: Running job: job_1480588584072_4755
16/12/06 17:53:47 INFO mapreduce.Job: Job job_1480588584072_4755 running in uber mode : false
16/12/06 17:53:47 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 17:54:05 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 17:54:14 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 17:54:15 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 17:54:16 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 17:54:18 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 17:54:19 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 17:54:20 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 17:54:22 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 17:54:30 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 17:54:32 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 17:54:33 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 17:54:34 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 17:54:35 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 17:54:36 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 17:54:37 INFO mapreduce.Job:  map 27% reduce 0%
16/12/06 17:54:38 INFO mapreduce.Job:  map 29% reduce 0%
16/12/06 17:54:39 INFO mapreduce.Job:  map 32% reduce 0%
16/12/06 17:54:40 INFO mapreduce.Job:  map 34% reduce 0%
16/12/06 17:54:41 INFO mapreduce.Job:  map 36% reduce 0%
16/12/06 17:54:42 INFO mapreduce.Job:  map 39% reduce 1%
16/12/06 17:54:44 INFO mapreduce.Job:  map 40% reduce 1%
16/12/06 17:54:47 INFO mapreduce.Job:  map 41% reduce 1%
16/12/06 17:54:53 INFO mapreduce.Job:  map 41% reduce 2%
16/12/06 17:54:59 INFO mapreduce.Job:  map 42% reduce 3%
16/12/06 17:55:00 INFO mapreduce.Job:  map 43% reduce 5%
16/12/06 17:55:01 INFO mapreduce.Job:  map 47% reduce 5%
16/12/06 17:55:02 INFO mapreduce.Job:  map 49% reduce 6%
16/12/06 17:55:03 INFO mapreduce.Job:  map 50% reduce 9%
16/12/06 17:55:05 INFO mapreduce.Job:  map 51% reduce 9%
16/12/06 17:55:06 INFO mapreduce.Job:  map 52% reduce 9%
16/12/06 17:55:07 INFO mapreduce.Job:  map 53% reduce 10%
16/12/06 17:55:08 INFO mapreduce.Job:  map 54% reduce 12%
16/12/06 17:55:09 INFO mapreduce.Job:  map 56% reduce 13%
16/12/06 17:55:10 INFO mapreduce.Job:  map 59% reduce 14%
16/12/06 17:55:11 INFO mapreduce.Job:  map 62% reduce 18%
16/12/06 17:55:12 INFO mapreduce.Job:  map 67% reduce 18%
16/12/06 17:55:13 INFO mapreduce.Job:  map 75% reduce 20%
16/12/06 17:55:14 INFO mapreduce.Job:  map 79% reduce 22%
16/12/06 17:55:15 INFO mapreduce.Job:  map 79% reduce 23%
16/12/06 17:55:16 INFO mapreduce.Job:  map 79% reduce 25%
16/12/06 17:55:17 INFO mapreduce.Job:  map 79% reduce 26%
16/12/06 17:55:20 INFO mapreduce.Job:  map 81% reduce 26%
16/12/06 17:55:21 INFO mapreduce.Job:  map 84% reduce 26%
16/12/06 17:55:22 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 17:55:23 INFO mapreduce.Job:  map 86% reduce 28%
16/12/06 17:55:24 INFO mapreduce.Job:  map 87% reduce 28%
16/12/06 17:55:25 INFO mapreduce.Job:  map 89% reduce 28%
16/12/06 17:55:26 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 17:55:27 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 17:55:28 INFO mapreduce.Job:  map 99% reduce 30%
16/12/06 17:55:29 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 17:55:30 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 17:55:31 INFO mapreduce.Job:  map 100% reduce 40%
16/12/06 17:55:32 INFO mapreduce.Job:  map 100% reduce 54%
16/12/06 17:55:33 INFO mapreduce.Job:  map 100% reduce 67%
16/12/06 17:55:34 INFO mapreduce.Job:  map 100% reduce 71%
16/12/06 17:55:35 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 17:55:36 INFO mapreduce.Job:  map 100% reduce 84%
16/12/06 17:55:37 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 17:55:38 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 17:55:39 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 17:55:40 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 17:55:41 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 17:55:44 INFO mapreduce.Job: Job job_1480588584072_4755 completed successfully
16/12/06 17:55:44 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=694038807
		FILE: Number of bytes written=1420459579
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=589499369
		WASB: Number of bytes written=373099417
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=10879964
		Total time spent by all reduces in occupied slots (ms)=2459892
		Total time spent by all map tasks (ms)=5439982
		Total time spent by all reduce tasks (ms)=1229946
		Total vcore-seconds taken by all map tasks=5439982
		Total vcore-seconds taken by all reduce tasks=1229946
		Total megabyte-seconds taken by all map tasks=5570541568
		Total megabyte-seconds taken by all reduce tasks=1259464704
	Map-Reduce Framework
		Map input records=1882379
		Map output records=1687221
		Map output bytes=687531010
		Map output materialized bytes=694062327
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1481805
		Reduce shuffle bytes=694062327
		Reduce input records=1687221
		Reduce output records=1100757
		Spilled Records=3374442
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=69611
		CPU time spent (ms)=887520
		Physical memory (bytes) snapshot=323917692928
		Virtual memory (bytes) snapshot=742504529920
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=586803365
	File Output Format Counters 
		Bytes Written=373099417
16/12/06 17:55:44 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0800
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030500 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0900 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030500
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0900': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1896105060103539059.jar tmpDir=null
16/12/06 17:56:21 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:56:21 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:56:22 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 17:56:24 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 17:56:24 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 17:56:25 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4759
16/12/06 17:56:25 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4759
16/12/06 17:56:25 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4759/
16/12/06 17:56:25 INFO mapreduce.Job: Running job: job_1480588584072_4759
16/12/06 17:56:38 INFO mapreduce.Job: Job job_1480588584072_4759 running in uber mode : false
16/12/06 17:56:38 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 17:56:55 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 17:56:56 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 17:56:57 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 17:56:58 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 17:56:59 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 17:57:19 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 17:57:23 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 17:57:24 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 17:57:26 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 17:57:27 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 17:57:28 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 17:57:29 INFO mapreduce.Job:  map 21% reduce 1%
16/12/06 17:57:30 INFO mapreduce.Job:  map 24% reduce 1%
16/12/06 17:57:32 INFO mapreduce.Job:  map 31% reduce 1%
16/12/06 17:57:33 INFO mapreduce.Job:  map 33% reduce 1%
16/12/06 17:57:35 INFO mapreduce.Job:  map 37% reduce 1%
16/12/06 17:57:36 INFO mapreduce.Job:  map 42% reduce 1%
16/12/06 17:57:37 INFO mapreduce.Job:  map 43% reduce 1%
16/12/06 17:57:39 INFO mapreduce.Job:  map 44% reduce 1%
16/12/06 17:57:40 INFO mapreduce.Job:  map 44% reduce 2%
16/12/06 17:57:41 INFO mapreduce.Job:  map 45% reduce 2%
16/12/06 17:57:42 INFO mapreduce.Job:  map 46% reduce 2%
16/12/06 17:57:43 INFO mapreduce.Job:  map 47% reduce 3%
16/12/06 17:57:44 INFO mapreduce.Job:  map 50% reduce 5%
16/12/06 17:57:45 INFO mapreduce.Job:  map 51% reduce 6%
16/12/06 17:57:46 INFO mapreduce.Job:  map 53% reduce 7%
16/12/06 17:57:47 INFO mapreduce.Job:  map 54% reduce 7%
16/12/06 17:57:49 INFO mapreduce.Job:  map 55% reduce 7%
16/12/06 17:57:50 INFO mapreduce.Job:  map 56% reduce 8%
16/12/06 17:57:52 INFO mapreduce.Job:  map 59% reduce 9%
16/12/06 17:57:53 INFO mapreduce.Job:  map 59% reduce 11%
16/12/06 17:57:55 INFO mapreduce.Job:  map 59% reduce 13%
16/12/06 17:57:56 INFO mapreduce.Job:  map 60% reduce 14%
16/12/06 17:57:57 INFO mapreduce.Job:  map 61% reduce 14%
16/12/06 17:57:58 INFO mapreduce.Job:  map 63% reduce 15%
16/12/06 17:57:59 INFO mapreduce.Job:  map 64% reduce 15%
16/12/06 17:58:00 INFO mapreduce.Job:  map 65% reduce 16%
16/12/06 17:58:01 INFO mapreduce.Job:  map 66% reduce 16%
16/12/06 17:58:02 INFO mapreduce.Job:  map 69% reduce 16%
16/12/06 17:58:03 INFO mapreduce.Job:  map 71% reduce 16%
16/12/06 17:58:04 INFO mapreduce.Job:  map 73% reduce 21%
16/12/06 17:58:05 INFO mapreduce.Job:  map 74% reduce 22%
16/12/06 17:58:06 INFO mapreduce.Job:  map 76% reduce 23%
16/12/06 17:58:07 INFO mapreduce.Job:  map 78% reduce 23%
16/12/06 17:58:08 INFO mapreduce.Job:  map 79% reduce 25%
16/12/06 17:58:09 INFO mapreduce.Job:  map 81% reduce 25%
16/12/06 17:58:10 INFO mapreduce.Job:  map 84% reduce 26%
16/12/06 17:58:11 INFO mapreduce.Job:  map 88% reduce 26%
16/12/06 17:58:12 INFO mapreduce.Job:  map 91% reduce 27%
16/12/06 17:58:13 INFO mapreduce.Job:  map 91% reduce 29%
16/12/06 17:58:15 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 17:58:16 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 17:58:17 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 17:58:18 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 17:58:19 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 17:58:20 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 17:58:21 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 17:58:22 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 17:58:23 INFO mapreduce.Job:  map 100% reduce 37%
16/12/06 17:58:24 INFO mapreduce.Job:  map 100% reduce 52%
16/12/06 17:58:25 INFO mapreduce.Job:  map 100% reduce 63%
16/12/06 17:58:26 INFO mapreduce.Job:  map 100% reduce 73%
16/12/06 17:58:27 INFO mapreduce.Job:  map 100% reduce 82%
16/12/06 17:58:28 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 17:58:29 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 17:58:30 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 17:58:31 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 17:58:32 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 17:58:35 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 17:58:41 INFO mapreduce.Job: Job job_1480588584072_4759 completed successfully
16/12/06 17:58:41 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=672029996
		FILE: Number of bytes written=1376441957
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=579888363
		WASB: Number of bytes written=338730785
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=10974536
		Total time spent by all reduces in occupied slots (ms)=2529312
		Total time spent by all map tasks (ms)=5487268
		Total time spent by all reduce tasks (ms)=1264656
		Total vcore-seconds taken by all map tasks=5487268
		Total vcore-seconds taken by all reduce tasks=1264656
		Total megabyte-seconds taken by all map tasks=5618962432
		Total megabyte-seconds taken by all reduce tasks=1295007744
	Map-Reduce Framework
		Map input records=1868607
		Map output records=1637979
		Map output bytes=665702539
		Map output materialized bytes=672053516
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1426966
		Reduce shuffle bytes=672053516
		Reduce input records=1637979
		Reduce output records=999073
		Spilled Records=3275958
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=67486
		CPU time spent (ms)=888540
		Physical memory (bytes) snapshot=323804954624
		Virtual memory (bytes) snapshot=742689017856
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=577192359
	File Output Format Counters 
		Bytes Written=338730785
16/12/06 17:58:41 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/0900
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030600 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030600
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4206069021027059577.jar tmpDir=null
16/12/06 17:59:19 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:59:20 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 17:59:20 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 17:59:22 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 17:59:22 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 17:59:23 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4763
16/12/06 17:59:23 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4763
16/12/06 17:59:23 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4763/
16/12/06 17:59:23 INFO mapreduce.Job: Running job: job_1480588584072_4763
16/12/06 17:59:37 INFO mapreduce.Job: Job job_1480588584072_4763 running in uber mode : false
16/12/06 17:59:37 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 17:59:52 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 18:00:01 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 18:00:05 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 18:00:09 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 18:00:10 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 18:00:13 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 18:00:15 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 18:00:18 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 18:00:20 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 18:00:21 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 18:00:22 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 18:00:23 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 18:00:24 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 18:00:25 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 18:00:26 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 18:00:27 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 18:00:28 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 18:00:29 INFO mapreduce.Job:  map 31% reduce 0%
16/12/06 18:00:30 INFO mapreduce.Job:  map 34% reduce 1%
16/12/06 18:00:31 INFO mapreduce.Job:  map 36% reduce 1%
16/12/06 18:00:32 INFO mapreduce.Job:  map 39% reduce 1%
16/12/06 18:00:33 INFO mapreduce.Job:  map 43% reduce 2%
16/12/06 18:00:35 INFO mapreduce.Job:  map 44% reduce 2%
16/12/06 18:00:36 INFO mapreduce.Job:  map 44% reduce 5%
16/12/06 18:00:37 INFO mapreduce.Job:  map 44% reduce 7%
16/12/06 18:00:38 INFO mapreduce.Job:  map 45% reduce 7%
16/12/06 18:00:40 INFO mapreduce.Job:  map 48% reduce 7%
16/12/06 18:00:41 INFO mapreduce.Job:  map 50% reduce 7%
16/12/06 18:00:42 INFO mapreduce.Job:  map 51% reduce 8%
16/12/06 18:00:43 INFO mapreduce.Job:  map 52% reduce 9%
16/12/06 18:00:44 INFO mapreduce.Job:  map 52% reduce 10%
16/12/06 18:00:45 INFO mapreduce.Job:  map 53% reduce 11%
16/12/06 18:00:46 INFO mapreduce.Job:  map 54% reduce 11%
16/12/06 18:00:47 INFO mapreduce.Job:  map 56% reduce 12%
16/12/06 18:00:48 INFO mapreduce.Job:  map 57% reduce 12%
16/12/06 18:00:49 INFO mapreduce.Job:  map 60% reduce 13%
16/12/06 18:00:50 INFO mapreduce.Job:  map 61% reduce 13%
16/12/06 18:00:51 INFO mapreduce.Job:  map 61% reduce 16%
16/12/06 18:00:52 INFO mapreduce.Job:  map 63% reduce 17%
16/12/06 18:00:53 INFO mapreduce.Job:  map 64% reduce 17%
16/12/06 18:00:54 INFO mapreduce.Job:  map 65% reduce 18%
16/12/06 18:00:55 INFO mapreduce.Job:  map 66% reduce 18%
16/12/06 18:00:56 INFO mapreduce.Job:  map 67% reduce 18%
16/12/06 18:00:57 INFO mapreduce.Job:  map 68% reduce 20%
16/12/06 18:00:59 INFO mapreduce.Job:  map 69% reduce 20%
16/12/06 18:01:00 INFO mapreduce.Job:  map 70% reduce 23%
16/12/06 18:01:01 INFO mapreduce.Job:  map 71% reduce 23%
16/12/06 18:01:02 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 18:01:03 INFO mapreduce.Job:  map 75% reduce 23%
16/12/06 18:01:04 INFO mapreduce.Job:  map 77% reduce 24%
16/12/06 18:01:05 INFO mapreduce.Job:  map 79% reduce 24%
16/12/06 18:01:06 INFO mapreduce.Job:  map 81% reduce 26%
16/12/06 18:01:07 INFO mapreduce.Job:  map 84% reduce 26%
16/12/06 18:01:08 INFO mapreduce.Job:  map 86% reduce 26%
16/12/06 18:01:09 INFO mapreduce.Job:  map 87% reduce 28%
16/12/06 18:01:10 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 18:01:11 INFO mapreduce.Job:  map 90% reduce 28%
16/12/06 18:01:12 INFO mapreduce.Job:  map 91% reduce 29%
16/12/06 18:01:13 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 18:01:14 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 18:01:15 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 18:01:16 INFO mapreduce.Job:  map 93% reduce 31%
16/12/06 18:01:17 INFO mapreduce.Job:  map 94% reduce 31%
16/12/06 18:01:18 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 18:01:19 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 18:01:20 INFO mapreduce.Job:  map 98% reduce 31%
16/12/06 18:01:21 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 18:01:22 INFO mapreduce.Job:  map 99% reduce 33%
16/12/06 18:01:23 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 18:01:24 INFO mapreduce.Job:  map 100% reduce 38%
16/12/06 18:01:25 INFO mapreduce.Job:  map 100% reduce 45%
16/12/06 18:01:26 INFO mapreduce.Job:  map 100% reduce 48%
16/12/06 18:01:27 INFO mapreduce.Job:  map 100% reduce 60%
16/12/06 18:01:28 INFO mapreduce.Job:  map 100% reduce 70%
16/12/06 18:01:29 INFO mapreduce.Job:  map 100% reduce 73%
16/12/06 18:01:30 INFO mapreduce.Job:  map 100% reduce 79%
16/12/06 18:01:31 INFO mapreduce.Job:  map 100% reduce 84%
16/12/06 18:01:32 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 18:01:33 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 18:01:34 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 18:01:35 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 18:01:36 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 18:01:38 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 18:01:39 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 18:01:40 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 18:01:41 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 18:01:42 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 18:01:43 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 18:01:47 INFO mapreduce.Job: Job job_1480588584072_4763 completed successfully
16/12/06 18:01:47 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=748283588
		FILE: Number of bytes written=1528949141
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=641958159
		WASB: Number of bytes written=388241506
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=10682010
		Total time spent by all reduces in occupied slots (ms)=2925638
		Total time spent by all map tasks (ms)=5341005
		Total time spent by all reduce tasks (ms)=1462819
		Total vcore-seconds taken by all map tasks=5341005
		Total vcore-seconds taken by all reduce tasks=1462819
		Total megabyte-seconds taken by all map tasks=5469189120
		Total megabyte-seconds taken by all reduce tasks=1497926656
	Map-Reduce Framework
		Map input records=2060284
		Map output records=1820394
		Map output bytes=741252481
		Map output materialized bytes=748307108
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1589673
		Reduce shuffle bytes=748307108
		Reduce input records=1820394
		Reduce output records=1144408
		Spilled Records=3640788
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=75876
		CPU time spent (ms)=935610
		Physical memory (bytes) snapshot=324039716864
		Virtual memory (bytes) snapshot=742648590336
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=639262155
	File Output Format Counters 
		Bytes Written=388241506
16/12/06 18:01:47 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030700 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030700
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7474358343076960419.jar tmpDir=null
16/12/06 18:02:26 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:02:27 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:02:27 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 18:02:29 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 18:02:29 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 18:02:30 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4770
16/12/06 18:02:30 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4770
16/12/06 18:02:31 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4770/
16/12/06 18:02:31 INFO mapreduce.Job: Running job: job_1480588584072_4770
16/12/06 18:05:27 INFO mapreduce.Job: Job job_1480588584072_4770 running in uber mode : false
16/12/06 18:05:27 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 18:05:43 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 18:05:44 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 18:05:49 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 18:05:50 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 18:06:00 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 18:06:01 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 18:06:02 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 18:06:10 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 18:06:11 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 18:06:12 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 18:06:13 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 18:06:14 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 18:06:15 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 18:06:16 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 18:06:17 INFO mapreduce.Job:  map 30% reduce 0%
16/12/06 18:06:18 INFO mapreduce.Job:  map 32% reduce 0%
16/12/06 18:06:19 INFO mapreduce.Job:  map 33% reduce 0%
16/12/06 18:06:20 INFO mapreduce.Job:  map 34% reduce 0%
16/12/06 18:06:21 INFO mapreduce.Job:  map 35% reduce 0%
16/12/06 18:06:22 INFO mapreduce.Job:  map 37% reduce 1%
16/12/06 18:06:23 INFO mapreduce.Job:  map 38% reduce 1%
16/12/06 18:06:24 INFO mapreduce.Job:  map 39% reduce 1%
16/12/06 18:06:35 INFO mapreduce.Job:  map 39% reduce 3%
16/12/06 18:06:37 INFO mapreduce.Job:  map 40% reduce 3%
16/12/06 18:06:38 INFO mapreduce.Job:  map 40% reduce 4%
16/12/06 18:06:40 INFO mapreduce.Job:  map 41% reduce 6%
16/12/06 18:06:41 INFO mapreduce.Job:  map 43% reduce 7%
16/12/06 18:06:42 INFO mapreduce.Job:  map 46% reduce 7%
16/12/06 18:06:43 INFO mapreduce.Job:  map 48% reduce 8%
16/12/06 18:06:44 INFO mapreduce.Job:  map 49% reduce 10%
16/12/06 18:06:45 INFO mapreduce.Job:  map 50% reduce 11%
16/12/06 18:06:47 INFO mapreduce.Job:  map 51% reduce 12%
16/12/06 18:06:48 INFO mapreduce.Job:  map 51% reduce 13%
16/12/06 18:06:55 INFO mapreduce.Job:  map 52% reduce 13%
16/12/06 18:06:56 INFO mapreduce.Job:  map 52% reduce 14%
16/12/06 18:06:57 INFO mapreduce.Job:  map 53% reduce 14%
16/12/06 18:06:58 INFO mapreduce.Job:  map 54% reduce 14%
16/12/06 18:06:59 INFO mapreduce.Job:  map 55% reduce 14%
16/12/06 18:07:00 INFO mapreduce.Job:  map 56% reduce 14%
16/12/06 18:07:01 INFO mapreduce.Job:  map 56% reduce 15%
16/12/06 18:07:02 INFO mapreduce.Job:  map 57% reduce 15%
16/12/06 18:07:03 INFO mapreduce.Job:  map 59% reduce 15%
16/12/06 18:07:06 INFO mapreduce.Job:  map 61% reduce 17%
16/12/06 18:07:07 INFO mapreduce.Job:  map 61% reduce 18%
16/12/06 18:07:09 INFO mapreduce.Job:  map 62% reduce 18%
16/12/06 18:07:10 INFO mapreduce.Job:  map 63% reduce 18%
16/12/06 18:07:11 INFO mapreduce.Job:  map 63% reduce 19%
16/12/06 18:07:13 INFO mapreduce.Job:  map 63% reduce 20%
16/12/06 18:07:14 INFO mapreduce.Job:  map 64% reduce 20%
16/12/06 18:07:15 INFO mapreduce.Job:  map 70% reduce 20%
16/12/06 18:07:16 INFO mapreduce.Job:  map 72% reduce 21%
16/12/06 18:07:18 INFO mapreduce.Job:  map 72% reduce 22%
16/12/06 18:07:19 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 18:07:20 INFO mapreduce.Job:  map 74% reduce 23%
16/12/06 18:07:22 INFO mapreduce.Job:  map 76% reduce 23%
16/12/06 18:07:23 INFO mapreduce.Job:  map 76% reduce 24%
16/12/06 18:07:24 INFO mapreduce.Job:  map 78% reduce 25%
16/12/06 18:07:26 INFO mapreduce.Job:  map 79% reduce 26%
16/12/06 18:07:28 INFO mapreduce.Job:  map 80% reduce 26%
16/12/06 18:07:29 INFO mapreduce.Job:  map 82% reduce 26%
16/12/06 18:07:30 INFO mapreduce.Job:  map 86% reduce 26%
16/12/06 18:07:31 INFO mapreduce.Job:  map 91% reduce 27%
16/12/06 18:07:32 INFO mapreduce.Job:  map 93% reduce 28%
16/12/06 18:07:33 INFO mapreduce.Job:  map 94% reduce 29%
16/12/06 18:07:34 INFO mapreduce.Job:  map 94% reduce 31%
16/12/06 18:07:37 INFO mapreduce.Job:  map 96% reduce 32%
16/12/06 18:07:38 INFO mapreduce.Job:  map 97% reduce 32%
16/12/06 18:07:39 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 18:07:40 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 18:07:41 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 18:07:43 INFO mapreduce.Job:  map 100% reduce 39%
16/12/06 18:07:44 INFO mapreduce.Job:  map 100% reduce 51%
16/12/06 18:07:45 INFO mapreduce.Job:  map 100% reduce 57%
16/12/06 18:07:46 INFO mapreduce.Job:  map 100% reduce 61%
16/12/06 18:07:47 INFO mapreduce.Job:  map 100% reduce 68%
16/12/06 18:07:48 INFO mapreduce.Job:  map 100% reduce 71%
16/12/06 18:07:49 INFO mapreduce.Job:  map 100% reduce 74%
16/12/06 18:07:50 INFO mapreduce.Job:  map 100% reduce 79%
16/12/06 18:07:51 INFO mapreduce.Job:  map 100% reduce 82%
16/12/06 18:07:52 INFO mapreduce.Job:  map 100% reduce 83%
16/12/06 18:07:53 INFO mapreduce.Job:  map 100% reduce 85%
16/12/06 18:07:54 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 18:07:55 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 18:07:56 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 18:07:57 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 18:07:58 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 18:07:59 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 18:08:02 INFO mapreduce.Job: Job job_1480588584072_4770 completed successfully
16/12/06 18:08:02 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=726309551
		FILE: Number of bytes written=1485001067
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=625420503
		WASB: Number of bytes written=363848520
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=10516548
		Total time spent by all reduces in occupied slots (ms)=3581894
		Total time spent by all map tasks (ms)=5258274
		Total time spent by all reduce tasks (ms)=1790947
		Total vcore-seconds taken by all map tasks=5258274
		Total vcore-seconds taken by all reduce tasks=1790947
		Total megabyte-seconds taken by all map tasks=5384472576
		Total megabyte-seconds taken by all reduce tasks=1833929728
	Map-Reduce Framework
		Map input records=2020453
		Map output records=1774688
		Map output bytes=719459274
		Map output materialized bytes=726333071
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1542188
		Reduce shuffle bytes=726333071
		Reduce input records=1774688
		Reduce output records=1077694
		Spilled Records=3549376
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=68206
		CPU time spent (ms)=940680
		Physical memory (bytes) snapshot=324113735680
		Virtual memory (bytes) snapshot=742644699136
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=622724499
	File Output Format Counters 
		Bytes Written=363848520
16/12/06 18:08:02 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030800 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030800
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob6196021085464109384.jar tmpDir=null
16/12/06 18:08:42 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:08:43 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:08:43 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 18:08:45 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 18:08:45 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 18:08:46 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4776
16/12/06 18:08:46 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4776
16/12/06 18:08:47 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4776/
16/12/06 18:08:47 INFO mapreduce.Job: Running job: job_1480588584072_4776
16/12/06 18:09:08 INFO mapreduce.Job: Job job_1480588584072_4776 running in uber mode : false
16/12/06 18:09:08 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 18:09:24 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 18:11:58 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 18:12:12 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 18:12:16 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 18:12:17 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 18:12:18 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 18:12:19 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 18:12:20 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 18:12:21 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 18:12:22 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 18:12:24 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 18:12:25 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 18:12:26 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 18:12:27 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 18:12:29 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 18:12:30 INFO mapreduce.Job:  map 29% reduce 0%
16/12/06 18:12:31 INFO mapreduce.Job:  map 32% reduce 0%
16/12/06 18:12:32 INFO mapreduce.Job:  map 34% reduce 1%
16/12/06 18:12:33 INFO mapreduce.Job:  map 35% reduce 1%
16/12/06 18:12:36 INFO mapreduce.Job:  map 36% reduce 2%
16/12/06 18:12:39 INFO mapreduce.Job:  map 40% reduce 2%
16/12/06 18:12:40 INFO mapreduce.Job:  map 41% reduce 2%
16/12/06 18:12:41 INFO mapreduce.Job:  map 44% reduce 5%
16/12/06 18:12:42 INFO mapreduce.Job:  map 46% reduce 7%
16/12/06 18:12:44 INFO mapreduce.Job:  map 47% reduce 8%
16/12/06 18:12:45 INFO mapreduce.Job:  map 48% reduce 9%
16/12/06 18:12:46 INFO mapreduce.Job:  map 49% reduce 11%
16/12/06 18:12:47 INFO mapreduce.Job:  map 50% reduce 11%
16/12/06 18:12:48 INFO mapreduce.Job:  map 51% reduce 12%
16/12/06 18:12:49 INFO mapreduce.Job:  map 54% reduce 12%
16/12/06 18:12:50 INFO mapreduce.Job:  map 55% reduce 14%
16/12/06 18:12:51 INFO mapreduce.Job:  map 56% reduce 16%
16/12/06 18:12:52 INFO mapreduce.Job:  map 57% reduce 16%
16/12/06 18:12:53 INFO mapreduce.Job:  map 57% reduce 17%
16/12/06 18:12:54 INFO mapreduce.Job:  map 58% reduce 18%
16/12/06 18:12:56 INFO mapreduce.Job:  map 59% reduce 19%
16/12/06 18:12:57 INFO mapreduce.Job:  map 61% reduce 19%
16/12/06 18:12:58 INFO mapreduce.Job:  map 63% reduce 20%
16/12/06 18:12:59 INFO mapreduce.Job:  map 64% reduce 20%
16/12/06 18:13:00 INFO mapreduce.Job:  map 65% reduce 21%
16/12/06 18:13:01 INFO mapreduce.Job:  map 66% reduce 21%
16/12/06 18:13:02 INFO mapreduce.Job:  map 69% reduce 21%
16/12/06 18:13:03 INFO mapreduce.Job:  map 69% reduce 22%
16/12/06 18:13:04 INFO mapreduce.Job:  map 73% reduce 22%
16/12/06 18:13:05 INFO mapreduce.Job:  map 75% reduce 23%
16/12/06 18:13:06 INFO mapreduce.Job:  map 76% reduce 24%
16/12/06 18:13:07 INFO mapreduce.Job:  map 79% reduce 25%
16/12/06 18:13:09 INFO mapreduce.Job:  map 80% reduce 26%
16/12/06 18:13:10 INFO mapreduce.Job:  map 81% reduce 26%
16/12/06 18:13:11 INFO mapreduce.Job:  map 83% reduce 27%
16/12/06 18:13:13 INFO mapreduce.Job:  map 84% reduce 27%
16/12/06 18:13:14 INFO mapreduce.Job:  map 86% reduce 28%
16/12/06 18:13:16 INFO mapreduce.Job:  map 89% reduce 28%
16/12/06 18:13:17 INFO mapreduce.Job:  map 92% reduce 29%
16/12/06 18:13:18 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 18:13:19 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 18:13:20 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 18:13:21 INFO mapreduce.Job:  map 97% reduce 32%
16/12/06 18:13:22 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 18:13:23 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 18:13:24 INFO mapreduce.Job:  map 99% reduce 33%
16/12/06 18:13:27 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 18:13:28 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 18:13:29 INFO mapreduce.Job:  map 100% reduce 44%
16/12/06 18:13:30 INFO mapreduce.Job:  map 100% reduce 53%
16/12/06 18:13:31 INFO mapreduce.Job:  map 100% reduce 64%
16/12/06 18:13:32 INFO mapreduce.Job:  map 100% reduce 73%
16/12/06 18:13:33 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 18:13:34 INFO mapreduce.Job:  map 100% reduce 81%
16/12/06 18:13:35 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 18:13:36 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 18:13:37 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 18:13:38 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 18:13:40 INFO mapreduce.Job: Job job_1480588584072_4776 completed successfully
16/12/06 18:13:40 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=807260654
		FILE: Number of bytes written=1646903273
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=692260694
		WASB: Number of bytes written=417487154
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=6578326
		Total time spent by all reduces in occupied slots (ms)=2759114
		Total time spent by all map tasks (ms)=3289163
		Total time spent by all reduce tasks (ms)=1379557
		Total vcore-seconds taken by all map tasks=3289163
		Total vcore-seconds taken by all reduce tasks=1379557
		Total megabyte-seconds taken by all map tasks=3368102912
		Total megabyte-seconds taken by all reduce tasks=1412666368
	Map-Reduce Framework
		Map input records=2224530
		Map output records=1966574
		Map output bytes=799673939
		Map output materialized bytes=807284174
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1713364
		Reduce shuffle bytes=807284174
		Reduce input records=1966574
		Reduce output records=1234681
		Spilled Records=3933148
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=44766
		CPU time spent (ms)=912570
		Physical memory (bytes) snapshot=324496740352
		Virtual memory (bytes) snapshot=742860722176
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=689564690
	File Output Format Counters 
		Bytes Written=417487154
16/12/06 18:13:40 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030900 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030900
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob6282217923379338778.jar tmpDir=null
16/12/06 18:14:19 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:14:20 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:14:20 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 18:14:22 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 18:14:22 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 18:14:23 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4780
16/12/06 18:14:23 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4780
16/12/06 18:14:23 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4780/
16/12/06 18:14:23 INFO mapreduce.Job: Running job: job_1480588584072_4780
16/12/06 18:14:36 INFO mapreduce.Job: Job job_1480588584072_4780 running in uber mode : false
16/12/06 18:14:36 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 18:14:48 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 18:15:04 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 18:15:20 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 18:15:22 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 18:15:24 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 18:15:28 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 18:15:29 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 18:15:32 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 18:15:38 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 18:15:44 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 18:15:46 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 18:15:47 INFO mapreduce.Job:  map 16% reduce 1%
16/12/06 18:15:48 INFO mapreduce.Job:  map 21% reduce 1%
16/12/06 18:15:49 INFO mapreduce.Job:  map 22% reduce 1%
16/12/06 18:15:50 INFO mapreduce.Job:  map 24% reduce 1%
16/12/06 18:15:51 INFO mapreduce.Job:  map 25% reduce 1%
16/12/06 18:15:52 INFO mapreduce.Job:  map 28% reduce 1%
16/12/06 18:15:53 INFO mapreduce.Job:  map 29% reduce 2%
16/12/06 18:15:54 INFO mapreduce.Job:  map 31% reduce 2%
16/12/06 18:15:56 INFO mapreduce.Job:  map 32% reduce 2%
16/12/06 18:15:57 INFO mapreduce.Job:  map 33% reduce 2%
16/12/06 18:15:58 INFO mapreduce.Job:  map 34% reduce 2%
16/12/06 18:15:59 INFO mapreduce.Job:  map 35% reduce 2%
16/12/06 18:16:09 INFO mapreduce.Job:  map 36% reduce 3%
16/12/06 18:16:10 INFO mapreduce.Job:  map 37% reduce 4%
16/12/06 18:16:11 INFO mapreduce.Job:  map 38% reduce 4%
16/12/06 18:16:12 INFO mapreduce.Job:  map 39% reduce 4%
16/12/06 18:16:13 INFO mapreduce.Job:  map 40% reduce 4%
16/12/06 18:16:14 INFO mapreduce.Job:  map 41% reduce 6%
16/12/06 18:16:15 INFO mapreduce.Job:  map 41% reduce 7%
16/12/06 18:16:16 INFO mapreduce.Job:  map 44% reduce 7%
16/12/06 18:16:17 INFO mapreduce.Job:  map 45% reduce 8%
16/12/06 18:16:18 INFO mapreduce.Job:  map 46% reduce 9%
16/12/06 18:16:20 INFO mapreduce.Job:  map 47% reduce 10%
16/12/06 18:16:21 INFO mapreduce.Job:  map 48% reduce 10%
16/12/06 18:16:22 INFO mapreduce.Job:  map 48% reduce 11%
16/12/06 18:16:24 INFO mapreduce.Job:  map 49% reduce 11%
16/12/06 18:16:29 INFO mapreduce.Job:  map 50% reduce 11%
16/12/06 18:16:30 INFO mapreduce.Job:  map 51% reduce 11%
16/12/06 18:16:31 INFO mapreduce.Job:  map 53% reduce 12%
16/12/06 18:16:32 INFO mapreduce.Job:  map 55% reduce 12%
16/12/06 18:16:33 INFO mapreduce.Job:  map 55% reduce 13%
16/12/06 18:16:34 INFO mapreduce.Job:  map 56% reduce 13%
16/12/06 18:16:35 INFO mapreduce.Job:  map 57% reduce 14%
16/12/06 18:16:36 INFO mapreduce.Job:  map 57% reduce 15%
16/12/06 18:16:38 INFO mapreduce.Job:  map 58% reduce 15%
16/12/06 18:16:39 INFO mapreduce.Job:  map 59% reduce 15%
16/12/06 18:16:40 INFO mapreduce.Job:  map 61% reduce 18%
16/12/06 18:16:41 INFO mapreduce.Job:  map 64% reduce 19%
16/12/06 18:16:42 INFO mapreduce.Job:  map 68% reduce 20%
16/12/06 18:16:43 INFO mapreduce.Job:  map 71% reduce 20%
16/12/06 18:16:44 INFO mapreduce.Job:  map 73% reduce 22%
16/12/06 18:16:45 INFO mapreduce.Job:  map 75% reduce 23%
16/12/06 18:16:46 INFO mapreduce.Job:  map 78% reduce 23%
16/12/06 18:16:47 INFO mapreduce.Job:  map 82% reduce 25%
16/12/06 18:16:48 INFO mapreduce.Job:  map 86% reduce 26%
16/12/06 18:16:49 INFO mapreduce.Job:  map 88% reduce 26%
16/12/06 18:16:50 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 18:16:51 INFO mapreduce.Job:  map 88% reduce 29%
16/12/06 18:16:52 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 18:16:53 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 18:16:54 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 18:16:55 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 18:16:56 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 18:16:57 INFO mapreduce.Job:  map 97% reduce 32%
16/12/06 18:16:59 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 18:17:00 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 18:17:01 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 18:17:02 INFO mapreduce.Job:  map 100% reduce 49%
16/12/06 18:17:03 INFO mapreduce.Job:  map 100% reduce 61%
16/12/06 18:17:04 INFO mapreduce.Job:  map 100% reduce 62%
16/12/06 18:17:05 INFO mapreduce.Job:  map 100% reduce 74%
16/12/06 18:17:06 INFO mapreduce.Job:  map 100% reduce 78%
16/12/06 18:17:07 INFO mapreduce.Job:  map 100% reduce 81%
16/12/06 18:17:08 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 18:17:09 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 18:17:11 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 18:17:12 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 18:17:13 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 18:17:14 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 18:17:15 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 18:17:22 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 18:17:28 INFO mapreduce.Job: Job job_1480588584072_4780 completed successfully
16/12/06 18:17:28 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=854286272
		FILE: Number of bytes written=1740954509
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=729648405
		WASB: Number of bytes written=453265485
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=8928572
		Total time spent by all reduces in occupied slots (ms)=3010248
		Total time spent by all map tasks (ms)=4464286
		Total time spent by all reduce tasks (ms)=1505124
		Total vcore-seconds taken by all map tasks=4464286
		Total vcore-seconds taken by all reduce tasks=1505124
		Total megabyte-seconds taken by all map tasks=4571428864
		Total megabyte-seconds taken by all reduce tasks=1541246976
	Map-Reduce Framework
		Map input records=2326916
		Map output records=2071933
		Map output bytes=846276969
		Map output materialized bytes=854309792
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1804586
		Reduce shuffle bytes=854309792
		Reduce input records=2071933
		Reduce output records=1332807
		Spilled Records=4143866
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=66608
		CPU time spent (ms)=939030
		Physical memory (bytes) snapshot=324664909824
		Virtual memory (bytes) snapshot=742710312960
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=726952401
	File Output Format Counters 
		Bytes Written=453265485
16/12/06 18:17:28 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1400 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1400': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3242236789085841746.jar tmpDir=null
16/12/06 18:18:05 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:18:06 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:18:06 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 18:18:08 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 18:18:08 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 18:18:08 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4784
16/12/06 18:18:09 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4784
16/12/06 18:18:09 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4784/
16/12/06 18:18:09 INFO mapreduce.Job: Running job: job_1480588584072_4784
16/12/06 18:18:52 INFO mapreduce.Job: Job job_1480588584072_4784 running in uber mode : false
16/12/06 18:18:52 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 18:19:03 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 18:19:22 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 18:19:23 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 18:19:34 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 18:19:35 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 18:19:36 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 18:19:37 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 18:19:38 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 18:19:39 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 18:19:40 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 18:19:41 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 18:19:42 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 18:19:43 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 18:19:44 INFO mapreduce.Job:  map 30% reduce 0%
16/12/06 18:19:45 INFO mapreduce.Job:  map 32% reduce 0%
16/12/06 18:19:46 INFO mapreduce.Job:  map 34% reduce 0%
16/12/06 18:19:47 INFO mapreduce.Job:  map 36% reduce 0%
16/12/06 18:19:48 INFO mapreduce.Job:  map 38% reduce 0%
16/12/06 18:19:49 INFO mapreduce.Job:  map 39% reduce 0%
16/12/06 18:19:50 INFO mapreduce.Job:  map 41% reduce 0%
16/12/06 18:19:53 INFO mapreduce.Job:  map 42% reduce 0%
16/12/06 18:19:57 INFO mapreduce.Job:  map 43% reduce 0%
16/12/06 18:19:59 INFO mapreduce.Job:  map 43% reduce 1%
16/12/06 18:20:02 INFO mapreduce.Job:  map 43% reduce 3%
16/12/06 18:20:03 INFO mapreduce.Job:  map 43% reduce 4%
16/12/06 18:20:04 INFO mapreduce.Job:  map 44% reduce 4%
16/12/06 18:20:05 INFO mapreduce.Job:  map 44% reduce 6%
16/12/06 18:20:06 INFO mapreduce.Job:  map 46% reduce 6%
16/12/06 18:20:07 INFO mapreduce.Job:  map 48% reduce 8%
16/12/06 18:20:08 INFO mapreduce.Job:  map 50% reduce 10%
16/12/06 18:20:09 INFO mapreduce.Job:  map 51% reduce 12%
16/12/06 18:20:10 INFO mapreduce.Job:  map 52% reduce 12%
16/12/06 18:20:11 INFO mapreduce.Job:  map 54% reduce 13%
16/12/06 18:20:12 INFO mapreduce.Job:  map 55% reduce 16%
16/12/06 18:20:13 INFO mapreduce.Job:  map 56% reduce 17%
16/12/06 18:20:14 INFO mapreduce.Job:  map 58% reduce 17%
16/12/06 18:20:15 INFO mapreduce.Job:  map 59% reduce 17%
16/12/06 18:20:16 INFO mapreduce.Job:  map 60% reduce 19%
16/12/06 18:20:17 INFO mapreduce.Job:  map 62% reduce 19%
16/12/06 18:20:18 INFO mapreduce.Job:  map 66% reduce 20%
16/12/06 18:20:19 INFO mapreduce.Job:  map 69% reduce 20%
16/12/06 18:20:20 INFO mapreduce.Job:  map 74% reduce 21%
16/12/06 18:20:21 INFO mapreduce.Job:  map 76% reduce 23%
16/12/06 18:20:22 INFO mapreduce.Job:  map 77% reduce 24%
16/12/06 18:20:23 INFO mapreduce.Job:  map 81% reduce 25%
16/12/06 18:20:24 INFO mapreduce.Job:  map 82% reduce 26%
16/12/06 18:20:25 INFO mapreduce.Job:  map 84% reduce 27%
16/12/06 18:20:26 INFO mapreduce.Job:  map 87% reduce 27%
16/12/06 18:20:27 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 18:20:28 INFO mapreduce.Job:  map 89% reduce 29%
16/12/06 18:20:31 INFO mapreduce.Job:  map 89% reduce 30%
16/12/06 18:20:35 INFO mapreduce.Job:  map 90% reduce 30%
16/12/06 18:20:36 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 18:20:37 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 18:20:38 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 18:20:39 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 18:20:40 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 18:20:41 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 18:20:42 INFO mapreduce.Job:  map 100% reduce 36%
16/12/06 18:20:43 INFO mapreduce.Job:  map 100% reduce 50%
16/12/06 18:20:44 INFO mapreduce.Job:  map 100% reduce 54%
16/12/06 18:20:45 INFO mapreduce.Job:  map 100% reduce 63%
16/12/06 18:20:46 INFO mapreduce.Job:  map 100% reduce 67%
16/12/06 18:20:47 INFO mapreduce.Job:  map 100% reduce 72%
16/12/06 18:20:48 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 18:20:49 INFO mapreduce.Job:  map 100% reduce 79%
16/12/06 18:20:50 INFO mapreduce.Job:  map 100% reduce 83%
16/12/06 18:20:51 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 18:20:52 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 18:20:53 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 18:20:54 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 18:20:55 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 18:20:57 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 18:20:58 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 18:21:03 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 18:21:05 INFO mapreduce.Job: Job job_1480588584072_4784 completed successfully
16/12/06 18:21:05 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=808779482
		FILE: Number of bytes written=1649940929
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=695099429
		WASB: Number of bytes written=405589864
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12195546
		Total time spent by all reduces in occupied slots (ms)=2866196
		Total time spent by all map tasks (ms)=6097773
		Total time spent by all reduce tasks (ms)=1433098
		Total vcore-seconds taken by all map tasks=6097773
		Total vcore-seconds taken by all reduce tasks=1433098
		Total megabyte-seconds taken by all map tasks=6244119552
		Total megabyte-seconds taken by all reduce tasks=1467492352
	Map-Reduce Framework
		Map input records=2237045
		Map output records=1972539
		Map output bytes=801154826
		Map output materialized bytes=808803002
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1709873
		Reduce shuffle bytes=808803002
		Reduce input records=1972539
		Reduce output records=1200010
		Spilled Records=3945078
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=75666
		CPU time spent (ms)=936590
		Physical memory (bytes) snapshot=324333002752
		Virtual memory (bytes) snapshot=742616899584
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=692403425
	File Output Format Counters 
		Bytes Written=405589864
16/12/06 18:21:05 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1400
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1500 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1500': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob708138150764944859.jar tmpDir=null
16/12/06 18:21:43 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:21:44 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:21:45 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 18:21:46 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 18:21:46 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 18:21:47 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4788
16/12/06 18:21:48 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4788
16/12/06 18:21:48 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4788/
16/12/06 18:21:48 INFO mapreduce.Job: Running job: job_1480588584072_4788
16/12/06 18:22:01 INFO mapreduce.Job: Job job_1480588584072_4788 running in uber mode : false
16/12/06 18:22:01 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 18:22:13 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 18:22:23 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 18:22:31 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 18:22:33 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 18:22:34 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 18:22:35 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 18:22:36 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 18:22:40 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 18:22:41 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 18:22:42 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 18:22:43 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 18:22:44 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 18:22:45 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 18:22:46 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 18:22:48 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 18:22:49 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 18:22:50 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 18:22:51 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 18:22:52 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 18:22:54 INFO mapreduce.Job:  map 27% reduce 0%
16/12/06 18:22:55 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 18:22:56 INFO mapreduce.Job:  map 29% reduce 0%
16/12/06 18:22:57 INFO mapreduce.Job:  map 30% reduce 0%
16/12/06 18:22:58 INFO mapreduce.Job:  map 31% reduce 1%
16/12/06 18:23:06 INFO mapreduce.Job:  map 32% reduce 1%
16/12/06 18:23:09 INFO mapreduce.Job:  map 33% reduce 1%
16/12/06 18:23:10 INFO mapreduce.Job:  map 34% reduce 2%
16/12/06 18:23:11 INFO mapreduce.Job:  map 36% reduce 2%
16/12/06 18:23:13 INFO mapreduce.Job:  map 38% reduce 3%
16/12/06 18:23:14 INFO mapreduce.Job:  map 40% reduce 3%
16/12/06 18:23:15 INFO mapreduce.Job:  map 40% reduce 4%
16/12/06 18:23:16 INFO mapreduce.Job:  map 42% reduce 4%
16/12/06 18:23:17 INFO mapreduce.Job:  map 47% reduce 4%
16/12/06 18:23:20 INFO mapreduce.Job:  map 48% reduce 5%
16/12/06 18:23:21 INFO mapreduce.Job:  map 49% reduce 6%
16/12/06 18:23:23 INFO mapreduce.Job:  map 53% reduce 8%
16/12/06 18:23:26 INFO mapreduce.Job:  map 55% reduce 12%
16/12/06 18:23:27 INFO mapreduce.Job:  map 59% reduce 13%
16/12/06 18:23:28 INFO mapreduce.Job:  map 62% reduce 13%
16/12/06 18:23:29 INFO mapreduce.Job:  map 65% reduce 14%
16/12/06 18:23:30 INFO mapreduce.Job:  map 66% reduce 14%
16/12/06 18:23:32 INFO mapreduce.Job:  map 68% reduce 14%
16/12/06 18:23:33 INFO mapreduce.Job:  map 69% reduce 16%
16/12/06 18:23:34 INFO mapreduce.Job:  map 70% reduce 16%
16/12/06 18:23:35 INFO mapreduce.Job:  map 70% reduce 19%
16/12/06 18:23:36 INFO mapreduce.Job:  map 72% reduce 21%
16/12/06 18:23:37 INFO mapreduce.Job:  map 75% reduce 21%
16/12/06 18:23:38 INFO mapreduce.Job:  map 76% reduce 21%
16/12/06 18:23:39 INFO mapreduce.Job:  map 77% reduce 25%
16/12/06 18:23:40 INFO mapreduce.Job:  map 78% reduce 25%
16/12/06 18:23:41 INFO mapreduce.Job:  map 80% reduce 25%
16/12/06 18:23:42 INFO mapreduce.Job:  map 81% reduce 26%
16/12/06 18:23:43 INFO mapreduce.Job:  map 82% reduce 26%
16/12/06 18:23:44 INFO mapreduce.Job:  map 85% reduce 26%
16/12/06 18:23:45 INFO mapreduce.Job:  map 86% reduce 27%
16/12/06 18:23:46 INFO mapreduce.Job:  map 90% reduce 28%
16/12/06 18:23:47 INFO mapreduce.Job:  map 91% reduce 28%
16/12/06 18:23:48 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 18:23:49 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 18:23:50 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 18:23:51 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 18:23:52 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 18:23:53 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 18:23:54 INFO mapreduce.Job:  map 100% reduce 45%
16/12/06 18:23:55 INFO mapreduce.Job:  map 100% reduce 58%
16/12/06 18:23:56 INFO mapreduce.Job:  map 100% reduce 65%
16/12/06 18:23:57 INFO mapreduce.Job:  map 100% reduce 70%
16/12/06 18:23:58 INFO mapreduce.Job:  map 100% reduce 77%
16/12/06 18:23:59 INFO mapreduce.Job:  map 100% reduce 81%
16/12/06 18:24:00 INFO mapreduce.Job:  map 100% reduce 84%
16/12/06 18:24:01 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 18:24:03 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 18:24:04 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 18:24:10 INFO mapreduce.Job: Job job_1480588584072_4788 completed successfully
16/12/06 18:24:11 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=901764042
		FILE: Number of bytes written=1835910049
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=766916588
		WASB: Number of bytes written=481340508
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=8784332
		Total time spent by all reduces in occupied slots (ms)=2419460
		Total time spent by all map tasks (ms)=4392166
		Total time spent by all reduce tasks (ms)=1209730
		Total vcore-seconds taken by all map tasks=4392166
		Total vcore-seconds taken by all reduce tasks=1209730
		Total megabyte-seconds taken by all map tasks=4497577984
		Total megabyte-seconds taken by all reduce tasks=1238763520
	Map-Reduce Framework
		Map input records=2436754
		Map output records=2182428
		Map output bytes=893317336
		Map output materialized bytes=901787562
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1901082
		Reduce shuffle bytes=901787562
		Reduce input records=2182428
		Reduce output records=1410594
		Spilled Records=4364856
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=69726
		CPU time spent (ms)=940770
		Physical memory (bytes) snapshot=324631945216
		Virtual memory (bytes) snapshot=742564782080
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=764220584
	File Output Format Counters 
		Bytes Written=481340508
16/12/06 18:24:11 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1500
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1600 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1600': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3559891334649023708.jar tmpDir=null
16/12/06 18:24:47 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:24:48 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:24:48 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 18:24:50 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 18:24:50 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 18:24:50 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4791
16/12/06 18:24:51 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4791
16/12/06 18:24:51 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4791/
16/12/06 18:24:51 INFO mapreduce.Job: Running job: job_1480588584072_4791
16/12/06 18:25:49 INFO mapreduce.Job: Job job_1480588584072_4791 running in uber mode : false
16/12/06 18:25:49 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 18:26:07 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 18:26:08 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 18:26:16 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 18:26:17 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 18:26:18 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 18:26:19 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 18:26:20 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 18:26:21 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 18:26:22 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 18:26:23 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 18:26:24 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 18:26:27 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 18:26:32 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 18:26:35 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 18:26:36 INFO mapreduce.Job:  map 22% reduce 1%
16/12/06 18:26:38 INFO mapreduce.Job:  map 27% reduce 1%
16/12/06 18:26:39 INFO mapreduce.Job:  map 31% reduce 2%
16/12/06 18:26:41 INFO mapreduce.Job:  map 34% reduce 2%
16/12/06 18:26:42 INFO mapreduce.Job:  map 37% reduce 2%
16/12/06 18:26:43 INFO mapreduce.Job:  map 39% reduce 3%
16/12/06 18:26:44 INFO mapreduce.Job:  map 43% reduce 4%
16/12/06 18:26:45 INFO mapreduce.Job:  map 45% reduce 4%
16/12/06 18:26:46 INFO mapreduce.Job:  map 48% reduce 5%
16/12/06 18:26:47 INFO mapreduce.Job:  map 50% reduce 7%
16/12/06 18:26:48 INFO mapreduce.Job:  map 51% reduce 8%
16/12/06 18:26:49 INFO mapreduce.Job:  map 53% reduce 9%
16/12/06 18:26:50 INFO mapreduce.Job:  map 53% reduce 11%
16/12/06 18:26:51 INFO mapreduce.Job:  map 54% reduce 13%
16/12/06 18:26:52 INFO mapreduce.Job:  map 54% reduce 14%
16/12/06 18:26:53 INFO mapreduce.Job:  map 55% reduce 14%
16/12/06 18:26:55 INFO mapreduce.Job:  map 55% reduce 15%
16/12/06 18:26:56 INFO mapreduce.Job:  map 55% reduce 17%
16/12/06 18:26:57 INFO mapreduce.Job:  map 56% reduce 18%
16/12/06 18:26:58 INFO mapreduce.Job:  map 57% reduce 18%
16/12/06 18:26:59 INFO mapreduce.Job:  map 58% reduce 18%
16/12/06 18:27:00 INFO mapreduce.Job:  map 59% reduce 18%
16/12/06 18:27:02 INFO mapreduce.Job:  map 60% reduce 18%
16/12/06 18:27:03 INFO mapreduce.Job:  map 60% reduce 19%
16/12/06 18:27:05 INFO mapreduce.Job:  map 61% reduce 19%
16/12/06 18:27:07 INFO mapreduce.Job:  map 62% reduce 19%
16/12/06 18:27:08 INFO mapreduce.Job:  map 63% reduce 19%
16/12/06 18:27:09 INFO mapreduce.Job:  map 64% reduce 19%
16/12/06 18:27:10 INFO mapreduce.Job:  map 67% reduce 20%
16/12/06 18:27:11 INFO mapreduce.Job:  map 69% reduce 20%
16/12/06 18:27:12 INFO mapreduce.Job:  map 70% reduce 22%
16/12/06 18:27:13 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 18:27:14 INFO mapreduce.Job:  map 74% reduce 23%
16/12/06 18:27:15 INFO mapreduce.Job:  map 77% reduce 23%
16/12/06 18:27:16 INFO mapreduce.Job:  map 79% reduce 24%
16/12/06 18:27:17 INFO mapreduce.Job:  map 84% reduce 25%
16/12/06 18:27:18 INFO mapreduce.Job:  map 86% reduce 26%
16/12/06 18:27:19 INFO mapreduce.Job:  map 89% reduce 27%
16/12/06 18:27:20 INFO mapreduce.Job:  map 92% reduce 28%
16/12/06 18:27:21 INFO mapreduce.Job:  map 94% reduce 29%
16/12/06 18:27:22 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 18:27:23 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 18:27:24 INFO mapreduce.Job:  map 97% reduce 32%
16/12/06 18:27:27 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 18:27:28 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 18:27:29 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 18:27:30 INFO mapreduce.Job:  map 100% reduce 39%
16/12/06 18:27:31 INFO mapreduce.Job:  map 100% reduce 54%
16/12/06 18:27:32 INFO mapreduce.Job:  map 100% reduce 57%
16/12/06 18:27:33 INFO mapreduce.Job:  map 100% reduce 65%
16/12/06 18:27:34 INFO mapreduce.Job:  map 100% reduce 73%
16/12/06 18:27:35 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 18:27:36 INFO mapreduce.Job:  map 100% reduce 79%
16/12/06 18:27:37 INFO mapreduce.Job:  map 100% reduce 85%
16/12/06 18:27:38 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 18:27:39 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 18:27:40 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 18:27:41 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 18:27:42 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 18:27:44 INFO mapreduce.Job: Job job_1480588584072_4791 completed successfully
16/12/06 18:27:44 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=800505106
		FILE: Number of bytes written=1633392177
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=690796153
		WASB: Number of bytes written=386952922
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=11904712
		Total time spent by all reduces in occupied slots (ms)=2809930
		Total time spent by all map tasks (ms)=5952356
		Total time spent by all reduce tasks (ms)=1404965
		Total vcore-seconds taken by all map tasks=5952356
		Total vcore-seconds taken by all reduce tasks=1404965
		Total megabyte-seconds taken by all map tasks=6095212544
		Total megabyte-seconds taken by all reduce tasks=1438684160
	Map-Reduce Framework
		Map input records=2225633
		Map output records=1950252
		Map output bytes=792957038
		Map output materialized bytes=800528626
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1679722
		Reduce shuffle bytes=800528626
		Reduce input records=1950252
		Reduce output records=1139483
		Spilled Records=3900504
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=91025
		CPU time spent (ms)=950660
		Physical memory (bytes) snapshot=324177608704
		Virtual memory (bytes) snapshot=742280491008
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=688100149
	File Output Format Counters 
		Bytes Written=386952922
16/12/06 18:27:44 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1600
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1700 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612030900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1700': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob673764293414997579.jar tmpDir=null
16/12/06 18:28:21 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:28:22 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:28:30 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 18:28:32 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 18:28:32 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 18:28:33 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4793
16/12/06 18:28:33 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4793
16/12/06 18:28:33 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4793/
16/12/06 18:28:33 INFO mapreduce.Job: Running job: job_1480588584072_4793
16/12/06 18:28:47 INFO mapreduce.Job: Job job_1480588584072_4793 running in uber mode : false
16/12/06 18:28:47 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 18:28:59 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 18:29:01 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 18:29:02 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 18:29:07 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 18:29:08 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 18:29:13 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 18:29:14 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 18:29:15 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 18:29:17 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 18:29:18 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 18:29:20 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 18:29:21 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 18:29:22 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 18:29:23 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 18:29:24 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 18:29:25 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 18:29:26 INFO mapreduce.Job:  map 29% reduce 0%
16/12/06 18:29:27 INFO mapreduce.Job:  map 30% reduce 0%
16/12/06 18:29:28 INFO mapreduce.Job:  map 33% reduce 1%
16/12/06 18:29:29 INFO mapreduce.Job:  map 34% reduce 1%
16/12/06 18:29:30 INFO mapreduce.Job:  map 35% reduce 2%
16/12/06 18:29:31 INFO mapreduce.Job:  map 36% reduce 3%
16/12/06 18:29:33 INFO mapreduce.Job:  map 37% reduce 3%
16/12/06 18:29:35 INFO mapreduce.Job:  map 38% reduce 3%
16/12/06 18:29:37 INFO mapreduce.Job:  map 39% reduce 3%
16/12/06 18:29:39 INFO mapreduce.Job:  map 40% reduce 4%
16/12/06 18:29:40 INFO mapreduce.Job:  map 41% reduce 5%
16/12/06 18:29:41 INFO mapreduce.Job:  map 42% reduce 5%
16/12/06 18:29:42 INFO mapreduce.Job:  map 44% reduce 5%
16/12/06 18:29:43 INFO mapreduce.Job:  map 45% reduce 6%
16/12/06 18:29:44 INFO mapreduce.Job:  map 45% reduce 7%
16/12/06 18:29:45 INFO mapreduce.Job:  map 45% reduce 8%
16/12/06 18:29:46 INFO mapreduce.Job:  map 46% reduce 8%
16/12/06 18:29:47 INFO mapreduce.Job:  map 46% reduce 9%
16/12/06 18:29:51 INFO mapreduce.Job:  map 47% reduce 9%
16/12/06 18:29:52 INFO mapreduce.Job:  map 48% reduce 9%
16/12/06 18:29:55 INFO mapreduce.Job:  map 50% reduce 9%
16/12/06 18:29:56 INFO mapreduce.Job:  map 50% reduce 10%
16/12/06 18:29:58 INFO mapreduce.Job:  map 53% reduce 10%
16/12/06 18:29:59 INFO mapreduce.Job:  map 54% reduce 10%
16/12/06 18:30:01 INFO mapreduce.Job:  map 54% reduce 11%
16/12/06 18:30:04 INFO mapreduce.Job:  map 55% reduce 12%
16/12/06 18:30:05 INFO mapreduce.Job:  map 56% reduce 12%
16/12/06 18:30:06 INFO mapreduce.Job:  map 58% reduce 15%
16/12/06 18:30:08 INFO mapreduce.Job:  map 60% reduce 15%
16/12/06 18:30:09 INFO mapreduce.Job:  map 62% reduce 15%
16/12/06 18:30:10 INFO mapreduce.Job:  map 63% reduce 16%
16/12/06 18:30:12 INFO mapreduce.Job:  map 64% reduce 17%
16/12/06 18:30:13 INFO mapreduce.Job:  map 66% reduce 17%
16/12/06 18:30:14 INFO mapreduce.Job:  map 67% reduce 17%
16/12/06 18:30:15 INFO mapreduce.Job:  map 71% reduce 17%
16/12/06 18:30:16 INFO mapreduce.Job:  map 74% reduce 18%
16/12/06 18:30:17 INFO mapreduce.Job:  map 77% reduce 19%
16/12/06 18:30:18 INFO mapreduce.Job:  map 80% reduce 22%
16/12/06 18:30:19 INFO mapreduce.Job:  map 83% reduce 22%
16/12/06 18:30:20 INFO mapreduce.Job:  map 86% reduce 24%
16/12/06 18:30:21 INFO mapreduce.Job:  map 90% reduce 26%
16/12/06 18:30:22 INFO mapreduce.Job:  map 91% reduce 28%
16/12/06 18:30:23 INFO mapreduce.Job:  map 91% reduce 29%
16/12/06 18:30:24 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 18:30:25 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 18:30:26 INFO mapreduce.Job:  map 93% reduce 31%
16/12/06 18:30:27 INFO mapreduce.Job:  map 94% reduce 31%
16/12/06 18:30:28 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 18:30:29 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 18:30:30 INFO mapreduce.Job:  map 97% reduce 32%
16/12/06 18:30:31 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 18:30:32 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 18:30:33 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 18:30:34 INFO mapreduce.Job:  map 100% reduce 36%
16/12/06 18:30:35 INFO mapreduce.Job:  map 100% reduce 43%
16/12/06 18:30:36 INFO mapreduce.Job:  map 100% reduce 57%
16/12/06 18:30:37 INFO mapreduce.Job:  map 100% reduce 65%
16/12/06 18:30:38 INFO mapreduce.Job:  map 100% reduce 72%
16/12/06 18:30:40 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 18:30:41 INFO mapreduce.Job:  map 100% reduce 80%
16/12/06 18:30:42 INFO mapreduce.Job:  map 100% reduce 85%
16/12/06 18:30:43 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 18:30:44 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 18:30:45 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 18:30:46 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 18:30:47 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 18:30:50 INFO mapreduce.Job: Job job_1480588584072_4793 completed successfully
16/12/06 18:30:50 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=908118179
		FILE: Number of bytes written=1848618323
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=773394721
		WASB: Number of bytes written=469281931
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=9016002
		Total time spent by all reduces in occupied slots (ms)=2758140
		Total time spent by all map tasks (ms)=4508001
		Total time spent by all reduce tasks (ms)=1379070
		Total vcore-seconds taken by all map tasks=4508001
		Total vcore-seconds taken by all reduce tasks=1379070
		Total megabyte-seconds taken by all map tasks=4616193024
		Total megabyte-seconds taken by all reduce tasks=1412167680
	Map-Reduce Framework
		Map input records=2472890
		Map output records=2205997
		Map output bytes=899590458
		Map output materialized bytes=908141699
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1919291
		Reduce shuffle bytes=908141699
		Reduce input records=2205997
		Reduce output records=1380381
		Spilled Records=4411994
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=64476
		CPU time spent (ms)=949590
		Physical memory (bytes) snapshot=324892807168
		Virtual memory (bytes) snapshot=742563139584
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=770698717
	File Output Format Counters 
		Bytes Written=469281931
16/12/06 18:30:50 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1700
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031400 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1800 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031400
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1800': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2723137196296887037.jar tmpDir=null
16/12/06 18:31:28 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:31:29 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:31:29 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 18:31:31 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 18:31:31 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 18:31:32 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4797
16/12/06 18:31:32 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4797
16/12/06 18:31:32 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4797/
16/12/06 18:31:32 INFO mapreduce.Job: Running job: job_1480588584072_4797
16/12/06 18:32:08 INFO mapreduce.Job: Job job_1480588584072_4797 running in uber mode : false
16/12/06 18:32:08 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 18:32:23 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 18:32:26 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 18:32:29 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 18:32:31 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 18:32:36 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 18:32:39 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 18:32:43 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 18:32:44 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 18:32:47 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 18:32:48 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 18:32:49 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 18:32:56 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 18:32:58 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 18:33:03 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 18:33:04 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 18:33:07 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 18:33:10 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 18:33:11 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 18:33:18 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 18:33:19 INFO mapreduce.Job:  map 28% reduce 1%
16/12/06 18:33:22 INFO mapreduce.Job:  map 29% reduce 1%
16/12/06 18:33:23 INFO mapreduce.Job:  map 30% reduce 2%
16/12/06 18:33:26 INFO mapreduce.Job:  map 34% reduce 2%
16/12/06 18:33:27 INFO mapreduce.Job:  map 35% reduce 4%
16/12/06 18:33:28 INFO mapreduce.Job:  map 39% reduce 4%
16/12/06 18:33:29 INFO mapreduce.Job:  map 42% reduce 4%
16/12/06 18:33:30 INFO mapreduce.Job:  map 43% reduce 5%
16/12/06 18:33:31 INFO mapreduce.Job:  map 46% reduce 6%
16/12/06 18:33:32 INFO mapreduce.Job:  map 47% reduce 7%
16/12/06 18:33:33 INFO mapreduce.Job:  map 48% reduce 8%
16/12/06 18:33:34 INFO mapreduce.Job:  map 48% reduce 10%
16/12/06 18:33:36 INFO mapreduce.Job:  map 51% reduce 10%
16/12/06 18:33:37 INFO mapreduce.Job:  map 52% reduce 13%
16/12/06 18:33:42 INFO mapreduce.Job:  map 52% reduce 14%
16/12/06 18:33:43 INFO mapreduce.Job:  map 54% reduce 16%
16/12/06 18:33:44 INFO mapreduce.Job:  map 56% reduce 16%
16/12/06 18:33:46 INFO mapreduce.Job:  map 57% reduce 16%
16/12/06 18:33:47 INFO mapreduce.Job:  map 61% reduce 18%
16/12/06 18:33:48 INFO mapreduce.Job:  map 63% reduce 18%
16/12/06 18:33:49 INFO mapreduce.Job:  map 65% reduce 18%
16/12/06 18:33:50 INFO mapreduce.Job:  map 66% reduce 21%
16/12/06 18:33:51 INFO mapreduce.Job:  map 68% reduce 21%
16/12/06 18:33:52 INFO mapreduce.Job:  map 68% reduce 22%
16/12/06 18:33:54 INFO mapreduce.Job:  map 69% reduce 23%
16/12/06 18:33:55 INFO mapreduce.Job:  map 71% reduce 23%
16/12/06 18:33:56 INFO mapreduce.Job:  map 74% reduce 23%
16/12/06 18:33:57 INFO mapreduce.Job:  map 76% reduce 23%
16/12/06 18:33:59 INFO mapreduce.Job:  map 81% reduce 24%
16/12/06 18:34:00 INFO mapreduce.Job:  map 83% reduce 25%
16/12/06 18:34:01 INFO mapreduce.Job:  map 86% reduce 26%
16/12/06 18:34:02 INFO mapreduce.Job:  map 88% reduce 26%
16/12/06 18:34:03 INFO mapreduce.Job:  map 90% reduce 28%
16/12/06 18:34:04 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 18:34:06 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 18:34:13 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 18:34:14 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 18:34:15 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 18:34:16 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 18:34:18 INFO mapreduce.Job:  map 97% reduce 32%
16/12/06 18:34:19 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 18:34:21 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 18:34:22 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 18:34:24 INFO mapreduce.Job:  map 100% reduce 62%
16/12/06 18:34:26 INFO mapreduce.Job:  map 100% reduce 65%
16/12/06 18:34:27 INFO mapreduce.Job:  map 100% reduce 73%
16/12/06 18:34:28 INFO mapreduce.Job:  map 100% reduce 74%
16/12/06 18:34:29 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 18:34:30 INFO mapreduce.Job:  map 100% reduce 85%
16/12/06 18:34:31 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 18:34:32 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 18:34:33 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 18:34:34 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 18:34:35 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 18:34:36 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 18:34:40 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 18:34:43 INFO mapreduce.Job: Job job_1480588584072_4797 completed successfully
16/12/06 18:34:43 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=925803698
		FILE: Number of bytes written=1883989361
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=790359332
		WASB: Number of bytes written=467132039
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=9571552
		Total time spent by all reduces in occupied slots (ms)=3334156
		Total time spent by all map tasks (ms)=4785776
		Total time spent by all reduce tasks (ms)=1667078
		Total vcore-seconds taken by all map tasks=4785776
		Total vcore-seconds taken by all reduce tasks=1667078
		Total megabyte-seconds taken by all map tasks=4900634624
		Total megabyte-seconds taken by all reduce tasks=1707087872
	Map-Reduce Framework
		Map input records=2536486
		Map output records=2253086
		Map output bytes=917085736
		Map output materialized bytes=925827218
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1953120
		Reduce shuffle bytes=925827218
		Reduce input records=2253086
		Reduce output records=1375388
		Spilled Records=4506172
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=70686
		CPU time spent (ms)=939440
		Physical memory (bytes) snapshot=324536328192
		Virtual memory (bytes) snapshot=742487949312
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=787663328
	File Output Format Counters 
		Bytes Written=467132039
16/12/06 18:34:43 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1800
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031500 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1900 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031500
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1900': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3113928774986134087.jar tmpDir=null
16/12/06 18:35:20 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:35:20 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:35:21 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 18:35:23 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 18:35:23 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 18:35:23 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4799
16/12/06 18:35:24 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4799
16/12/06 18:35:24 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4799/
16/12/06 18:35:24 INFO mapreduce.Job: Running job: job_1480588584072_4799
16/12/06 18:35:40 INFO mapreduce.Job: Job job_1480588584072_4799 running in uber mode : false
16/12/06 18:35:40 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 18:36:02 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 18:36:04 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 18:36:05 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 18:36:06 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 18:36:07 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 18:36:13 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 18:36:15 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 18:36:16 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 18:36:17 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 18:36:19 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 18:36:24 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 18:36:25 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 18:36:26 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 18:36:27 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 18:36:28 INFO mapreduce.Job:  map 31% reduce 1%
16/12/06 18:36:29 INFO mapreduce.Job:  map 34% reduce 1%
16/12/06 18:36:30 INFO mapreduce.Job:  map 38% reduce 1%
16/12/06 18:36:31 INFO mapreduce.Job:  map 40% reduce 2%
16/12/06 18:36:32 INFO mapreduce.Job:  map 43% reduce 3%
16/12/06 18:36:33 INFO mapreduce.Job:  map 44% reduce 5%
16/12/06 18:36:34 INFO mapreduce.Job:  map 46% reduce 6%
16/12/06 18:36:35 INFO mapreduce.Job:  map 46% reduce 8%
16/12/06 18:36:36 INFO mapreduce.Job:  map 47% reduce 9%
16/12/06 18:36:38 INFO mapreduce.Job:  map 48% reduce 10%
16/12/06 18:36:39 INFO mapreduce.Job:  map 49% reduce 10%
16/12/06 18:36:40 INFO mapreduce.Job:  map 51% reduce 10%
16/12/06 18:36:41 INFO mapreduce.Job:  map 51% reduce 11%
16/12/06 18:36:42 INFO mapreduce.Job:  map 53% reduce 11%
16/12/06 18:36:43 INFO mapreduce.Job:  map 54% reduce 11%
16/12/06 18:36:44 INFO mapreduce.Job:  map 55% reduce 11%
16/12/06 18:36:45 INFO mapreduce.Job:  map 56% reduce 12%
16/12/06 18:36:47 INFO mapreduce.Job:  map 57% reduce 12%
16/12/06 18:36:48 INFO mapreduce.Job:  map 59% reduce 12%
16/12/06 18:36:49 INFO mapreduce.Job:  map 59% reduce 13%
16/12/06 18:36:50 INFO mapreduce.Job:  map 59% reduce 15%
16/12/06 18:36:51 INFO mapreduce.Job:  map 61% reduce 15%
16/12/06 18:36:52 INFO mapreduce.Job:  map 62% reduce 15%
16/12/06 18:36:53 INFO mapreduce.Job:  map 63% reduce 16%
16/12/06 18:36:54 INFO mapreduce.Job:  map 65% reduce 16%
16/12/06 18:36:55 INFO mapreduce.Job:  map 70% reduce 16%
16/12/06 18:36:56 INFO mapreduce.Job:  map 73% reduce 18%
16/12/06 18:36:57 INFO mapreduce.Job:  map 75% reduce 19%
16/12/06 18:36:58 INFO mapreduce.Job:  map 76% reduce 21%
16/12/06 18:36:59 INFO mapreduce.Job:  map 78% reduce 22%
16/12/06 18:37:00 INFO mapreduce.Job:  map 81% reduce 25%
16/12/06 18:37:01 INFO mapreduce.Job:  map 83% reduce 26%
16/12/06 18:37:02 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 18:37:03 INFO mapreduce.Job:  map 86% reduce 27%
16/12/06 18:37:04 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 18:37:05 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 18:37:07 INFO mapreduce.Job:  map 90% reduce 30%
16/12/06 18:37:14 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 18:37:18 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 18:37:19 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 18:37:20 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 18:37:21 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 18:37:22 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 18:37:23 INFO mapreduce.Job:  map 97% reduce 32%
16/12/06 18:37:24 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 18:37:26 INFO mapreduce.Job:  map 99% reduce 33%
16/12/06 18:37:27 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 18:37:28 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 18:37:29 INFO mapreduce.Job:  map 100% reduce 41%
16/12/06 18:37:30 INFO mapreduce.Job:  map 100% reduce 48%
16/12/06 18:37:31 INFO mapreduce.Job:  map 100% reduce 59%
16/12/06 18:37:32 INFO mapreduce.Job:  map 100% reduce 66%
16/12/06 18:37:33 INFO mapreduce.Job:  map 100% reduce 70%
16/12/06 18:37:34 INFO mapreduce.Job:  map 100% reduce 73%
16/12/06 18:37:35 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 18:37:36 INFO mapreduce.Job:  map 100% reduce 80%
16/12/06 18:37:37 INFO mapreduce.Job:  map 100% reduce 83%
16/12/06 18:37:38 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 18:37:39 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 18:37:40 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 18:37:41 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 18:37:42 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 18:37:43 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 18:37:44 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 18:37:46 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 18:37:48 INFO mapreduce.Job: Job job_1480588584072_4799 completed successfully
16/12/06 18:37:49 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=1014168242
		FILE: Number of bytes written=2060718449
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=855930527
		WASB: Number of bytes written=536703043
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12060952
		Total time spent by all reduces in occupied slots (ms)=3235356
		Total time spent by all map tasks (ms)=6030476
		Total time spent by all reduce tasks (ms)=1617678
		Total vcore-seconds taken by all map tasks=6030476
		Total vcore-seconds taken by all reduce tasks=1617678
		Total megabyte-seconds taken by all map tasks=6175207424
		Total megabyte-seconds taken by all reduce tasks=1656502272
	Map-Reduce Framework
		Map input records=2733297
		Map output records=2465652
		Map output bytes=1004642131
		Map output materialized bytes=1014191762
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2152901
		Reduce shuffle bytes=1014191762
		Reduce input records=2465652
		Reduce output records=1584960
		Spilled Records=4931304
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=76409
		CPU time spent (ms)=1016190
		Physical memory (bytes) snapshot=325445591040
		Virtual memory (bytes) snapshot=742291963904
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=853234523
	File Output Format Counters 
		Bytes Written=536703043
16/12/06 18:37:49 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/1900
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031600 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/2000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031600
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/2000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8051845112998522746.jar tmpDir=null
16/12/06 18:38:26 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:38:27 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:38:28 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 18:38:29 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 18:38:30 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 18:38:30 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4803
16/12/06 18:38:31 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4803
16/12/06 18:38:31 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4803/
16/12/06 18:38:31 INFO mapreduce.Job: Running job: job_1480588584072_4803
16/12/06 18:38:45 INFO mapreduce.Job: Job job_1480588584072_4803 running in uber mode : false
16/12/06 18:38:45 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 18:39:00 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 18:39:01 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 18:39:09 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 18:39:10 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 18:39:11 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 18:39:16 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 18:39:17 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 18:39:20 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 18:39:21 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 18:39:23 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 18:39:24 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 18:39:26 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 18:39:27 INFO mapreduce.Job:  map 22% reduce 1%
16/12/06 18:39:31 INFO mapreduce.Job:  map 23% reduce 1%
16/12/06 18:39:33 INFO mapreduce.Job:  map 25% reduce 1%
16/12/06 18:39:34 INFO mapreduce.Job:  map 26% reduce 1%
16/12/06 18:39:35 INFO mapreduce.Job:  map 28% reduce 2%
16/12/06 18:39:36 INFO mapreduce.Job:  map 30% reduce 3%
16/12/06 18:39:38 INFO mapreduce.Job:  map 31% reduce 4%
16/12/06 18:39:39 INFO mapreduce.Job:  map 31% reduce 6%
16/12/06 18:39:40 INFO mapreduce.Job:  map 31% reduce 7%
16/12/06 18:39:41 INFO mapreduce.Job:  map 34% reduce 7%
16/12/06 18:39:42 INFO mapreduce.Job:  map 34% reduce 8%
16/12/06 18:39:43 INFO mapreduce.Job:  map 37% reduce 9%
16/12/06 18:39:44 INFO mapreduce.Job:  map 38% reduce 9%
16/12/06 18:39:45 INFO mapreduce.Job:  map 39% reduce 11%
16/12/06 18:39:47 INFO mapreduce.Job:  map 40% reduce 12%
16/12/06 18:39:49 INFO mapreduce.Job:  map 41% reduce 12%
16/12/06 18:39:51 INFO mapreduce.Job:  map 43% reduce 12%
16/12/06 18:39:52 INFO mapreduce.Job:  map 44% reduce 13%
16/12/06 18:39:53 INFO mapreduce.Job:  map 46% reduce 13%
16/12/06 18:39:54 INFO mapreduce.Job:  map 48% reduce 13%
16/12/06 18:39:55 INFO mapreduce.Job:  map 50% reduce 14%
16/12/06 18:39:57 INFO mapreduce.Job:  map 51% reduce 15%
16/12/06 18:39:58 INFO mapreduce.Job:  map 52% reduce 16%
16/12/06 18:40:00 INFO mapreduce.Job:  map 54% reduce 16%
16/12/06 18:40:01 INFO mapreduce.Job:  map 55% reduce 17%
16/12/06 18:40:02 INFO mapreduce.Job:  map 57% reduce 17%
16/12/06 18:40:03 INFO mapreduce.Job:  map 60% reduce 18%
16/12/06 18:40:04 INFO mapreduce.Job:  map 64% reduce 19%
16/12/06 18:40:05 INFO mapreduce.Job:  map 66% reduce 19%
16/12/06 18:40:06 INFO mapreduce.Job:  map 69% reduce 20%
16/12/06 18:40:07 INFO mapreduce.Job:  map 71% reduce 21%
16/12/06 18:40:08 INFO mapreduce.Job:  map 72% reduce 21%
16/12/06 18:40:09 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 18:40:10 INFO mapreduce.Job:  map 73% reduce 24%
16/12/06 18:40:11 INFO mapreduce.Job:  map 74% reduce 24%
16/12/06 18:40:12 INFO mapreduce.Job:  map 76% reduce 24%
16/12/06 18:40:13 INFO mapreduce.Job:  map 77% reduce 24%
16/12/06 18:40:14 INFO mapreduce.Job:  map 77% reduce 25%
16/12/06 18:40:15 INFO mapreduce.Job:  map 78% reduce 25%
16/12/06 18:40:16 INFO mapreduce.Job:  map 78% reduce 26%
16/12/06 18:40:18 INFO mapreduce.Job:  map 79% reduce 26%
16/12/06 18:40:19 INFO mapreduce.Job:  map 80% reduce 26%
16/12/06 18:40:20 INFO mapreduce.Job:  map 83% reduce 26%
16/12/06 18:40:21 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 18:40:22 INFO mapreduce.Job:  map 87% reduce 27%
16/12/06 18:40:23 INFO mapreduce.Job:  map 90% reduce 28%
16/12/06 18:40:24 INFO mapreduce.Job:  map 94% reduce 29%
16/12/06 18:40:25 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 18:40:26 INFO mapreduce.Job:  map 97% reduce 30%
16/12/06 18:40:27 INFO mapreduce.Job:  map 99% reduce 31%
16/12/06 18:40:28 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 18:40:30 INFO mapreduce.Job:  map 100% reduce 45%
16/12/06 18:40:31 INFO mapreduce.Job:  map 100% reduce 56%
16/12/06 18:40:32 INFO mapreduce.Job:  map 100% reduce 60%
16/12/06 18:40:33 INFO mapreduce.Job:  map 100% reduce 65%
16/12/06 18:40:34 INFO mapreduce.Job:  map 100% reduce 75%
16/12/06 18:40:35 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 18:40:36 INFO mapreduce.Job:  map 100% reduce 81%
16/12/06 18:40:37 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 18:40:38 INFO mapreduce.Job:  map 100% reduce 88%
16/12/06 18:40:39 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 18:40:40 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 18:40:41 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 18:40:42 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 18:40:43 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 18:40:44 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 18:40:45 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 18:40:46 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 18:40:51 INFO mapreduce.Job: Job job_1480588584072_4803 completed successfully
16/12/06 18:40:51 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=977702404
		FILE: Number of bytes written=1987786773
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=823041789
		WASB: Number of bytes written=523800536
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=10479666
		Total time spent by all reduces in occupied slots (ms)=3153102
		Total time spent by all map tasks (ms)=5239833
		Total time spent by all reduce tasks (ms)=1576551
		Total vcore-seconds taken by all map tasks=5239833
		Total vcore-seconds taken by all reduce tasks=1576551
		Total megabyte-seconds taken by all map tasks=5365588992
		Total megabyte-seconds taken by all reduce tasks=1614388224
	Map-Reduce Framework
		Map input records=2620950
		Map output records=2373543
		Map output bytes=968528280
		Map output materialized bytes=977725924
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2074216
		Reduce shuffle bytes=977725924
		Reduce input records=2373543
		Reduce output records=1544292
		Spilled Records=4747086
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=69355
		CPU time spent (ms)=971650
		Physical memory (bytes) snapshot=325477793792
		Virtual memory (bytes) snapshot=742788317184
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=820345785
	File Output Format Counters 
		Bytes Written=523800536
16/12/06 18:40:51 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/2000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031700 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/2100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031700
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/2100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2126996139983834613.jar tmpDir=null
16/12/06 18:41:29 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:41:30 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:41:30 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 18:41:31 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 18:41:32 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 18:41:32 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4808
16/12/06 18:41:33 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4808
16/12/06 18:41:33 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4808/
16/12/06 18:41:33 INFO mapreduce.Job: Running job: job_1480588584072_4808
16/12/06 18:41:46 INFO mapreduce.Job: Job job_1480588584072_4808 running in uber mode : false
16/12/06 18:41:46 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 18:42:10 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 18:42:11 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 18:42:15 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 18:42:16 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 18:42:17 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 18:42:18 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 18:42:20 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 18:42:21 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 18:42:22 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 18:42:23 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 18:42:24 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 18:42:25 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 18:42:29 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 18:42:32 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 18:42:33 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 18:42:34 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 18:42:35 INFO mapreduce.Job:  map 29% reduce 0%
16/12/06 18:42:38 INFO mapreduce.Job:  map 30% reduce 0%
16/12/06 18:42:39 INFO mapreduce.Job:  map 36% reduce 1%
16/12/06 18:42:40 INFO mapreduce.Job:  map 41% reduce 1%
16/12/06 18:42:41 INFO mapreduce.Job:  map 43% reduce 1%
16/12/06 18:42:42 INFO mapreduce.Job:  map 49% reduce 4%
16/12/06 18:42:43 INFO mapreduce.Job:  map 51% reduce 4%
16/12/06 18:42:44 INFO mapreduce.Job:  map 54% reduce 4%
16/12/06 18:42:45 INFO mapreduce.Job:  map 56% reduce 7%
16/12/06 18:42:46 INFO mapreduce.Job:  map 57% reduce 8%
16/12/06 18:42:47 INFO mapreduce.Job:  map 57% reduce 11%
16/12/06 18:42:48 INFO mapreduce.Job:  map 57% reduce 14%
16/12/06 18:42:52 INFO mapreduce.Job:  map 59% reduce 15%
16/12/06 18:42:53 INFO mapreduce.Job:  map 62% reduce 15%
16/12/06 18:42:54 INFO mapreduce.Job:  map 63% reduce 17%
16/12/06 18:42:56 INFO mapreduce.Job:  map 64% reduce 17%
16/12/06 18:42:57 INFO mapreduce.Job:  map 65% reduce 18%
16/12/06 18:42:58 INFO mapreduce.Job:  map 66% reduce 18%
16/12/06 18:42:59 INFO mapreduce.Job:  map 68% reduce 19%
16/12/06 18:43:00 INFO mapreduce.Job:  map 69% reduce 21%
16/12/06 18:43:01 INFO mapreduce.Job:  map 69% reduce 22%
16/12/06 18:43:03 INFO mapreduce.Job:  map 69% reduce 23%
16/12/06 18:43:04 INFO mapreduce.Job:  map 70% reduce 23%
16/12/06 18:43:05 INFO mapreduce.Job:  map 72% reduce 23%
16/12/06 18:43:06 INFO mapreduce.Job:  map 74% reduce 23%
16/12/06 18:43:07 INFO mapreduce.Job:  map 77% reduce 24%
16/12/06 18:43:08 INFO mapreduce.Job:  map 80% reduce 24%
16/12/06 18:43:09 INFO mapreduce.Job:  map 83% reduce 25%
16/12/06 18:43:10 INFO mapreduce.Job:  map 86% reduce 27%
16/12/06 18:43:11 INFO mapreduce.Job:  map 86% reduce 28%
16/12/06 18:43:12 INFO mapreduce.Job:  map 89% reduce 28%
16/12/06 18:43:13 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 18:43:14 INFO mapreduce.Job:  map 91% reduce 29%
16/12/06 18:43:15 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 18:43:16 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 18:43:17 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 18:43:18 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 18:43:19 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 18:43:20 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 18:43:22 INFO mapreduce.Job:  map 100% reduce 43%
16/12/06 18:43:23 INFO mapreduce.Job:  map 100% reduce 53%
16/12/06 18:43:24 INFO mapreduce.Job:  map 100% reduce 54%
16/12/06 18:43:25 INFO mapreduce.Job:  map 100% reduce 66%
16/12/06 18:43:26 INFO mapreduce.Job:  map 100% reduce 73%
16/12/06 18:43:28 INFO mapreduce.Job:  map 100% reduce 78%
16/12/06 18:43:29 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 18:43:30 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 18:43:31 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 18:43:32 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 18:43:34 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 18:43:37 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 18:43:40 INFO mapreduce.Job: Job job_1480588584072_4808 completed successfully
16/12/06 18:43:40 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=999985844
		FILE: Number of bytes written=2032353653
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=831321765
		WASB: Number of bytes written=577243105
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=11898328
		Total time spent by all reduces in occupied slots (ms)=2587918
		Total time spent by all map tasks (ms)=5949164
		Total time spent by all reduce tasks (ms)=1293959
		Total vcore-seconds taken by all map tasks=5949164
		Total vcore-seconds taken by all reduce tasks=1293959
		Total megabyte-seconds taken by all map tasks=6091943936
		Total megabyte-seconds taken by all reduce tasks=1325014016
	Map-Reduce Framework
		Map input records=2618667
		Map output records=2418377
		Map output bytes=990647700
		Map output materialized bytes=1000009364
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2137332
		Reduce shuffle bytes=1000009364
		Reduce input records=2418377
		Reduce output records=1700348
		Spilled Records=4836754
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=74999
		CPU time spent (ms)=1000100
		Physical memory (bytes) snapshot=325697888256
		Virtual memory (bytes) snapshot=742488563712
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=828625761
	File Output Format Counters 
		Bytes Written=577243105
16/12/06 18:43:40 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/2100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031800 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/2200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031800
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/2200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob509822179619779301.jar tmpDir=null
16/12/06 18:44:18 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:44:18 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:44:19 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 18:44:20 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 18:44:20 INFO mapreduce.JobSubmitter: number of splits:212
16/12/06 18:44:21 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4811
16/12/06 18:44:22 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4811
16/12/06 18:44:22 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4811/
16/12/06 18:44:22 INFO mapreduce.Job: Running job: job_1480588584072_4811
16/12/06 18:44:35 INFO mapreduce.Job: Job job_1480588584072_4811 running in uber mode : false
16/12/06 18:44:35 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 18:44:58 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 18:44:59 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 18:45:00 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 18:45:02 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 18:45:03 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 18:45:04 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 18:45:05 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 18:45:06 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 18:45:10 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 18:45:12 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 18:45:13 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 18:45:18 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 18:45:19 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 18:45:22 INFO mapreduce.Job:  map 27% reduce 1%
16/12/06 18:45:23 INFO mapreduce.Job:  map 28% reduce 2%
16/12/06 18:45:25 INFO mapreduce.Job:  map 30% reduce 4%
16/12/06 18:45:26 INFO mapreduce.Job:  map 31% reduce 4%
16/12/06 18:45:27 INFO mapreduce.Job:  map 36% reduce 5%
16/12/06 18:45:28 INFO mapreduce.Job:  map 38% reduce 6%
16/12/06 18:45:29 INFO mapreduce.Job:  map 39% reduce 6%
16/12/06 18:45:30 INFO mapreduce.Job:  map 42% reduce 7%
16/12/06 18:45:32 INFO mapreduce.Job:  map 45% reduce 8%
16/12/06 18:45:33 INFO mapreduce.Job:  map 46% reduce 9%
16/12/06 18:45:34 INFO mapreduce.Job:  map 48% reduce 9%
16/12/06 18:45:35 INFO mapreduce.Job:  map 48% reduce 11%
16/12/06 18:45:36 INFO mapreduce.Job:  map 51% reduce 12%
16/12/06 18:45:37 INFO mapreduce.Job:  map 53% reduce 13%
16/12/06 18:45:38 INFO mapreduce.Job:  map 55% reduce 13%
16/12/06 18:45:39 INFO mapreduce.Job:  map 56% reduce 13%
16/12/06 18:45:40 INFO mapreduce.Job:  map 57% reduce 14%
16/12/06 18:45:41 INFO mapreduce.Job:  map 57% reduce 15%
16/12/06 18:45:42 INFO mapreduce.Job:  map 58% reduce 15%
16/12/06 18:45:43 INFO mapreduce.Job:  map 58% reduce 16%
16/12/06 18:45:45 INFO mapreduce.Job:  map 58% reduce 17%
16/12/06 18:45:47 INFO mapreduce.Job:  map 60% reduce 17%
16/12/06 18:45:48 INFO mapreduce.Job:  map 61% reduce 18%
16/12/06 18:45:50 INFO mapreduce.Job:  map 62% reduce 18%
16/12/06 18:45:53 INFO mapreduce.Job:  map 64% reduce 19%
16/12/06 18:45:54 INFO mapreduce.Job:  map 65% reduce 19%
16/12/06 18:45:55 INFO mapreduce.Job:  map 67% reduce 20%
16/12/06 18:45:56 INFO mapreduce.Job:  map 69% reduce 20%
16/12/06 18:45:57 INFO mapreduce.Job:  map 71% reduce 20%
16/12/06 18:45:58 INFO mapreduce.Job:  map 73% reduce 21%
16/12/06 18:45:59 INFO mapreduce.Job:  map 75% reduce 23%
16/12/06 18:46:00 INFO mapreduce.Job:  map 78% reduce 23%
16/12/06 18:46:01 INFO mapreduce.Job:  map 82% reduce 24%
16/12/06 18:46:02 INFO mapreduce.Job:  map 86% reduce 25%
16/12/06 18:46:03 INFO mapreduce.Job:  map 90% reduce 26%
16/12/06 18:46:04 INFO mapreduce.Job:  map 94% reduce 28%
16/12/06 18:46:05 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 18:46:06 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 18:46:07 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 18:46:09 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 18:46:10 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 18:46:11 INFO mapreduce.Job:  map 100% reduce 43%
16/12/06 18:46:12 INFO mapreduce.Job:  map 100% reduce 54%
16/12/06 18:46:13 INFO mapreduce.Job:  map 100% reduce 55%
16/12/06 18:46:14 INFO mapreduce.Job:  map 100% reduce 69%
16/12/06 18:46:15 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 18:46:16 INFO mapreduce.Job:  map 100% reduce 77%
16/12/06 18:46:17 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 18:46:18 INFO mapreduce.Job:  map 100% reduce 88%
16/12/06 18:46:19 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 18:46:20 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 18:46:21 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 18:46:22 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 18:46:23 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 18:46:24 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 18:46:25 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 18:46:26 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 18:46:30 INFO mapreduce.Job: Job job_1480588584072_4811 completed successfully
16/12/06 18:46:31 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=851833622
		FILE: Number of bytes written=1738288484
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=710163211
		WASB: Number of bytes written=502637107
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=212
		Launched reduce tasks=20
		Rack-local map tasks=212
		Total time spent by all maps in occupied slots (ms)=11353282
		Total time spent by all reduces in occupied slots (ms)=2811686
		Total time spent by all map tasks (ms)=5676641
		Total time spent by all reduce tasks (ms)=1405843
		Total vcore-seconds taken by all map tasks=5676641
		Total vcore-seconds taken by all reduce tasks=1405843
		Total megabyte-seconds taken by all map tasks=5812880384
		Total megabyte-seconds taken by all reduce tasks=1439583232
	Map-Reduce Framework
		Map input records=2214354
		Map output records=2054973
		Map output bytes=843894841
		Map output materialized bytes=851858942
		Input split bytes=29501
		Combine input records=0
		Combine output records=0
		Reduce input groups=1823506
		Reduce shuffle bytes=851858942
		Reduce input records=2054973
		Reduce output records=1476228
		Spilled Records=4109946
		Shuffled Maps =4240
		Failed Shuffles=0
		Merged Map outputs=4240
		GC time elapsed (ms)=80815
		CPU time spent (ms)=1001040
		Physical memory (bytes) snapshot=349112287232
		Virtual memory (bytes) snapshot=793948438528
		Total committed heap usage (bytes)=614255820800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=707034907
	File Output Format Counters 
		Bytes Written=502637107
16/12/06 18:46:31 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/2200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031600
16/12/06 18:46:52 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031900 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/2300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161203/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031900
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/2300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4093903386146911296.jar tmpDir=null
16/12/06 18:47:07 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:47:08 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:47:08 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 18:47:11 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 18:47:11 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 18:47:11 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4813
16/12/06 18:47:12 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4813
16/12/06 18:47:12 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4813/
16/12/06 18:47:12 INFO mapreduce.Job: Running job: job_1480588584072_4813
16/12/06 18:47:24 INFO mapreduce.Job: Job job_1480588584072_4813 running in uber mode : false
16/12/06 18:47:24 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 18:47:36 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 18:47:44 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 18:47:45 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 18:47:51 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 18:47:52 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 18:47:55 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 18:47:56 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 18:47:57 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 18:48:00 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 18:48:02 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 18:48:06 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 18:48:07 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 18:48:08 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 18:48:09 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 18:48:10 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 18:48:11 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 18:48:12 INFO mapreduce.Job:  map 30% reduce 1%
16/12/06 18:48:13 INFO mapreduce.Job:  map 31% reduce 1%
16/12/06 18:48:14 INFO mapreduce.Job:  map 34% reduce 1%
16/12/06 18:48:15 INFO mapreduce.Job:  map 40% reduce 3%
16/12/06 18:48:16 INFO mapreduce.Job:  map 42% reduce 4%
16/12/06 18:48:17 INFO mapreduce.Job:  map 44% reduce 5%
16/12/06 18:48:18 INFO mapreduce.Job:  map 45% reduce 6%
16/12/06 18:48:19 INFO mapreduce.Job:  map 47% reduce 6%
16/12/06 18:48:20 INFO mapreduce.Job:  map 49% reduce 7%
16/12/06 18:48:21 INFO mapreduce.Job:  map 50% reduce 7%
16/12/06 18:48:22 INFO mapreduce.Job:  map 51% reduce 9%
16/12/06 18:48:23 INFO mapreduce.Job:  map 52% reduce 10%
16/12/06 18:48:24 INFO mapreduce.Job:  map 52% reduce 11%
16/12/06 18:48:29 INFO mapreduce.Job:  map 53% reduce 11%
16/12/06 18:48:31 INFO mapreduce.Job:  map 53% reduce 14%
16/12/06 18:48:32 INFO mapreduce.Job:  map 54% reduce 15%
16/12/06 18:48:33 INFO mapreduce.Job:  map 56% reduce 15%
16/12/06 18:48:34 INFO mapreduce.Job:  map 58% reduce 15%
16/12/06 18:48:35 INFO mapreduce.Job:  map 58% reduce 17%
16/12/06 18:48:37 INFO mapreduce.Job:  map 58% reduce 18%
16/12/06 18:48:38 INFO mapreduce.Job:  map 59% reduce 18%
16/12/06 18:48:40 INFO mapreduce.Job:  map 59% reduce 19%
16/12/06 18:48:41 INFO mapreduce.Job:  map 60% reduce 19%
16/12/06 18:48:42 INFO mapreduce.Job:  map 62% reduce 20%
16/12/06 18:48:43 INFO mapreduce.Job:  map 65% reduce 20%
16/12/06 18:48:45 INFO mapreduce.Job:  map 68% reduce 21%
16/12/06 18:48:46 INFO mapreduce.Job:  map 70% reduce 21%
16/12/06 18:48:47 INFO mapreduce.Job:  map 72% reduce 22%
16/12/06 18:48:48 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 18:48:49 INFO mapreduce.Job:  map 76% reduce 24%
16/12/06 18:48:50 INFO mapreduce.Job:  map 80% reduce 24%
16/12/06 18:48:51 INFO mapreduce.Job:  map 83% reduce 25%
16/12/06 18:48:52 INFO mapreduce.Job:  map 83% reduce 26%
16/12/06 18:48:53 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 18:48:54 INFO mapreduce.Job:  map 86% reduce 28%
16/12/06 18:48:55 INFO mapreduce.Job:  map 87% reduce 28%
16/12/06 18:48:56 INFO mapreduce.Job:  map 89% reduce 28%
16/12/06 18:48:57 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 18:48:58 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 18:48:59 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 18:49:00 INFO mapreduce.Job:  map 94% reduce 31%
16/12/06 18:49:01 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 18:49:02 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 18:49:03 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 18:49:04 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 18:49:05 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 18:49:06 INFO mapreduce.Job:  map 100% reduce 49%
16/12/06 18:49:07 INFO mapreduce.Job:  map 100% reduce 59%
16/12/06 18:49:08 INFO mapreduce.Job:  map 100% reduce 62%
16/12/06 18:49:09 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 18:49:10 INFO mapreduce.Job:  map 100% reduce 84%
16/12/06 18:49:11 INFO mapreduce.Job:  map 100% reduce 85%
16/12/06 18:49:12 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 18:49:13 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 18:49:14 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 18:49:15 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 18:49:16 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 18:49:17 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 18:49:18 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 18:49:19 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 18:49:21 INFO mapreduce.Job: Job job_1480588584072_4813 completed successfully
16/12/06 18:49:21 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=553121375
		FILE: Number of bytes written=1138624715
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=460417233
		WASB: Number of bytes written=313348521
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12182010
		Total time spent by all reduces in occupied slots (ms)=2723502
		Total time spent by all map tasks (ms)=6091005
		Total time spent by all reduce tasks (ms)=1361751
		Total vcore-seconds taken by all map tasks=6091005
		Total vcore-seconds taken by all reduce tasks=1361751
		Total megabyte-seconds taken by all map tasks=6237189120
		Total megabyte-seconds taken by all reduce tasks=1394433024
	Map-Reduce Framework
		Map input records=1446921
		Map output records=1336867
		Map output bytes=547954498
		Map output materialized bytes=553144895
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1180067
		Reduce shuffle bytes=553144895
		Reduce input records=1336867
		Reduce output records=919585
		Spilled Records=2673734
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=85761
		CPU time spent (ms)=838120
		Physical memory (bytes) snapshot=323418476544
		Virtual memory (bytes) snapshot=742501613568
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=457721229
	File Output Format Counters 
		Bytes Written=313348521
16/12/06 18:49:21 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161203/2300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161203/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8588458793358648358.jar tmpDir=null
16/12/06 18:49:58 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:49:59 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:49:59 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 18:50:01 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 18:50:01 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 18:50:01 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4815
16/12/06 18:50:02 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4815
16/12/06 18:50:02 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4815/
16/12/06 18:50:02 INFO mapreduce.Job: Running job: job_1480588584072_4815
16/12/06 18:50:14 INFO mapreduce.Job: Job job_1480588584072_4815 running in uber mode : false
16/12/06 18:50:14 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 18:50:39 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 18:50:40 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 18:50:41 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 18:50:42 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 18:50:43 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 18:50:44 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 18:50:45 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 18:50:46 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 18:50:47 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 18:50:48 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 18:50:50 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 18:50:52 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 18:50:53 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 18:50:57 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 18:50:58 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 18:51:00 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 18:51:01 INFO mapreduce.Job:  map 29% reduce 0%
16/12/06 18:51:02 INFO mapreduce.Job:  map 33% reduce 1%
16/12/06 18:51:04 INFO mapreduce.Job:  map 34% reduce 1%
16/12/06 18:51:05 INFO mapreduce.Job:  map 39% reduce 1%
16/12/06 18:51:06 INFO mapreduce.Job:  map 42% reduce 2%
16/12/06 18:51:08 INFO mapreduce.Job:  map 47% reduce 6%
16/12/06 18:51:09 INFO mapreduce.Job:  map 51% reduce 9%
16/12/06 18:51:10 INFO mapreduce.Job:  map 52% reduce 10%
16/12/06 18:51:11 INFO mapreduce.Job:  map 53% reduce 12%
16/12/06 18:51:12 INFO mapreduce.Job:  map 55% reduce 13%
16/12/06 18:51:13 INFO mapreduce.Job:  map 56% reduce 15%
16/12/06 18:51:15 INFO mapreduce.Job:  map 57% reduce 15%
16/12/06 18:51:16 INFO mapreduce.Job:  map 57% reduce 17%
16/12/06 18:51:17 INFO mapreduce.Job:  map 59% reduce 17%
16/12/06 18:51:20 INFO mapreduce.Job:  map 60% reduce 18%
16/12/06 18:51:21 INFO mapreduce.Job:  map 62% reduce 18%
16/12/06 18:51:22 INFO mapreduce.Job:  map 64% reduce 18%
16/12/06 18:51:23 INFO mapreduce.Job:  map 65% reduce 19%
16/12/06 18:51:24 INFO mapreduce.Job:  map 66% reduce 19%
16/12/06 18:51:26 INFO mapreduce.Job:  map 67% reduce 20%
16/12/06 18:51:27 INFO mapreduce.Job:  map 68% reduce 20%
16/12/06 18:51:28 INFO mapreduce.Job:  map 70% reduce 21%
16/12/06 18:51:30 INFO mapreduce.Job:  map 73% reduce 22%
16/12/06 18:51:31 INFO mapreduce.Job:  map 75% reduce 22%
16/12/06 18:51:32 INFO mapreduce.Job:  map 77% reduce 23%
16/12/06 18:51:33 INFO mapreduce.Job:  map 81% reduce 23%
16/12/06 18:51:34 INFO mapreduce.Job:  map 87% reduce 26%
16/12/06 18:51:35 INFO mapreduce.Job:  map 89% reduce 27%
16/12/06 18:51:36 INFO mapreduce.Job:  map 90% reduce 28%
16/12/06 18:51:37 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 18:51:38 INFO mapreduce.Job:  map 90% reduce 30%
16/12/06 18:51:39 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 18:51:40 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 18:51:41 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 18:51:43 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 18:51:44 INFO mapreduce.Job:  map 99% reduce 31%
16/12/06 18:51:45 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 18:51:46 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 18:51:47 INFO mapreduce.Job:  map 100% reduce 42%
16/12/06 18:51:48 INFO mapreduce.Job:  map 100% reduce 50%
16/12/06 18:51:49 INFO mapreduce.Job:  map 100% reduce 63%
16/12/06 18:51:50 INFO mapreduce.Job:  map 100% reduce 79%
16/12/06 18:51:51 INFO mapreduce.Job:  map 100% reduce 84%
16/12/06 18:51:52 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 18:51:53 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 18:51:56 INFO mapreduce.Job: Job job_1480588584072_4815 completed successfully
16/12/06 18:51:56 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=361076798
		FILE: Number of bytes written=754535561
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=299910930
		WASB: Number of bytes written=207202437
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=11402186
		Total time spent by all reduces in occupied slots (ms)=2410596
		Total time spent by all map tasks (ms)=5701093
		Total time spent by all reduce tasks (ms)=1205298
		Total vcore-seconds taken by all map tasks=5701093
		Total vcore-seconds taken by all reduce tasks=1205298
		Total megabyte-seconds taken by all map tasks=5837919232
		Total megabyte-seconds taken by all reduce tasks=1234225152
	Map-Reduce Framework
		Map input records=939461
		Map output records=872946
		Map output bytes=357705615
		Map output materialized bytes=361100318
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=774243
		Reduce shuffle bytes=361100318
		Reduce input records=872946
		Reduce output records=607998
		Spilled Records=1745892
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=69214
		CPU time spent (ms)=731250
		Physical memory (bytes) snapshot=322817024000
		Virtual memory (bytes) snapshot=742558437376
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=297214926
	File Output Format Counters 
		Bytes Written=207202437
16/12/06 18:51:56 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3865560761536536012.jar tmpDir=null
16/12/06 18:52:33 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:52:34 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:52:34 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 18:52:36 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 18:52:36 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 18:52:36 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4818
16/12/06 18:52:37 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4818
16/12/06 18:52:37 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4818/
16/12/06 18:52:37 INFO mapreduce.Job: Running job: job_1480588584072_4818
16/12/06 18:52:49 INFO mapreduce.Job: Job job_1480588584072_4818 running in uber mode : false
16/12/06 18:52:49 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 18:53:11 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 18:53:14 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 18:53:15 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 18:53:16 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 18:53:17 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 18:53:18 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 18:53:19 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 18:53:20 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 18:53:22 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 18:53:24 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 18:53:27 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 18:53:33 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 18:53:34 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 18:53:35 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 18:53:37 INFO mapreduce.Job:  map 32% reduce 0%
16/12/06 18:53:38 INFO mapreduce.Job:  map 37% reduce 1%
16/12/06 18:53:39 INFO mapreduce.Job:  map 43% reduce 1%
16/12/06 18:53:40 INFO mapreduce.Job:  map 44% reduce 4%
16/12/06 18:53:41 INFO mapreduce.Job:  map 48% reduce 5%
16/12/06 18:53:42 INFO mapreduce.Job:  map 49% reduce 6%
16/12/06 18:53:43 INFO mapreduce.Job:  map 50% reduce 8%
16/12/06 18:53:44 INFO mapreduce.Job:  map 51% reduce 10%
16/12/06 18:53:45 INFO mapreduce.Job:  map 53% reduce 10%
16/12/06 18:53:46 INFO mapreduce.Job:  map 56% reduce 12%
16/12/06 18:53:47 INFO mapreduce.Job:  map 57% reduce 14%
16/12/06 18:53:48 INFO mapreduce.Job:  map 57% reduce 15%
16/12/06 18:53:49 INFO mapreduce.Job:  map 58% reduce 15%
16/12/06 18:53:50 INFO mapreduce.Job:  map 59% reduce 16%
16/12/06 18:53:51 INFO mapreduce.Job:  map 60% reduce 16%
16/12/06 18:53:52 INFO mapreduce.Job:  map 63% reduce 16%
16/12/06 18:53:53 INFO mapreduce.Job:  map 65% reduce 17%
16/12/06 18:53:54 INFO mapreduce.Job:  map 66% reduce 18%
16/12/06 18:53:55 INFO mapreduce.Job:  map 67% reduce 18%
16/12/06 18:53:56 INFO mapreduce.Job:  map 67% reduce 19%
16/12/06 18:53:58 INFO mapreduce.Job:  map 68% reduce 19%
16/12/06 18:53:59 INFO mapreduce.Job:  map 70% reduce 19%
16/12/06 18:54:00 INFO mapreduce.Job:  map 70% reduce 20%
16/12/06 18:54:02 INFO mapreduce.Job:  map 71% reduce 22%
16/12/06 18:54:03 INFO mapreduce.Job:  map 74% reduce 22%
16/12/06 18:54:04 INFO mapreduce.Job:  map 76% reduce 23%
16/12/06 18:54:05 INFO mapreduce.Job:  map 78% reduce 23%
16/12/06 18:54:06 INFO mapreduce.Job:  map 81% reduce 26%
16/12/06 18:54:07 INFO mapreduce.Job:  map 86% reduce 26%
16/12/06 18:54:08 INFO mapreduce.Job:  map 89% reduce 27%
16/12/06 18:54:09 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 18:54:10 INFO mapreduce.Job:  map 90% reduce 30%
16/12/06 18:54:11 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 18:54:15 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 18:54:17 INFO mapreduce.Job:  map 93% reduce 31%
16/12/06 18:54:18 INFO mapreduce.Job:  map 94% reduce 31%
16/12/06 18:54:19 INFO mapreduce.Job:  map 98% reduce 31%
16/12/06 18:54:20 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 18:54:21 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 18:54:22 INFO mapreduce.Job:  map 100% reduce 39%
16/12/06 18:54:23 INFO mapreduce.Job:  map 100% reduce 47%
16/12/06 18:54:24 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 18:54:25 INFO mapreduce.Job:  map 100% reduce 80%
16/12/06 18:54:26 INFO mapreduce.Job:  map 100% reduce 85%
16/12/06 18:54:27 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 18:54:28 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 18:54:30 INFO mapreduce.Job: Job job_1480588584072_4818 completed successfully
16/12/06 18:54:30 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=227041862
		FILE: Number of bytes written=486465689
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=190297704
		WASB: Number of bytes written=123868526
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=11148520
		Total time spent by all reduces in occupied slots (ms)=2423986
		Total time spent by all map tasks (ms)=5574260
		Total time spent by all reduce tasks (ms)=1211993
		Total vcore-seconds taken by all map tasks=5574260
		Total vcore-seconds taken by all reduce tasks=1211993
		Total megabyte-seconds taken by all map tasks=5708042240
		Total megabyte-seconds taken by all reduce tasks=1241080832
	Map-Reduce Framework
		Map input records=605181
		Map output records=556067
		Map output bytes=224905956
		Map output materialized bytes=227065382
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=491271
		Reduce shuffle bytes=227065382
		Reduce input records=556067
		Reduce output records=369555
		Spilled Records=1112134
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=70373
		CPU time spent (ms)=672170
		Physical memory (bytes) snapshot=322111643648
		Virtual memory (bytes) snapshot=742653935616
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=187601700
	File Output Format Counters 
		Bytes Written=123868526
16/12/06 18:54:30 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1975490426444762059.jar tmpDir=null
16/12/06 18:55:07 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:55:08 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:55:08 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 18:55:10 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 18:55:10 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 18:55:10 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4821
16/12/06 18:55:11 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4821
16/12/06 18:55:11 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4821/
16/12/06 18:55:11 INFO mapreduce.Job: Running job: job_1480588584072_4821
16/12/06 18:55:27 INFO mapreduce.Job: Job job_1480588584072_4821 running in uber mode : false
16/12/06 18:55:27 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 18:55:49 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 18:55:50 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 18:55:52 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 18:55:53 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 18:55:54 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 18:55:55 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 18:55:56 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 18:55:58 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 18:55:59 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 18:56:00 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 18:56:01 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 18:56:02 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 18:56:11 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 18:56:12 INFO mapreduce.Job:  map 30% reduce 0%
16/12/06 18:56:13 INFO mapreduce.Job:  map 32% reduce 0%
16/12/06 18:56:14 INFO mapreduce.Job:  map 40% reduce 0%
16/12/06 18:56:15 INFO mapreduce.Job:  map 45% reduce 1%
16/12/06 18:56:16 INFO mapreduce.Job:  map 48% reduce 2%
16/12/06 18:56:17 INFO mapreduce.Job:  map 48% reduce 4%
16/12/06 18:56:18 INFO mapreduce.Job:  map 49% reduce 9%
16/12/06 18:56:19 INFO mapreduce.Job:  map 50% reduce 9%
16/12/06 18:56:20 INFO mapreduce.Job:  map 52% reduce 10%
16/12/06 18:56:21 INFO mapreduce.Job:  map 55% reduce 13%
16/12/06 18:56:23 INFO mapreduce.Job:  map 57% reduce 13%
16/12/06 18:56:24 INFO mapreduce.Job:  map 57% reduce 14%
16/12/06 18:56:25 INFO mapreduce.Job:  map 58% reduce 14%
16/12/06 18:56:26 INFO mapreduce.Job:  map 59% reduce 14%
16/12/06 18:56:27 INFO mapreduce.Job:  map 62% reduce 15%
16/12/06 18:56:28 INFO mapreduce.Job:  map 63% reduce 15%
16/12/06 18:56:30 INFO mapreduce.Job:  map 64% reduce 16%
16/12/06 18:56:31 INFO mapreduce.Job:  map 65% reduce 16%
16/12/06 18:56:34 INFO mapreduce.Job:  map 66% reduce 16%
16/12/06 18:56:35 INFO mapreduce.Job:  map 69% reduce 16%
16/12/06 18:56:36 INFO mapreduce.Job:  map 69% reduce 17%
16/12/06 18:56:37 INFO mapreduce.Job:  map 71% reduce 19%
16/12/06 18:56:38 INFO mapreduce.Job:  map 72% reduce 20%
16/12/06 18:56:39 INFO mapreduce.Job:  map 76% reduce 20%
16/12/06 18:56:41 INFO mapreduce.Job:  map 80% reduce 23%
16/12/06 18:56:42 INFO mapreduce.Job:  map 85% reduce 23%
16/12/06 18:56:43 INFO mapreduce.Job:  map 88% reduce 25%
16/12/06 18:56:44 INFO mapreduce.Job:  map 90% reduce 27%
16/12/06 18:56:46 INFO mapreduce.Job:  map 90% reduce 30%
16/12/06 18:56:48 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 18:56:50 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 18:56:51 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 18:56:52 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 18:56:53 INFO mapreduce.Job:  map 97% reduce 32%
16/12/06 18:56:54 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 18:56:55 INFO mapreduce.Job:  map 100% reduce 39%
16/12/06 18:56:56 INFO mapreduce.Job:  map 100% reduce 58%
16/12/06 18:56:57 INFO mapreduce.Job:  map 100% reduce 75%
16/12/06 18:56:58 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 18:56:59 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 18:57:01 INFO mapreduce.Job: Job job_1480588584072_4821 completed successfully
16/12/06 18:57:01 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=172850819
		FILE: Number of bytes written=378083603
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=147452223
		WASB: Number of bytes written=84181490
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=10371474
		Total time spent by all reduces in occupied slots (ms)=2209416
		Total time spent by all map tasks (ms)=5185737
		Total time spent by all reduce tasks (ms)=1104708
		Total vcore-seconds taken by all map tasks=5185737
		Total vcore-seconds taken by all reduce tasks=1104708
		Total megabyte-seconds taken by all map tasks=5310194688
		Total megabyte-seconds taken by all reduce tasks=1131220992
	Map-Reduce Framework
		Map input records=473625
		Map output records=425295
		Map output bytes=171212236
		Map output materialized bytes=172874339
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=372710
		Reduce shuffle bytes=172874339
		Reduce input records=425295
		Reduce output records=250308
		Spilled Records=850590
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=73730
		CPU time spent (ms)=644850
		Physical memory (bytes) snapshot=321962532864
		Virtual memory (bytes) snapshot=742443765760
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=144756219
	File Output Format Counters 
		Bytes Written=84181490
16/12/06 18:57:01 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612031900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5610184903469073634.jar tmpDir=null
16/12/06 18:57:38 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:57:39 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 18:57:39 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 18:57:41 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 18:57:41 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 18:57:42 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4825
16/12/06 18:57:43 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4825
16/12/06 18:57:43 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4825/
16/12/06 18:57:43 INFO mapreduce.Job: Running job: job_1480588584072_4825
16/12/06 18:57:55 INFO mapreduce.Job: Job job_1480588584072_4825 running in uber mode : false
16/12/06 18:57:55 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 18:58:19 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 18:58:21 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 18:58:24 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 18:58:25 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 18:58:26 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 18:58:27 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 18:58:28 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 18:58:30 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 18:58:31 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 18:58:33 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 18:58:34 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 18:58:35 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 18:58:36 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 18:58:38 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 18:58:40 INFO mapreduce.Job:  map 29% reduce 0%
16/12/06 18:58:44 INFO mapreduce.Job:  map 39% reduce 0%
16/12/06 18:58:45 INFO mapreduce.Job:  map 45% reduce 0%
16/12/06 18:58:46 INFO mapreduce.Job:  map 46% reduce 1%
16/12/06 18:58:47 INFO mapreduce.Job:  map 48% reduce 1%
16/12/06 18:58:48 INFO mapreduce.Job:  map 52% reduce 4%
16/12/06 18:58:49 INFO mapreduce.Job:  map 53% reduce 4%
16/12/06 18:58:50 INFO mapreduce.Job:  map 54% reduce 5%
16/12/06 18:58:53 INFO mapreduce.Job:  map 55% reduce 5%
16/12/06 18:58:54 INFO mapreduce.Job:  map 56% reduce 5%
16/12/06 18:58:55 INFO mapreduce.Job:  map 58% reduce 6%
16/12/06 18:58:56 INFO mapreduce.Job:  map 59% reduce 6%
16/12/06 18:58:57 INFO mapreduce.Job:  map 62% reduce 9%
16/12/06 18:58:58 INFO mapreduce.Job:  map 63% reduce 11%
16/12/06 18:58:59 INFO mapreduce.Job:  map 64% reduce 12%
16/12/06 18:59:00 INFO mapreduce.Job:  map 64% reduce 13%
16/12/06 18:59:01 INFO mapreduce.Job:  map 64% reduce 17%
16/12/06 18:59:02 INFO mapreduce.Job:  map 65% reduce 17%
16/12/06 18:59:03 INFO mapreduce.Job:  map 67% reduce 18%
16/12/06 18:59:04 INFO mapreduce.Job:  map 67% reduce 20%
16/12/06 18:59:06 INFO mapreduce.Job:  map 68% reduce 20%
16/12/06 18:59:07 INFO mapreduce.Job:  map 72% reduce 20%
16/12/06 18:59:08 INFO mapreduce.Job:  map 77% reduce 22%
16/12/06 18:59:09 INFO mapreduce.Job:  map 81% reduce 23%
16/12/06 18:59:10 INFO mapreduce.Job:  map 83% reduce 25%
16/12/06 18:59:11 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 18:59:12 INFO mapreduce.Job:  map 89% reduce 27%
16/12/06 18:59:13 INFO mapreduce.Job:  map 91% reduce 28%
16/12/06 18:59:14 INFO mapreduce.Job:  map 93% reduce 29%
16/12/06 18:59:15 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 18:59:16 INFO mapreduce.Job:  map 94% reduce 31%
16/12/06 18:59:17 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 18:59:18 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 18:59:19 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 18:59:21 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 18:59:22 INFO mapreduce.Job:  map 100% reduce 43%
16/12/06 18:59:23 INFO mapreduce.Job:  map 100% reduce 57%
16/12/06 18:59:24 INFO mapreduce.Job:  map 100% reduce 66%
16/12/06 18:59:25 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 18:59:26 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 18:59:28 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 18:59:30 INFO mapreduce.Job: Job job_1480588584072_4825 completed successfully
16/12/06 18:59:31 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=169625536
		FILE: Number of bytes written=371633037
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=146264552
		WASB: Number of bytes written=71012314
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=10698536
		Total time spent by all reduces in occupied slots (ms)=2122200
		Total time spent by all map tasks (ms)=5349268
		Total time spent by all reduce tasks (ms)=1061100
		Total vcore-seconds taken by all map tasks=5349268
		Total vcore-seconds taken by all reduce tasks=1061100
		Total megabyte-seconds taken by all map tasks=5477650432
		Total megabyte-seconds taken by all reduce tasks=1086566400
	Map-Reduce Framework
		Map input records=476307
		Map output records=420036
		Map output bytes=168003960
		Map output materialized bytes=169649056
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=362538
		Reduce shuffle bytes=169649056
		Reduce input records=420036
		Reduce output records=211911
		Spilled Records=840072
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=71998
		CPU time spent (ms)=643970
		Physical memory (bytes) snapshot=321970769920
		Virtual memory (bytes) snapshot=742463393792
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=143568548
	File Output Format Counters 
		Bytes Written=71012314
16/12/06 18:59:31 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0400 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0400': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3308706409250219472.jar tmpDir=null
16/12/06 19:00:08 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:00:09 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:00:10 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 19:00:12 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 19:00:12 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 19:00:13 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4829
16/12/06 19:00:14 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4829
16/12/06 19:00:14 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4829/
16/12/06 19:00:14 INFO mapreduce.Job: Running job: job_1480588584072_4829
16/12/06 19:00:27 INFO mapreduce.Job: Job job_1480588584072_4829 running in uber mode : false
16/12/06 19:00:27 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 19:00:37 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 19:00:45 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 19:00:53 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 19:00:56 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 19:00:57 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 19:01:01 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 19:01:02 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 19:01:03 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 19:01:06 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 19:01:07 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 19:01:08 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 19:01:09 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 19:01:11 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 19:01:12 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 19:01:13 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 19:01:14 INFO mapreduce.Job:  map 31% reduce 0%
16/12/06 19:01:15 INFO mapreduce.Job:  map 34% reduce 2%
16/12/06 19:01:16 INFO mapreduce.Job:  map 37% reduce 3%
16/12/06 19:01:17 INFO mapreduce.Job:  map 40% reduce 3%
16/12/06 19:01:18 INFO mapreduce.Job:  map 43% reduce 5%
16/12/06 19:01:19 INFO mapreduce.Job:  map 44% reduce 5%
16/12/06 19:01:20 INFO mapreduce.Job:  map 46% reduce 6%
16/12/06 19:01:21 INFO mapreduce.Job:  map 48% reduce 6%
16/12/06 19:01:22 INFO mapreduce.Job:  map 50% reduce 7%
16/12/06 19:01:23 INFO mapreduce.Job:  map 51% reduce 7%
16/12/06 19:01:24 INFO mapreduce.Job:  map 52% reduce 7%
16/12/06 19:01:25 INFO mapreduce.Job:  map 53% reduce 8%
16/12/06 19:01:30 INFO mapreduce.Job:  map 55% reduce 10%
16/12/06 19:01:31 INFO mapreduce.Job:  map 56% reduce 10%
16/12/06 19:01:32 INFO mapreduce.Job:  map 57% reduce 10%
16/12/06 19:01:33 INFO mapreduce.Job:  map 57% reduce 11%
16/12/06 19:01:34 INFO mapreduce.Job:  map 59% reduce 12%
16/12/06 19:01:35 INFO mapreduce.Job:  map 60% reduce 14%
16/12/06 19:01:36 INFO mapreduce.Job:  map 61% reduce 15%
16/12/06 19:01:37 INFO mapreduce.Job:  map 61% reduce 16%
16/12/06 19:01:39 INFO mapreduce.Job:  map 62% reduce 16%
16/12/06 19:01:40 INFO mapreduce.Job:  map 63% reduce 17%
16/12/06 19:01:41 INFO mapreduce.Job:  map 66% reduce 19%
16/12/06 19:01:42 INFO mapreduce.Job:  map 67% reduce 21%
16/12/06 19:01:43 INFO mapreduce.Job:  map 69% reduce 22%
16/12/06 19:01:44 INFO mapreduce.Job:  map 70% reduce 22%
16/12/06 19:01:45 INFO mapreduce.Job:  map 71% reduce 23%
16/12/06 19:01:46 INFO mapreduce.Job:  map 75% reduce 23%
16/12/06 19:01:47 INFO mapreduce.Job:  map 77% reduce 24%
16/12/06 19:01:48 INFO mapreduce.Job:  map 81% reduce 25%
16/12/06 19:01:49 INFO mapreduce.Job:  map 85% reduce 26%
16/12/06 19:01:50 INFO mapreduce.Job:  map 89% reduce 27%
16/12/06 19:01:51 INFO mapreduce.Job:  map 90% reduce 28%
16/12/06 19:01:52 INFO mapreduce.Job:  map 91% reduce 29%
16/12/06 19:01:53 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 19:01:54 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 19:01:55 INFO mapreduce.Job:  map 94% reduce 31%
16/12/06 19:01:56 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 19:01:57 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 19:02:00 INFO mapreduce.Job:  map 99% reduce 33%
16/12/06 19:02:02 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 19:02:04 INFO mapreduce.Job:  map 100% reduce 40%
16/12/06 19:02:05 INFO mapreduce.Job:  map 100% reduce 45%
16/12/06 19:02:06 INFO mapreduce.Job:  map 100% reduce 68%
16/12/06 19:02:07 INFO mapreduce.Job:  map 100% reduce 81%
16/12/06 19:02:08 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 19:02:09 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 19:02:10 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 19:02:11 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 19:02:13 INFO mapreduce.Job: Job job_1480588584072_4829 completed successfully
16/12/06 19:02:13 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=236477230
		FILE: Number of bytes written=505336425
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=205546843
		WASB: Number of bytes written=101652926
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=11324958
		Total time spent by all reduces in occupied slots (ms)=2512862
		Total time spent by all map tasks (ms)=5662479
		Total time spent by all reduce tasks (ms)=1256431
		Total vcore-seconds taken by all map tasks=5662479
		Total vcore-seconds taken by all reduce tasks=1256431
		Total megabyte-seconds taken by all map tasks=5798378496
		Total megabyte-seconds taken by all reduce tasks=1286585344
	Map-Reduce Framework
		Map input records=671799
		Map output records=584843
		Map output bytes=234221653
		Map output materialized bytes=236500750
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=504901
		Reduce shuffle bytes=236500750
		Reduce input records=584843
		Reduce output records=303878
		Spilled Records=1169686
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=70291
		CPU time spent (ms)=707540
		Physical memory (bytes) snapshot=322398044160
		Virtual memory (bytes) snapshot=742633676800
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=202850839
	File Output Format Counters 
		Bytes Written=101652926
16/12/06 19:02:13 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0400
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0500 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0500': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5354027148874331940.jar tmpDir=null
16/12/06 19:02:49 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:02:50 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:02:51 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 19:02:52 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 19:02:53 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 19:02:53 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4835
16/12/06 19:02:54 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4835
16/12/06 19:02:54 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4835/
16/12/06 19:02:54 INFO mapreduce.Job: Running job: job_1480588584072_4835
16/12/06 19:04:54 INFO mapreduce.Job: Job job_1480588584072_4835 running in uber mode : false
16/12/06 19:04:54 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 19:05:18 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 19:05:20 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 19:05:23 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 19:05:25 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 19:05:26 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 19:05:27 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 19:05:28 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 19:05:29 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 19:05:30 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 19:05:33 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 19:05:34 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 19:05:35 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 19:05:36 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 19:05:37 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 19:05:38 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 19:05:41 INFO mapreduce.Job:  map 31% reduce 0%
16/12/06 19:05:42 INFO mapreduce.Job:  map 33% reduce 0%
16/12/06 19:05:43 INFO mapreduce.Job:  map 39% reduce 0%
16/12/06 19:05:44 INFO mapreduce.Job:  map 41% reduce 0%
16/12/06 19:05:45 INFO mapreduce.Job:  map 43% reduce 2%
16/12/06 19:05:46 INFO mapreduce.Job:  map 44% reduce 4%
16/12/06 19:05:47 INFO mapreduce.Job:  map 45% reduce 4%
16/12/06 19:05:48 INFO mapreduce.Job:  map 47% reduce 7%
16/12/06 19:05:49 INFO mapreduce.Job:  map 48% reduce 7%
16/12/06 19:05:50 INFO mapreduce.Job:  map 50% reduce 7%
16/12/06 19:05:51 INFO mapreduce.Job:  map 52% reduce 8%
16/12/06 19:05:53 INFO mapreduce.Job:  map 53% reduce 8%
16/12/06 19:05:54 INFO mapreduce.Job:  map 54% reduce 9%
16/12/06 19:05:55 INFO mapreduce.Job:  map 55% reduce 13%
16/12/06 19:05:56 INFO mapreduce.Job:  map 56% reduce 14%
16/12/06 19:05:57 INFO mapreduce.Job:  map 58% reduce 15%
16/12/06 19:05:58 INFO mapreduce.Job:  map 59% reduce 15%
16/12/06 19:05:59 INFO mapreduce.Job:  map 60% reduce 15%
16/12/06 19:06:00 INFO mapreduce.Job:  map 61% reduce 16%
16/12/06 19:06:01 INFO mapreduce.Job:  map 61% reduce 18%
16/12/06 19:06:02 INFO mapreduce.Job:  map 64% reduce 19%
16/12/06 19:06:03 INFO mapreduce.Job:  map 68% reduce 19%
16/12/06 19:06:04 INFO mapreduce.Job:  map 71% reduce 22%
16/12/06 19:06:05 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 19:06:06 INFO mapreduce.Job:  map 74% reduce 23%
16/12/06 19:06:07 INFO mapreduce.Job:  map 75% reduce 24%
16/12/06 19:06:08 INFO mapreduce.Job:  map 76% reduce 25%
16/12/06 19:06:09 INFO mapreduce.Job:  map 77% reduce 25%
16/12/06 19:06:11 INFO mapreduce.Job:  map 79% reduce 26%
16/12/06 19:06:12 INFO mapreduce.Job:  map 80% reduce 26%
16/12/06 19:06:13 INFO mapreduce.Job:  map 81% reduce 26%
16/12/06 19:06:14 INFO mapreduce.Job:  map 83% reduce 27%
16/12/06 19:06:15 INFO mapreduce.Job:  map 87% reduce 27%
16/12/06 19:06:16 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 19:06:17 INFO mapreduce.Job:  map 88% reduce 29%
16/12/06 19:06:18 INFO mapreduce.Job:  map 89% reduce 29%
16/12/06 19:06:19 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 19:06:20 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 19:06:21 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 19:06:22 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 19:06:23 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 19:06:25 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 19:06:26 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 19:06:28 INFO mapreduce.Job:  map 99% reduce 33%
16/12/06 19:06:29 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 19:06:31 INFO mapreduce.Job:  map 100% reduce 40%
16/12/06 19:06:32 INFO mapreduce.Job:  map 100% reduce 62%
16/12/06 19:06:34 INFO mapreduce.Job:  map 100% reduce 65%
16/12/06 19:06:35 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 19:06:36 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 19:06:37 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 19:06:38 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 19:06:39 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 19:06:40 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 19:06:41 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 19:06:43 INFO mapreduce.Job: Job job_1480588584072_4835 completed successfully
16/12/06 19:06:43 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=367428483
		FILE: Number of bytes written=767238931
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=315530793
		WASB: Number of bytes written=178650450
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=10707880
		Total time spent by all reduces in occupied slots (ms)=2614184
		Total time spent by all map tasks (ms)=5353940
		Total time spent by all reduce tasks (ms)=1307092
		Total vcore-seconds taken by all map tasks=5353940
		Total vcore-seconds taken by all reduce tasks=1307092
		Total megabyte-seconds taken by all map tasks=5482434560
		Total megabyte-seconds taken by all reduce tasks=1338462208
	Map-Reduce Framework
		Map input records=1020213
		Map output records=901591
		Map output bytes=363952713
		Map output materialized bytes=367452003
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=784950
		Reduce shuffle bytes=367452003
		Reduce input records=901591
		Reduce output records=530814
		Spilled Records=1803182
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=67535
		CPU time spent (ms)=779510
		Physical memory (bytes) snapshot=322881961984
		Virtual memory (bytes) snapshot=742454075392
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=312834789
	File Output Format Counters 
		Bytes Written=178650450
16/12/06 19:06:43 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0500
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0600 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0600': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2802077676822670037.jar tmpDir=null
16/12/06 19:07:22 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:07:23 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:07:23 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 19:07:25 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 19:07:25 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 19:07:26 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4843
16/12/06 19:07:27 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4843
16/12/06 19:07:27 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4843/
16/12/06 19:07:27 INFO mapreduce.Job: Running job: job_1480588584072_4843
16/12/06 19:07:41 INFO mapreduce.Job: Job job_1480588584072_4843 running in uber mode : false
16/12/06 19:07:41 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 19:07:55 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 19:08:10 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 19:08:26 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 19:08:40 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 19:08:56 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 19:09:13 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 19:09:28 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 19:09:43 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 19:09:48 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 19:09:49 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 19:09:50 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 19:09:58 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 19:10:02 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 19:10:05 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 19:10:06 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 19:10:07 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 19:10:09 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 19:10:10 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 19:10:11 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 19:10:13 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 19:10:15 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 19:10:16 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 19:10:18 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 19:10:19 INFO mapreduce.Job:  map 27% reduce 1%
16/12/06 19:10:20 INFO mapreduce.Job:  map 31% reduce 2%
16/12/06 19:10:21 INFO mapreduce.Job:  map 32% reduce 3%
16/12/06 19:10:22 INFO mapreduce.Job:  map 32% reduce 4%
16/12/06 19:10:23 INFO mapreduce.Job:  map 34% reduce 4%
16/12/06 19:10:24 INFO mapreduce.Job:  map 36% reduce 5%
16/12/06 19:10:25 INFO mapreduce.Job:  map 38% reduce 5%
16/12/06 19:10:26 INFO mapreduce.Job:  map 40% reduce 6%
16/12/06 19:10:27 INFO mapreduce.Job:  map 43% reduce 7%
16/12/06 19:10:28 INFO mapreduce.Job:  map 48% reduce 9%
16/12/06 19:10:29 INFO mapreduce.Job:  map 52% reduce 9%
16/12/06 19:10:30 INFO mapreduce.Job:  map 53% reduce 10%
16/12/06 19:10:31 INFO mapreduce.Job:  map 54% reduce 11%
16/12/06 19:10:32 INFO mapreduce.Job:  map 55% reduce 12%
16/12/06 19:10:33 INFO mapreduce.Job:  map 57% reduce 15%
16/12/06 19:10:34 INFO mapreduce.Job:  map 58% reduce 16%
16/12/06 19:10:36 INFO mapreduce.Job:  map 59% reduce 17%
16/12/06 19:10:37 INFO mapreduce.Job:  map 61% reduce 17%
16/12/06 19:10:38 INFO mapreduce.Job:  map 62% reduce 18%
16/12/06 19:10:39 INFO mapreduce.Job:  map 62% reduce 19%
16/12/06 19:10:41 INFO mapreduce.Job:  map 63% reduce 19%
16/12/06 19:10:42 INFO mapreduce.Job:  map 63% reduce 21%
16/12/06 19:10:43 INFO mapreduce.Job:  map 64% reduce 21%
16/12/06 19:10:44 INFO mapreduce.Job:  map 65% reduce 21%
16/12/06 19:10:45 INFO mapreduce.Job:  map 67% reduce 21%
16/12/06 19:10:46 INFO mapreduce.Job:  map 68% reduce 22%
16/12/06 19:10:48 INFO mapreduce.Job:  map 69% reduce 22%
16/12/06 19:10:49 INFO mapreduce.Job:  map 71% reduce 23%
16/12/06 19:10:50 INFO mapreduce.Job:  map 74% reduce 23%
16/12/06 19:10:51 INFO mapreduce.Job:  map 77% reduce 23%
16/12/06 19:10:52 INFO mapreduce.Job:  map 82% reduce 24%
16/12/06 19:10:53 INFO mapreduce.Job:  map 86% reduce 25%
16/12/06 19:10:54 INFO mapreduce.Job:  map 89% reduce 26%
16/12/06 19:10:55 INFO mapreduce.Job:  map 92% reduce 29%
16/12/06 19:10:57 INFO mapreduce.Job:  map 95% reduce 29%
16/12/06 19:10:58 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 19:10:59 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 19:11:00 INFO mapreduce.Job:  map 97% reduce 32%
16/12/06 19:11:02 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 19:11:03 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 19:11:04 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 19:11:05 INFO mapreduce.Job:  map 100% reduce 39%
16/12/06 19:11:06 INFO mapreduce.Job:  map 100% reduce 44%
16/12/06 19:11:07 INFO mapreduce.Job:  map 100% reduce 59%
16/12/06 19:11:08 INFO mapreduce.Job:  map 100% reduce 75%
16/12/06 19:11:09 INFO mapreduce.Job:  map 100% reduce 83%
16/12/06 19:11:10 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 19:11:11 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 19:11:12 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 19:11:15 INFO mapreduce.Job: Job job_1480588584072_4843 completed successfully
16/12/06 19:11:15 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=480249149
		FILE: Number of bytes written=992880263
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=413052104
		WASB: Number of bytes written=238155796
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=7826900
		Total time spent by all reduces in occupied slots (ms)=2588210
		Total time spent by all map tasks (ms)=3913450
		Total time spent by all reduce tasks (ms)=1294105
		Total vcore-seconds taken by all map tasks=3913450
		Total vcore-seconds taken by all reduce tasks=1294105
		Total megabyte-seconds taken by all map tasks=4007372800
		Total megabyte-seconds taken by all reduce tasks=1325163520
	Map-Reduce Framework
		Map input records=1329752
		Map output records=1174100
		Map output bytes=475717503
		Map output materialized bytes=480272669
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1024398
		Reduce shuffle bytes=480272669
		Reduce input records=1174100
		Reduce output records=702317
		Spilled Records=2348200
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=66168
		CPU time spent (ms)=808650
		Physical memory (bytes) snapshot=323433959424
		Virtual memory (bytes) snapshot=742666145792
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=410356100
	File Output Format Counters 
		Bytes Written=238155796
16/12/06 19:11:15 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0600
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0700 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161203/201612032300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0700': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob43219304136793908.jar tmpDir=null
16/12/06 19:11:52 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:11:53 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:11:53 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 19:11:55 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 19:11:55 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 19:11:55 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4848
16/12/06 19:11:56 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4848
16/12/06 19:11:56 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4848/
16/12/06 19:11:56 INFO mapreduce.Job: Running job: job_1480588584072_4848
16/12/06 19:12:19 INFO mapreduce.Job: Job job_1480588584072_4848 running in uber mode : false
16/12/06 19:12:19 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 19:12:32 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 19:12:33 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 19:12:40 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 19:12:41 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 19:12:47 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 19:12:48 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 19:12:49 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 19:12:50 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 19:12:52 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 19:12:57 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 19:13:01 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 19:13:03 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 19:13:04 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 19:13:05 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 19:13:06 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 19:13:07 INFO mapreduce.Job:  map 25% reduce 1%
16/12/06 19:13:08 INFO mapreduce.Job:  map 29% reduce 1%
16/12/06 19:13:09 INFO mapreduce.Job:  map 33% reduce 1%
16/12/06 19:13:10 INFO mapreduce.Job:  map 36% reduce 3%
16/12/06 19:13:11 INFO mapreduce.Job:  map 39% reduce 4%
16/12/06 19:13:12 INFO mapreduce.Job:  map 42% reduce 5%
16/12/06 19:13:13 INFO mapreduce.Job:  map 46% reduce 5%
16/12/06 19:13:14 INFO mapreduce.Job:  map 49% reduce 6%
16/12/06 19:13:15 INFO mapreduce.Job:  map 50% reduce 6%
16/12/06 19:13:16 INFO mapreduce.Job:  map 52% reduce 8%
16/12/06 19:13:17 INFO mapreduce.Job:  map 53% reduce 8%
16/12/06 19:13:18 INFO mapreduce.Job:  map 54% reduce 9%
16/12/06 19:13:19 INFO mapreduce.Job:  map 54% reduce 10%
16/12/06 19:13:23 INFO mapreduce.Job:  map 55% reduce 10%
16/12/06 19:13:27 INFO mapreduce.Job:  map 56% reduce 10%
16/12/06 19:13:30 INFO mapreduce.Job:  map 56% reduce 11%
16/12/06 19:13:31 INFO mapreduce.Job:  map 56% reduce 12%
16/12/06 19:13:32 INFO mapreduce.Job:  map 57% reduce 12%
16/12/06 19:13:33 INFO mapreduce.Job:  map 57% reduce 13%
16/12/06 19:13:34 INFO mapreduce.Job:  map 59% reduce 14%
16/12/06 19:13:35 INFO mapreduce.Job:  map 60% reduce 14%
16/12/06 19:13:36 INFO mapreduce.Job:  map 61% reduce 17%
16/12/06 19:13:37 INFO mapreduce.Job:  map 64% reduce 18%
16/12/06 19:13:38 INFO mapreduce.Job:  map 65% reduce 20%
16/12/06 19:13:39 INFO mapreduce.Job:  map 69% reduce 21%
16/12/06 19:13:40 INFO mapreduce.Job:  map 72% reduce 22%
16/12/06 19:13:41 INFO mapreduce.Job:  map 76% reduce 22%
16/12/06 19:13:42 INFO mapreduce.Job:  map 80% reduce 23%
16/12/06 19:13:43 INFO mapreduce.Job:  map 82% reduce 25%
16/12/06 19:13:44 INFO mapreduce.Job:  map 84% reduce 26%
16/12/06 19:13:45 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 19:13:46 INFO mapreduce.Job:  map 86% reduce 28%
16/12/06 19:13:47 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 19:13:48 INFO mapreduce.Job:  map 90% reduce 28%
16/12/06 19:13:49 INFO mapreduce.Job:  map 91% reduce 29%
16/12/06 19:13:50 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 19:13:52 INFO mapreduce.Job:  map 94% reduce 31%
16/12/06 19:13:53 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 19:13:55 INFO mapreduce.Job:  map 96% reduce 32%
16/12/06 19:13:56 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 19:13:57 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 19:13:58 INFO mapreduce.Job:  map 99% reduce 33%
16/12/06 19:13:59 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 19:14:00 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 19:14:01 INFO mapreduce.Job:  map 100% reduce 48%
16/12/06 19:14:02 INFO mapreduce.Job:  map 100% reduce 57%
16/12/06 19:14:03 INFO mapreduce.Job:  map 100% reduce 66%
16/12/06 19:14:04 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 19:14:05 INFO mapreduce.Job:  map 100% reduce 82%
16/12/06 19:14:06 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 19:14:07 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 19:14:08 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 19:14:09 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 19:14:10 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 19:14:11 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 19:14:13 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 19:14:15 INFO mapreduce.Job: Job job_1480588584072_4848 completed successfully
16/12/06 19:14:16 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=653022515
		FILE: Number of bytes written=1338426995
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=557683859
		WASB: Number of bytes written=348301980
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12413878
		Total time spent by all reduces in occupied slots (ms)=2698380
		Total time spent by all map tasks (ms)=6206939
		Total time spent by all reduce tasks (ms)=1349190
		Total vcore-seconds taken by all map tasks=6206939
		Total vcore-seconds taken by all reduce tasks=1349190
		Total megabyte-seconds taken by all map tasks=6355905536
		Total megabyte-seconds taken by all reduce tasks=1381570560
	Map-Reduce Framework
		Map input records=1781309
		Map output records=1590263
		Map output bytes=646890072
		Map output materialized bytes=653046035
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1401048
		Reduce shuffle bytes=653046035
		Reduce input records=1590263
		Reduce output records=1025257
		Spilled Records=3180526
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=81888
		CPU time spent (ms)=898330
		Physical memory (bytes) snapshot=324053610496
		Virtual memory (bytes) snapshot=742581428224
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=554987855
	File Output Format Counters 
		Bytes Written=348301980
16/12/06 19:14:16 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0700
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040400 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0800 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040400
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0800': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob582252088981662183.jar tmpDir=null
16/12/06 19:14:53 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:14:53 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:14:54 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 19:14:55 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 19:14:56 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 19:14:56 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4853
16/12/06 19:14:57 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4853
16/12/06 19:14:57 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4853/
16/12/06 19:14:57 INFO mapreduce.Job: Running job: job_1480588584072_4853
16/12/06 19:15:10 INFO mapreduce.Job: Job job_1480588584072_4853 running in uber mode : false
16/12/06 19:15:10 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 19:15:34 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 19:15:35 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 19:15:38 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 19:15:39 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 19:15:40 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 19:15:42 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 19:15:43 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 19:15:44 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 19:15:45 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 19:15:46 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 19:15:50 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 19:15:51 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 19:15:52 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 19:15:54 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 19:15:55 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 19:15:56 INFO mapreduce.Job:  map 29% reduce 0%
16/12/06 19:16:00 INFO mapreduce.Job:  map 35% reduce 0%
16/12/06 19:16:02 INFO mapreduce.Job:  map 42% reduce 1%
16/12/06 19:16:03 INFO mapreduce.Job:  map 47% reduce 2%
16/12/06 19:16:04 INFO mapreduce.Job:  map 50% reduce 3%
16/12/06 19:16:06 INFO mapreduce.Job:  map 51% reduce 4%
16/12/06 19:16:07 INFO mapreduce.Job:  map 53% reduce 7%
16/12/06 19:16:08 INFO mapreduce.Job:  map 54% reduce 9%
16/12/06 19:16:09 INFO mapreduce.Job:  map 55% reduce 10%
16/12/06 19:16:10 INFO mapreduce.Job:  map 57% reduce 12%
16/12/06 19:16:11 INFO mapreduce.Job:  map 57% reduce 13%
16/12/06 19:16:12 INFO mapreduce.Job:  map 58% reduce 14%
16/12/06 19:16:14 INFO mapreduce.Job:  map 60% reduce 14%
16/12/06 19:16:15 INFO mapreduce.Job:  map 62% reduce 16%
16/12/06 19:16:16 INFO mapreduce.Job:  map 62% reduce 17%
16/12/06 19:16:18 INFO mapreduce.Job:  map 63% reduce 17%
16/12/06 19:16:19 INFO mapreduce.Job:  map 64% reduce 19%
16/12/06 19:16:20 INFO mapreduce.Job:  map 64% reduce 20%
16/12/06 19:16:22 INFO mapreduce.Job:  map 64% reduce 21%
16/12/06 19:16:23 INFO mapreduce.Job:  map 65% reduce 21%
16/12/06 19:16:24 INFO mapreduce.Job:  map 68% reduce 21%
16/12/06 19:16:25 INFO mapreduce.Job:  map 70% reduce 22%
16/12/06 19:16:26 INFO mapreduce.Job:  map 75% reduce 22%
16/12/06 19:16:27 INFO mapreduce.Job:  map 76% reduce 23%
16/12/06 19:16:28 INFO mapreduce.Job:  map 79% reduce 25%
16/12/06 19:16:29 INFO mapreduce.Job:  map 81% reduce 25%
16/12/06 19:16:30 INFO mapreduce.Job:  map 85% reduce 26%
16/12/06 19:16:31 INFO mapreduce.Job:  map 87% reduce 27%
16/12/06 19:16:32 INFO mapreduce.Job:  map 90% reduce 28%
16/12/06 19:16:33 INFO mapreduce.Job:  map 92% reduce 28%
16/12/06 19:16:34 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 19:16:36 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 19:16:37 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 19:16:38 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 19:16:39 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 19:16:40 INFO mapreduce.Job:  map 99% reduce 33%
16/12/06 19:16:41 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 19:16:42 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 19:16:43 INFO mapreduce.Job:  map 100% reduce 46%
16/12/06 19:16:44 INFO mapreduce.Job:  map 100% reduce 48%
16/12/06 19:16:46 INFO mapreduce.Job:  map 100% reduce 53%
16/12/06 19:16:47 INFO mapreduce.Job:  map 100% reduce 68%
16/12/06 19:16:48 INFO mapreduce.Job:  map 100% reduce 72%
16/12/06 19:16:49 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 19:16:50 INFO mapreduce.Job:  map 100% reduce 83%
16/12/06 19:16:51 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 19:16:52 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 19:16:53 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 19:16:54 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 19:16:55 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 19:16:56 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 19:16:58 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 19:17:01 INFO mapreduce.Job: Job job_1480588584072_4853 completed successfully
16/12/06 19:17:01 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=708375261
		FILE: Number of bytes written=1449132487
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=607154199
		WASB: Number of bytes written=373693168
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=11453058
		Total time spent by all reduces in occupied slots (ms)=2643452
		Total time spent by all map tasks (ms)=5726529
		Total time spent by all reduce tasks (ms)=1321726
		Total vcore-seconds taken by all map tasks=5726529
		Total vcore-seconds taken by all reduce tasks=1321726
		Total megabyte-seconds taken by all map tasks=5863965696
		Total megabyte-seconds taken by all reduce tasks=1353447424
	Map-Reduce Framework
		Map input records=1947742
		Map output records=1730371
		Map output bytes=701707725
		Map output materialized bytes=708398781
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1520703
		Reduce shuffle bytes=708398781
		Reduce input records=1730371
		Reduce output records=1104406
		Spilled Records=3460742
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=70152
		CPU time spent (ms)=912570
		Physical memory (bytes) snapshot=323957895168
		Virtual memory (bytes) snapshot=742703087616
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=604458195
	File Output Format Counters 
		Bytes Written=373693168
16/12/06 19:17:01 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0800
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040500 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0900 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040500
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0900': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob605850793808003221.jar tmpDir=null
16/12/06 19:17:37 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:17:38 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:17:38 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 19:17:40 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 19:17:40 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 19:17:41 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4854
16/12/06 19:17:41 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4854
16/12/06 19:17:41 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4854/
16/12/06 19:17:41 INFO mapreduce.Job: Running job: job_1480588584072_4854
16/12/06 19:17:54 INFO mapreduce.Job: Job job_1480588584072_4854 running in uber mode : false
16/12/06 19:17:54 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 19:18:16 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 19:18:17 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 19:18:20 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 19:18:23 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 19:18:24 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 19:18:25 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 19:18:26 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 19:18:27 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 19:18:28 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 19:18:29 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 19:18:30 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 19:18:31 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 19:18:38 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 19:18:40 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 19:18:41 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 19:18:42 INFO mapreduce.Job:  map 29% reduce 0%
16/12/06 19:18:43 INFO mapreduce.Job:  map 33% reduce 1%
16/12/06 19:18:44 INFO mapreduce.Job:  map 35% reduce 1%
16/12/06 19:18:45 INFO mapreduce.Job:  map 41% reduce 2%
16/12/06 19:18:46 INFO mapreduce.Job:  map 44% reduce 4%
16/12/06 19:18:48 INFO mapreduce.Job:  map 47% reduce 5%
16/12/06 19:18:49 INFO mapreduce.Job:  map 48% reduce 5%
16/12/06 19:18:50 INFO mapreduce.Job:  map 49% reduce 7%
16/12/06 19:18:51 INFO mapreduce.Job:  map 50% reduce 8%
16/12/06 19:18:52 INFO mapreduce.Job:  map 50% reduce 11%
16/12/06 19:18:53 INFO mapreduce.Job:  map 54% reduce 12%
16/12/06 19:18:54 INFO mapreduce.Job:  map 55% reduce 12%
16/12/06 19:18:55 INFO mapreduce.Job:  map 56% reduce 13%
16/12/06 19:18:56 INFO mapreduce.Job:  map 56% reduce 15%
16/12/06 19:18:57 INFO mapreduce.Job:  map 58% reduce 15%
16/12/06 19:18:58 INFO mapreduce.Job:  map 59% reduce 16%
16/12/06 19:18:59 INFO mapreduce.Job:  map 60% reduce 16%
16/12/06 19:19:00 INFO mapreduce.Job:  map 61% reduce 16%
16/12/06 19:19:02 INFO mapreduce.Job:  map 62% reduce 17%
16/12/06 19:19:03 INFO mapreduce.Job:  map 63% reduce 17%
16/12/06 19:19:04 INFO mapreduce.Job:  map 65% reduce 17%
16/12/06 19:19:05 INFO mapreduce.Job:  map 67% reduce 18%
16/12/06 19:19:06 INFO mapreduce.Job:  map 67% reduce 19%
16/12/06 19:19:07 INFO mapreduce.Job:  map 68% reduce 20%
16/12/06 19:19:09 INFO mapreduce.Job:  map 69% reduce 21%
16/12/06 19:19:10 INFO mapreduce.Job:  map 69% reduce 23%
16/12/06 19:19:11 INFO mapreduce.Job:  map 71% reduce 23%
16/12/06 19:19:12 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 19:19:13 INFO mapreduce.Job:  map 78% reduce 23%
16/12/06 19:19:14 INFO mapreduce.Job:  map 82% reduce 24%
16/12/06 19:19:15 INFO mapreduce.Job:  map 85% reduce 25%
16/12/06 19:19:16 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 19:19:17 INFO mapreduce.Job:  map 87% reduce 28%
16/12/06 19:19:18 INFO mapreduce.Job:  map 89% reduce 28%
16/12/06 19:19:19 INFO mapreduce.Job:  map 91% reduce 29%
16/12/06 19:19:20 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 19:19:25 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 19:19:26 INFO mapreduce.Job:  map 93% reduce 31%
16/12/06 19:19:28 INFO mapreduce.Job:  map 94% reduce 31%
16/12/06 19:19:30 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 19:19:31 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 19:19:32 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 19:19:33 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 19:19:34 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 19:19:35 INFO mapreduce.Job:  map 100% reduce 46%
16/12/06 19:19:36 INFO mapreduce.Job:  map 100% reduce 56%
16/12/06 19:19:37 INFO mapreduce.Job:  map 100% reduce 64%
16/12/06 19:19:38 INFO mapreduce.Job:  map 100% reduce 72%
16/12/06 19:19:39 INFO mapreduce.Job:  map 100% reduce 75%
16/12/06 19:19:40 INFO mapreduce.Job:  map 100% reduce 78%
16/12/06 19:19:41 INFO mapreduce.Job:  map 100% reduce 84%
16/12/06 19:19:42 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 19:19:43 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 19:19:44 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 19:19:45 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 19:19:46 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 19:19:49 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 19:19:51 INFO mapreduce.Job: Job job_1480588584072_4854 completed successfully
16/12/06 19:19:51 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=826530031
		FILE: Number of bytes written=1685442027
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=706265747
		WASB: Number of bytes written=451860698
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=11723106
		Total time spent by all reduces in occupied slots (ms)=2863288
		Total time spent by all map tasks (ms)=5861553
		Total time spent by all reduce tasks (ms)=1431644
		Total vcore-seconds taken by all map tasks=5861553
		Total vcore-seconds taken by all reduce tasks=1431644
		Total megabyte-seconds taken by all map tasks=6002230272
		Total megabyte-seconds taken by all reduce tasks=1466003456
	Map-Reduce Framework
		Map input records=2251992
		Map output records=2011904
		Map output bytes=818776043
		Map output materialized bytes=826553551
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1776135
		Reduce shuffle bytes=826553551
		Reduce input records=2011904
		Reduce output records=1329479
		Spilled Records=4023808
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=71412
		CPU time spent (ms)=957290
		Physical memory (bytes) snapshot=324769931264
		Virtual memory (bytes) snapshot=742601953280
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=703569743
	File Output Format Counters 
		Bytes Written=451860698
16/12/06 19:19:51 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/0900
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040600 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040600
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob45880511644860730.jar tmpDir=null
16/12/06 19:20:28 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:20:29 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:20:29 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 19:20:31 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 19:20:32 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 19:20:32 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4855
16/12/06 19:20:33 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4855
16/12/06 19:20:33 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4855/
16/12/06 19:20:33 INFO mapreduce.Job: Running job: job_1480588584072_4855
16/12/06 19:20:45 INFO mapreduce.Job: Job job_1480588584072_4855 running in uber mode : false
16/12/06 19:20:45 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 19:20:55 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 19:20:56 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 19:21:04 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 19:21:11 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 19:21:13 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 19:21:15 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 19:21:16 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 19:21:20 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 19:21:21 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 19:21:28 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 19:21:29 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 19:21:30 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 19:21:31 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 19:21:32 INFO mapreduce.Job:  map 24% reduce 2%
16/12/06 19:21:33 INFO mapreduce.Job:  map 28% reduce 2%
16/12/06 19:21:34 INFO mapreduce.Job:  map 31% reduce 3%
16/12/06 19:21:35 INFO mapreduce.Job:  map 34% reduce 5%
16/12/06 19:21:37 INFO mapreduce.Job:  map 36% reduce 5%
16/12/06 19:21:38 INFO mapreduce.Job:  map 38% reduce 6%
16/12/06 19:21:39 INFO mapreduce.Job:  map 39% reduce 6%
16/12/06 19:21:40 INFO mapreduce.Job:  map 40% reduce 6%
16/12/06 19:21:41 INFO mapreduce.Job:  map 42% reduce 6%
16/12/06 19:21:42 INFO mapreduce.Job:  map 43% reduce 6%
16/12/06 19:21:43 INFO mapreduce.Job:  map 45% reduce 6%
16/12/06 19:21:44 INFO mapreduce.Job:  map 47% reduce 7%
16/12/06 19:21:45 INFO mapreduce.Job:  map 49% reduce 7%
16/12/06 19:21:46 INFO mapreduce.Job:  map 51% reduce 7%
16/12/06 19:21:47 INFO mapreduce.Job:  map 51% reduce 8%
16/12/06 19:21:48 INFO mapreduce.Job:  map 52% reduce 8%
16/12/06 19:21:49 INFO mapreduce.Job:  map 53% reduce 9%
16/12/06 19:21:50 INFO mapreduce.Job:  map 54% reduce 9%
16/12/06 19:21:52 INFO mapreduce.Job:  map 54% reduce 10%
16/12/06 19:21:53 INFO mapreduce.Job:  map 56% reduce 10%
16/12/06 19:21:54 INFO mapreduce.Job:  map 56% reduce 11%
16/12/06 19:21:57 INFO mapreduce.Job:  map 57% reduce 13%
16/12/06 19:21:58 INFO mapreduce.Job:  map 59% reduce 14%
16/12/06 19:21:59 INFO mapreduce.Job:  map 59% reduce 15%
16/12/06 19:22:00 INFO mapreduce.Job:  map 62% reduce 16%
16/12/06 19:22:01 INFO mapreduce.Job:  map 63% reduce 18%
16/12/06 19:22:02 INFO mapreduce.Job:  map 64% reduce 19%
16/12/06 19:22:03 INFO mapreduce.Job:  map 66% reduce 21%
16/12/06 19:22:04 INFO mapreduce.Job:  map 68% reduce 21%
16/12/06 19:22:05 INFO mapreduce.Job:  map 69% reduce 22%
16/12/06 19:22:06 INFO mapreduce.Job:  map 70% reduce 22%
16/12/06 19:22:07 INFO mapreduce.Job:  map 71% reduce 23%
16/12/06 19:22:09 INFO mapreduce.Job:  map 73% reduce 24%
16/12/06 19:22:12 INFO mapreduce.Job:  map 74% reduce 24%
16/12/06 19:22:13 INFO mapreduce.Job:  map 76% reduce 24%
16/12/06 19:22:14 INFO mapreduce.Job:  map 77% reduce 25%
16/12/06 19:22:15 INFO mapreduce.Job:  map 78% reduce 25%
16/12/06 19:22:16 INFO mapreduce.Job:  map 81% reduce 25%
16/12/06 19:22:17 INFO mapreduce.Job:  map 85% reduce 26%
16/12/06 19:22:18 INFO mapreduce.Job:  map 90% reduce 27%
16/12/06 19:22:19 INFO mapreduce.Job:  map 91% reduce 28%
16/12/06 19:22:20 INFO mapreduce.Job:  map 93% reduce 29%
16/12/06 19:22:21 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 19:22:22 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 19:22:23 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 19:22:24 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 19:22:25 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 19:22:26 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 19:22:27 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 19:22:28 INFO mapreduce.Job:  map 100% reduce 37%
16/12/06 19:22:29 INFO mapreduce.Job:  map 100% reduce 46%
16/12/06 19:22:30 INFO mapreduce.Job:  map 100% reduce 56%
16/12/06 19:22:31 INFO mapreduce.Job:  map 100% reduce 68%
16/12/06 19:22:32 INFO mapreduce.Job:  map 100% reduce 70%
16/12/06 19:22:33 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 19:22:34 INFO mapreduce.Job:  map 100% reduce 81%
16/12/06 19:22:35 INFO mapreduce.Job:  map 100% reduce 85%
16/12/06 19:22:36 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 19:22:37 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 19:22:38 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 19:22:39 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 19:22:40 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 19:22:43 INFO mapreduce.Job: Job job_1480588584072_4855 completed successfully
16/12/06 19:22:44 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=885164045
		FILE: Number of bytes written=1802710055
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=753630067
		WASB: Number of bytes written=489405018
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12930150
		Total time spent by all reduces in occupied slots (ms)=2915150
		Total time spent by all map tasks (ms)=6465075
		Total time spent by all reduce tasks (ms)=1457575
		Total vcore-seconds taken by all map tasks=6465075
		Total vcore-seconds taken by all reduce tasks=1457575
		Total megabyte-seconds taken by all map tasks=6620236800
		Total megabyte-seconds taken by all reduce tasks=1492556800
	Map-Reduce Framework
		Map input records=2403053
		Map output records=2158404
		Map output bytes=876853227
		Map output materialized bytes=885187565
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1908395
		Reduce shuffle bytes=885187565
		Reduce input records=2158404
		Reduce output records=1441239
		Spilled Records=4316808
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=97266
		CPU time spent (ms)=982630
		Physical memory (bytes) snapshot=325192732672
		Virtual memory (bytes) snapshot=742687129600
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=750934063
	File Output Format Counters 
		Bytes Written=489405018
16/12/06 19:22:44 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040700 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040700
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1721731052916828862.jar tmpDir=null
16/12/06 19:23:20 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:23:21 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:23:21 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 19:23:23 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 19:23:23 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 19:23:23 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4856
16/12/06 19:23:24 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4856
16/12/06 19:23:25 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4856/
16/12/06 19:23:25 INFO mapreduce.Job: Running job: job_1480588584072_4856
16/12/06 19:23:38 INFO mapreduce.Job: Job job_1480588584072_4856 running in uber mode : false
16/12/06 19:23:38 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 19:23:55 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 19:23:57 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 19:24:02 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 19:24:07 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 19:24:08 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 19:24:09 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 19:24:10 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 19:24:15 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 19:24:16 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 19:24:21 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 19:24:22 INFO mapreduce.Job:  map 16% reduce 1%
16/12/06 19:24:23 INFO mapreduce.Job:  map 19% reduce 1%
16/12/06 19:24:24 INFO mapreduce.Job:  map 21% reduce 2%
16/12/06 19:24:25 INFO mapreduce.Job:  map 23% reduce 2%
16/12/06 19:24:26 INFO mapreduce.Job:  map 28% reduce 2%
16/12/06 19:24:27 INFO mapreduce.Job:  map 31% reduce 2%
16/12/06 19:24:28 INFO mapreduce.Job:  map 34% reduce 3%
16/12/06 19:24:29 INFO mapreduce.Job:  map 36% reduce 4%
16/12/06 19:24:30 INFO mapreduce.Job:  map 41% reduce 4%
16/12/06 19:24:31 INFO mapreduce.Job:  map 44% reduce 5%
16/12/06 19:24:32 INFO mapreduce.Job:  map 46% reduce 6%
16/12/06 19:24:33 INFO mapreduce.Job:  map 48% reduce 6%
16/12/06 19:24:34 INFO mapreduce.Job:  map 49% reduce 7%
16/12/06 19:24:35 INFO mapreduce.Job:  map 51% reduce 7%
16/12/06 19:24:36 INFO mapreduce.Job:  map 53% reduce 7%
16/12/06 19:24:37 INFO mapreduce.Job:  map 54% reduce 8%
16/12/06 19:24:38 INFO mapreduce.Job:  map 54% reduce 9%
16/12/06 19:24:39 INFO mapreduce.Job:  map 55% reduce 10%
16/12/06 19:24:43 INFO mapreduce.Job:  map 56% reduce 10%
16/12/06 19:24:46 INFO mapreduce.Job:  map 57% reduce 11%
16/12/06 19:24:48 INFO mapreduce.Job:  map 57% reduce 13%
16/12/06 19:24:50 INFO mapreduce.Job:  map 58% reduce 13%
16/12/06 19:24:51 INFO mapreduce.Job:  map 58% reduce 14%
16/12/06 19:24:52 INFO mapreduce.Job:  map 60% reduce 14%
16/12/06 19:24:53 INFO mapreduce.Job:  map 61% reduce 16%
16/12/06 19:24:54 INFO mapreduce.Job:  map 62% reduce 16%
16/12/06 19:24:55 INFO mapreduce.Job:  map 63% reduce 17%
16/12/06 19:24:56 INFO mapreduce.Job:  map 65% reduce 18%
16/12/06 19:24:57 INFO mapreduce.Job:  map 67% reduce 19%
16/12/06 19:24:58 INFO mapreduce.Job:  map 68% reduce 19%
16/12/06 19:24:59 INFO mapreduce.Job:  map 70% reduce 20%
16/12/06 19:25:00 INFO mapreduce.Job:  map 71% reduce 20%
16/12/06 19:25:01 INFO mapreduce.Job:  map 72% reduce 22%
16/12/06 19:25:02 INFO mapreduce.Job:  map 74% reduce 22%
16/12/06 19:25:03 INFO mapreduce.Job:  map 76% reduce 22%
16/12/06 19:25:04 INFO mapreduce.Job:  map 78% reduce 23%
16/12/06 19:25:05 INFO mapreduce.Job:  map 82% reduce 23%
16/12/06 19:25:06 INFO mapreduce.Job:  map 85% reduce 24%
16/12/06 19:25:07 INFO mapreduce.Job:  map 89% reduce 26%
16/12/06 19:25:08 INFO mapreduce.Job:  map 91% reduce 26%
16/12/06 19:25:09 INFO mapreduce.Job:  map 94% reduce 29%
16/12/06 19:25:10 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 19:25:12 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 19:25:13 INFO mapreduce.Job:  map 98% reduce 31%
16/12/06 19:25:14 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 19:25:16 INFO mapreduce.Job:  map 100% reduce 39%
16/12/06 19:25:17 INFO mapreduce.Job:  map 100% reduce 54%
16/12/06 19:25:18 INFO mapreduce.Job:  map 100% reduce 58%
16/12/06 19:25:19 INFO mapreduce.Job:  map 100% reduce 70%
16/12/06 19:25:20 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 19:25:21 INFO mapreduce.Job:  map 100% reduce 77%
16/12/06 19:25:22 INFO mapreduce.Job:  map 100% reduce 84%
16/12/06 19:25:23 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 19:25:24 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 19:25:25 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 19:25:26 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 19:25:27 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 19:25:30 INFO mapreduce.Job: Job job_1480588584072_4856 completed successfully
16/12/06 19:25:30 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=851878333
		FILE: Number of bytes written=1736138631
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=728168064
		WASB: Number of bytes written=456978461
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12636056
		Total time spent by all reduces in occupied slots (ms)=2634922
		Total time spent by all map tasks (ms)=6318028
		Total time spent by all reduce tasks (ms)=1317461
		Total vcore-seconds taken by all map tasks=6318028
		Total vcore-seconds taken by all reduce tasks=1317461
		Total megabyte-seconds taken by all map tasks=6469660672
		Total megabyte-seconds taken by all reduce tasks=1349080064
	Map-Reduce Framework
		Map input records=2336163
		Map output records=2082968
		Map output bytes=843858509
		Map output materialized bytes=851901853
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1836109
		Reduce shuffle bytes=851901853
		Reduce input records=2082968
		Reduce output records=1346108
		Spilled Records=4165936
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=75112
		CPU time spent (ms)=952060
		Physical memory (bytes) snapshot=324498059264
		Virtual memory (bytes) snapshot=742546657280
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=725472060
	File Output Format Counters 
		Bytes Written=456978461
16/12/06 19:25:30 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040800 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040800
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob992157683888243321.jar tmpDir=null
16/12/06 19:26:07 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:26:08 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:26:08 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 19:26:10 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 19:26:10 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 19:26:10 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4857
16/12/06 19:26:11 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4857
16/12/06 19:26:11 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4857/
16/12/06 19:26:11 INFO mapreduce.Job: Running job: job_1480588584072_4857
16/12/06 19:26:24 INFO mapreduce.Job: Job job_1480588584072_4857 running in uber mode : false
16/12/06 19:26:24 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 19:26:37 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 19:26:44 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 19:26:53 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 19:26:54 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 19:26:55 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 19:27:01 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 19:27:02 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 19:27:06 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 19:27:08 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 19:27:09 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 19:27:10 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 19:27:11 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 19:27:12 INFO mapreduce.Job:  map 23% reduce 1%
16/12/06 19:27:13 INFO mapreduce.Job:  map 27% reduce 2%
16/12/06 19:27:14 INFO mapreduce.Job:  map 30% reduce 2%
16/12/06 19:27:15 INFO mapreduce.Job:  map 33% reduce 3%
16/12/06 19:27:16 INFO mapreduce.Job:  map 35% reduce 3%
16/12/06 19:27:17 INFO mapreduce.Job:  map 39% reduce 3%
16/12/06 19:27:18 INFO mapreduce.Job:  map 41% reduce 3%
16/12/06 19:27:19 INFO mapreduce.Job:  map 46% reduce 4%
16/12/06 19:27:20 INFO mapreduce.Job:  map 48% reduce 4%
16/12/06 19:27:21 INFO mapreduce.Job:  map 49% reduce 4%
16/12/06 19:27:22 INFO mapreduce.Job:  map 50% reduce 5%
16/12/06 19:27:23 INFO mapreduce.Job:  map 54% reduce 5%
16/12/06 19:27:25 INFO mapreduce.Job:  map 55% reduce 7%
16/12/06 19:27:26 INFO mapreduce.Job:  map 55% reduce 9%
16/12/06 19:27:27 INFO mapreduce.Job:  map 55% reduce 10%
16/12/06 19:27:30 INFO mapreduce.Job:  map 56% reduce 10%
16/12/06 19:27:31 INFO mapreduce.Job:  map 57% reduce 11%
16/12/06 19:27:36 INFO mapreduce.Job:  map 57% reduce 12%
16/12/06 19:27:37 INFO mapreduce.Job:  map 57% reduce 14%
16/12/06 19:27:38 INFO mapreduce.Job:  map 58% reduce 14%
16/12/06 19:27:40 INFO mapreduce.Job:  map 58% reduce 16%
16/12/06 19:27:41 INFO mapreduce.Job:  map 60% reduce 17%
16/12/06 19:27:42 INFO mapreduce.Job:  map 60% reduce 19%
16/12/06 19:27:43 INFO mapreduce.Job:  map 61% reduce 19%
16/12/06 19:27:44 INFO mapreduce.Job:  map 63% reduce 19%
16/12/06 19:27:45 INFO mapreduce.Job:  map 67% reduce 19%
16/12/06 19:27:46 INFO mapreduce.Job:  map 69% reduce 21%
16/12/06 19:27:47 INFO mapreduce.Job:  map 72% reduce 22%
16/12/06 19:27:48 INFO mapreduce.Job:  map 73% reduce 22%
16/12/06 19:27:49 INFO mapreduce.Job:  map 75% reduce 23%
16/12/06 19:27:50 INFO mapreduce.Job:  map 77% reduce 24%
16/12/06 19:27:51 INFO mapreduce.Job:  map 81% reduce 24%
16/12/06 19:27:52 INFO mapreduce.Job:  map 83% reduce 25%
16/12/06 19:27:53 INFO mapreduce.Job:  map 86% reduce 26%
16/12/06 19:27:54 INFO mapreduce.Job:  map 88% reduce 27%
16/12/06 19:27:55 INFO mapreduce.Job:  map 91% reduce 28%
16/12/06 19:27:56 INFO mapreduce.Job:  map 95% reduce 29%
16/12/06 19:27:57 INFO mapreduce.Job:  map 99% reduce 30%
16/12/06 19:27:58 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 19:27:59 INFO mapreduce.Job:  map 100% reduce 36%
16/12/06 19:28:00 INFO mapreduce.Job:  map 100% reduce 39%
16/12/06 19:28:01 INFO mapreduce.Job:  map 100% reduce 52%
16/12/06 19:28:02 INFO mapreduce.Job:  map 100% reduce 64%
16/12/06 19:28:03 INFO mapreduce.Job:  map 100% reduce 69%
16/12/06 19:28:04 INFO mapreduce.Job:  map 100% reduce 75%
16/12/06 19:28:05 INFO mapreduce.Job:  map 100% reduce 80%
16/12/06 19:28:06 INFO mapreduce.Job:  map 100% reduce 84%
16/12/06 19:28:07 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 19:28:08 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 19:28:09 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 19:28:10 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 19:28:11 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 19:28:13 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 19:28:16 INFO mapreduce.Job: Job job_1480588584072_4857 completed successfully
16/12/06 19:28:17 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=937126063
		FILE: Number of bytes written=1906634091
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=794878568
		WASB: Number of bytes written=526387993
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12753488
		Total time spent by all reduces in occupied slots (ms)=2464180
		Total time spent by all map tasks (ms)=6376744
		Total time spent by all reduce tasks (ms)=1232090
		Total vcore-seconds taken by all map tasks=6376744
		Total vcore-seconds taken by all reduce tasks=1232090
		Total megabyte-seconds taken by all map tasks=6529785856
		Total megabyte-seconds taken by all reduce tasks=1261660160
	Map-Reduce Framework
		Map input records=2542277
		Map output records=2287942
		Map output bytes=928331818
		Map output materialized bytes=937149583
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2029624
		Reduce shuffle bytes=937149583
		Reduce input records=2287942
		Reduce output records=1552632
		Spilled Records=4575884
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=77200
		CPU time spent (ms)=976170
		Physical memory (bytes) snapshot=325309779968
		Virtual memory (bytes) snapshot=742601359360
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=792182564
	File Output Format Counters 
		Bytes Written=526387993
16/12/06 19:28:17 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/13.done
16/12/06 19:28:25 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040900 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040900
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob499732265684719747.jar tmpDir=null
16/12/06 19:28:54 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:28:55 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:28:55 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 19:28:58 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 19:28:58 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 19:28:59 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4858
16/12/06 19:29:00 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4858
16/12/06 19:29:00 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4858/
16/12/06 19:29:00 INFO mapreduce.Job: Running job: job_1480588584072_4858
16/12/06 19:29:12 INFO mapreduce.Job: Job job_1480588584072_4858 running in uber mode : false
16/12/06 19:29:12 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 19:29:35 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 19:29:36 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 19:29:41 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 19:29:43 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 19:29:44 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 19:29:45 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 19:29:46 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 19:29:47 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 19:29:48 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 19:29:49 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 19:29:51 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 19:29:55 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 19:29:56 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 19:29:57 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 19:29:58 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 19:29:59 INFO mapreduce.Job:  map 27% reduce 0%
16/12/06 19:30:00 INFO mapreduce.Job:  map 32% reduce 0%
16/12/06 19:30:01 INFO mapreduce.Job:  map 33% reduce 0%
16/12/06 19:30:02 INFO mapreduce.Job:  map 35% reduce 0%
16/12/06 19:30:04 INFO mapreduce.Job:  map 36% reduce 0%
16/12/06 19:30:05 INFO mapreduce.Job:  map 42% reduce 2%
16/12/06 19:30:06 INFO mapreduce.Job:  map 45% reduce 3%
16/12/06 19:30:07 INFO mapreduce.Job:  map 47% reduce 4%
16/12/06 19:30:09 INFO mapreduce.Job:  map 49% reduce 4%
16/12/06 19:30:10 INFO mapreduce.Job:  map 50% reduce 4%
16/12/06 19:30:11 INFO mapreduce.Job:  map 52% reduce 5%
16/12/06 19:30:12 INFO mapreduce.Job:  map 52% reduce 7%
16/12/06 19:30:13 INFO mapreduce.Job:  map 53% reduce 9%
16/12/06 19:30:14 INFO mapreduce.Job:  map 55% reduce 9%
16/12/06 19:30:15 INFO mapreduce.Job:  map 55% reduce 12%
16/12/06 19:30:16 INFO mapreduce.Job:  map 55% reduce 13%
16/12/06 19:30:17 INFO mapreduce.Job:  map 55% reduce 14%
16/12/06 19:30:18 INFO mapreduce.Job:  map 56% reduce 17%
16/12/06 19:30:20 INFO mapreduce.Job:  map 57% reduce 17%
16/12/06 19:30:21 INFO mapreduce.Job:  map 58% reduce 18%
16/12/06 19:30:23 INFO mapreduce.Job:  map 60% reduce 18%
16/12/06 19:30:24 INFO mapreduce.Job:  map 63% reduce 18%
16/12/06 19:30:25 INFO mapreduce.Job:  map 64% reduce 19%
16/12/06 19:30:26 INFO mapreduce.Job:  map 65% reduce 19%
16/12/06 19:30:27 INFO mapreduce.Job:  map 65% reduce 21%
16/12/06 19:30:28 INFO mapreduce.Job:  map 66% reduce 21%
16/12/06 19:30:29 INFO mapreduce.Job:  map 69% reduce 22%
16/12/06 19:30:30 INFO mapreduce.Job:  map 71% reduce 22%
16/12/06 19:30:31 INFO mapreduce.Job:  map 72% reduce 23%
16/12/06 19:30:32 INFO mapreduce.Job:  map 74% reduce 23%
16/12/06 19:30:33 INFO mapreduce.Job:  map 74% reduce 24%
16/12/06 19:30:34 INFO mapreduce.Job:  map 76% reduce 24%
16/12/06 19:30:35 INFO mapreduce.Job:  map 78% reduce 24%
16/12/06 19:30:37 INFO mapreduce.Job:  map 81% reduce 25%
16/12/06 19:30:38 INFO mapreduce.Job:  map 82% reduce 26%
16/12/06 19:30:39 INFO mapreduce.Job:  map 83% reduce 26%
16/12/06 19:30:40 INFO mapreduce.Job:  map 84% reduce 27%
16/12/06 19:30:41 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 19:30:42 INFO mapreduce.Job:  map 90% reduce 28%
16/12/06 19:30:43 INFO mapreduce.Job:  map 94% reduce 29%
16/12/06 19:30:44 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 19:30:46 INFO mapreduce.Job:  map 98% reduce 31%
16/12/06 19:30:47 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 19:30:48 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 19:30:49 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 19:30:50 INFO mapreduce.Job:  map 100% reduce 38%
16/12/06 19:30:51 INFO mapreduce.Job:  map 100% reduce 49%
16/12/06 19:30:52 INFO mapreduce.Job:  map 100% reduce 57%
16/12/06 19:30:53 INFO mapreduce.Job:  map 100% reduce 62%
16/12/06 19:30:54 INFO mapreduce.Job:  map 100% reduce 67%
16/12/06 19:30:55 INFO mapreduce.Job:  map 100% reduce 72%
16/12/06 19:30:56 INFO mapreduce.Job:  map 100% reduce 74%
16/12/06 19:30:57 INFO mapreduce.Job:  map 100% reduce 77%
16/12/06 19:30:58 INFO mapreduce.Job:  map 100% reduce 80%
16/12/06 19:30:59 INFO mapreduce.Job:  map 100% reduce 82%
16/12/06 19:31:00 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 19:31:01 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 19:31:02 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 19:31:03 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 19:31:04 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 19:31:06 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 19:31:07 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 19:31:11 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 19:31:13 INFO mapreduce.Job: Job job_1480588584072_4858 completed successfully
16/12/06 19:31:13 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=840370543
		FILE: Number of bytes written=1713123051
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=716545938
		WASB: Number of bytes written=449599757
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12141914
		Total time spent by all reduces in occupied slots (ms)=2825658
		Total time spent by all map tasks (ms)=6070957
		Total time spent by all reduce tasks (ms)=1412829
		Total vcore-seconds taken by all map tasks=6070957
		Total vcore-seconds taken by all reduce tasks=1412829
		Total megabyte-seconds taken by all map tasks=6216659968
		Total megabyte-seconds taken by all reduce tasks=1446736896
	Map-Reduce Framework
		Map input records=2321280
		Map output records=2068198
		Map output bytes=832441977
		Map output materialized bytes=840394063
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1818591
		Reduce shuffle bytes=840394063
		Reduce input records=2068198
		Reduce output records=1336147
		Spilled Records=4136396
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=75960
		CPU time spent (ms)=963210
		Physical memory (bytes) snapshot=324504354816
		Virtual memory (bytes) snapshot=742334472192
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=713849934
	File Output Format Counters 
		Bytes Written=449599757
16/12/06 19:31:13 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1400 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1400': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8078286822871626564.jar tmpDir=null
16/12/06 19:31:49 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:31:50 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:31:50 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 19:31:52 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 19:31:52 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 19:31:52 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4859
16/12/06 19:31:53 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4859
16/12/06 19:31:53 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4859/
16/12/06 19:31:53 INFO mapreduce.Job: Running job: job_1480588584072_4859
16/12/06 19:32:06 INFO mapreduce.Job: Job job_1480588584072_4859 running in uber mode : false
16/12/06 19:32:06 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 19:32:21 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 19:32:22 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 19:32:23 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 19:32:30 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 19:32:31 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 19:32:33 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 19:32:34 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 19:32:35 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 19:32:36 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 19:32:43 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 19:32:44 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 19:32:48 INFO mapreduce.Job:  map 15% reduce 1%
16/12/06 19:32:49 INFO mapreduce.Job:  map 16% reduce 1%
16/12/06 19:32:50 INFO mapreduce.Job:  map 17% reduce 2%
16/12/06 19:32:51 INFO mapreduce.Job:  map 19% reduce 2%
16/12/06 19:32:52 INFO mapreduce.Job:  map 20% reduce 2%
16/12/06 19:32:53 INFO mapreduce.Job:  map 21% reduce 2%
16/12/06 19:32:54 INFO mapreduce.Job:  map 24% reduce 2%
16/12/06 19:32:55 INFO mapreduce.Job:  map 29% reduce 2%
16/12/06 19:32:56 INFO mapreduce.Job:  map 32% reduce 3%
16/12/06 19:32:57 INFO mapreduce.Job:  map 34% reduce 4%
16/12/06 19:32:58 INFO mapreduce.Job:  map 36% reduce 4%
16/12/06 19:32:59 INFO mapreduce.Job:  map 39% reduce 5%
16/12/06 19:33:00 INFO mapreduce.Job:  map 41% reduce 5%
16/12/06 19:33:01 INFO mapreduce.Job:  map 45% reduce 5%
16/12/06 19:33:03 INFO mapreduce.Job:  map 48% reduce 6%
16/12/06 19:33:04 INFO mapreduce.Job:  map 51% reduce 6%
16/12/06 19:33:05 INFO mapreduce.Job:  map 53% reduce 6%
16/12/06 19:33:06 INFO mapreduce.Job:  map 54% reduce 8%
16/12/06 19:33:07 INFO mapreduce.Job:  map 54% reduce 9%
16/12/06 19:33:08 INFO mapreduce.Job:  map 55% reduce 9%
16/12/06 19:33:09 INFO mapreduce.Job:  map 55% reduce 10%
16/12/06 19:33:12 INFO mapreduce.Job:  map 56% reduce 10%
16/12/06 19:33:16 INFO mapreduce.Job:  map 56% reduce 11%
16/12/06 19:33:17 INFO mapreduce.Job:  map 57% reduce 11%
16/12/06 19:33:18 INFO mapreduce.Job:  map 57% reduce 12%
16/12/06 19:33:19 INFO mapreduce.Job:  map 59% reduce 14%
16/12/06 19:33:21 INFO mapreduce.Job:  map 60% reduce 16%
16/12/06 19:33:22 INFO mapreduce.Job:  map 60% reduce 18%
16/12/06 19:33:23 INFO mapreduce.Job:  map 61% reduce 18%
16/12/06 19:33:24 INFO mapreduce.Job:  map 62% reduce 18%
16/12/06 19:33:25 INFO mapreduce.Job:  map 63% reduce 18%
16/12/06 19:33:26 INFO mapreduce.Job:  map 65% reduce 20%
16/12/06 19:33:27 INFO mapreduce.Job:  map 66% reduce 20%
16/12/06 19:33:28 INFO mapreduce.Job:  map 67% reduce 20%
16/12/06 19:33:30 INFO mapreduce.Job:  map 69% reduce 21%
16/12/06 19:33:31 INFO mapreduce.Job:  map 71% reduce 21%
16/12/06 19:33:32 INFO mapreduce.Job:  map 73% reduce 21%
16/12/06 19:33:33 INFO mapreduce.Job:  map 76% reduce 22%
16/12/06 19:33:34 INFO mapreduce.Job:  map 81% reduce 23%
16/12/06 19:33:35 INFO mapreduce.Job:  map 83% reduce 24%
16/12/06 19:33:36 INFO mapreduce.Job:  map 88% reduce 25%
16/12/06 19:33:37 INFO mapreduce.Job:  map 88% reduce 26%
16/12/06 19:33:38 INFO mapreduce.Job:  map 92% reduce 27%
16/12/06 19:33:39 INFO mapreduce.Job:  map 95% reduce 28%
16/12/06 19:33:40 INFO mapreduce.Job:  map 98% reduce 29%
16/12/06 19:33:41 INFO mapreduce.Job:  map 99% reduce 30%
16/12/06 19:33:42 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 19:33:43 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 19:33:44 INFO mapreduce.Job:  map 100% reduce 39%
16/12/06 19:33:45 INFO mapreduce.Job:  map 100% reduce 56%
16/12/06 19:33:46 INFO mapreduce.Job:  map 100% reduce 63%
16/12/06 19:33:47 INFO mapreduce.Job:  map 100% reduce 66%
16/12/06 19:33:48 INFO mapreduce.Job:  map 100% reduce 74%
16/12/06 19:33:49 INFO mapreduce.Job:  map 100% reduce 78%
16/12/06 19:33:50 INFO mapreduce.Job:  map 100% reduce 81%
16/12/06 19:33:51 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 19:33:52 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 19:33:53 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 19:33:54 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 19:33:55 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 19:33:56 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 19:34:00 INFO mapreduce.Job: Job job_1480588584072_4859 completed successfully
16/12/06 19:34:00 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=891728436
		FILE: Number of bytes written=1815838837
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=757118084
		WASB: Number of bytes written=484834648
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12726522
		Total time spent by all reduces in occupied slots (ms)=2690550
		Total time spent by all map tasks (ms)=6363261
		Total time spent by all reduce tasks (ms)=1345275
		Total vcore-seconds taken by all map tasks=6363261
		Total vcore-seconds taken by all reduce tasks=1345275
		Total megabyte-seconds taken by all map tasks=6515979264
		Total megabyte-seconds taken by all reduce tasks=1377561600
	Map-Reduce Framework
		Map input records=2454113
		Map output records=2195652
		Map output bytes=883316010
		Map output materialized bytes=891751956
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1935919
		Reduce shuffle bytes=891751956
		Reduce input records=2195652
		Reduce output records=1443366
		Spilled Records=4391304
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=87555
		CPU time spent (ms)=968390
		Physical memory (bytes) snapshot=325081739264
		Virtual memory (bytes) snapshot=742588121088
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=754422080
	File Output Format Counters 
		Bytes Written=484834648
16/12/06 19:34:00 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1400
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1500 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1500': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7062715794334333592.jar tmpDir=null
16/12/06 19:34:36 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:34:37 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:34:38 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 19:34:39 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 19:34:39 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 19:34:40 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4860
16/12/06 19:34:41 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4860
16/12/06 19:34:41 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4860/
16/12/06 19:34:41 INFO mapreduce.Job: Running job: job_1480588584072_4860
16/12/06 19:34:54 INFO mapreduce.Job: Job job_1480588584072_4860 running in uber mode : false
16/12/06 19:34:54 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 19:35:04 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 19:35:12 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 19:35:20 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 19:35:21 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 19:35:22 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 19:35:23 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 19:35:28 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 19:35:29 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 19:35:33 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 19:35:35 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 19:35:36 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 19:35:37 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 19:35:39 INFO mapreduce.Job:  map 20% reduce 1%
16/12/06 19:35:40 INFO mapreduce.Job:  map 22% reduce 1%
16/12/06 19:35:41 INFO mapreduce.Job:  map 23% reduce 1%
16/12/06 19:35:42 INFO mapreduce.Job:  map 27% reduce 2%
16/12/06 19:35:43 INFO mapreduce.Job:  map 29% reduce 3%
16/12/06 19:35:44 INFO mapreduce.Job:  map 31% reduce 4%
16/12/06 19:35:45 INFO mapreduce.Job:  map 34% reduce 4%
16/12/06 19:35:46 INFO mapreduce.Job:  map 36% reduce 4%
16/12/06 19:35:47 INFO mapreduce.Job:  map 39% reduce 5%
16/12/06 19:35:48 INFO mapreduce.Job:  map 41% reduce 5%
16/12/06 19:35:49 INFO mapreduce.Job:  map 44% reduce 6%
16/12/06 19:35:50 INFO mapreduce.Job:  map 47% reduce 7%
16/12/06 19:35:51 INFO mapreduce.Job:  map 50% reduce 7%
16/12/06 19:35:52 INFO mapreduce.Job:  map 51% reduce 8%
16/12/06 19:35:53 INFO mapreduce.Job:  map 51% reduce 9%
16/12/06 19:35:54 INFO mapreduce.Job:  map 53% reduce 10%
16/12/06 19:35:55 INFO mapreduce.Job:  map 53% reduce 11%
16/12/06 19:35:57 INFO mapreduce.Job:  map 54% reduce 11%
16/12/06 19:36:00 INFO mapreduce.Job:  map 54% reduce 12%
16/12/06 19:36:02 INFO mapreduce.Job:  map 55% reduce 12%
16/12/06 19:36:04 INFO mapreduce.Job:  map 55% reduce 13%
16/12/06 19:36:05 INFO mapreduce.Job:  map 56% reduce 13%
16/12/06 19:36:06 INFO mapreduce.Job:  map 56% reduce 16%
16/12/06 19:36:07 INFO mapreduce.Job:  map 57% reduce 17%
16/12/06 19:36:08 INFO mapreduce.Job:  map 57% reduce 18%
16/12/06 19:36:09 INFO mapreduce.Job:  map 58% reduce 19%
16/12/06 19:36:11 INFO mapreduce.Job:  map 60% reduce 19%
16/12/06 19:36:12 INFO mapreduce.Job:  map 61% reduce 19%
16/12/06 19:36:13 INFO mapreduce.Job:  map 62% reduce 20%
16/12/06 19:36:15 INFO mapreduce.Job:  map 63% reduce 20%
16/12/06 19:36:16 INFO mapreduce.Job:  map 63% reduce 21%
16/12/06 19:36:17 INFO mapreduce.Job:  map 64% reduce 21%
16/12/06 19:36:18 INFO mapreduce.Job:  map 65% reduce 21%
16/12/06 19:36:19 INFO mapreduce.Job:  map 67% reduce 21%
16/12/06 19:36:20 INFO mapreduce.Job:  map 70% reduce 21%
16/12/06 19:36:21 INFO mapreduce.Job:  map 72% reduce 22%
16/12/06 19:36:22 INFO mapreduce.Job:  map 75% reduce 23%
16/12/06 19:36:23 INFO mapreduce.Job:  map 79% reduce 24%
16/12/06 19:36:24 INFO mapreduce.Job:  map 81% reduce 24%
16/12/06 19:36:25 INFO mapreduce.Job:  map 85% reduce 26%
16/12/06 19:36:26 INFO mapreduce.Job:  map 87% reduce 27%
16/12/06 19:36:27 INFO mapreduce.Job:  map 89% reduce 27%
16/12/06 19:36:28 INFO mapreduce.Job:  map 91% reduce 29%
16/12/06 19:36:29 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 19:36:30 INFO mapreduce.Job:  map 97% reduce 30%
16/12/06 19:36:31 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 19:36:32 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 19:36:33 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 19:36:34 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 19:36:35 INFO mapreduce.Job:  map 100% reduce 36%
16/12/06 19:36:36 INFO mapreduce.Job:  map 100% reduce 42%
16/12/06 19:36:37 INFO mapreduce.Job:  map 100% reduce 56%
16/12/06 19:36:38 INFO mapreduce.Job:  map 100% reduce 65%
16/12/06 19:36:39 INFO mapreduce.Job:  map 100% reduce 71%
16/12/06 19:36:40 INFO mapreduce.Job:  map 100% reduce 74%
16/12/06 19:36:41 INFO mapreduce.Job:  map 100% reduce 79%
16/12/06 19:36:42 INFO mapreduce.Job:  map 100% reduce 81%
16/12/06 19:36:43 INFO mapreduce.Job:  map 100% reduce 83%
16/12/06 19:36:44 INFO mapreduce.Job:  map 100% reduce 88%
16/12/06 19:36:45 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 19:36:46 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 19:36:47 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 19:36:48 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 19:36:49 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 19:36:50 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 19:36:53 INFO mapreduce.Job: Job job_1480588584072_4860 completed successfully
16/12/06 19:36:53 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=862758518
		FILE: Number of bytes written=1757899001
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=734253251
		WASB: Number of bytes written=456815632
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13127078
		Total time spent by all reduces in occupied slots (ms)=2936236
		Total time spent by all map tasks (ms)=6563539
		Total time spent by all reduce tasks (ms)=1468118
		Total vcore-seconds taken by all map tasks=6563539
		Total vcore-seconds taken by all reduce tasks=1468118
		Total megabyte-seconds taken by all map tasks=6721063936
		Total megabyte-seconds taken by all reduce tasks=1503352832
	Map-Reduce Framework
		Map input records=2382256
		Map output records=2123099
		Map output bytes=854609315
		Map output materialized bytes=862782038
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1863136
		Reduce shuffle bytes=862782038
		Reduce input records=2123099
		Reduce output records=1355681
		Spilled Records=4246198
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=85811
		CPU time spent (ms)=981500
		Physical memory (bytes) snapshot=324834652160
		Virtual memory (bytes) snapshot=742296764416
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=731557247
	File Output Format Counters 
		Bytes Written=456815632
16/12/06 19:36:53 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1500
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1600 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1600': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5754218840418601180.jar tmpDir=null
16/12/06 19:37:30 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:37:31 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:37:31 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 19:37:33 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 19:37:33 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 19:37:33 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4861
16/12/06 19:37:34 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4861
16/12/06 19:37:34 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4861/
16/12/06 19:37:34 INFO mapreduce.Job: Running job: job_1480588584072_4861
16/12/06 19:37:47 INFO mapreduce.Job: Job job_1480588584072_4861 running in uber mode : false
16/12/06 19:37:47 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 19:38:11 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 19:38:12 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 19:38:13 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 19:38:14 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 19:38:15 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 19:38:16 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 19:38:18 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 19:38:20 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 19:38:21 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 19:38:22 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 19:38:25 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 19:38:33 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 19:38:34 INFO mapreduce.Job:  map 22% reduce 1%
16/12/06 19:38:35 INFO mapreduce.Job:  map 26% reduce 1%
16/12/06 19:38:36 INFO mapreduce.Job:  map 30% reduce 1%
16/12/06 19:38:37 INFO mapreduce.Job:  map 34% reduce 1%
16/12/06 19:38:38 INFO mapreduce.Job:  map 38% reduce 2%
16/12/06 19:38:39 INFO mapreduce.Job:  map 41% reduce 3%
16/12/06 19:38:40 INFO mapreduce.Job:  map 43% reduce 6%
16/12/06 19:38:41 INFO mapreduce.Job:  map 45% reduce 7%
16/12/06 19:38:42 INFO mapreduce.Job:  map 49% reduce 10%
16/12/06 19:38:43 INFO mapreduce.Job:  map 51% reduce 11%
16/12/06 19:38:44 INFO mapreduce.Job:  map 53% reduce 11%
16/12/06 19:38:45 INFO mapreduce.Job:  map 54% reduce 12%
16/12/06 19:38:46 INFO mapreduce.Job:  map 57% reduce 13%
16/12/06 19:38:47 INFO mapreduce.Job:  map 58% reduce 14%
16/12/06 19:38:48 INFO mapreduce.Job:  map 59% reduce 14%
16/12/06 19:38:49 INFO mapreduce.Job:  map 59% reduce 16%
16/12/06 19:38:50 INFO mapreduce.Job:  map 59% reduce 18%
16/12/06 19:38:51 INFO mapreduce.Job:  map 60% reduce 18%
16/12/06 19:38:53 INFO mapreduce.Job:  map 62% reduce 18%
16/12/06 19:38:54 INFO mapreduce.Job:  map 63% reduce 18%
16/12/06 19:38:55 INFO mapreduce.Job:  map 64% reduce 19%
16/12/06 19:38:56 INFO mapreduce.Job:  map 65% reduce 19%
16/12/06 19:38:59 INFO mapreduce.Job:  map 65% reduce 20%
16/12/06 19:39:00 INFO mapreduce.Job:  map 66% reduce 20%
16/12/06 19:39:01 INFO mapreduce.Job:  map 67% reduce 20%
16/12/06 19:39:02 INFO mapreduce.Job:  map 69% reduce 20%
16/12/06 19:39:03 INFO mapreduce.Job:  map 71% reduce 22%
16/12/06 19:39:04 INFO mapreduce.Job:  map 72% reduce 23%
16/12/06 19:39:05 INFO mapreduce.Job:  map 74% reduce 23%
16/12/06 19:39:06 INFO mapreduce.Job:  map 75% reduce 24%
16/12/06 19:39:07 INFO mapreduce.Job:  map 76% reduce 24%
16/12/06 19:39:08 INFO mapreduce.Job:  map 78% reduce 25%
16/12/06 19:39:09 INFO mapreduce.Job:  map 80% reduce 25%
16/12/06 19:39:10 INFO mapreduce.Job:  map 82% reduce 26%
16/12/06 19:39:11 INFO mapreduce.Job:  map 84% reduce 26%
16/12/06 19:39:12 INFO mapreduce.Job:  map 86% reduce 27%
16/12/06 19:39:13 INFO mapreduce.Job:  map 87% reduce 28%
16/12/06 19:39:14 INFO mapreduce.Job:  map 90% reduce 28%
16/12/06 19:39:15 INFO mapreduce.Job:  map 92% reduce 29%
16/12/06 19:39:16 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 19:39:17 INFO mapreduce.Job:  map 96% reduce 30%
16/12/06 19:39:18 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 19:39:19 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 19:39:21 INFO mapreduce.Job:  map 100% reduce 36%
16/12/06 19:39:22 INFO mapreduce.Job:  map 100% reduce 52%
16/12/06 19:39:23 INFO mapreduce.Job:  map 100% reduce 62%
16/12/06 19:39:24 INFO mapreduce.Job:  map 100% reduce 67%
16/12/06 19:39:25 INFO mapreduce.Job:  map 100% reduce 73%
16/12/06 19:39:26 INFO mapreduce.Job:  map 100% reduce 77%
16/12/06 19:39:27 INFO mapreduce.Job:  map 100% reduce 82%
16/12/06 19:39:29 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 19:39:30 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 19:39:31 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 19:39:32 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 19:39:35 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 19:39:38 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 19:39:40 INFO mapreduce.Job: Job job_1480588584072_4861 completed successfully
16/12/06 19:39:40 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=844429165
		FILE: Number of bytes written=1721240295
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=721783332
		WASB: Number of bytes written=426337052
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=11953340
		Total time spent by all reduces in occupied slots (ms)=2636262
		Total time spent by all map tasks (ms)=5976670
		Total time spent by all reduce tasks (ms)=1318131
		Total vcore-seconds taken by all map tasks=5976670
		Total vcore-seconds taken by all reduce tasks=1318131
		Total megabyte-seconds taken by all map tasks=6120110080
		Total megabyte-seconds taken by all reduce tasks=1349766144
	Map-Reduce Framework
		Map input records=2358914
		Map output records=2088533
		Map output bytes=836421585
		Map output materialized bytes=844452685
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1825986
		Reduce shuffle bytes=844452685
		Reduce input records=2088533
		Reduce output records=1268914
		Spilled Records=4177066
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=86621
		CPU time spent (ms)=936200
		Physical memory (bytes) snapshot=324588421120
		Virtual memory (bytes) snapshot=742595272704
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=719087328
	File Output Format Counters 
		Bytes Written=426337052
16/12/06 19:39:40 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1600
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1700 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612040900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1700': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8002754738468429562.jar tmpDir=null
16/12/06 19:40:16 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:40:17 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:40:17 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 19:40:19 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 19:40:19 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 19:40:19 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4862
16/12/06 19:40:20 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4862
16/12/06 19:40:20 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4862/
16/12/06 19:40:20 INFO mapreduce.Job: Running job: job_1480588584072_4862
16/12/06 19:40:32 INFO mapreduce.Job: Job job_1480588584072_4862 running in uber mode : false
16/12/06 19:40:32 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 19:40:56 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 19:40:57 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 19:40:59 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 19:41:02 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 19:41:03 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 19:41:05 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 19:41:06 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 19:41:08 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 19:41:09 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 19:41:10 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 19:41:11 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 19:41:14 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 19:41:17 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 19:41:19 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 19:41:20 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 19:41:21 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 19:41:22 INFO mapreduce.Job:  map 33% reduce 0%
16/12/06 19:41:24 INFO mapreduce.Job:  map 38% reduce 0%
16/12/06 19:41:25 INFO mapreduce.Job:  map 41% reduce 0%
16/12/06 19:41:26 INFO mapreduce.Job:  map 44% reduce 1%
16/12/06 19:41:27 INFO mapreduce.Job:  map 48% reduce 2%
16/12/06 19:41:28 INFO mapreduce.Job:  map 51% reduce 2%
16/12/06 19:41:29 INFO mapreduce.Job:  map 54% reduce 3%
16/12/06 19:41:32 INFO mapreduce.Job:  map 55% reduce 6%
16/12/06 19:41:33 INFO mapreduce.Job:  map 55% reduce 8%
16/12/06 19:41:34 INFO mapreduce.Job:  map 57% reduce 9%
16/12/06 19:41:35 INFO mapreduce.Job:  map 57% reduce 10%
16/12/06 19:41:36 INFO mapreduce.Job:  map 57% reduce 11%
16/12/06 19:41:37 INFO mapreduce.Job:  map 57% reduce 12%
16/12/06 19:41:38 INFO mapreduce.Job:  map 58% reduce 13%
16/12/06 19:41:39 INFO mapreduce.Job:  map 58% reduce 15%
16/12/06 19:41:42 INFO mapreduce.Job:  map 58% reduce 16%
16/12/06 19:41:43 INFO mapreduce.Job:  map 58% reduce 18%
16/12/06 19:41:44 INFO mapreduce.Job:  map 59% reduce 18%
16/12/06 19:41:45 INFO mapreduce.Job:  map 60% reduce 18%
16/12/06 19:41:46 INFO mapreduce.Job:  map 63% reduce 20%
16/12/06 19:41:47 INFO mapreduce.Job:  map 65% reduce 20%
16/12/06 19:41:48 INFO mapreduce.Job:  map 67% reduce 21%
16/12/06 19:41:49 INFO mapreduce.Job:  map 67% reduce 22%
16/12/06 19:41:50 INFO mapreduce.Job:  map 69% reduce 22%
16/12/06 19:41:51 INFO mapreduce.Job:  map 71% reduce 22%
16/12/06 19:41:52 INFO mapreduce.Job:  map 71% reduce 23%
16/12/06 19:41:53 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 19:41:54 INFO mapreduce.Job:  map 75% reduce 24%
16/12/06 19:41:55 INFO mapreduce.Job:  map 80% reduce 24%
16/12/06 19:41:56 INFO mapreduce.Job:  map 83% reduce 25%
16/12/06 19:41:57 INFO mapreduce.Job:  map 85% reduce 26%
16/12/06 19:41:58 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 19:41:59 INFO mapreduce.Job:  map 85% reduce 28%
16/12/06 19:42:00 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 19:42:01 INFO mapreduce.Job:  map 88% reduce 29%
16/12/06 19:42:02 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 19:42:03 INFO mapreduce.Job:  map 94% reduce 29%
16/12/06 19:42:04 INFO mapreduce.Job:  map 97% reduce 30%
16/12/06 19:42:05 INFO mapreduce.Job:  map 99% reduce 30%
16/12/06 19:42:06 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 19:42:07 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 19:42:08 INFO mapreduce.Job:  map 100% reduce 41%
16/12/06 19:42:09 INFO mapreduce.Job:  map 100% reduce 48%
16/12/06 19:42:10 INFO mapreduce.Job:  map 100% reduce 62%
16/12/06 19:42:11 INFO mapreduce.Job:  map 100% reduce 68%
16/12/06 19:42:12 INFO mapreduce.Job:  map 100% reduce 70%
16/12/06 19:42:13 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 19:42:14 INFO mapreduce.Job:  map 100% reduce 79%
16/12/06 19:42:15 INFO mapreduce.Job:  map 100% reduce 80%
16/12/06 19:42:16 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 19:42:17 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 19:42:18 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 19:42:19 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 19:42:20 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 19:42:21 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 19:42:22 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 19:42:24 INFO mapreduce.Job: Job job_1480588584072_4862 completed successfully
16/12/06 19:42:25 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=1030818615
		FILE: Number of bytes written=2094019195
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=869139891
		WASB: Number of bytes written=562984421
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12209390
		Total time spent by all reduces in occupied slots (ms)=2558028
		Total time spent by all map tasks (ms)=6104695
		Total time spent by all reduce tasks (ms)=1279014
		Total vcore-seconds taken by all map tasks=6104695
		Total vcore-seconds taken by all reduce tasks=1279014
		Total megabyte-seconds taken by all map tasks=6251207680
		Total megabyte-seconds taken by all reduce tasks=1309710336
	Map-Reduce Framework
		Map input records=2804826
		Map output records=2537562
		Map output bytes=1021091531
		Map output materialized bytes=1030842135
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2238984
		Reduce shuffle bytes=1030842135
		Reduce input records=2537562
		Reduce output records=1669781
		Spilled Records=5075124
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=80056
		CPU time spent (ms)=1005060
		Physical memory (bytes) snapshot=325698981888
		Virtual memory (bytes) snapshot=742538870784
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=866443887
	File Output Format Counters 
		Bytes Written=562984421
16/12/06 19:42:25 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1700
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041400 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1800 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041400
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1800': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob9009688200712131339.jar tmpDir=null
16/12/06 19:43:01 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:43:02 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:43:02 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 19:43:04 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 19:43:04 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 19:43:04 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4863
16/12/06 19:43:05 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4863
16/12/06 19:43:05 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4863/
16/12/06 19:43:05 INFO mapreduce.Job: Running job: job_1480588584072_4863
16/12/06 19:43:17 INFO mapreduce.Job: Job job_1480588584072_4863 running in uber mode : false
16/12/06 19:43:17 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 19:43:32 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 19:43:33 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 19:43:34 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 19:43:39 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 19:43:40 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 19:43:45 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 19:43:46 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 19:43:47 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 19:43:51 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 19:43:52 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 19:44:00 INFO mapreduce.Job:  map 15% reduce 1%
16/12/06 19:44:01 INFO mapreduce.Job:  map 17% reduce 1%
16/12/06 19:44:02 INFO mapreduce.Job:  map 18% reduce 2%
16/12/06 19:44:03 INFO mapreduce.Job:  map 21% reduce 2%
16/12/06 19:44:04 INFO mapreduce.Job:  map 24% reduce 2%
16/12/06 19:44:05 INFO mapreduce.Job:  map 27% reduce 2%
16/12/06 19:44:06 INFO mapreduce.Job:  map 29% reduce 3%
16/12/06 19:44:07 INFO mapreduce.Job:  map 31% reduce 4%
16/12/06 19:44:08 INFO mapreduce.Job:  map 33% reduce 4%
16/12/06 19:44:09 INFO mapreduce.Job:  map 35% reduce 5%
16/12/06 19:44:10 INFO mapreduce.Job:  map 38% reduce 5%
16/12/06 19:44:11 INFO mapreduce.Job:  map 41% reduce 5%
16/12/06 19:44:12 INFO mapreduce.Job:  map 43% reduce 5%
16/12/06 19:44:13 INFO mapreduce.Job:  map 45% reduce 6%
16/12/06 19:44:15 INFO mapreduce.Job:  map 46% reduce 6%
16/12/06 19:44:16 INFO mapreduce.Job:  map 49% reduce 7%
16/12/06 19:44:17 INFO mapreduce.Job:  map 51% reduce 8%
16/12/06 19:44:18 INFO mapreduce.Job:  map 52% reduce 8%
16/12/06 19:44:19 INFO mapreduce.Job:  map 53% reduce 9%
16/12/06 19:44:20 INFO mapreduce.Job:  map 54% reduce 10%
16/12/06 19:44:21 INFO mapreduce.Job:  map 55% reduce 10%
16/12/06 19:44:23 INFO mapreduce.Job:  map 55% reduce 11%
16/12/06 19:44:26 INFO mapreduce.Job:  map 56% reduce 11%
16/12/06 19:44:27 INFO mapreduce.Job:  map 56% reduce 12%
16/12/06 19:44:28 INFO mapreduce.Job:  map 56% reduce 14%
16/12/06 19:44:31 INFO mapreduce.Job:  map 57% reduce 14%
16/12/06 19:44:32 INFO mapreduce.Job:  map 58% reduce 16%
16/12/06 19:44:33 INFO mapreduce.Job:  map 59% reduce 16%
16/12/06 19:44:34 INFO mapreduce.Job:  map 60% reduce 19%
16/12/06 19:44:35 INFO mapreduce.Job:  map 61% reduce 20%
16/12/06 19:44:36 INFO mapreduce.Job:  map 63% reduce 20%
16/12/06 19:44:37 INFO mapreduce.Job:  map 64% reduce 20%
16/12/06 19:44:38 INFO mapreduce.Job:  map 64% reduce 21%
16/12/06 19:44:40 INFO mapreduce.Job:  map 66% reduce 21%
16/12/06 19:44:42 INFO mapreduce.Job:  map 68% reduce 22%
16/12/06 19:44:43 INFO mapreduce.Job:  map 70% reduce 22%
16/12/06 19:44:44 INFO mapreduce.Job:  map 71% reduce 22%
16/12/06 19:44:45 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 19:44:46 INFO mapreduce.Job:  map 75% reduce 23%
16/12/06 19:44:47 INFO mapreduce.Job:  map 78% reduce 24%
16/12/06 19:44:48 INFO mapreduce.Job:  map 80% reduce 24%
16/12/06 19:44:49 INFO mapreduce.Job:  map 82% reduce 25%
16/12/06 19:44:50 INFO mapreduce.Job:  map 88% reduce 26%
16/12/06 19:44:51 INFO mapreduce.Job:  map 93% reduce 27%
16/12/06 19:44:52 INFO mapreduce.Job:  map 97% reduce 29%
16/12/06 19:44:53 INFO mapreduce.Job:  map 98% reduce 31%
16/12/06 19:44:54 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 19:44:55 INFO mapreduce.Job:  map 99% reduce 33%
16/12/06 19:44:56 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 19:44:57 INFO mapreduce.Job:  map 100% reduce 37%
16/12/06 19:44:58 INFO mapreduce.Job:  map 100% reduce 45%
16/12/06 19:44:59 INFO mapreduce.Job:  map 100% reduce 55%
16/12/06 19:45:00 INFO mapreduce.Job:  map 100% reduce 67%
16/12/06 19:45:01 INFO mapreduce.Job:  map 100% reduce 69%
16/12/06 19:45:02 INFO mapreduce.Job:  map 100% reduce 72%
16/12/06 19:45:03 INFO mapreduce.Job:  map 100% reduce 78%
16/12/06 19:45:04 INFO mapreduce.Job:  map 100% reduce 80%
16/12/06 19:45:05 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 19:45:06 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 19:45:07 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 19:45:08 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 19:45:09 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 19:45:10 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 19:45:12 INFO mapreduce.Job: Job job_1480588584072_4863 completed successfully
16/12/06 19:45:12 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=972171749
		FILE: Number of bytes written=1976725463
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=824640931
		WASB: Number of bytes written=497681911
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12967186
		Total time spent by all reduces in occupied slots (ms)=2848214
		Total time spent by all map tasks (ms)=6483593
		Total time spent by all reduce tasks (ms)=1424107
		Total vcore-seconds taken by all map tasks=6483593
		Total vcore-seconds taken by all reduce tasks=1424107
		Total megabyte-seconds taken by all map tasks=6639199232
		Total megabyte-seconds taken by all reduce tasks=1458285568
	Map-Reduce Framework
		Map input records=2677106
		Map output records=2399459
		Map output bytes=962961715
		Map output materialized bytes=972195269
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2098235
		Reduce shuffle bytes=972195269
		Reduce input records=2399459
		Reduce output records=1472321
		Spilled Records=4798918
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=84543
		CPU time spent (ms)=1000570
		Physical memory (bytes) snapshot=325088923648
		Virtual memory (bytes) snapshot=742305042432
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=821944927
	File Output Format Counters 
		Bytes Written=497681911
16/12/06 19:45:12 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1800
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041500 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1900 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041500
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1900': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4889972468111890941.jar tmpDir=null
16/12/06 19:45:49 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:45:50 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:45:50 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 19:45:52 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 19:45:52 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 19:45:53 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4864
16/12/06 19:45:54 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4864
16/12/06 19:45:54 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4864/
16/12/06 19:45:54 INFO mapreduce.Job: Running job: job_1480588584072_4864
16/12/06 19:46:08 INFO mapreduce.Job: Job job_1480588584072_4864 running in uber mode : false
16/12/06 19:46:08 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 19:46:24 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 19:46:26 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 19:46:27 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 19:46:28 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 19:46:31 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 19:46:32 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 19:46:33 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 19:46:39 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 19:46:40 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 19:46:41 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 19:46:45 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 19:46:47 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 19:46:51 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 19:46:53 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 19:46:54 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 19:46:55 INFO mapreduce.Job:  map 19% reduce 1%
16/12/06 19:46:56 INFO mapreduce.Job:  map 24% reduce 2%
16/12/06 19:46:57 INFO mapreduce.Job:  map 27% reduce 2%
16/12/06 19:46:58 INFO mapreduce.Job:  map 32% reduce 2%
16/12/06 19:46:59 INFO mapreduce.Job:  map 34% reduce 3%
16/12/06 19:47:00 INFO mapreduce.Job:  map 37% reduce 4%
16/12/06 19:47:01 INFO mapreduce.Job:  map 40% reduce 4%
16/12/06 19:47:02 INFO mapreduce.Job:  map 41% reduce 6%
16/12/06 19:47:03 INFO mapreduce.Job:  map 44% reduce 6%
16/12/06 19:47:04 INFO mapreduce.Job:  map 45% reduce 6%
16/12/06 19:47:05 INFO mapreduce.Job:  map 47% reduce 7%
16/12/06 19:47:06 INFO mapreduce.Job:  map 50% reduce 7%
16/12/06 19:47:07 INFO mapreduce.Job:  map 52% reduce 7%
16/12/06 19:47:08 INFO mapreduce.Job:  map 52% reduce 8%
16/12/06 19:47:09 INFO mapreduce.Job:  map 53% reduce 8%
16/12/06 19:47:10 INFO mapreduce.Job:  map 53% reduce 9%
16/12/06 19:47:11 INFO mapreduce.Job:  map 54% reduce 9%
16/12/06 19:47:13 INFO mapreduce.Job:  map 56% reduce 10%
16/12/06 19:47:17 INFO mapreduce.Job:  map 56% reduce 11%
16/12/06 19:47:21 INFO mapreduce.Job:  map 58% reduce 11%
16/12/06 19:47:23 INFO mapreduce.Job:  map 59% reduce 13%
16/12/06 19:47:24 INFO mapreduce.Job:  map 60% reduce 13%
16/12/06 19:47:25 INFO mapreduce.Job:  map 61% reduce 14%
16/12/06 19:47:26 INFO mapreduce.Job:  map 62% reduce 17%
16/12/06 19:47:27 INFO mapreduce.Job:  map 64% reduce 18%
16/12/06 19:47:28 INFO mapreduce.Job:  map 66% reduce 19%
16/12/06 19:47:29 INFO mapreduce.Job:  map 68% reduce 20%
16/12/06 19:47:30 INFO mapreduce.Job:  map 69% reduce 21%
16/12/06 19:47:31 INFO mapreduce.Job:  map 70% reduce 21%
16/12/06 19:47:32 INFO mapreduce.Job:  map 71% reduce 22%
16/12/06 19:47:33 INFO mapreduce.Job:  map 72% reduce 22%
16/12/06 19:47:34 INFO mapreduce.Job:  map 73% reduce 24%
16/12/06 19:47:35 INFO mapreduce.Job:  map 75% reduce 24%
16/12/06 19:47:36 INFO mapreduce.Job:  map 77% reduce 24%
16/12/06 19:47:37 INFO mapreduce.Job:  map 79% reduce 24%
16/12/06 19:47:38 INFO mapreduce.Job:  map 82% reduce 25%
16/12/06 19:47:39 INFO mapreduce.Job:  map 88% reduce 26%
16/12/06 19:47:40 INFO mapreduce.Job:  map 91% reduce 27%
16/12/06 19:47:41 INFO mapreduce.Job:  map 93% reduce 28%
16/12/06 19:47:42 INFO mapreduce.Job:  map 95% reduce 29%
16/12/06 19:47:43 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 19:47:44 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 19:47:45 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 19:47:46 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 19:47:47 INFO mapreduce.Job:  map 100% reduce 36%
16/12/06 19:47:48 INFO mapreduce.Job:  map 100% reduce 43%
16/12/06 19:47:49 INFO mapreduce.Job:  map 100% reduce 56%
16/12/06 19:47:50 INFO mapreduce.Job:  map 100% reduce 63%
16/12/06 19:47:51 INFO mapreduce.Job:  map 100% reduce 70%
16/12/06 19:47:52 INFO mapreduce.Job:  map 100% reduce 74%
16/12/06 19:47:53 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 19:47:54 INFO mapreduce.Job:  map 100% reduce 80%
16/12/06 19:47:55 INFO mapreduce.Job:  map 100% reduce 85%
16/12/06 19:47:56 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 19:47:57 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 19:47:58 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 19:47:59 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 19:48:00 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 19:48:01 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 19:48:05 INFO mapreduce.Job: Job job_1480588584072_4864 completed successfully
16/12/06 19:48:06 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=1149226091
		FILE: Number of bytes written=2330834147
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=960028445
		WASB: Number of bytes written=640999536
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12926708
		Total time spent by all reduces in occupied slots (ms)=2756750
		Total time spent by all map tasks (ms)=6463354
		Total time spent by all reduce tasks (ms)=1378375
		Total vcore-seconds taken by all map tasks=6463354
		Total vcore-seconds taken by all reduce tasks=1378375
		Total megabyte-seconds taken by all map tasks=6618474496
		Total megabyte-seconds taken by all reduce tasks=1411456000
	Map-Reduce Framework
		Map input records=3091288
		Map output records=2834106
		Map output bytes=1138384576
		Map output materialized bytes=1149249611
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2515484
		Reduce shuffle bytes=1149249611
		Reduce input records=2834106
		Reduce output records=1906900
		Spilled Records=5668212
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=84754
		CPU time spent (ms)=1059190
		Physical memory (bytes) snapshot=326014652416
		Virtual memory (bytes) snapshot=742475808768
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=957332441
	File Output Format Counters 
		Bytes Written=640999536
16/12/06 19:48:06 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/1900
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041600 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/2000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041600
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/2000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob155617867895477089.jar tmpDir=null
16/12/06 19:48:44 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:48:45 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:48:45 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 19:48:47 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 19:48:47 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 19:48:47 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4865
16/12/06 19:48:48 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4865
16/12/06 19:48:48 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4865/
16/12/06 19:48:48 INFO mapreduce.Job: Running job: job_1480588584072_4865
16/12/06 19:49:01 INFO mapreduce.Job: Job job_1480588584072_4865 running in uber mode : false
16/12/06 19:49:01 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 19:49:17 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 19:49:18 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 19:49:19 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 19:49:20 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 19:49:23 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 19:49:24 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 19:49:31 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 19:49:32 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 19:49:33 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 19:49:34 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 19:49:35 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 19:49:36 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 19:49:37 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 19:49:42 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 19:49:43 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 19:49:45 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 19:49:46 INFO mapreduce.Job:  map 19% reduce 1%
16/12/06 19:49:47 INFO mapreduce.Job:  map 22% reduce 2%
16/12/06 19:49:48 INFO mapreduce.Job:  map 26% reduce 3%
16/12/06 19:49:49 INFO mapreduce.Job:  map 30% reduce 3%
16/12/06 19:49:50 INFO mapreduce.Job:  map 33% reduce 4%
16/12/06 19:49:51 INFO mapreduce.Job:  map 37% reduce 4%
16/12/06 19:49:52 INFO mapreduce.Job:  map 39% reduce 5%
16/12/06 19:49:53 INFO mapreduce.Job:  map 41% reduce 6%
16/12/06 19:49:54 INFO mapreduce.Job:  map 42% reduce 7%
16/12/06 19:49:55 INFO mapreduce.Job:  map 43% reduce 7%
16/12/06 19:49:56 INFO mapreduce.Job:  map 44% reduce 7%
16/12/06 19:49:57 INFO mapreduce.Job:  map 44% reduce 8%
16/12/06 19:49:58 INFO mapreduce.Job:  map 45% reduce 8%
16/12/06 19:49:59 INFO mapreduce.Job:  map 46% reduce 8%
16/12/06 19:50:01 INFO mapreduce.Job:  map 48% reduce 8%
16/12/06 19:50:02 INFO mapreduce.Job:  map 49% reduce 9%
16/12/06 19:50:04 INFO mapreduce.Job:  map 50% reduce 9%
16/12/06 19:50:06 INFO mapreduce.Job:  map 51% reduce 10%
16/12/06 19:50:07 INFO mapreduce.Job:  map 52% reduce 10%
16/12/06 19:50:08 INFO mapreduce.Job:  map 53% reduce 10%
16/12/06 19:50:09 INFO mapreduce.Job:  map 55% reduce 10%
16/12/06 19:50:10 INFO mapreduce.Job:  map 55% reduce 11%
16/12/06 19:50:12 INFO mapreduce.Job:  map 56% reduce 11%
16/12/06 19:50:13 INFO mapreduce.Job:  map 56% reduce 12%
16/12/06 19:50:14 INFO mapreduce.Job:  map 57% reduce 12%
16/12/06 19:50:15 INFO mapreduce.Job:  map 57% reduce 13%
16/12/06 19:50:16 INFO mapreduce.Job:  map 58% reduce 16%
16/12/06 19:50:17 INFO mapreduce.Job:  map 59% reduce 16%
16/12/06 19:50:18 INFO mapreduce.Job:  map 62% reduce 17%
16/12/06 19:50:19 INFO mapreduce.Job:  map 63% reduce 19%
16/12/06 19:50:20 INFO mapreduce.Job:  map 64% reduce 19%
16/12/06 19:50:21 INFO mapreduce.Job:  map 66% reduce 19%
16/12/06 19:50:22 INFO mapreduce.Job:  map 67% reduce 21%
16/12/06 19:50:23 INFO mapreduce.Job:  map 71% reduce 22%
16/12/06 19:50:25 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 19:50:26 INFO mapreduce.Job:  map 75% reduce 23%
16/12/06 19:50:27 INFO mapreduce.Job:  map 78% reduce 24%
16/12/06 19:50:28 INFO mapreduce.Job:  map 80% reduce 25%
16/12/06 19:50:29 INFO mapreduce.Job:  map 81% reduce 26%
16/12/06 19:50:31 INFO mapreduce.Job:  map 82% reduce 27%
16/12/06 19:50:34 INFO mapreduce.Job:  map 83% reduce 27%
16/12/06 19:50:35 INFO mapreduce.Job:  map 85% reduce 28%
16/12/06 19:50:36 INFO mapreduce.Job:  map 87% reduce 28%
16/12/06 19:50:37 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 19:50:38 INFO mapreduce.Job:  map 89% reduce 29%
16/12/06 19:50:39 INFO mapreduce.Job:  map 92% reduce 29%
16/12/06 19:50:40 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 19:50:41 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 19:50:42 INFO mapreduce.Job:  map 94% reduce 31%
16/12/06 19:50:43 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 19:50:45 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 19:50:46 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 19:50:47 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 19:50:48 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 19:50:49 INFO mapreduce.Job:  map 100% reduce 43%
16/12/06 19:50:50 INFO mapreduce.Job:  map 100% reduce 54%
16/12/06 19:50:51 INFO mapreduce.Job:  map 100% reduce 62%
16/12/06 19:50:52 INFO mapreduce.Job:  map 100% reduce 71%
16/12/06 19:50:53 INFO mapreduce.Job:  map 100% reduce 73%
16/12/06 19:50:54 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 19:50:55 INFO mapreduce.Job:  map 100% reduce 82%
16/12/06 19:50:56 INFO mapreduce.Job:  map 100% reduce 85%
16/12/06 19:50:57 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 19:50:58 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 19:51:00 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 19:51:01 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 19:51:05 INFO mapreduce.Job: Job job_1480588584072_4865 completed successfully
16/12/06 19:51:05 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=1045744145
		FILE: Number of bytes written=2123870255
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=874201323
		WASB: Number of bytes written=577039456
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13153868
		Total time spent by all reduces in occupied slots (ms)=3125808
		Total time spent by all map tasks (ms)=6576934
		Total time spent by all reduce tasks (ms)=1562904
		Total vcore-seconds taken by all map tasks=6576934
		Total vcore-seconds taken by all reduce tasks=1562904
		Total megabyte-seconds taken by all map tasks=6734780416
		Total megabyte-seconds taken by all reduce tasks=1600413696
	Map-Reduce Framework
		Map input records=2823371
		Map output records=2586101
		Map output bytes=1035854756
		Map output materialized bytes=1045767665
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2287135
		Reduce shuffle bytes=1045767665
		Reduce input records=2586101
		Reduce output records=1716432
		Spilled Records=5172202
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=86786
		CPU time spent (ms)=1039020
		Physical memory (bytes) snapshot=325632651264
		Virtual memory (bytes) snapshot=742476455936
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=871505319
	File Output Format Counters 
		Bytes Written=577039456
16/12/06 19:51:05 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/2000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041700 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/2100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041700
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/2100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3425031964877313898.jar tmpDir=null
16/12/06 19:51:42 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:51:43 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:51:44 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 19:51:46 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 19:51:46 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 19:51:46 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4866
16/12/06 19:51:47 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4866
16/12/06 19:51:47 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4866/
16/12/06 19:51:47 INFO mapreduce.Job: Running job: job_1480588584072_4866
16/12/06 19:51:59 INFO mapreduce.Job: Job job_1480588584072_4866 running in uber mode : false
16/12/06 19:51:59 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 19:52:10 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 19:52:18 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 19:52:26 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 19:52:29 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 19:52:30 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 19:52:31 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 19:52:35 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 19:52:36 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 19:52:43 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 19:52:44 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 19:52:45 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 19:52:46 INFO mapreduce.Job:  map 19% reduce 2%
16/12/06 19:52:47 INFO mapreduce.Job:  map 21% reduce 2%
16/12/06 19:52:48 INFO mapreduce.Job:  map 24% reduce 2%
16/12/06 19:52:49 INFO mapreduce.Job:  map 27% reduce 3%
16/12/06 19:52:50 INFO mapreduce.Job:  map 31% reduce 3%
16/12/06 19:52:51 INFO mapreduce.Job:  map 34% reduce 3%
16/12/06 19:52:52 INFO mapreduce.Job:  map 40% reduce 4%
16/12/06 19:52:53 INFO mapreduce.Job:  map 42% reduce 4%
16/12/06 19:52:54 INFO mapreduce.Job:  map 45% reduce 5%
16/12/06 19:52:55 INFO mapreduce.Job:  map 47% reduce 6%
16/12/06 19:52:56 INFO mapreduce.Job:  map 49% reduce 6%
16/12/06 19:52:57 INFO mapreduce.Job:  map 51% reduce 7%
16/12/06 19:52:58 INFO mapreduce.Job:  map 52% reduce 8%
16/12/06 19:53:00 INFO mapreduce.Job:  map 54% reduce 9%
16/12/06 19:53:01 INFO mapreduce.Job:  map 55% reduce 9%
16/12/06 19:53:03 INFO mapreduce.Job:  map 55% reduce 10%
16/12/06 19:53:04 INFO mapreduce.Job:  map 56% reduce 10%
16/12/06 19:53:08 INFO mapreduce.Job:  map 57% reduce 10%
16/12/06 19:53:09 INFO mapreduce.Job:  map 57% reduce 11%
16/12/06 19:53:12 INFO mapreduce.Job:  map 57% reduce 12%
16/12/06 19:53:13 INFO mapreduce.Job:  map 57% reduce 13%
16/12/06 19:53:14 INFO mapreduce.Job:  map 58% reduce 14%
16/12/06 19:53:15 INFO mapreduce.Job:  map 59% reduce 14%
16/12/06 19:53:16 INFO mapreduce.Job:  map 61% reduce 15%
16/12/06 19:53:17 INFO mapreduce.Job:  map 61% reduce 17%
16/12/06 19:53:18 INFO mapreduce.Job:  map 62% reduce 17%
16/12/06 19:53:19 INFO mapreduce.Job:  map 63% reduce 18%
16/12/06 19:53:20 INFO mapreduce.Job:  map 65% reduce 18%
16/12/06 19:53:21 INFO mapreduce.Job:  map 66% reduce 19%
16/12/06 19:53:22 INFO mapreduce.Job:  map 68% reduce 19%
16/12/06 19:53:23 INFO mapreduce.Job:  map 69% reduce 20%
16/12/06 19:53:24 INFO mapreduce.Job:  map 73% reduce 20%
16/12/06 19:53:25 INFO mapreduce.Job:  map 74% reduce 20%
16/12/06 19:53:26 INFO mapreduce.Job:  map 77% reduce 21%
16/12/06 19:53:27 INFO mapreduce.Job:  map 81% reduce 22%
16/12/06 19:53:28 INFO mapreduce.Job:  map 87% reduce 23%
16/12/06 19:53:29 INFO mapreduce.Job:  map 90% reduce 25%
16/12/06 19:53:30 INFO mapreduce.Job:  map 93% reduce 27%
16/12/06 19:53:31 INFO mapreduce.Job:  map 93% reduce 28%
16/12/06 19:53:32 INFO mapreduce.Job:  map 93% reduce 29%
16/12/06 19:53:33 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 19:53:35 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 19:53:37 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 19:53:39 INFO mapreduce.Job:  map 96% reduce 30%
16/12/06 19:53:40 INFO mapreduce.Job:  map 98% reduce 30%
16/12/06 19:53:41 INFO mapreduce.Job:  map 99% reduce 31%
16/12/06 19:53:42 INFO mapreduce.Job:  map 100% reduce 31%
16/12/06 19:53:43 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 19:53:44 INFO mapreduce.Job:  map 100% reduce 40%
16/12/06 19:53:45 INFO mapreduce.Job:  map 100% reduce 48%
16/12/06 19:53:47 INFO mapreduce.Job:  map 100% reduce 61%
16/12/06 19:53:48 INFO mapreduce.Job:  map 100% reduce 66%
16/12/06 19:53:49 INFO mapreduce.Job:  map 100% reduce 72%
16/12/06 19:53:50 INFO mapreduce.Job:  map 100% reduce 77%
16/12/06 19:53:51 INFO mapreduce.Job:  map 100% reduce 80%
16/12/06 19:53:52 INFO mapreduce.Job:  map 100% reduce 85%
16/12/06 19:53:53 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 19:53:54 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 19:53:55 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 19:53:56 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 19:53:57 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 19:53:59 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 19:54:00 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 19:54:04 INFO mapreduce.Job: Job job_1480588584072_4866 completed successfully
16/12/06 19:54:04 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=998011859
		FILE: Number of bytes written=2028405683
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=826120131
		WASB: Number of bytes written=582679839
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12936560
		Total time spent by all reduces in occupied slots (ms)=2967280
		Total time spent by all map tasks (ms)=6468280
		Total time spent by all reduce tasks (ms)=1483640
		Total vcore-seconds taken by all map tasks=6468280
		Total vcore-seconds taken by all reduce tasks=1483640
		Total megabyte-seconds taken by all map tasks=6623518720
		Total megabyte-seconds taken by all reduce tasks=1519247360
	Map-Reduce Framework
		Map input records=2642149
		Map output records=2455995
		Map output bytes=988618131
		Map output materialized bytes=998035379
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2186708
		Reduce shuffle bytes=998035379
		Reduce input records=2455995
		Reduce output records=1724181
		Spilled Records=4911990
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=87578
		CPU time spent (ms)=1008920
		Physical memory (bytes) snapshot=325633527808
		Virtual memory (bytes) snapshot=742344859648
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=823424127
	File Output Format Counters 
		Bytes Written=582679839
16/12/06 19:54:04 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/2100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041800 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/2200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041800
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/2200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7440098409985258021.jar tmpDir=null
16/12/06 19:54:41 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:54:42 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:54:42 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 19:54:44 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 19:54:44 INFO mapreduce.JobSubmitter: number of splits:229
16/12/06 19:54:45 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4867
16/12/06 19:54:45 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4867
16/12/06 19:54:45 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4867/
16/12/06 19:54:45 INFO mapreduce.Job: Running job: job_1480588584072_4867
16/12/06 19:54:57 INFO mapreduce.Job: Job job_1480588584072_4867 running in uber mode : false
16/12/06 19:54:57 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 19:55:19 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 19:55:20 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 19:55:25 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 19:55:26 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 19:55:27 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 19:55:28 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 19:55:31 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 19:55:33 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 19:55:43 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 19:55:44 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 19:55:45 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 19:55:47 INFO mapreduce.Job:  map 24% reduce 1%
16/12/06 19:55:48 INFO mapreduce.Job:  map 26% reduce 3%
16/12/06 19:55:49 INFO mapreduce.Job:  map 29% reduce 3%
16/12/06 19:55:50 INFO mapreduce.Job:  map 32% reduce 3%
16/12/06 19:55:51 INFO mapreduce.Job:  map 33% reduce 4%
16/12/06 19:55:52 INFO mapreduce.Job:  map 38% reduce 4%
16/12/06 19:55:53 INFO mapreduce.Job:  map 43% reduce 4%
16/12/06 19:55:54 INFO mapreduce.Job:  map 46% reduce 6%
16/12/06 19:55:55 INFO mapreduce.Job:  map 47% reduce 7%
16/12/06 19:55:56 INFO mapreduce.Job:  map 49% reduce 7%
16/12/06 19:55:58 INFO mapreduce.Job:  map 49% reduce 8%
16/12/06 19:55:59 INFO mapreduce.Job:  map 52% reduce 9%
16/12/06 19:56:01 INFO mapreduce.Job:  map 52% reduce 10%
16/12/06 19:56:02 INFO mapreduce.Job:  map 52% reduce 12%
16/12/06 19:56:08 INFO mapreduce.Job:  map 53% reduce 12%
16/12/06 19:56:09 INFO mapreduce.Job:  map 54% reduce 12%
16/12/06 19:56:10 INFO mapreduce.Job:  map 54% reduce 13%
16/12/06 19:56:12 INFO mapreduce.Job:  map 55% reduce 14%
16/12/06 19:56:14 INFO mapreduce.Job:  map 58% reduce 15%
16/12/06 19:56:15 INFO mapreduce.Job:  map 59% reduce 15%
16/12/06 19:56:18 INFO mapreduce.Job:  map 61% reduce 17%
16/12/06 19:56:20 INFO mapreduce.Job:  map 62% reduce 19%
16/12/06 19:56:21 INFO mapreduce.Job:  map 64% reduce 19%
16/12/06 19:56:22 INFO mapreduce.Job:  map 67% reduce 21%
16/12/06 19:56:23 INFO mapreduce.Job:  map 68% reduce 21%
16/12/06 19:56:24 INFO mapreduce.Job:  map 70% reduce 21%
16/12/06 19:56:25 INFO mapreduce.Job:  map 72% reduce 21%
16/12/06 19:56:26 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 19:56:27 INFO mapreduce.Job:  map 77% reduce 23%
16/12/06 19:56:28 INFO mapreduce.Job:  map 79% reduce 23%
16/12/06 19:56:29 INFO mapreduce.Job:  map 81% reduce 25%
16/12/06 19:56:30 INFO mapreduce.Job:  map 82% reduce 25%
16/12/06 19:56:31 INFO mapreduce.Job:  map 84% reduce 26%
16/12/06 19:56:32 INFO mapreduce.Job:  map 85% reduce 26%
16/12/06 19:56:33 INFO mapreduce.Job:  map 85% reduce 28%
16/12/06 19:56:34 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 19:56:35 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 19:56:36 INFO mapreduce.Job:  map 92% reduce 29%
16/12/06 19:56:38 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 19:56:39 INFO mapreduce.Job:  map 93% reduce 31%
16/12/06 19:56:40 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 19:56:41 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 19:56:42 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 19:56:44 INFO mapreduce.Job:  map 100% reduce 37%
16/12/06 19:56:45 INFO mapreduce.Job:  map 100% reduce 50%
16/12/06 19:56:48 INFO mapreduce.Job:  map 100% reduce 54%
16/12/06 19:56:49 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 19:56:51 INFO mapreduce.Job:  map 100% reduce 79%
16/12/06 19:56:52 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 19:56:54 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 19:56:55 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 19:56:57 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 19:57:00 INFO mapreduce.Job: Job job_1480588584072_4867 completed successfully
16/12/06 19:57:00 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=830340572
		FILE: Number of bytes written=1697840229
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=694316392
		WASB: Number of bytes written=496256048
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=229
		Launched reduce tasks=20
		Rack-local map tasks=229
		Total time spent by all maps in occupied slots (ms)=13565344
		Total time spent by all reduces in occupied slots (ms)=2986036
		Total time spent by all map tasks (ms)=6782672
		Total time spent by all reduce tasks (ms)=1493018
		Total vcore-seconds taken by all map tasks=6782672
		Total vcore-seconds taken by all reduce tasks=1493018
		Total megabyte-seconds taken by all map tasks=6945456128
		Total megabyte-seconds taken by all reduce tasks=1528850432
	Map-Reduce Framework
		Map input records=2197001
		Map output records=2048555
		Map output bytes=822525175
		Map output materialized bytes=830367932
		Input split bytes=31932
		Combine input records=0
		Combine output records=0
		Reduce input groups=1831618
		Reduce shuffle bytes=830367932
		Reduce input records=2048555
		Reduce output records=1473330
		Spilled Records=4097110
		Shuffled Maps =4580
		Failed Shuffles=0
		Merged Map outputs=4580
		GC time elapsed (ms)=90360
		CPU time spent (ms)=1041260
		Physical memory (bytes) snapshot=376136859648
		Virtual memory (bytes) snapshot=851839111168
		Total committed heap usage (bytes)=659265945600
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=690659252
	File Output Format Counters 
		Bytes Written=496256048
16/12/06 19:57:00 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/2200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041900 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/2300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161204/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041900
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/2300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3015895833873619949.jar tmpDir=null
16/12/06 19:57:36 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:57:37 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 19:57:37 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 19:57:39 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 19:57:39 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 19:57:39 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4868
16/12/06 19:57:40 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4868
16/12/06 19:57:40 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4868/
16/12/06 19:57:40 INFO mapreduce.Job: Running job: job_1480588584072_4868
16/12/06 19:57:52 INFO mapreduce.Job: Job job_1480588584072_4868 running in uber mode : false
16/12/06 19:57:52 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 19:58:15 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 19:58:16 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 19:58:19 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 19:58:21 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 19:58:22 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 19:58:23 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 19:58:24 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 19:58:25 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 19:58:26 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 19:58:27 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 19:58:28 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 19:58:29 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 19:58:37 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 19:58:38 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 19:58:39 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 19:58:40 INFO mapreduce.Job:  map 35% reduce 0%
16/12/06 19:58:41 INFO mapreduce.Job:  map 36% reduce 0%
16/12/06 19:58:43 INFO mapreduce.Job:  map 39% reduce 2%
16/12/06 19:58:44 INFO mapreduce.Job:  map 42% reduce 4%
16/12/06 19:58:45 INFO mapreduce.Job:  map 43% reduce 5%
16/12/06 19:58:46 INFO mapreduce.Job:  map 45% reduce 5%
16/12/06 19:58:47 INFO mapreduce.Job:  map 47% reduce 6%
16/12/06 19:58:48 INFO mapreduce.Job:  map 48% reduce 7%
16/12/06 19:58:49 INFO mapreduce.Job:  map 50% reduce 9%
16/12/06 19:58:50 INFO mapreduce.Job:  map 52% reduce 12%
16/12/06 19:58:51 INFO mapreduce.Job:  map 53% reduce 13%
16/12/06 19:58:52 INFO mapreduce.Job:  map 55% reduce 14%
16/12/06 19:58:53 INFO mapreduce.Job:  map 57% reduce 14%
16/12/06 19:58:54 INFO mapreduce.Job:  map 58% reduce 16%
16/12/06 19:58:55 INFO mapreduce.Job:  map 59% reduce 18%
16/12/06 19:58:56 INFO mapreduce.Job:  map 59% reduce 19%
16/12/06 19:58:57 INFO mapreduce.Job:  map 60% reduce 19%
16/12/06 19:58:58 INFO mapreduce.Job:  map 62% reduce 19%
16/12/06 19:58:59 INFO mapreduce.Job:  map 62% reduce 20%
16/12/06 19:59:00 INFO mapreduce.Job:  map 65% reduce 20%
16/12/06 19:59:01 INFO mapreduce.Job:  map 65% reduce 21%
16/12/06 19:59:02 INFO mapreduce.Job:  map 66% reduce 21%
16/12/06 19:59:03 INFO mapreduce.Job:  map 66% reduce 22%
16/12/06 19:59:05 INFO mapreduce.Job:  map 67% reduce 22%
16/12/06 19:59:06 INFO mapreduce.Job:  map 68% reduce 22%
16/12/06 19:59:07 INFO mapreduce.Job:  map 71% reduce 22%
16/12/06 19:59:08 INFO mapreduce.Job:  map 75% reduce 23%
16/12/06 19:59:09 INFO mapreduce.Job:  map 78% reduce 23%
16/12/06 19:59:10 INFO mapreduce.Job:  map 80% reduce 25%
16/12/06 19:59:11 INFO mapreduce.Job:  map 81% reduce 25%
16/12/06 19:59:12 INFO mapreduce.Job:  map 83% reduce 26%
16/12/06 19:59:13 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 19:59:14 INFO mapreduce.Job:  map 87% reduce 27%
16/12/06 19:59:15 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 19:59:16 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 19:59:18 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 19:59:19 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 19:59:20 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 19:59:21 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 19:59:22 INFO mapreduce.Job:  map 94% reduce 31%
16/12/06 19:59:24 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 19:59:25 INFO mapreduce.Job:  map 97% reduce 32%
16/12/06 19:59:26 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 19:59:27 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 19:59:28 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 19:59:29 INFO mapreduce.Job:  map 100% reduce 39%
16/12/06 19:59:30 INFO mapreduce.Job:  map 100% reduce 50%
16/12/06 19:59:31 INFO mapreduce.Job:  map 100% reduce 64%
16/12/06 19:59:32 INFO mapreduce.Job:  map 100% reduce 72%
16/12/06 19:59:33 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 19:59:34 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 19:59:35 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 19:59:36 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 19:59:37 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 19:59:38 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 19:59:39 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 19:59:41 INFO mapreduce.Job: Job job_1480588584072_4868 completed successfully
16/12/06 19:59:42 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=493475419
		FILE: Number of bytes written=1019332803
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=410142228
		WASB: Number of bytes written=275810896
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=11587828
		Total time spent by all reduces in occupied slots (ms)=2676862
		Total time spent by all map tasks (ms)=5793914
		Total time spent by all reduce tasks (ms)=1338431
		Total vcore-seconds taken by all map tasks=5793914
		Total vcore-seconds taken by all reduce tasks=1338431
		Total megabyte-seconds taken by all map tasks=5932967936
		Total megabyte-seconds taken by all reduce tasks=1370553344
	Map-Reduce Framework
		Map input records=1340745
		Map output records=1237160
		Map output bytes=488779767
		Map output materialized bytes=493498939
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1095736
		Reduce shuffle bytes=493498939
		Reduce input records=1237160
		Reduce output records=824281
		Spilled Records=2474320
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=71261
		CPU time spent (ms)=829150
		Physical memory (bytes) snapshot=323383078912
		Virtual memory (bytes) snapshot=742748057600
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=407446224
	File Output Format Counters 
		Bytes Written=275810896
16/12/06 19:59:42 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161204/2300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161204/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4580557226548666771.jar tmpDir=null
16/12/06 20:00:19 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:00:20 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:00:20 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 20:00:22 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 20:00:22 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 20:00:23 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4870
16/12/06 20:00:23 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4870
16/12/06 20:00:23 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4870/
16/12/06 20:00:23 INFO mapreduce.Job: Running job: job_1480588584072_4870
16/12/06 20:00:38 INFO mapreduce.Job: Job job_1480588584072_4870 running in uber mode : false
16/12/06 20:00:38 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 20:00:58 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 20:00:59 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 20:01:06 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 20:01:07 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 20:01:08 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 20:01:09 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 20:01:10 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 20:01:11 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 20:01:18 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 20:01:19 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 20:01:20 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 20:01:21 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 20:01:22 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 20:01:23 INFO mapreduce.Job:  map 27% reduce 0%
16/12/06 20:01:25 INFO mapreduce.Job:  map 30% reduce 0%
16/12/06 20:01:26 INFO mapreduce.Job:  map 31% reduce 0%
16/12/06 20:01:27 INFO mapreduce.Job:  map 33% reduce 0%
16/12/06 20:01:28 INFO mapreduce.Job:  map 34% reduce 0%
16/12/06 20:01:30 INFO mapreduce.Job:  map 35% reduce 0%
16/12/06 20:01:31 INFO mapreduce.Job:  map 35% reduce 1%
16/12/06 20:01:33 INFO mapreduce.Job:  map 37% reduce 2%
16/12/06 20:01:34 INFO mapreduce.Job:  map 41% reduce 4%
16/12/06 20:01:35 INFO mapreduce.Job:  map 43% reduce 4%
16/12/06 20:01:36 INFO mapreduce.Job:  map 44% reduce 6%
16/12/06 20:01:38 INFO mapreduce.Job:  map 45% reduce 6%
16/12/06 20:01:39 INFO mapreduce.Job:  map 45% reduce 7%
16/12/06 20:01:42 INFO mapreduce.Job:  map 47% reduce 8%
16/12/06 20:01:44 INFO mapreduce.Job:  map 50% reduce 9%
16/12/06 20:01:45 INFO mapreduce.Job:  map 52% reduce 11%
16/12/06 20:01:46 INFO mapreduce.Job:  map 53% reduce 12%
16/12/06 20:01:48 INFO mapreduce.Job:  map 54% reduce 14%
16/12/06 20:01:49 INFO mapreduce.Job:  map 55% reduce 15%
16/12/06 20:01:50 INFO mapreduce.Job:  map 57% reduce 15%
16/12/06 20:01:51 INFO mapreduce.Job:  map 58% reduce 18%
16/12/06 20:01:52 INFO mapreduce.Job:  map 60% reduce 18%
16/12/06 20:01:54 INFO mapreduce.Job:  map 60% reduce 19%
16/12/06 20:01:59 INFO mapreduce.Job:  map 62% reduce 20%
16/12/06 20:02:00 INFO mapreduce.Job:  map 65% reduce 20%
16/12/06 20:02:01 INFO mapreduce.Job:  map 67% reduce 21%
16/12/06 20:02:02 INFO mapreduce.Job:  map 68% reduce 21%
16/12/06 20:02:03 INFO mapreduce.Job:  map 70% reduce 22%
16/12/06 20:02:04 INFO mapreduce.Job:  map 70% reduce 23%
16/12/06 20:02:05 INFO mapreduce.Job:  map 72% reduce 23%
16/12/06 20:02:07 INFO mapreduce.Job:  map 75% reduce 24%
16/12/06 20:02:08 INFO mapreduce.Job:  map 78% reduce 24%
16/12/06 20:02:09 INFO mapreduce.Job:  map 78% reduce 25%
16/12/06 20:02:10 INFO mapreduce.Job:  map 81% reduce 25%
16/12/06 20:02:11 INFO mapreduce.Job:  map 82% reduce 26%
16/12/06 20:02:12 INFO mapreduce.Job:  map 83% reduce 27%
16/12/06 20:02:14 INFO mapreduce.Job:  map 85% reduce 28%
16/12/06 20:02:16 INFO mapreduce.Job:  map 86% reduce 28%
16/12/06 20:02:17 INFO mapreduce.Job:  map 89% reduce 28%
16/12/06 20:02:18 INFO mapreduce.Job:  map 91% reduce 29%
16/12/06 20:02:20 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 20:02:21 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 20:02:22 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 20:02:23 INFO mapreduce.Job:  map 94% reduce 31%
16/12/06 20:02:26 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 20:02:27 INFO mapreduce.Job:  map 97% reduce 32%
16/12/06 20:02:28 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 20:02:29 INFO mapreduce.Job:  map 99% reduce 33%
16/12/06 20:02:30 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 20:02:31 INFO mapreduce.Job:  map 100% reduce 41%
16/12/06 20:02:32 INFO mapreduce.Job:  map 100% reduce 52%
16/12/06 20:02:33 INFO mapreduce.Job:  map 100% reduce 58%
16/12/06 20:02:34 INFO mapreduce.Job:  map 100% reduce 66%
16/12/06 20:02:35 INFO mapreduce.Job:  map 100% reduce 77%
16/12/06 20:02:36 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 20:02:37 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 20:02:38 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 20:02:39 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 20:02:40 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 20:02:42 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 20:02:45 INFO mapreduce.Job: Job job_1480588584072_4870 completed successfully
16/12/06 20:02:46 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=297527800
		FILE: Number of bytes written=627437565
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=247379691
		WASB: Number of bytes written=163510482
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=10747210
		Total time spent by all reduces in occupied slots (ms)=3205442
		Total time spent by all map tasks (ms)=5373605
		Total time spent by all reduce tasks (ms)=1602721
		Total vcore-seconds taken by all map tasks=5373605
		Total vcore-seconds taken by all reduce tasks=1602721
		Total megabyte-seconds taken by all map tasks=5502571520
		Total megabyte-seconds taken by all reduce tasks=1641186304
	Map-Reduce Framework
		Map input records=833569
		Map output records=768493
		Map output bytes=294654818
		Map output materialized bytes=297551320
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=685348
		Reduce shuffle bytes=297551320
		Reduce input records=768493
		Reduce output records=502460
		Spilled Records=1536986
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=70636
		CPU time spent (ms)=734290
		Physical memory (bytes) snapshot=322566975488
		Virtual memory (bytes) snapshot=742555570176
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=244683687
	File Output Format Counters 
		Bytes Written=163510482
16/12/06 20:02:46 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1701882223282020303.jar tmpDir=null
16/12/06 20:03:22 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:03:23 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:03:23 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 20:03:25 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 20:03:25 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 20:03:26 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4871
16/12/06 20:03:26 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4871
16/12/06 20:03:27 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4871/
16/12/06 20:03:27 INFO mapreduce.Job: Running job: job_1480588584072_4871
16/12/06 20:05:13 INFO mapreduce.Job: Job job_1480588584072_4871 running in uber mode : false
16/12/06 20:05:13 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 20:05:36 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 20:05:37 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 20:05:40 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 20:05:43 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 20:05:44 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 20:05:45 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 20:05:46 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 20:05:47 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 20:05:49 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 20:05:50 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 20:05:52 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 20:05:53 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 20:05:54 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 20:05:55 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 20:05:57 INFO mapreduce.Job:  map 27% reduce 0%
16/12/06 20:05:59 INFO mapreduce.Job:  map 29% reduce 0%
16/12/06 20:06:00 INFO mapreduce.Job:  map 31% reduce 0%
16/12/06 20:06:01 INFO mapreduce.Job:  map 36% reduce 1%
16/12/06 20:06:03 INFO mapreduce.Job:  map 42% reduce 1%
16/12/06 20:06:05 INFO mapreduce.Job:  map 44% reduce 2%
16/12/06 20:06:06 INFO mapreduce.Job:  map 45% reduce 3%
16/12/06 20:06:07 INFO mapreduce.Job:  map 45% reduce 5%
16/12/06 20:06:08 INFO mapreduce.Job:  map 46% reduce 5%
16/12/06 20:06:09 INFO mapreduce.Job:  map 49% reduce 7%
16/12/06 20:06:10 INFO mapreduce.Job:  map 50% reduce 7%
16/12/06 20:06:11 INFO mapreduce.Job:  map 53% reduce 7%
16/12/06 20:06:12 INFO mapreduce.Job:  map 55% reduce 10%
16/12/06 20:06:13 INFO mapreduce.Job:  map 59% reduce 12%
16/12/06 20:06:14 INFO mapreduce.Job:  map 59% reduce 13%
16/12/06 20:06:15 INFO mapreduce.Job:  map 60% reduce 14%
16/12/06 20:06:16 INFO mapreduce.Job:  map 60% reduce 16%
16/12/06 20:06:17 INFO mapreduce.Job:  map 63% reduce 16%
16/12/06 20:06:18 INFO mapreduce.Job:  map 65% reduce 16%
16/12/06 20:06:19 INFO mapreduce.Job:  map 66% reduce 19%
16/12/06 20:06:20 INFO mapreduce.Job:  map 68% reduce 20%
16/12/06 20:06:21 INFO mapreduce.Job:  map 68% reduce 21%
16/12/06 20:06:23 INFO mapreduce.Job:  map 71% reduce 21%
16/12/06 20:06:24 INFO mapreduce.Job:  map 74% reduce 23%
16/12/06 20:06:25 INFO mapreduce.Job:  map 75% reduce 24%
16/12/06 20:06:27 INFO mapreduce.Job:  map 77% reduce 25%
16/12/06 20:06:28 INFO mapreduce.Job:  map 80% reduce 25%
16/12/06 20:06:29 INFO mapreduce.Job:  map 82% reduce 26%
16/12/06 20:06:30 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 20:06:32 INFO mapreduce.Job:  map 85% reduce 28%
16/12/06 20:06:33 INFO mapreduce.Job:  map 86% reduce 28%
16/12/06 20:06:34 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 20:06:35 INFO mapreduce.Job:  map 92% reduce 29%
16/12/06 20:06:36 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 20:06:37 INFO mapreduce.Job:  map 93% reduce 31%
16/12/06 20:06:39 INFO mapreduce.Job:  map 94% reduce 31%
16/12/06 20:06:40 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 20:06:41 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 20:06:42 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 20:06:43 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 20:06:44 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 20:06:45 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 20:06:46 INFO mapreduce.Job:  map 100% reduce 44%
16/12/06 20:06:47 INFO mapreduce.Job:  map 100% reduce 61%
16/12/06 20:06:49 INFO mapreduce.Job:  map 100% reduce 77%
16/12/06 20:06:50 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 20:06:51 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 20:06:53 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 20:06:55 INFO mapreduce.Job: Job job_1480588584072_4871 completed successfully
16/12/06 20:06:55 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=201994737
		FILE: Number of bytes written=436371439
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=169743118
		WASB: Number of bytes written=105632141
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=10509036
		Total time spent by all reduces in occupied slots (ms)=2367374
		Total time spent by all map tasks (ms)=5254518
		Total time spent by all reduce tasks (ms)=1183687
		Total vcore-seconds taken by all map tasks=5254518
		Total vcore-seconds taken by all reduce tasks=1183687
		Total megabyte-seconds taken by all map tasks=5380626432
		Total megabyte-seconds taken by all reduce tasks=1212095488
	Map-Reduce Framework
		Map input records=588304
		Map output records=535163
		Map output bytes=200012555
		Map output materialized bytes=202018257
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=474965
		Reduce shuffle bytes=202018257
		Reduce input records=535163
		Reduce output records=326925
		Spilled Records=1070326
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=66527
		CPU time spent (ms)=676190
		Physical memory (bytes) snapshot=322098884608
		Virtual memory (bytes) snapshot=742686408704
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=167047114
	File Output Format Counters 
		Bytes Written=105632141
16/12/06 20:06:55 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob6587665361620009461.jar tmpDir=null
16/12/06 20:07:32 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:07:33 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:07:34 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 20:07:36 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 20:07:36 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 20:07:37 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4872
16/12/06 20:07:37 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4872
16/12/06 20:07:37 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4872/
16/12/06 20:07:37 INFO mapreduce.Job: Running job: job_1480588584072_4872
16/12/06 20:07:50 INFO mapreduce.Job: Job job_1480588584072_4872 running in uber mode : false
16/12/06 20:07:50 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 20:08:11 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 20:08:14 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 20:08:16 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 20:08:17 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 20:08:18 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 20:08:19 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 20:08:20 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 20:08:21 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 20:08:22 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 20:08:25 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 20:08:27 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 20:08:28 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 20:08:29 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 20:08:30 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 20:08:32 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 20:08:33 INFO mapreduce.Job:  map 27% reduce 0%
16/12/06 20:08:34 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 20:08:35 INFO mapreduce.Job:  map 29% reduce 0%
16/12/06 20:08:36 INFO mapreduce.Job:  map 30% reduce 0%
16/12/06 20:08:37 INFO mapreduce.Job:  map 31% reduce 1%
16/12/06 20:08:38 INFO mapreduce.Job:  map 35% reduce 1%
16/12/06 20:08:39 INFO mapreduce.Job:  map 38% reduce 3%
16/12/06 20:08:40 INFO mapreduce.Job:  map 42% reduce 4%
16/12/06 20:08:41 INFO mapreduce.Job:  map 45% reduce 5%
16/12/06 20:08:42 INFO mapreduce.Job:  map 48% reduce 5%
16/12/06 20:08:43 INFO mapreduce.Job:  map 51% reduce 6%
16/12/06 20:08:44 INFO mapreduce.Job:  map 53% reduce 8%
16/12/06 20:08:45 INFO mapreduce.Job:  map 55% reduce 9%
16/12/06 20:08:47 INFO mapreduce.Job:  map 56% reduce 11%
16/12/06 20:08:48 INFO mapreduce.Job:  map 58% reduce 11%
16/12/06 20:08:49 INFO mapreduce.Job:  map 60% reduce 13%
16/12/06 20:08:50 INFO mapreduce.Job:  map 61% reduce 13%
16/12/06 20:08:52 INFO mapreduce.Job:  map 62% reduce 15%
16/12/06 20:08:53 INFO mapreduce.Job:  map 63% reduce 15%
16/12/06 20:08:54 INFO mapreduce.Job:  map 64% reduce 16%
16/12/06 20:08:55 INFO mapreduce.Job:  map 66% reduce 18%
16/12/06 20:08:56 INFO mapreduce.Job:  map 68% reduce 21%
16/12/06 20:08:57 INFO mapreduce.Job:  map 70% reduce 22%
16/12/06 20:08:58 INFO mapreduce.Job:  map 72% reduce 23%
16/12/06 20:08:59 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 20:09:00 INFO mapreduce.Job:  map 74% reduce 24%
16/12/06 20:09:01 INFO mapreduce.Job:  map 76% reduce 24%
16/12/06 20:09:02 INFO mapreduce.Job:  map 77% reduce 25%
16/12/06 20:09:05 INFO mapreduce.Job:  map 78% reduce 26%
16/12/06 20:09:06 INFO mapreduce.Job:  map 80% reduce 26%
16/12/06 20:09:07 INFO mapreduce.Job:  map 82% reduce 26%
16/12/06 20:09:08 INFO mapreduce.Job:  map 83% reduce 26%
16/12/06 20:09:09 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 20:09:10 INFO mapreduce.Job:  map 86% reduce 28%
16/12/06 20:09:11 INFO mapreduce.Job:  map 87% reduce 28%
16/12/06 20:09:12 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 20:09:13 INFO mapreduce.Job:  map 92% reduce 29%
16/12/06 20:09:14 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 20:09:15 INFO mapreduce.Job:  map 94% reduce 31%
16/12/06 20:09:16 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 20:09:17 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 20:09:18 INFO mapreduce.Job:  map 97% reduce 32%
16/12/06 20:09:19 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 20:09:20 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 20:09:21 INFO mapreduce.Job:  map 99% reduce 33%
16/12/06 20:09:25 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 20:09:27 INFO mapreduce.Job:  map 100% reduce 44%
16/12/06 20:09:28 INFO mapreduce.Job:  map 100% reduce 51%
16/12/06 20:09:29 INFO mapreduce.Job:  map 100% reduce 69%
16/12/06 20:09:30 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 20:09:31 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 20:09:33 INFO mapreduce.Job: Job job_1480588584072_4872 completed successfully
16/12/06 20:09:33 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=168259837
		FILE: Number of bytes written=368901639
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=143500101
		WASB: Number of bytes written=77704896
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=10399516
		Total time spent by all reduces in occupied slots (ms)=2605122
		Total time spent by all map tasks (ms)=5199758
		Total time spent by all reduce tasks (ms)=1302561
		Total vcore-seconds taken by all map tasks=5199758
		Total vcore-seconds taken by all reduce tasks=1302561
		Total megabyte-seconds taken by all map tasks=5324552192
		Total megabyte-seconds taken by all reduce tasks=1333822464
	Map-Reduce Framework
		Map input records=514293
		Map output records=458208
		Map output bytes=166577899
		Map output materialized bytes=168283357
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=408807
		Reduce shuffle bytes=168283357
		Reduce input records=458208
		Reduce output records=244353
		Spilled Records=916416
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=64480
		CPU time spent (ms)=666240
		Physical memory (bytes) snapshot=322281947136
		Virtual memory (bytes) snapshot=742801227776
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=140804097
	File Output Format Counters 
		Bytes Written=77704896
16/12/06 20:09:33 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612041900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1714748853029374595.jar tmpDir=null
16/12/06 20:10:11 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:10:12 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:10:12 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 20:10:14 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 20:10:14 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 20:10:14 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4874
16/12/06 20:10:15 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4874
16/12/06 20:10:15 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4874/
16/12/06 20:10:15 INFO mapreduce.Job: Running job: job_1480588584072_4874
16/12/06 20:10:29 INFO mapreduce.Job: Job job_1480588584072_4874 running in uber mode : false
16/12/06 20:10:29 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 20:10:38 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 20:10:52 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 20:11:06 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 20:11:20 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 20:11:35 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 20:11:50 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 20:12:05 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 20:12:20 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 20:12:34 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 20:12:41 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 20:12:42 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 20:12:43 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 20:12:51 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 20:12:53 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 20:12:54 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 20:12:55 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 20:12:59 INFO mapreduce.Job:  map 17% reduce 1%
16/12/06 20:13:01 INFO mapreduce.Job:  map 19% reduce 1%
16/12/06 20:13:02 INFO mapreduce.Job:  map 20% reduce 1%
16/12/06 20:13:03 INFO mapreduce.Job:  map 21% reduce 1%
16/12/06 20:13:04 INFO mapreduce.Job:  map 21% reduce 2%
16/12/06 20:13:05 INFO mapreduce.Job:  map 22% reduce 2%
16/12/06 20:13:06 INFO mapreduce.Job:  map 22% reduce 3%
16/12/06 20:13:07 INFO mapreduce.Job:  map 24% reduce 3%
16/12/06 20:13:09 INFO mapreduce.Job:  map 26% reduce 4%
16/12/06 20:13:10 INFO mapreduce.Job:  map 27% reduce 4%
16/12/06 20:13:11 INFO mapreduce.Job:  map 30% reduce 4%
16/12/06 20:13:12 INFO mapreduce.Job:  map 32% reduce 5%
16/12/06 20:13:13 INFO mapreduce.Job:  map 34% reduce 6%
16/12/06 20:13:14 INFO mapreduce.Job:  map 37% reduce 6%
16/12/06 20:13:15 INFO mapreduce.Job:  map 37% reduce 7%
16/12/06 20:13:17 INFO mapreduce.Job:  map 39% reduce 8%
16/12/06 20:13:18 INFO mapreduce.Job:  map 40% reduce 8%
16/12/06 20:13:19 INFO mapreduce.Job:  map 41% reduce 8%
16/12/06 20:13:20 INFO mapreduce.Job:  map 43% reduce 9%
16/12/06 20:13:21 INFO mapreduce.Job:  map 47% reduce 9%
16/12/06 20:13:22 INFO mapreduce.Job:  map 47% reduce 10%
16/12/06 20:13:23 INFO mapreduce.Job:  map 48% reduce 10%
16/12/06 20:13:24 INFO mapreduce.Job:  map 49% reduce 11%
16/12/06 20:13:25 INFO mapreduce.Job:  map 51% reduce 11%
16/12/06 20:13:26 INFO mapreduce.Job:  map 54% reduce 12%
16/12/06 20:13:27 INFO mapreduce.Job:  map 56% reduce 12%
16/12/06 20:13:28 INFO mapreduce.Job:  map 58% reduce 13%
16/12/06 20:13:29 INFO mapreduce.Job:  map 59% reduce 14%
16/12/06 20:13:30 INFO mapreduce.Job:  map 60% reduce 14%
16/12/06 20:13:31 INFO mapreduce.Job:  map 61% reduce 14%
16/12/06 20:13:32 INFO mapreduce.Job:  map 61% reduce 15%
16/12/06 20:13:33 INFO mapreduce.Job:  map 63% reduce 15%
16/12/06 20:13:34 INFO mapreduce.Job:  map 65% reduce 16%
16/12/06 20:13:35 INFO mapreduce.Job:  map 67% reduce 18%
16/12/06 20:13:36 INFO mapreduce.Job:  map 69% reduce 19%
16/12/06 20:13:37 INFO mapreduce.Job:  map 70% reduce 20%
16/12/06 20:13:38 INFO mapreduce.Job:  map 71% reduce 20%
16/12/06 20:13:39 INFO mapreduce.Job:  map 73% reduce 21%
16/12/06 20:13:41 INFO mapreduce.Job:  map 74% reduce 22%
16/12/06 20:13:42 INFO mapreduce.Job:  map 76% reduce 22%
16/12/06 20:13:43 INFO mapreduce.Job:  map 77% reduce 22%
16/12/06 20:13:44 INFO mapreduce.Job:  map 79% reduce 23%
16/12/06 20:13:45 INFO mapreduce.Job:  map 80% reduce 23%
16/12/06 20:13:46 INFO mapreduce.Job:  map 82% reduce 23%
16/12/06 20:13:47 INFO mapreduce.Job:  map 83% reduce 24%
16/12/06 20:13:48 INFO mapreduce.Job:  map 89% reduce 26%
16/12/06 20:13:49 INFO mapreduce.Job:  map 92% reduce 28%
16/12/06 20:13:50 INFO mapreduce.Job:  map 94% reduce 29%
16/12/06 20:13:51 INFO mapreduce.Job:  map 94% reduce 31%
16/12/06 20:13:53 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 20:13:54 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 20:13:55 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 20:13:56 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 20:13:57 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 20:13:58 INFO mapreduce.Job:  map 100% reduce 43%
16/12/06 20:13:59 INFO mapreduce.Job:  map 100% reduce 63%
16/12/06 20:14:00 INFO mapreduce.Job:  map 100% reduce 88%
16/12/06 20:14:01 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 20:14:02 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 20:14:04 INFO mapreduce.Job: Job job_1480588584072_4874 completed successfully
16/12/06 20:14:04 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=174714584
		FILE: Number of bytes written=381811133
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=150142821
		WASB: Number of bytes written=70978400
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=8094810
		Total time spent by all reduces in occupied slots (ms)=2587196
		Total time spent by all map tasks (ms)=4047405
		Total time spent by all reduce tasks (ms)=1293598
		Total vcore-seconds taken by all map tasks=4047405
		Total vcore-seconds taken by all reduce tasks=1293598
		Total megabyte-seconds taken by all map tasks=4144542720
		Total megabyte-seconds taken by all reduce tasks=1324644352
	Map-Reduce Framework
		Map input records=545013
		Map output records=479830
		Map output bytes=172955907
		Map output materialized bytes=174738104
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=421607
		Reduce shuffle bytes=174738104
		Reduce input records=479830
		Reduce output records=225311
		Spilled Records=959660
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=66061
		CPU time spent (ms)=649890
		Physical memory (bytes) snapshot=322089848832
		Virtual memory (bytes) snapshot=742390919168
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=147446817
	File Output Format Counters 
		Bytes Written=70978400
16/12/06 20:14:04 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0400 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0400': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4711689518087284226.jar tmpDir=null
16/12/06 20:14:42 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:14:43 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:14:43 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 20:14:45 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 20:14:45 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 20:14:46 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4875
16/12/06 20:14:46 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4875
16/12/06 20:14:46 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4875/
16/12/06 20:14:46 INFO mapreduce.Job: Running job: job_1480588584072_4875
16/12/06 20:14:58 INFO mapreduce.Job: Job job_1480588584072_4875 running in uber mode : false
16/12/06 20:14:58 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 20:15:20 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 20:15:21 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 20:15:22 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 20:15:24 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 20:15:25 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 20:15:26 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 20:15:27 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 20:15:28 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 20:15:29 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 20:15:31 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 20:15:34 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 20:15:35 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 20:15:39 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 20:15:41 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 20:15:42 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 20:15:44 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 20:15:45 INFO mapreduce.Job:  map 27% reduce 0%
16/12/06 20:15:46 INFO mapreduce.Job:  map 29% reduce 0%
16/12/06 20:15:47 INFO mapreduce.Job:  map 35% reduce 2%
16/12/06 20:15:48 INFO mapreduce.Job:  map 36% reduce 3%
16/12/06 20:15:49 INFO mapreduce.Job:  map 41% reduce 4%
16/12/06 20:15:50 INFO mapreduce.Job:  map 43% reduce 6%
16/12/06 20:15:51 INFO mapreduce.Job:  map 45% reduce 7%
16/12/06 20:15:52 INFO mapreduce.Job:  map 47% reduce 9%
16/12/06 20:15:53 INFO mapreduce.Job:  map 51% reduce 10%
16/12/06 20:15:54 INFO mapreduce.Job:  map 54% reduce 11%
16/12/06 20:15:56 INFO mapreduce.Job:  map 55% reduce 11%
16/12/06 20:15:57 INFO mapreduce.Job:  map 56% reduce 14%
16/12/06 20:15:58 INFO mapreduce.Job:  map 56% reduce 15%
16/12/06 20:16:00 INFO mapreduce.Job:  map 58% reduce 16%
16/12/06 20:16:01 INFO mapreduce.Job:  map 59% reduce 16%
16/12/06 20:16:02 INFO mapreduce.Job:  map 60% reduce 16%
16/12/06 20:16:03 INFO mapreduce.Job:  map 60% reduce 17%
16/12/06 20:16:05 INFO mapreduce.Job:  map 61% reduce 17%
16/12/06 20:16:06 INFO mapreduce.Job:  map 63% reduce 17%
16/12/06 20:16:08 INFO mapreduce.Job:  map 63% reduce 18%
16/12/06 20:16:09 INFO mapreduce.Job:  map 66% reduce 18%
16/12/06 20:16:11 INFO mapreduce.Job:  map 67% reduce 19%
16/12/06 20:16:12 INFO mapreduce.Job:  map 69% reduce 19%
16/12/06 20:16:13 INFO mapreduce.Job:  map 71% reduce 20%
16/12/06 20:16:14 INFO mapreduce.Job:  map 72% reduce 22%
16/12/06 20:16:15 INFO mapreduce.Job:  map 73% reduce 22%
16/12/06 20:16:16 INFO mapreduce.Job:  map 77% reduce 24%
16/12/06 20:16:17 INFO mapreduce.Job:  map 81% reduce 25%
16/12/06 20:16:18 INFO mapreduce.Job:  map 85% reduce 26%
16/12/06 20:16:19 INFO mapreduce.Job:  map 88% reduce 27%
16/12/06 20:16:20 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 20:16:21 INFO mapreduce.Job:  map 89% reduce 29%
16/12/06 20:16:23 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 20:16:24 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 20:16:26 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 20:16:27 INFO mapreduce.Job:  map 93% reduce 31%
16/12/06 20:16:28 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 20:16:30 INFO mapreduce.Job:  map 97% reduce 32%
16/12/06 20:16:31 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 20:16:32 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 20:16:33 INFO mapreduce.Job:  map 100% reduce 45%
16/12/06 20:16:34 INFO mapreduce.Job:  map 100% reduce 59%
16/12/06 20:16:35 INFO mapreduce.Job:  map 100% reduce 72%
16/12/06 20:16:36 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 20:16:37 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 20:16:38 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 20:16:40 INFO mapreduce.Job: Job job_1480588584072_4875 completed successfully
16/12/06 20:16:40 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=259010678
		FILE: Number of bytes written=550403321
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=223079708
		WASB: Number of bytes written=111980300
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=11530314
		Total time spent by all reduces in occupied slots (ms)=2442508
		Total time spent by all map tasks (ms)=5765157
		Total time spent by all reduce tasks (ms)=1221254
		Total vcore-seconds taken by all map tasks=5765157
		Total vcore-seconds taken by all reduce tasks=1221254
		Total megabyte-seconds taken by all map tasks=5903520768
		Total megabyte-seconds taken by all reduce tasks=1250564096
	Map-Reduce Framework
		Map input records=795267
		Map output records=700042
		Map output bytes=256429894
		Map output materialized bytes=259034198
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=618275
		Reduce shuffle bytes=259034198
		Reduce input records=700042
		Reduce output records=355599
		Spilled Records=1400084
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=67791
		CPU time spent (ms)=739140
		Physical memory (bytes) snapshot=322721214464
		Virtual memory (bytes) snapshot=742472744960
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=220383704
	File Output Format Counters 
		Bytes Written=111980300
16/12/06 20:16:40 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0400
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0500 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0500': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2056386243022444279.jar tmpDir=null
16/12/06 20:17:17 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:17:18 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:17:18 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 20:17:20 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 20:17:20 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 20:17:21 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4876
16/12/06 20:17:21 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4876
16/12/06 20:17:21 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4876/
16/12/06 20:17:21 INFO mapreduce.Job: Running job: job_1480588584072_4876
16/12/06 20:17:34 INFO mapreduce.Job: Job job_1480588584072_4876 running in uber mode : false
16/12/06 20:17:34 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 20:17:45 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 20:17:52 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 20:17:53 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 20:18:01 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 20:18:02 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 20:18:03 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 20:18:08 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 20:18:09 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 20:18:13 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 20:18:17 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 20:18:18 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 20:18:19 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 20:18:20 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 20:18:21 INFO mapreduce.Job:  map 28% reduce 2%
16/12/06 20:18:22 INFO mapreduce.Job:  map 32% reduce 2%
16/12/06 20:18:23 INFO mapreduce.Job:  map 36% reduce 3%
16/12/06 20:18:24 INFO mapreduce.Job:  map 38% reduce 4%
16/12/06 20:18:25 INFO mapreduce.Job:  map 41% reduce 4%
16/12/06 20:18:26 INFO mapreduce.Job:  map 43% reduce 5%
16/12/06 20:18:27 INFO mapreduce.Job:  map 44% reduce 6%
16/12/06 20:18:28 INFO mapreduce.Job:  map 45% reduce 6%
16/12/06 20:18:29 INFO mapreduce.Job:  map 46% reduce 7%
16/12/06 20:18:30 INFO mapreduce.Job:  map 47% reduce 8%
16/12/06 20:18:31 INFO mapreduce.Job:  map 50% reduce 8%
16/12/06 20:18:32 INFO mapreduce.Job:  map 51% reduce 8%
16/12/06 20:18:33 INFO mapreduce.Job:  map 53% reduce 9%
16/12/06 20:18:34 INFO mapreduce.Job:  map 54% reduce 9%
16/12/06 20:18:35 INFO mapreduce.Job:  map 55% reduce 9%
16/12/06 20:18:36 INFO mapreduce.Job:  map 55% reduce 10%
16/12/06 20:18:37 INFO mapreduce.Job:  map 56% reduce 10%
16/12/06 20:18:39 INFO mapreduce.Job:  map 57% reduce 10%
16/12/06 20:18:43 INFO mapreduce.Job:  map 58% reduce 11%
16/12/06 20:18:44 INFO mapreduce.Job:  map 58% reduce 12%
16/12/06 20:18:45 INFO mapreduce.Job:  map 58% reduce 13%
16/12/06 20:18:46 INFO mapreduce.Job:  map 59% reduce 14%
16/12/06 20:18:47 INFO mapreduce.Job:  map 61% reduce 15%
16/12/06 20:18:48 INFO mapreduce.Job:  map 62% reduce 16%
16/12/06 20:18:49 INFO mapreduce.Job:  map 64% reduce 17%
16/12/06 20:18:50 INFO mapreduce.Job:  map 65% reduce 19%
16/12/06 20:18:51 INFO mapreduce.Job:  map 67% reduce 20%
16/12/06 20:18:52 INFO mapreduce.Job:  map 70% reduce 22%
16/12/06 20:18:53 INFO mapreduce.Job:  map 71% reduce 22%
16/12/06 20:18:54 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 20:18:55 INFO mapreduce.Job:  map 77% reduce 23%
16/12/06 20:18:56 INFO mapreduce.Job:  map 80% reduce 24%
16/12/06 20:18:57 INFO mapreduce.Job:  map 81% reduce 25%
16/12/06 20:18:58 INFO mapreduce.Job:  map 81% reduce 26%
16/12/06 20:18:59 INFO mapreduce.Job:  map 83% reduce 26%
16/12/06 20:19:00 INFO mapreduce.Job:  map 84% reduce 27%
16/12/06 20:19:01 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 20:19:02 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 20:19:03 INFO mapreduce.Job:  map 89% reduce 28%
16/12/06 20:19:04 INFO mapreduce.Job:  map 92% reduce 29%
16/12/06 20:19:05 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 20:19:06 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 20:19:07 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 20:19:08 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 20:19:09 INFO mapreduce.Job:  map 97% reduce 32%
16/12/06 20:19:10 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 20:19:11 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 20:19:12 INFO mapreduce.Job:  map 100% reduce 40%
16/12/06 20:19:13 INFO mapreduce.Job:  map 100% reduce 47%
16/12/06 20:19:14 INFO mapreduce.Job:  map 100% reduce 65%
16/12/06 20:19:15 INFO mapreduce.Job:  map 100% reduce 79%
16/12/06 20:19:16 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 20:19:17 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 20:19:18 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 20:19:19 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 20:19:20 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 20:19:24 INFO mapreduce.Job: Job job_1480588584072_4876 completed successfully
16/12/06 20:19:24 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=384381781
		FILE: Number of bytes written=801145527
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=330045744
		WASB: Number of bytes written=178437294
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12291866
		Total time spent by all reduces in occupied slots (ms)=2553660
		Total time spent by all map tasks (ms)=6145933
		Total time spent by all reduce tasks (ms)=1276830
		Total vcore-seconds taken by all map tasks=6145933
		Total vcore-seconds taken by all reduce tasks=1276830
		Total megabyte-seconds taken by all map tasks=6293435392
		Total megabyte-seconds taken by all reduce tasks=1307473920
	Map-Reduce Framework
		Map input records=1146993
		Map output records=1013162
		Map output bytes=380609702
		Map output materialized bytes=384405301
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=891226
		Reduce shuffle bytes=384405301
		Reduce input records=1013162
		Reduce output records=555838
		Spilled Records=2026324
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=78277
		CPU time spent (ms)=802610
		Physical memory (bytes) snapshot=323045736448
		Virtual memory (bytes) snapshot=742650191872
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=327349740
	File Output Format Counters 
		Bytes Written=178437294
16/12/06 20:19:24 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0500
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0600 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0600': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4351610429855618600.jar tmpDir=null
16/12/06 20:20:02 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:20:03 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:20:03 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 20:20:04 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 20:20:05 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 20:20:05 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4877
16/12/06 20:20:06 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4877
16/12/06 20:20:06 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4877/
16/12/06 20:20:06 INFO mapreduce.Job: Running job: job_1480588584072_4877
16/12/06 20:20:19 INFO mapreduce.Job: Job job_1480588584072_4877 running in uber mode : false
16/12/06 20:20:19 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 20:20:36 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 20:20:37 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 20:20:43 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 20:20:47 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 20:20:48 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 20:20:49 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 20:20:52 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 20:20:55 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 20:20:56 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 20:21:02 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 20:21:03 INFO mapreduce.Job:  map 15% reduce 1%
16/12/06 20:21:04 INFO mapreduce.Job:  map 17% reduce 1%
16/12/06 20:21:05 INFO mapreduce.Job:  map 19% reduce 2%
16/12/06 20:21:06 INFO mapreduce.Job:  map 24% reduce 2%
16/12/06 20:21:07 INFO mapreduce.Job:  map 29% reduce 2%
16/12/06 20:21:08 INFO mapreduce.Job:  map 35% reduce 3%
16/12/06 20:21:09 INFO mapreduce.Job:  map 38% reduce 3%
16/12/06 20:21:10 INFO mapreduce.Job:  map 41% reduce 4%
16/12/06 20:21:11 INFO mapreduce.Job:  map 44% reduce 6%
16/12/06 20:21:12 INFO mapreduce.Job:  map 46% reduce 6%
16/12/06 20:21:13 INFO mapreduce.Job:  map 49% reduce 7%
16/12/06 20:21:14 INFO mapreduce.Job:  map 51% reduce 7%
16/12/06 20:21:16 INFO mapreduce.Job:  map 52% reduce 8%
16/12/06 20:21:17 INFO mapreduce.Job:  map 53% reduce 8%
16/12/06 20:21:18 INFO mapreduce.Job:  map 53% reduce 9%
16/12/06 20:21:19 INFO mapreduce.Job:  map 54% reduce 9%
16/12/06 20:21:20 INFO mapreduce.Job:  map 54% reduce 11%
16/12/06 20:21:21 INFO mapreduce.Job:  map 55% reduce 11%
16/12/06 20:21:27 INFO mapreduce.Job:  map 56% reduce 11%
16/12/06 20:21:29 INFO mapreduce.Job:  map 57% reduce 11%
16/12/06 20:21:31 INFO mapreduce.Job:  map 57% reduce 14%
16/12/06 20:21:33 INFO mapreduce.Job:  map 57% reduce 15%
16/12/06 20:21:34 INFO mapreduce.Job:  map 58% reduce 15%
16/12/06 20:21:35 INFO mapreduce.Job:  map 60% reduce 16%
16/12/06 20:21:36 INFO mapreduce.Job:  map 62% reduce 16%
16/12/06 20:21:37 INFO mapreduce.Job:  map 63% reduce 17%
16/12/06 20:21:38 INFO mapreduce.Job:  map 65% reduce 17%
16/12/06 20:21:39 INFO mapreduce.Job:  map 67% reduce 19%
16/12/06 20:21:40 INFO mapreduce.Job:  map 70% reduce 19%
16/12/06 20:21:41 INFO mapreduce.Job:  map 75% reduce 19%
16/12/06 20:21:42 INFO mapreduce.Job:  map 79% reduce 21%
16/12/06 20:21:43 INFO mapreduce.Job:  map 81% reduce 24%
16/12/06 20:21:44 INFO mapreduce.Job:  map 83% reduce 25%
16/12/06 20:21:45 INFO mapreduce.Job:  map 83% reduce 27%
16/12/06 20:21:46 INFO mapreduce.Job:  map 84% reduce 27%
16/12/06 20:21:47 INFO mapreduce.Job:  map 84% reduce 28%
16/12/06 20:21:48 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 20:21:50 INFO mapreduce.Job:  map 91% reduce 29%
16/12/06 20:21:51 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 20:21:52 INFO mapreduce.Job:  map 96% reduce 30%
16/12/06 20:21:53 INFO mapreduce.Job:  map 98% reduce 31%
16/12/06 20:21:54 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 20:21:55 INFO mapreduce.Job:  map 99% reduce 33%
16/12/06 20:21:57 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 20:21:58 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 20:21:59 INFO mapreduce.Job:  map 100% reduce 43%
16/12/06 20:22:00 INFO mapreduce.Job:  map 100% reduce 55%
16/12/06 20:22:01 INFO mapreduce.Job:  map 100% reduce 69%
16/12/06 20:22:02 INFO mapreduce.Job:  map 100% reduce 79%
16/12/06 20:22:03 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 20:22:04 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 20:22:05 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 20:22:06 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 20:22:07 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 20:22:10 INFO mapreduce.Job: Job job_1480588584072_4877 completed successfully
16/12/06 20:22:10 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=480236586
		FILE: Number of bytes written=992855137
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=410487518
		WASB: Number of bytes written=229726092
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12300434
		Total time spent by all reduces in occupied slots (ms)=2555494
		Total time spent by all map tasks (ms)=6150217
		Total time spent by all reduce tasks (ms)=1277747
		Total vcore-seconds taken by all map tasks=6150217
		Total vcore-seconds taken by all reduce tasks=1277747
		Total megabyte-seconds taken by all map tasks=6297822208
		Total megabyte-seconds taken by all reduce tasks=1308412928
	Map-Reduce Framework
		Map input records=1396888
		Map output records=1240841
		Map output bytes=475571264
		Map output materialized bytes=480260106
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1091228
		Reduce shuffle bytes=480260106
		Reduce input records=1240841
		Reduce output records=700829
		Spilled Records=2481682
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=74447
		CPU time spent (ms)=831780
		Physical memory (bytes) snapshot=323388256256
		Virtual memory (bytes) snapshot=742551580672
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=407791514
	File Output Format Counters 
		Bytes Written=229726092
16/12/06 20:22:10 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0600
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0700 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161204/201612042300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0700': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5876013012662010167.jar tmpDir=null
16/12/06 20:22:48 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:22:48 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:22:49 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 20:22:50 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 20:22:51 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 20:22:51 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4878
16/12/06 20:22:52 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4878
16/12/06 20:22:52 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4878/
16/12/06 20:22:52 INFO mapreduce.Job: Running job: job_1480588584072_4878
16/12/06 20:23:04 INFO mapreduce.Job: Job job_1480588584072_4878 running in uber mode : false
16/12/06 20:23:04 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 20:23:28 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 20:23:29 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 20:23:32 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 20:23:33 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 20:23:34 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 20:23:35 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 20:23:36 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 20:23:38 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 20:23:39 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 20:23:41 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 20:23:42 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 20:23:43 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 20:23:46 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 20:23:50 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 20:23:51 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 20:23:52 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 20:23:53 INFO mapreduce.Job:  map 31% reduce 0%
16/12/06 20:23:54 INFO mapreduce.Job:  map 39% reduce 1%
16/12/06 20:23:55 INFO mapreduce.Job:  map 41% reduce 1%
16/12/06 20:23:56 INFO mapreduce.Job:  map 43% reduce 3%
16/12/06 20:23:57 INFO mapreduce.Job:  map 45% reduce 3%
16/12/06 20:23:58 INFO mapreduce.Job:  map 48% reduce 4%
16/12/06 20:23:59 INFO mapreduce.Job:  map 50% reduce 5%
16/12/06 20:24:00 INFO mapreduce.Job:  map 52% reduce 5%
16/12/06 20:24:01 INFO mapreduce.Job:  map 54% reduce 8%
16/12/06 20:24:02 INFO mapreduce.Job:  map 55% reduce 12%
16/12/06 20:24:03 INFO mapreduce.Job:  map 55% reduce 13%
16/12/06 20:24:04 INFO mapreduce.Job:  map 56% reduce 15%
16/12/06 20:24:05 INFO mapreduce.Job:  map 57% reduce 16%
16/12/06 20:24:07 INFO mapreduce.Job:  map 58% reduce 17%
16/12/06 20:24:08 INFO mapreduce.Job:  map 60% reduce 17%
16/12/06 20:24:09 INFO mapreduce.Job:  map 62% reduce 18%
16/12/06 20:24:11 INFO mapreduce.Job:  map 62% reduce 19%
16/12/06 20:24:12 INFO mapreduce.Job:  map 62% reduce 20%
16/12/06 20:24:13 INFO mapreduce.Job:  map 63% reduce 20%
16/12/06 20:24:14 INFO mapreduce.Job:  map 64% reduce 20%
16/12/06 20:24:17 INFO mapreduce.Job:  map 65% reduce 20%
16/12/06 20:24:19 INFO mapreduce.Job:  map 67% reduce 20%
16/12/06 20:24:20 INFO mapreduce.Job:  map 68% reduce 21%
16/12/06 20:24:21 INFO mapreduce.Job:  map 70% reduce 21%
16/12/06 20:24:22 INFO mapreduce.Job:  map 71% reduce 21%
16/12/06 20:24:23 INFO mapreduce.Job:  map 74% reduce 22%
16/12/06 20:24:24 INFO mapreduce.Job:  map 75% reduce 22%
16/12/06 20:24:25 INFO mapreduce.Job:  map 79% reduce 23%
16/12/06 20:24:26 INFO mapreduce.Job:  map 83% reduce 24%
16/12/06 20:24:27 INFO mapreduce.Job:  map 85% reduce 24%
16/12/06 20:24:28 INFO mapreduce.Job:  map 86% reduce 25%
16/12/06 20:24:29 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 20:24:30 INFO mapreduce.Job:  map 89% reduce 28%
16/12/06 20:24:31 INFO mapreduce.Job:  map 92% reduce 29%
16/12/06 20:24:32 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 20:24:34 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 20:24:35 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 20:24:36 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 20:24:38 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 20:24:39 INFO mapreduce.Job:  map 100% reduce 36%
16/12/06 20:24:40 INFO mapreduce.Job:  map 100% reduce 43%
16/12/06 20:24:41 INFO mapreduce.Job:  map 100% reduce 51%
16/12/06 20:24:42 INFO mapreduce.Job:  map 100% reduce 57%
16/12/06 20:24:43 INFO mapreduce.Job:  map 100% reduce 68%
16/12/06 20:24:44 INFO mapreduce.Job:  map 100% reduce 72%
16/12/06 20:24:45 INFO mapreduce.Job:  map 100% reduce 75%
16/12/06 20:24:46 INFO mapreduce.Job:  map 100% reduce 82%
16/12/06 20:24:47 INFO mapreduce.Job:  map 100% reduce 85%
16/12/06 20:24:48 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 20:24:49 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 20:24:50 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 20:24:51 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 20:24:52 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 20:24:53 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 20:24:54 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 20:24:55 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 20:24:57 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 20:25:00 INFO mapreduce.Job: Job job_1480588584072_4878 completed successfully
16/12/06 20:25:00 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=693668074
		FILE: Number of bytes written=1419718113
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=588423303
		WASB: Number of bytes written=371274728
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=11890374
		Total time spent by all reduces in occupied slots (ms)=2693820
		Total time spent by all map tasks (ms)=5945187
		Total time spent by all reduce tasks (ms)=1346910
		Total vcore-seconds taken by all map tasks=5945187
		Total vcore-seconds taken by all reduce tasks=1346910
		Total megabyte-seconds taken by all map tasks=6087871488
		Total megabyte-seconds taken by all reduce tasks=1379235840
	Map-Reduce Framework
		Map input records=1951597
		Map output records=1754809
		Map output bytes=687031443
		Map output materialized bytes=693691594
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1561152
		Reduce shuffle bytes=693691594
		Reduce input records=1754809
		Reduce output records=1120470
		Spilled Records=3509618
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=82149
		CPU time spent (ms)=914980
		Physical memory (bytes) snapshot=323854970880
		Virtual memory (bytes) snapshot=742316052480
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=585727299
	File Output Format Counters 
		Bytes Written=371274728
16/12/06 20:25:00 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0700
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050400 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0800 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050400
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0800': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob6208012273959830354.jar tmpDir=null
16/12/06 20:25:37 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:25:38 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:25:38 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 20:25:40 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 20:25:40 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 20:25:40 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4879
16/12/06 20:25:41 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4879
16/12/06 20:25:41 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4879/
16/12/06 20:25:41 INFO mapreduce.Job: Running job: job_1480588584072_4879
16/12/06 20:25:53 INFO mapreduce.Job: Job job_1480588584072_4879 running in uber mode : false
16/12/06 20:25:53 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 20:26:16 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 20:26:17 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 20:26:21 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 20:26:22 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 20:26:24 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 20:26:25 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 20:26:26 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 20:26:27 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 20:26:28 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 20:26:29 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 20:26:36 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 20:26:38 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 20:26:39 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 20:26:40 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 20:26:41 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 20:26:42 INFO mapreduce.Job:  map 33% reduce 1%
16/12/06 20:26:43 INFO mapreduce.Job:  map 34% reduce 1%
16/12/06 20:26:44 INFO mapreduce.Job:  map 43% reduce 2%
16/12/06 20:26:45 INFO mapreduce.Job:  map 44% reduce 3%
16/12/06 20:26:46 INFO mapreduce.Job:  map 45% reduce 3%
16/12/06 20:26:48 INFO mapreduce.Job:  map 47% reduce 4%
16/12/06 20:26:49 INFO mapreduce.Job:  map 48% reduce 5%
16/12/06 20:26:50 INFO mapreduce.Job:  map 49% reduce 6%
16/12/06 20:26:51 INFO mapreduce.Job:  map 51% reduce 8%
16/12/06 20:26:52 INFO mapreduce.Job:  map 52% reduce 9%
16/12/06 20:26:53 INFO mapreduce.Job:  map 53% reduce 10%
16/12/06 20:26:54 INFO mapreduce.Job:  map 53% reduce 12%
16/12/06 20:26:55 INFO mapreduce.Job:  map 54% reduce 14%
16/12/06 20:26:56 INFO mapreduce.Job:  map 57% reduce 14%
16/12/06 20:26:57 INFO mapreduce.Job:  map 59% reduce 16%
16/12/06 20:26:58 INFO mapreduce.Job:  map 60% reduce 16%
16/12/06 20:26:59 INFO mapreduce.Job:  map 62% reduce 18%
16/12/06 20:27:00 INFO mapreduce.Job:  map 62% reduce 19%
16/12/06 20:27:03 INFO mapreduce.Job:  map 64% reduce 20%
16/12/06 20:27:04 INFO mapreduce.Job:  map 65% reduce 20%
16/12/06 20:27:06 INFO mapreduce.Job:  map 66% reduce 20%
16/12/06 20:27:08 INFO mapreduce.Job:  map 67% reduce 21%
16/12/06 20:27:09 INFO mapreduce.Job:  map 71% reduce 21%
16/12/06 20:27:11 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 20:27:12 INFO mapreduce.Job:  map 77% reduce 24%
16/12/06 20:27:13 INFO mapreduce.Job:  map 80% reduce 24%
16/12/06 20:27:14 INFO mapreduce.Job:  map 82% reduce 25%
16/12/06 20:27:15 INFO mapreduce.Job:  map 85% reduce 26%
16/12/06 20:27:16 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 20:27:17 INFO mapreduce.Job:  map 87% reduce 28%
16/12/06 20:27:18 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 20:27:20 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 20:27:27 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 20:27:28 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 20:27:29 INFO mapreduce.Job:  map 96% reduce 30%
16/12/06 20:27:30 INFO mapreduce.Job:  map 98% reduce 31%
16/12/06 20:27:31 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 20:27:32 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 20:27:33 INFO mapreduce.Job:  map 100% reduce 37%
16/12/06 20:27:34 INFO mapreduce.Job:  map 100% reduce 44%
16/12/06 20:27:35 INFO mapreduce.Job:  map 100% reduce 54%
16/12/06 20:27:36 INFO mapreduce.Job:  map 100% reduce 62%
16/12/06 20:27:37 INFO mapreduce.Job:  map 100% reduce 68%
16/12/06 20:27:38 INFO mapreduce.Job:  map 100% reduce 74%
16/12/06 20:27:39 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 20:27:40 INFO mapreduce.Job:  map 100% reduce 80%
16/12/06 20:27:41 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 20:27:43 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 20:27:44 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 20:27:45 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 20:27:46 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 20:27:47 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 20:27:49 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 20:27:51 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 20:27:54 INFO mapreduce.Job: Job job_1480588584072_4879 completed successfully
16/12/06 20:27:54 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=789720618
		FILE: Number of bytes written=1611823201
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=668607755
		WASB: Number of bytes written=427315159
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=11905360
		Total time spent by all reduces in occupied slots (ms)=2907482
		Total time spent by all map tasks (ms)=5952680
		Total time spent by all reduce tasks (ms)=1453741
		Total vcore-seconds taken by all map tasks=5952680
		Total vcore-seconds taken by all reduce tasks=1453741
		Total megabyte-seconds taken by all map tasks=6095544320
		Total megabyte-seconds taken by all reduce tasks=1488630784
	Map-Reduce Framework
		Map input records=2201159
		Map output records=1983068
		Map output bytes=782196433
		Map output materialized bytes=789744138
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1757342
		Reduce shuffle bytes=789744138
		Reduce input records=1983068
		Reduce output records=1279184
		Spilled Records=3966136
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=74063
		CPU time spent (ms)=950140
		Physical memory (bytes) snapshot=324665425920
		Virtual memory (bytes) snapshot=742498947072
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=665911751
	File Output Format Counters 
		Bytes Written=427315159
16/12/06 20:27:54 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0800
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050500 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0900 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050500
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0900': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob6082882211952309536.jar tmpDir=null
16/12/06 20:28:31 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:28:32 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:28:32 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 20:28:34 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 20:28:34 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 20:28:35 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4880
16/12/06 20:28:35 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4880
16/12/06 20:28:35 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4880/
16/12/06 20:28:35 INFO mapreduce.Job: Running job: job_1480588584072_4880
16/12/06 20:28:49 INFO mapreduce.Job: Job job_1480588584072_4880 running in uber mode : false
16/12/06 20:28:49 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 20:29:11 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 20:29:12 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 20:29:16 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 20:29:17 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 20:29:18 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 20:29:19 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 20:29:20 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 20:29:21 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 20:29:23 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 20:29:25 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 20:29:31 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 20:29:33 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 20:29:35 INFO mapreduce.Job:  map 26% reduce 1%
16/12/06 20:29:36 INFO mapreduce.Job:  map 30% reduce 1%
16/12/06 20:29:37 INFO mapreduce.Job:  map 33% reduce 1%
16/12/06 20:29:38 INFO mapreduce.Job:  map 35% reduce 2%
16/12/06 20:29:39 INFO mapreduce.Job:  map 36% reduce 3%
16/12/06 20:29:40 INFO mapreduce.Job:  map 39% reduce 3%
16/12/06 20:29:41 INFO mapreduce.Job:  map 40% reduce 3%
16/12/06 20:29:42 INFO mapreduce.Job:  map 41% reduce 3%
16/12/06 20:29:44 INFO mapreduce.Job:  map 44% reduce 4%
16/12/06 20:29:45 INFO mapreduce.Job:  map 48% reduce 5%
16/12/06 20:29:46 INFO mapreduce.Job:  map 52% reduce 7%
16/12/06 20:29:47 INFO mapreduce.Job:  map 55% reduce 7%
16/12/06 20:29:48 INFO mapreduce.Job:  map 59% reduce 12%
16/12/06 20:29:49 INFO mapreduce.Job:  map 60% reduce 13%
16/12/06 20:29:50 INFO mapreduce.Job:  map 60% reduce 14%
16/12/06 20:29:51 INFO mapreduce.Job:  map 61% reduce 15%
16/12/06 20:29:54 INFO mapreduce.Job:  map 62% reduce 15%
16/12/06 20:29:55 INFO mapreduce.Job:  map 63% reduce 15%
16/12/06 20:29:57 INFO mapreduce.Job:  map 64% reduce 17%
16/12/06 20:29:58 INFO mapreduce.Job:  map 65% reduce 19%
16/12/06 20:29:59 INFO mapreduce.Job:  map 65% reduce 20%
16/12/06 20:30:01 INFO mapreduce.Job:  map 65% reduce 22%
16/12/06 20:30:02 INFO mapreduce.Job:  map 66% reduce 22%
16/12/06 20:30:03 INFO mapreduce.Job:  map 69% reduce 22%
16/12/06 20:30:05 INFO mapreduce.Job:  map 71% reduce 22%
16/12/06 20:30:06 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 20:30:07 INFO mapreduce.Job:  map 73% reduce 24%
16/12/06 20:30:08 INFO mapreduce.Job:  map 75% reduce 24%
16/12/06 20:30:09 INFO mapreduce.Job:  map 79% reduce 24%
16/12/06 20:30:10 INFO mapreduce.Job:  map 80% reduce 25%
16/12/06 20:30:11 INFO mapreduce.Job:  map 81% reduce 26%
16/12/06 20:30:12 INFO mapreduce.Job:  map 82% reduce 27%
16/12/06 20:30:14 INFO mapreduce.Job:  map 83% reduce 27%
16/12/06 20:30:15 INFO mapreduce.Job:  map 84% reduce 27%
16/12/06 20:30:16 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 20:30:17 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 20:30:18 INFO mapreduce.Job:  map 89% reduce 28%
16/12/06 20:30:19 INFO mapreduce.Job:  map 93% reduce 29%
16/12/06 20:30:20 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 20:30:21 INFO mapreduce.Job:  map 96% reduce 30%
16/12/06 20:30:22 INFO mapreduce.Job:  map 99% reduce 31%
16/12/06 20:30:23 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 20:30:24 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 20:30:25 INFO mapreduce.Job:  map 100% reduce 41%
16/12/06 20:30:26 INFO mapreduce.Job:  map 100% reduce 49%
16/12/06 20:30:27 INFO mapreduce.Job:  map 100% reduce 59%
16/12/06 20:30:28 INFO mapreduce.Job:  map 100% reduce 68%
16/12/06 20:30:29 INFO mapreduce.Job:  map 100% reduce 73%
16/12/06 20:30:30 INFO mapreduce.Job:  map 100% reduce 80%
16/12/06 20:30:31 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 20:30:32 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 20:30:33 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 20:30:34 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 20:30:35 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 20:30:36 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 20:30:37 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 20:30:38 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 20:30:39 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 20:30:42 INFO mapreduce.Job: Job job_1480588584072_4880 completed successfully
16/12/06 20:30:42 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=747213852
		FILE: Number of bytes written=1526809669
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=632256684
		WASB: Number of bytes written=385118714
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12019488
		Total time spent by all reduces in occupied slots (ms)=2615320
		Total time spent by all map tasks (ms)=6009744
		Total time spent by all reduce tasks (ms)=1307660
		Total vcore-seconds taken by all map tasks=6009744
		Total vcore-seconds taken by all reduce tasks=1307660
		Total megabyte-seconds taken by all map tasks=6153977856
		Total megabyte-seconds taken by all reduce tasks=1339043840
	Map-Reduce Framework
		Map input records=2092403
		Map output records=1881081
		Map output bytes=740067893
		Map output materialized bytes=747237372
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1654669
		Reduce shuffle bytes=747237372
		Reduce input records=1881081
		Reduce output records=1155520
		Spilled Records=3762162
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=74545
		CPU time spent (ms)=927980
		Physical memory (bytes) snapshot=324100423680
		Virtual memory (bytes) snapshot=742547230720
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=629560680
	File Output Format Counters 
		Bytes Written=385118714
16/12/06 20:30:42 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/0900
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050600 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050600
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob6708407300640301283.jar tmpDir=null
16/12/06 20:31:19 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:31:20 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:31:20 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 20:31:22 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 20:31:22 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 20:31:23 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4881
16/12/06 20:31:23 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4881
16/12/06 20:31:24 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4881/
16/12/06 20:31:24 INFO mapreduce.Job: Running job: job_1480588584072_4881
16/12/06 20:31:37 INFO mapreduce.Job: Job job_1480588584072_4881 running in uber mode : false
16/12/06 20:31:37 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 20:31:58 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 20:32:01 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 20:32:03 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 20:32:04 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 20:32:06 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 20:32:07 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 20:32:08 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 20:32:09 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 20:32:10 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 20:32:11 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 20:32:12 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 20:32:17 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 20:32:20 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 20:32:22 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 20:32:23 INFO mapreduce.Job:  map 29% reduce 1%
16/12/06 20:32:24 INFO mapreduce.Job:  map 33% reduce 1%
16/12/06 20:32:25 INFO mapreduce.Job:  map 37% reduce 3%
16/12/06 20:32:26 INFO mapreduce.Job:  map 39% reduce 3%
16/12/06 20:32:27 INFO mapreduce.Job:  map 41% reduce 3%
16/12/06 20:32:28 INFO mapreduce.Job:  map 41% reduce 5%
16/12/06 20:32:29 INFO mapreduce.Job:  map 42% reduce 5%
16/12/06 20:32:30 INFO mapreduce.Job:  map 43% reduce 7%
16/12/06 20:32:31 INFO mapreduce.Job:  map 44% reduce 8%
16/12/06 20:32:32 INFO mapreduce.Job:  map 47% reduce 10%
16/12/06 20:32:33 INFO mapreduce.Job:  map 47% reduce 11%
16/12/06 20:32:34 INFO mapreduce.Job:  map 49% reduce 12%
16/12/06 20:32:36 INFO mapreduce.Job:  map 50% reduce 12%
16/12/06 20:32:37 INFO mapreduce.Job:  map 51% reduce 12%
16/12/06 20:32:38 INFO mapreduce.Job:  map 52% reduce 12%
16/12/06 20:32:39 INFO mapreduce.Job:  map 53% reduce 13%
16/12/06 20:32:40 INFO mapreduce.Job:  map 56% reduce 13%
16/12/06 20:32:41 INFO mapreduce.Job:  map 57% reduce 13%
16/12/06 20:32:43 INFO mapreduce.Job:  map 58% reduce 14%
16/12/06 20:32:44 INFO mapreduce.Job:  map 59% reduce 14%
16/12/06 20:32:45 INFO mapreduce.Job:  map 60% reduce 16%
16/12/06 20:32:46 INFO mapreduce.Job:  map 61% reduce 16%
16/12/06 20:32:47 INFO mapreduce.Job:  map 62% reduce 16%
16/12/06 20:32:48 INFO mapreduce.Job:  map 62% reduce 17%
16/12/06 20:32:49 INFO mapreduce.Job:  map 65% reduce 17%
16/12/06 20:32:50 INFO mapreduce.Job:  map 68% reduce 17%
16/12/06 20:32:51 INFO mapreduce.Job:  map 71% reduce 19%
16/12/06 20:32:52 INFO mapreduce.Job:  map 73% reduce 20%
16/12/06 20:32:53 INFO mapreduce.Job:  map 75% reduce 21%
16/12/06 20:32:54 INFO mapreduce.Job:  map 78% reduce 23%
16/12/06 20:32:55 INFO mapreduce.Job:  map 79% reduce 24%
16/12/06 20:32:56 INFO mapreduce.Job:  map 81% reduce 24%
16/12/06 20:32:57 INFO mapreduce.Job:  map 83% reduce 25%
16/12/06 20:32:58 INFO mapreduce.Job:  map 86% reduce 25%
16/12/06 20:32:59 INFO mapreduce.Job:  map 89% reduce 28%
16/12/06 20:33:00 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 20:33:02 INFO mapreduce.Job:  map 90% reduce 30%
16/12/06 20:33:08 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 20:33:12 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 20:33:13 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 20:33:14 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 20:33:15 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 20:33:16 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 20:33:17 INFO mapreduce.Job:  map 97% reduce 32%
16/12/06 20:33:18 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 20:33:19 INFO mapreduce.Job:  map 99% reduce 33%
16/12/06 20:33:21 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 20:33:23 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 20:33:24 INFO mapreduce.Job:  map 100% reduce 44%
16/12/06 20:33:25 INFO mapreduce.Job:  map 100% reduce 53%
16/12/06 20:33:26 INFO mapreduce.Job:  map 100% reduce 67%
16/12/06 20:33:27 INFO mapreduce.Job:  map 100% reduce 72%
16/12/06 20:33:28 INFO mapreduce.Job:  map 100% reduce 77%
16/12/06 20:33:29 INFO mapreduce.Job:  map 100% reduce 82%
16/12/06 20:33:30 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 20:33:31 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 20:33:32 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 20:33:33 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 20:33:34 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 20:33:36 INFO mapreduce.Job: Job job_1480588584072_4881 completed successfully
16/12/06 20:33:36 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=921415194
		FILE: Number of bytes written=1875212353
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=769139931
		WASB: Number of bytes written=522261423
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12038574
		Total time spent by all reduces in occupied slots (ms)=3135996
		Total time spent by all map tasks (ms)=6019287
		Total time spent by all reduce tasks (ms)=1567998
		Total vcore-seconds taken by all map tasks=6019287
		Total vcore-seconds taken by all reduce tasks=1567998
		Total megabyte-seconds taken by all map tasks=6163749888
		Total megabyte-seconds taken by all reduce tasks=1605629952
	Map-Reduce Framework
		Map input records=2509287
		Map output records=2301489
		Map output bytes=912673836
		Map output materialized bytes=921438714
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2052743
		Reduce shuffle bytes=921438714
		Reduce input records=2301489
		Reduce output records=1565040
		Spilled Records=4602978
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=81456
		CPU time spent (ms)=998280
		Physical memory (bytes) snapshot=325552975872
		Virtual memory (bytes) snapshot=742756888576
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=766443927
	File Output Format Counters 
		Bytes Written=522261423
16/12/06 20:33:36 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050700 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050700
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7469598982207620699.jar tmpDir=null
16/12/06 20:34:15 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:34:16 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:34:16 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 20:34:18 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 20:34:18 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 20:34:18 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4882
16/12/06 20:34:19 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4882
16/12/06 20:34:19 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4882/
16/12/06 20:34:19 INFO mapreduce.Job: Running job: job_1480588584072_4882
16/12/06 20:34:31 INFO mapreduce.Job: Job job_1480588584072_4882 running in uber mode : false
16/12/06 20:34:31 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 20:34:56 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 20:34:57 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 20:34:59 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 20:35:00 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 20:35:02 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 20:35:03 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 20:35:07 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 20:35:10 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 20:35:13 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 20:35:14 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 20:35:16 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 20:35:17 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 20:35:19 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 20:35:20 INFO mapreduce.Job:  map 30% reduce 0%
16/12/06 20:35:21 INFO mapreduce.Job:  map 32% reduce 0%
16/12/06 20:35:22 INFO mapreduce.Job:  map 33% reduce 0%
16/12/06 20:35:23 INFO mapreduce.Job:  map 35% reduce 3%
16/12/06 20:35:24 INFO mapreduce.Job:  map 37% reduce 4%
16/12/06 20:35:25 INFO mapreduce.Job:  map 40% reduce 4%
16/12/06 20:35:26 INFO mapreduce.Job:  map 44% reduce 4%
16/12/06 20:35:28 INFO mapreduce.Job:  map 48% reduce 7%
16/12/06 20:35:29 INFO mapreduce.Job:  map 50% reduce 7%
16/12/06 20:35:30 INFO mapreduce.Job:  map 53% reduce 9%
16/12/06 20:35:31 INFO mapreduce.Job:  map 56% reduce 10%
16/12/06 20:35:32 INFO mapreduce.Job:  map 57% reduce 10%
16/12/06 20:35:33 INFO mapreduce.Job:  map 58% reduce 11%
16/12/06 20:35:34 INFO mapreduce.Job:  map 59% reduce 13%
16/12/06 20:35:35 INFO mapreduce.Job:  map 60% reduce 14%
16/12/06 20:35:36 INFO mapreduce.Job:  map 60% reduce 15%
16/12/06 20:35:38 INFO mapreduce.Job:  map 60% reduce 17%
16/12/06 20:35:40 INFO mapreduce.Job:  map 60% reduce 18%
16/12/06 20:35:42 INFO mapreduce.Job:  map 60% reduce 19%
16/12/06 20:35:44 INFO mapreduce.Job:  map 62% reduce 19%
16/12/06 20:35:46 INFO mapreduce.Job:  map 63% reduce 19%
16/12/06 20:35:47 INFO mapreduce.Job:  map 64% reduce 19%
16/12/06 20:35:48 INFO mapreduce.Job:  map 67% reduce 20%
16/12/06 20:35:49 INFO mapreduce.Job:  map 68% reduce 20%
16/12/06 20:35:50 INFO mapreduce.Job:  map 71% reduce 21%
16/12/06 20:35:51 INFO mapreduce.Job:  map 72% reduce 22%
16/12/06 20:35:53 INFO mapreduce.Job:  map 74% reduce 22%
16/12/06 20:35:54 INFO mapreduce.Job:  map 76% reduce 23%
16/12/06 20:35:55 INFO mapreduce.Job:  map 77% reduce 25%
16/12/06 20:35:56 INFO mapreduce.Job:  map 80% reduce 25%
16/12/06 20:35:57 INFO mapreduce.Job:  map 82% reduce 26%
16/12/06 20:35:58 INFO mapreduce.Job:  map 87% reduce 27%
16/12/06 20:36:00 INFO mapreduce.Job:  map 91% reduce 28%
16/12/06 20:36:01 INFO mapreduce.Job:  map 93% reduce 29%
16/12/06 20:36:02 INFO mapreduce.Job:  map 94% reduce 29%
16/12/06 20:36:03 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 20:36:04 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 20:36:05 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 20:36:07 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 20:36:09 INFO mapreduce.Job:  map 100% reduce 39%
16/12/06 20:36:10 INFO mapreduce.Job:  map 100% reduce 52%
16/12/06 20:36:11 INFO mapreduce.Job:  map 100% reduce 55%
16/12/06 20:36:12 INFO mapreduce.Job:  map 100% reduce 64%
16/12/06 20:36:13 INFO mapreduce.Job:  map 100% reduce 74%
16/12/06 20:36:14 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 20:36:15 INFO mapreduce.Job:  map 100% reduce 80%
16/12/06 20:36:16 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 20:36:17 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 20:36:18 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 20:36:19 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 20:36:20 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 20:36:24 INFO mapreduce.Job: Job job_1480588584072_4882 completed successfully
16/12/06 20:36:24 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=842136368
		FILE: Number of bytes written=1716654701
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=709350990
		WASB: Number of bytes written=441215741
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12256798
		Total time spent by all reduces in occupied slots (ms)=2647274
		Total time spent by all map tasks (ms)=6128399
		Total time spent by all reduce tasks (ms)=1323637
		Total vcore-seconds taken by all map tasks=6128399
		Total vcore-seconds taken by all reduce tasks=1323637
		Total megabyte-seconds taken by all map tasks=6275480576
		Total megabyte-seconds taken by all reduce tasks=1355404288
	Map-Reduce Framework
		Map input records=2349555
		Map output records=2121237
		Map output bytes=834082723
		Map output materialized bytes=842159888
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1866877
		Reduce shuffle bytes=842159888
		Reduce input records=2121237
		Reduce output records=1329274
		Spilled Records=4242474
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=69668
		CPU time spent (ms)=952190
		Physical memory (bytes) snapshot=324771975168
		Virtual memory (bytes) snapshot=742481510400
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=706654986
	File Output Format Counters 
		Bytes Written=441215741
16/12/06 20:36:24 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050800 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050800
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8715611914717730707.jar tmpDir=null
16/12/06 20:37:01 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:37:02 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:37:02 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 20:37:04 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 20:37:04 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 20:37:04 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4883
16/12/06 20:37:05 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4883
16/12/06 20:37:05 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4883/
16/12/06 20:37:05 INFO mapreduce.Job: Running job: job_1480588584072_4883
16/12/06 20:37:18 INFO mapreduce.Job: Job job_1480588584072_4883 running in uber mode : false
16/12/06 20:37:18 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 20:37:41 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 20:37:42 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 20:37:43 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 20:37:45 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 20:37:46 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 20:37:47 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 20:37:49 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 20:37:50 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 20:37:51 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 20:37:53 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 20:37:54 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 20:37:55 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 20:37:56 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 20:38:01 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 20:38:02 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 20:38:03 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 20:38:04 INFO mapreduce.Job:  map 27% reduce 0%
16/12/06 20:38:05 INFO mapreduce.Job:  map 31% reduce 0%
16/12/06 20:38:06 INFO mapreduce.Job:  map 34% reduce 0%
16/12/06 20:38:07 INFO mapreduce.Job:  map 36% reduce 1%
16/12/06 20:38:08 INFO mapreduce.Job:  map 38% reduce 2%
16/12/06 20:38:09 INFO mapreduce.Job:  map 38% reduce 3%
16/12/06 20:38:11 INFO mapreduce.Job:  map 42% reduce 3%
16/12/06 20:38:12 INFO mapreduce.Job:  map 43% reduce 4%
16/12/06 20:38:13 INFO mapreduce.Job:  map 46% reduce 5%
16/12/06 20:38:14 INFO mapreduce.Job:  map 50% reduce 6%
16/12/06 20:38:15 INFO mapreduce.Job:  map 55% reduce 7%
16/12/06 20:38:16 INFO mapreduce.Job:  map 57% reduce 8%
16/12/06 20:38:17 INFO mapreduce.Job:  map 59% reduce 10%
16/12/06 20:38:18 INFO mapreduce.Job:  map 59% reduce 14%
16/12/06 20:38:19 INFO mapreduce.Job:  map 59% reduce 15%
16/12/06 20:38:20 INFO mapreduce.Job:  map 60% reduce 17%
16/12/06 20:38:22 INFO mapreduce.Job:  map 61% reduce 17%
16/12/06 20:38:24 INFO mapreduce.Job:  map 62% reduce 17%
16/12/06 20:38:25 INFO mapreduce.Job:  map 63% reduce 17%
16/12/06 20:38:26 INFO mapreduce.Job:  map 65% reduce 19%
16/12/06 20:38:27 INFO mapreduce.Job:  map 67% reduce 20%
16/12/06 20:38:29 INFO mapreduce.Job:  map 67% reduce 21%
16/12/06 20:38:30 INFO mapreduce.Job:  map 69% reduce 21%
16/12/06 20:38:31 INFO mapreduce.Job:  map 70% reduce 21%
16/12/06 20:38:32 INFO mapreduce.Job:  map 71% reduce 22%
16/12/06 20:38:33 INFO mapreduce.Job:  map 73% reduce 22%
16/12/06 20:38:34 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 20:38:35 INFO mapreduce.Job:  map 77% reduce 23%
16/12/06 20:38:36 INFO mapreduce.Job:  map 79% reduce 23%
16/12/06 20:38:37 INFO mapreduce.Job:  map 81% reduce 24%
16/12/06 20:38:38 INFO mapreduce.Job:  map 81% reduce 25%
16/12/06 20:38:39 INFO mapreduce.Job:  map 82% reduce 25%
16/12/06 20:38:40 INFO mapreduce.Job:  map 83% reduce 26%
16/12/06 20:38:42 INFO mapreduce.Job:  map 84% reduce 26%
16/12/06 20:38:43 INFO mapreduce.Job:  map 86% reduce 26%
16/12/06 20:38:44 INFO mapreduce.Job:  map 86% reduce 28%
16/12/06 20:38:45 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 20:38:46 INFO mapreduce.Job:  map 91% reduce 29%
16/12/06 20:38:47 INFO mapreduce.Job:  map 93% reduce 29%
16/12/06 20:38:48 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 20:38:49 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 20:38:50 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 20:38:51 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 20:38:52 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 20:38:53 INFO mapreduce.Job:  map 100% reduce 36%
16/12/06 20:38:54 INFO mapreduce.Job:  map 100% reduce 45%
16/12/06 20:38:55 INFO mapreduce.Job:  map 100% reduce 56%
16/12/06 20:38:56 INFO mapreduce.Job:  map 100% reduce 66%
16/12/06 20:38:57 INFO mapreduce.Job:  map 100% reduce 71%
16/12/06 20:38:58 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 20:38:59 INFO mapreduce.Job:  map 100% reduce 82%
16/12/06 20:39:00 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 20:39:01 INFO mapreduce.Job:  map 100% reduce 89%
16/12/06 20:39:02 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 20:39:03 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 20:39:04 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 20:39:05 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 20:39:06 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 20:39:09 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 20:39:12 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 20:39:15 INFO mapreduce.Job: Job job_1480588584072_4883 completed successfully
16/12/06 20:39:15 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=815235846
		FILE: Number of bytes written=1662853657
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=688941799
		WASB: Number of bytes written=413918642
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=11685342
		Total time spent by all reduces in occupied slots (ms)=2668248
		Total time spent by all map tasks (ms)=5842671
		Total time spent by all reduce tasks (ms)=1334124
		Total vcore-seconds taken by all map tasks=5842671
		Total vcore-seconds taken by all reduce tasks=1334124
		Total megabyte-seconds taken by all map tasks=5982895104
		Total megabyte-seconds taken by all reduce tasks=1366142976
	Map-Reduce Framework
		Map input records=2287481
		Map output records=2054313
		Map output bytes=807427519
		Map output materialized bytes=815259366
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1802584
		Reduce shuffle bytes=815259366
		Reduce input records=2054313
		Reduce output records=1243645
		Spilled Records=4108626
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=76031
		CPU time spent (ms)=927120
		Physical memory (bytes) snapshot=324304039936
		Virtual memory (bytes) snapshot=742462595072
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=686245795
	File Output Format Counters 
		Bytes Written=413918642
16/12/06 20:39:15 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050900 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050900
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2545954365851501621.jar tmpDir=null
16/12/06 20:39:52 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:39:53 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:39:53 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 20:39:55 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 20:39:55 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 20:39:55 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4884
16/12/06 20:39:57 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4884
16/12/06 20:39:57 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4884/
16/12/06 20:39:57 INFO mapreduce.Job: Running job: job_1480588584072_4884
16/12/06 20:40:12 INFO mapreduce.Job: Job job_1480588584072_4884 running in uber mode : false
16/12/06 20:40:12 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 20:40:29 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 20:40:30 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 20:40:31 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 20:40:36 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 20:40:37 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 20:40:43 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 20:40:44 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 20:40:45 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 20:40:48 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 20:40:50 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 20:40:51 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 20:40:53 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 20:40:56 INFO mapreduce.Job:  map 16% reduce 1%
16/12/06 20:40:58 INFO mapreduce.Job:  map 20% reduce 1%
16/12/06 20:40:59 INFO mapreduce.Job:  map 22% reduce 2%
16/12/06 20:41:00 INFO mapreduce.Job:  map 27% reduce 2%
16/12/06 20:41:01 INFO mapreduce.Job:  map 32% reduce 3%
16/12/06 20:41:02 INFO mapreduce.Job:  map 35% reduce 4%
16/12/06 20:41:03 INFO mapreduce.Job:  map 37% reduce 4%
16/12/06 20:41:04 INFO mapreduce.Job:  map 39% reduce 5%
16/12/06 20:41:05 INFO mapreduce.Job:  map 40% reduce 6%
16/12/06 20:41:06 INFO mapreduce.Job:  map 43% reduce 6%
16/12/06 20:41:07 INFO mapreduce.Job:  map 45% reduce 6%
16/12/06 20:41:08 INFO mapreduce.Job:  map 49% reduce 7%
16/12/06 20:41:09 INFO mapreduce.Job:  map 51% reduce 7%
16/12/06 20:41:10 INFO mapreduce.Job:  map 52% reduce 8%
16/12/06 20:41:11 INFO mapreduce.Job:  map 53% reduce 9%
16/12/06 20:41:12 INFO mapreduce.Job:  map 54% reduce 9%
16/12/06 20:41:14 INFO mapreduce.Job:  map 55% reduce 10%
16/12/06 20:41:16 INFO mapreduce.Job:  map 56% reduce 10%
16/12/06 20:41:22 INFO mapreduce.Job:  map 57% reduce 10%
16/12/06 20:41:24 INFO mapreduce.Job:  map 58% reduce 10%
16/12/06 20:41:25 INFO mapreduce.Job:  map 59% reduce 11%
16/12/06 20:41:26 INFO mapreduce.Job:  map 60% reduce 12%
16/12/06 20:41:27 INFO mapreduce.Job:  map 60% reduce 14%
16/12/06 20:41:28 INFO mapreduce.Job:  map 61% reduce 16%
16/12/06 20:41:29 INFO mapreduce.Job:  map 63% reduce 17%
16/12/06 20:41:30 INFO mapreduce.Job:  map 64% reduce 18%
16/12/06 20:41:31 INFO mapreduce.Job:  map 67% reduce 20%
16/12/06 20:41:33 INFO mapreduce.Job:  map 69% reduce 21%
16/12/06 20:41:34 INFO mapreduce.Job:  map 71% reduce 22%
16/12/06 20:41:35 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 20:41:36 INFO mapreduce.Job:  map 75% reduce 23%
16/12/06 20:41:37 INFO mapreduce.Job:  map 78% reduce 24%
16/12/06 20:41:38 INFO mapreduce.Job:  map 80% reduce 24%
16/12/06 20:41:39 INFO mapreduce.Job:  map 82% reduce 25%
16/12/06 20:41:40 INFO mapreduce.Job:  map 84% reduce 26%
16/12/06 20:41:41 INFO mapreduce.Job:  map 89% reduce 27%
16/12/06 20:41:42 INFO mapreduce.Job:  map 91% reduce 28%
16/12/06 20:41:43 INFO mapreduce.Job:  map 92% reduce 29%
16/12/06 20:41:44 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 20:41:45 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 20:41:46 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 20:41:47 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 20:41:48 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 20:41:49 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 20:41:50 INFO mapreduce.Job:  map 100% reduce 39%
16/12/06 20:41:51 INFO mapreduce.Job:  map 100% reduce 52%
16/12/06 20:41:52 INFO mapreduce.Job:  map 100% reduce 57%
16/12/06 20:41:53 INFO mapreduce.Job:  map 100% reduce 68%
16/12/06 20:41:54 INFO mapreduce.Job:  map 100% reduce 75%
16/12/06 20:41:55 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 20:41:56 INFO mapreduce.Job:  map 100% reduce 84%
16/12/06 20:41:57 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 20:41:58 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 20:41:59 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 20:42:01 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 20:42:02 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 20:42:05 INFO mapreduce.Job: Job job_1480588584072_4884 completed successfully
16/12/06 20:42:05 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=841453023
		FILE: Number of bytes written=1715288011
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=709431466
		WASB: Number of bytes written=434881920
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12654942
		Total time spent by all reduces in occupied slots (ms)=2654370
		Total time spent by all map tasks (ms)=6327471
		Total time spent by all reduce tasks (ms)=1327185
		Total vcore-seconds taken by all map tasks=6327471
		Total vcore-seconds taken by all reduce tasks=1327185
		Total megabyte-seconds taken by all map tasks=6479330304
		Total megabyte-seconds taken by all reduce tasks=1359037440
	Map-Reduce Framework
		Map input records=2357677
		Map output records=2126243
		Map output bytes=833394798
		Map output materialized bytes=841476543
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1870066
		Reduce shuffle bytes=841476543
		Reduce input records=2126243
		Reduce output records=1309805
		Spilled Records=4252486
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=88209
		CPU time spent (ms)=934710
		Physical memory (bytes) snapshot=324544417792
		Virtual memory (bytes) snapshot=742543364096
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=706735462
	File Output Format Counters 
		Bytes Written=434881920
16/12/06 20:42:05 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1400 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1400': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2017297380587240143.jar tmpDir=null
16/12/06 20:42:42 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:42:43 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:42:43 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 20:42:45 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 20:42:45 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 20:42:45 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4885
16/12/06 20:42:46 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4885
16/12/06 20:42:46 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4885/
16/12/06 20:42:46 INFO mapreduce.Job: Running job: job_1480588584072_4885
16/12/06 20:42:58 INFO mapreduce.Job: Job job_1480588584072_4885 running in uber mode : false
16/12/06 20:42:58 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 20:43:21 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 20:43:22 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 20:43:23 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 20:43:26 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 20:43:27 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 20:43:28 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 20:43:29 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 20:43:30 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 20:43:31 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 20:43:32 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 20:43:33 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 20:43:35 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 20:43:36 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 20:43:41 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 20:43:44 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 20:43:46 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 20:43:48 INFO mapreduce.Job:  map 36% reduce 1%
16/12/06 20:43:49 INFO mapreduce.Job:  map 38% reduce 1%
16/12/06 20:43:50 INFO mapreduce.Job:  map 40% reduce 2%
16/12/06 20:43:51 INFO mapreduce.Job:  map 41% reduce 3%
16/12/06 20:43:52 INFO mapreduce.Job:  map 42% reduce 4%
16/12/06 20:43:53 INFO mapreduce.Job:  map 45% reduce 6%
16/12/06 20:43:54 INFO mapreduce.Job:  map 46% reduce 7%
16/12/06 20:43:55 INFO mapreduce.Job:  map 48% reduce 8%
16/12/06 20:43:56 INFO mapreduce.Job:  map 50% reduce 9%
16/12/06 20:43:57 INFO mapreduce.Job:  map 52% reduce 11%
16/12/06 20:43:58 INFO mapreduce.Job:  map 54% reduce 12%
16/12/06 20:43:59 INFO mapreduce.Job:  map 55% reduce 14%
16/12/06 20:44:00 INFO mapreduce.Job:  map 56% reduce 14%
16/12/06 20:44:01 INFO mapreduce.Job:  map 57% reduce 16%
16/12/06 20:44:02 INFO mapreduce.Job:  map 58% reduce 16%
16/12/06 20:44:03 INFO mapreduce.Job:  map 59% reduce 16%
16/12/06 20:44:05 INFO mapreduce.Job:  map 60% reduce 17%
16/12/06 20:44:06 INFO mapreduce.Job:  map 61% reduce 17%
16/12/06 20:44:07 INFO mapreduce.Job:  map 64% reduce 17%
16/12/06 20:44:08 INFO mapreduce.Job:  map 65% reduce 18%
16/12/06 20:44:09 INFO mapreduce.Job:  map 66% reduce 19%
16/12/06 20:44:10 INFO mapreduce.Job:  map 67% reduce 19%
16/12/06 20:44:11 INFO mapreduce.Job:  map 68% reduce 20%
16/12/06 20:44:12 INFO mapreduce.Job:  map 69% reduce 20%
16/12/06 20:44:14 INFO mapreduce.Job:  map 71% reduce 20%
16/12/06 20:44:15 INFO mapreduce.Job:  map 72% reduce 21%
16/12/06 20:44:16 INFO mapreduce.Job:  map 74% reduce 21%
16/12/06 20:44:18 INFO mapreduce.Job:  map 78% reduce 24%
16/12/06 20:44:19 INFO mapreduce.Job:  map 83% reduce 25%
16/12/06 20:44:21 INFO mapreduce.Job:  map 84% reduce 25%
16/12/06 20:44:22 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 20:44:23 INFO mapreduce.Job:  map 86% reduce 27%
16/12/06 20:44:24 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 20:44:25 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 20:44:28 INFO mapreduce.Job:  map 90% reduce 30%
16/12/06 20:44:30 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 20:44:33 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 20:44:35 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 20:44:36 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 20:44:37 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 20:44:39 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 20:44:40 INFO mapreduce.Job:  map 98% reduce 32%
16/12/06 20:44:41 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 20:44:42 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 20:44:43 INFO mapreduce.Job:  map 100% reduce 41%
16/12/06 20:44:44 INFO mapreduce.Job:  map 100% reduce 55%
16/12/06 20:44:45 INFO mapreduce.Job:  map 100% reduce 64%
16/12/06 20:44:46 INFO mapreduce.Job:  map 100% reduce 70%
16/12/06 20:44:47 INFO mapreduce.Job:  map 100% reduce 74%
16/12/06 20:44:48 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 20:44:49 INFO mapreduce.Job:  map 100% reduce 79%
16/12/06 20:44:50 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 20:44:51 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 20:44:52 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 20:44:53 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 20:44:54 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 20:44:55 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 20:44:56 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 20:44:57 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 20:45:00 INFO mapreduce.Job: Job job_1480588584072_4885 completed successfully
16/12/06 20:45:00 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=932937489
		FILE: Number of bytes written=1898256943
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=788851987
		WASB: Number of bytes written=501876561
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12043642
		Total time spent by all reduces in occupied slots (ms)=3042168
		Total time spent by all map tasks (ms)=6021821
		Total time spent by all reduce tasks (ms)=1521084
		Total vcore-seconds taken by all map tasks=6021821
		Total vcore-seconds taken by all reduce tasks=1521084
		Total megabyte-seconds taken by all map tasks=6166344704
		Total megabyte-seconds taken by all reduce tasks=1557590016
	Map-Reduce Framework
		Map input records=2602307
		Map output records=2344421
		Map output bytes=924041558
		Map output materialized bytes=932961009
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2072359
		Reduce shuffle bytes=932961009
		Reduce input records=2344421
		Reduce output records=1508003
		Spilled Records=4688842
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=70974
		CPU time spent (ms)=1000300
		Physical memory (bytes) snapshot=325366169600
		Virtual memory (bytes) snapshot=742496395264
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=786155983
	File Output Format Counters 
		Bytes Written=501876561
16/12/06 20:45:00 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1400
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1500 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1500': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2605126394003471952.jar tmpDir=null
16/12/06 20:45:37 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:45:38 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:45:38 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 20:45:40 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 20:45:40 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 20:45:40 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4886
16/12/06 20:45:41 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4886
16/12/06 20:45:41 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4886/
16/12/06 20:45:41 INFO mapreduce.Job: Running job: job_1480588584072_4886
16/12/06 20:45:54 INFO mapreduce.Job: Job job_1480588584072_4886 running in uber mode : false
16/12/06 20:45:54 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 20:46:09 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 20:46:10 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 20:46:16 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 20:46:21 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 20:46:22 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 20:46:29 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 20:46:30 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 20:46:33 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 20:46:37 INFO mapreduce.Job:  map 16% reduce 1%
16/12/06 20:46:39 INFO mapreduce.Job:  map 18% reduce 1%
16/12/06 20:46:40 INFO mapreduce.Job:  map 20% reduce 2%
16/12/06 20:46:41 INFO mapreduce.Job:  map 23% reduce 2%
16/12/06 20:46:42 INFO mapreduce.Job:  map 25% reduce 2%
16/12/06 20:46:43 INFO mapreduce.Job:  map 27% reduce 3%
16/12/06 20:46:44 INFO mapreduce.Job:  map 29% reduce 4%
16/12/06 20:46:45 INFO mapreduce.Job:  map 32% reduce 4%
16/12/06 20:46:46 INFO mapreduce.Job:  map 33% reduce 5%
16/12/06 20:46:47 INFO mapreduce.Job:  map 41% reduce 5%
16/12/06 20:46:48 INFO mapreduce.Job:  map 45% reduce 5%
16/12/06 20:46:49 INFO mapreduce.Job:  map 47% reduce 6%
16/12/06 20:46:50 INFO mapreduce.Job:  map 48% reduce 7%
16/12/06 20:46:51 INFO mapreduce.Job:  map 50% reduce 7%
16/12/06 20:46:52 INFO mapreduce.Job:  map 51% reduce 8%
16/12/06 20:46:53 INFO mapreduce.Job:  map 53% reduce 9%
16/12/06 20:46:54 INFO mapreduce.Job:  map 54% reduce 9%
16/12/06 20:46:55 INFO mapreduce.Job:  map 55% reduce 10%
16/12/06 20:46:58 INFO mapreduce.Job:  map 55% reduce 11%
16/12/06 20:47:01 INFO mapreduce.Job:  map 56% reduce 11%
16/12/06 20:47:03 INFO mapreduce.Job:  map 56% reduce 12%
16/12/06 20:47:06 INFO mapreduce.Job:  map 56% reduce 14%
16/12/06 20:47:07 INFO mapreduce.Job:  map 57% reduce 15%
16/12/06 20:47:08 INFO mapreduce.Job:  map 59% reduce 15%
16/12/06 20:47:09 INFO mapreduce.Job:  map 60% reduce 18%
16/12/06 20:47:10 INFO mapreduce.Job:  map 60% reduce 20%
16/12/06 20:47:11 INFO mapreduce.Job:  map 62% reduce 20%
16/12/06 20:47:13 INFO mapreduce.Job:  map 62% reduce 21%
16/12/06 20:47:14 INFO mapreduce.Job:  map 63% reduce 21%
16/12/06 20:47:15 INFO mapreduce.Job:  map 65% reduce 21%
16/12/06 20:47:16 INFO mapreduce.Job:  map 66% reduce 21%
16/12/06 20:47:17 INFO mapreduce.Job:  map 67% reduce 21%
16/12/06 20:47:18 INFO mapreduce.Job:  map 68% reduce 22%
16/12/06 20:47:19 INFO mapreduce.Job:  map 70% reduce 22%
16/12/06 20:47:20 INFO mapreduce.Job:  map 71% reduce 23%
16/12/06 20:47:21 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 20:47:22 INFO mapreduce.Job:  map 75% reduce 23%
16/12/06 20:47:23 INFO mapreduce.Job:  map 78% reduce 24%
16/12/06 20:47:24 INFO mapreduce.Job:  map 81% reduce 24%
16/12/06 20:47:25 INFO mapreduce.Job:  map 89% reduce 26%
16/12/06 20:47:26 INFO mapreduce.Job:  map 94% reduce 28%
16/12/06 20:47:27 INFO mapreduce.Job:  map 96% reduce 29%
16/12/06 20:47:28 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 20:47:29 INFO mapreduce.Job:  map 97% reduce 32%
16/12/06 20:47:30 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 20:47:31 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 20:47:32 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 20:47:33 INFO mapreduce.Job:  map 100% reduce 38%
16/12/06 20:47:34 INFO mapreduce.Job:  map 100% reduce 47%
16/12/06 20:47:35 INFO mapreduce.Job:  map 100% reduce 57%
16/12/06 20:47:37 INFO mapreduce.Job:  map 100% reduce 66%
16/12/06 20:47:38 INFO mapreduce.Job:  map 100% reduce 70%
16/12/06 20:47:39 INFO mapreduce.Job:  map 100% reduce 73%
16/12/06 20:47:40 INFO mapreduce.Job:  map 100% reduce 78%
16/12/06 20:47:41 INFO mapreduce.Job:  map 100% reduce 80%
16/12/06 20:47:42 INFO mapreduce.Job:  map 100% reduce 85%
16/12/06 20:47:43 INFO mapreduce.Job:  map 100% reduce 88%
16/12/06 20:47:44 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 20:47:45 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 20:47:46 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 20:47:47 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 20:47:48 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 20:47:50 INFO mapreduce.Job: Job job_1480588584072_4886 completed successfully
16/12/06 20:47:50 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=959073057
		FILE: Number of bytes written=1950528079
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=811274938
		WASB: Number of bytes written=518157022
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12962584
		Total time spent by all reduces in occupied slots (ms)=2862094
		Total time spent by all map tasks (ms)=6481292
		Total time spent by all reduce tasks (ms)=1431047
		Total vcore-seconds taken by all map tasks=6481292
		Total vcore-seconds taken by all reduce tasks=1431047
		Total megabyte-seconds taken by all map tasks=6636843008
		Total megabyte-seconds taken by all reduce tasks=1465392128
	Map-Reduce Framework
		Map input records=2674098
		Map output records=2404776
		Map output bytes=949941961
		Map output materialized bytes=959096577
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2133479
		Reduce shuffle bytes=959096577
		Reduce input records=2404776
		Reduce output records=1553826
		Spilled Records=4809552
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=84035
		CPU time spent (ms)=1009800
		Physical memory (bytes) snapshot=325229133824
		Virtual memory (bytes) snapshot=742680211456
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=808578934
	File Output Format Counters 
		Bytes Written=518157022
16/12/06 20:47:50 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1500
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1600 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1600': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4811903152221382540.jar tmpDir=null
16/12/06 20:48:28 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:48:29 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:48:29 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 20:48:31 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 20:48:31 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 20:48:31 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4887
16/12/06 20:48:32 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4887
16/12/06 20:48:32 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4887/
16/12/06 20:48:32 INFO mapreduce.Job: Running job: job_1480588584072_4887
16/12/06 20:48:46 INFO mapreduce.Job: Job job_1480588584072_4887 running in uber mode : false
16/12/06 20:48:46 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 20:49:02 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 20:49:03 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 20:49:11 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 20:49:14 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 20:49:15 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 20:49:16 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 20:49:24 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 20:49:25 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 20:49:27 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 20:49:30 INFO mapreduce.Job:  map 15% reduce 1%
16/12/06 20:49:31 INFO mapreduce.Job:  map 16% reduce 2%
16/12/06 20:49:32 INFO mapreduce.Job:  map 18% reduce 2%
16/12/06 20:49:33 INFO mapreduce.Job:  map 20% reduce 2%
16/12/06 20:49:34 INFO mapreduce.Job:  map 23% reduce 2%
16/12/06 20:49:35 INFO mapreduce.Job:  map 26% reduce 2%
16/12/06 20:49:36 INFO mapreduce.Job:  map 33% reduce 2%
16/12/06 20:49:37 INFO mapreduce.Job:  map 36% reduce 3%
16/12/06 20:49:38 INFO mapreduce.Job:  map 37% reduce 3%
16/12/06 20:49:39 INFO mapreduce.Job:  map 39% reduce 5%
16/12/06 20:49:40 INFO mapreduce.Job:  map 41% reduce 5%
16/12/06 20:49:41 INFO mapreduce.Job:  map 42% reduce 5%
16/12/06 20:49:42 INFO mapreduce.Job:  map 46% reduce 5%
16/12/06 20:49:43 INFO mapreduce.Job:  map 47% reduce 5%
16/12/06 20:49:44 INFO mapreduce.Job:  map 49% reduce 6%
16/12/06 20:49:45 INFO mapreduce.Job:  map 52% reduce 6%
16/12/06 20:49:46 INFO mapreduce.Job:  map 54% reduce 7%
16/12/06 20:49:47 INFO mapreduce.Job:  map 55% reduce 7%
16/12/06 20:49:48 INFO mapreduce.Job:  map 55% reduce 9%
16/12/06 20:49:49 INFO mapreduce.Job:  map 55% reduce 10%
16/12/06 20:49:52 INFO mapreduce.Job:  map 56% reduce 10%
16/12/06 20:49:53 INFO mapreduce.Job:  map 57% reduce 10%
16/12/06 20:49:58 INFO mapreduce.Job:  map 57% reduce 11%
16/12/06 20:49:59 INFO mapreduce.Job:  map 58% reduce 12%
16/12/06 20:50:00 INFO mapreduce.Job:  map 59% reduce 12%
16/12/06 20:50:01 INFO mapreduce.Job:  map 60% reduce 15%
16/12/06 20:50:02 INFO mapreduce.Job:  map 61% reduce 15%
16/12/06 20:50:03 INFO mapreduce.Job:  map 62% reduce 17%
16/12/06 20:50:04 INFO mapreduce.Job:  map 63% reduce 18%
16/12/06 20:50:05 INFO mapreduce.Job:  map 65% reduce 19%
16/12/06 20:50:06 INFO mapreduce.Job:  map 68% reduce 20%
16/12/06 20:50:07 INFO mapreduce.Job:  map 70% reduce 21%
16/12/06 20:50:08 INFO mapreduce.Job:  map 71% reduce 22%
16/12/06 20:50:09 INFO mapreduce.Job:  map 73% reduce 23%
16/12/06 20:50:10 INFO mapreduce.Job:  map 75% reduce 23%
16/12/06 20:50:11 INFO mapreduce.Job:  map 76% reduce 24%
16/12/06 20:50:12 INFO mapreduce.Job:  map 77% reduce 25%
16/12/06 20:50:13 INFO mapreduce.Job:  map 78% reduce 25%
16/12/06 20:50:14 INFO mapreduce.Job:  map 79% reduce 26%
16/12/06 20:50:15 INFO mapreduce.Job:  map 82% reduce 26%
16/12/06 20:50:16 INFO mapreduce.Job:  map 87% reduce 26%
16/12/06 20:50:17 INFO mapreduce.Job:  map 90% reduce 28%
16/12/06 20:50:18 INFO mapreduce.Job:  map 94% reduce 29%
16/12/06 20:50:19 INFO mapreduce.Job:  map 98% reduce 30%
16/12/06 20:50:20 INFO mapreduce.Job:  map 100% reduce 31%
16/12/06 20:50:22 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 20:50:23 INFO mapreduce.Job:  map 100% reduce 36%
16/12/06 20:50:24 INFO mapreduce.Job:  map 100% reduce 49%
16/12/06 20:50:25 INFO mapreduce.Job:  map 100% reduce 57%
16/12/06 20:50:26 INFO mapreduce.Job:  map 100% reduce 68%
16/12/06 20:50:27 INFO mapreduce.Job:  map 100% reduce 73%
16/12/06 20:50:28 INFO mapreduce.Job:  map 100% reduce 79%
16/12/06 20:50:29 INFO mapreduce.Job:  map 100% reduce 83%
16/12/06 20:50:30 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 20:50:32 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 20:50:33 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 20:50:37 INFO mapreduce.Job: Job job_1480588584072_4887 completed successfully
16/12/06 20:50:37 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=796377150
		FILE: Number of bytes written=1625136265
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=684411140
		WASB: Number of bytes written=384036032
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12629770
		Total time spent by all reduces in occupied slots (ms)=2550644
		Total time spent by all map tasks (ms)=6314885
		Total time spent by all reduce tasks (ms)=1275322
		Total vcore-seconds taken by all map tasks=6314885
		Total vcore-seconds taken by all reduce tasks=1275322
		Total megabyte-seconds taken by all map tasks=6466442240
		Total megabyte-seconds taken by all reduce tasks=1305929728
	Map-Reduce Framework
		Map input records=2319627
		Map output records=2037681
		Map output bytes=788682172
		Map output materialized bytes=796400670
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1791036
		Reduce shuffle bytes=796400670
		Reduce input records=2037681
		Reduce output records=1175413
		Spilled Records=4075362
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=74702
		CPU time spent (ms)=929970
		Physical memory (bytes) snapshot=324240371712
		Virtual memory (bytes) snapshot=742492819456
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=681715136
	File Output Format Counters 
		Bytes Written=384036032
16/12/06 20:50:37 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1600
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1700 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612050900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1700': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7545753010831037756.jar tmpDir=null
16/12/06 20:51:14 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:51:15 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:51:16 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 20:51:18 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 20:51:18 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 20:51:19 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4888
16/12/06 20:51:19 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4888
16/12/06 20:51:20 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4888/
16/12/06 20:51:20 INFO mapreduce.Job: Running job: job_1480588584072_4888
16/12/06 20:51:33 INFO mapreduce.Job: Job job_1480588584072_4888 running in uber mode : false
16/12/06 20:51:33 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 20:51:47 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 20:51:48 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 20:51:54 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 20:51:59 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 20:52:00 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 20:52:01 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 20:52:02 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 20:52:07 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 20:52:08 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 20:52:13 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 20:52:16 INFO mapreduce.Job:  map 15% reduce 1%
16/12/06 20:52:17 INFO mapreduce.Job:  map 16% reduce 2%
16/12/06 20:52:18 INFO mapreduce.Job:  map 17% reduce 2%
16/12/06 20:52:19 INFO mapreduce.Job:  map 19% reduce 2%
16/12/06 20:52:20 INFO mapreduce.Job:  map 23% reduce 2%
16/12/06 20:52:21 INFO mapreduce.Job:  map 25% reduce 2%
16/12/06 20:52:22 INFO mapreduce.Job:  map 28% reduce 3%
16/12/06 20:52:23 INFO mapreduce.Job:  map 31% reduce 3%
16/12/06 20:52:24 INFO mapreduce.Job:  map 35% reduce 3%
16/12/06 20:52:25 INFO mapreduce.Job:  map 38% reduce 4%
16/12/06 20:52:26 INFO mapreduce.Job:  map 40% reduce 4%
16/12/06 20:52:27 INFO mapreduce.Job:  map 44% reduce 4%
16/12/06 20:52:28 INFO mapreduce.Job:  map 48% reduce 5%
16/12/06 20:52:29 INFO mapreduce.Job:  map 49% reduce 5%
16/12/06 20:52:30 INFO mapreduce.Job:  map 51% reduce 6%
16/12/06 20:52:31 INFO mapreduce.Job:  map 52% reduce 7%
16/12/06 20:52:32 INFO mapreduce.Job:  map 53% reduce 8%
16/12/06 20:52:33 INFO mapreduce.Job:  map 54% reduce 10%
16/12/06 20:52:35 INFO mapreduce.Job:  map 55% reduce 11%
16/12/06 20:52:36 INFO mapreduce.Job:  map 55% reduce 12%
16/12/06 20:52:39 INFO mapreduce.Job:  map 55% reduce 13%
16/12/06 20:52:43 INFO mapreduce.Job:  map 55% reduce 14%
16/12/06 20:52:45 INFO mapreduce.Job:  map 56% reduce 14%
16/12/06 20:52:47 INFO mapreduce.Job:  map 56% reduce 17%
16/12/06 20:52:48 INFO mapreduce.Job:  map 57% reduce 18%
16/12/06 20:52:49 INFO mapreduce.Job:  map 58% reduce 18%
16/12/06 20:52:50 INFO mapreduce.Job:  map 59% reduce 19%
16/12/06 20:52:51 INFO mapreduce.Job:  map 60% reduce 19%
16/12/06 20:52:52 INFO mapreduce.Job:  map 63% reduce 19%
16/12/06 20:52:53 INFO mapreduce.Job:  map 64% reduce 20%
16/12/06 20:52:54 INFO mapreduce.Job:  map 65% reduce 20%
16/12/06 20:52:55 INFO mapreduce.Job:  map 65% reduce 21%
16/12/06 20:52:56 INFO mapreduce.Job:  map 67% reduce 21%
16/12/06 20:52:57 INFO mapreduce.Job:  map 69% reduce 21%
16/12/06 20:52:58 INFO mapreduce.Job:  map 70% reduce 22%
16/12/06 20:52:59 INFO mapreduce.Job:  map 72% reduce 22%
16/12/06 20:53:00 INFO mapreduce.Job:  map 75% reduce 23%
16/12/06 20:53:01 INFO mapreduce.Job:  map 78% reduce 23%
16/12/06 20:53:02 INFO mapreduce.Job:  map 80% reduce 25%
16/12/06 20:53:03 INFO mapreduce.Job:  map 82% reduce 26%
16/12/06 20:53:04 INFO mapreduce.Job:  map 84% reduce 26%
16/12/06 20:53:05 INFO mapreduce.Job:  map 86% reduce 27%
16/12/06 20:53:06 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 20:53:07 INFO mapreduce.Job:  map 91% reduce 28%
16/12/06 20:53:08 INFO mapreduce.Job:  map 93% reduce 29%
16/12/06 20:53:09 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 20:53:10 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 20:53:11 INFO mapreduce.Job:  map 98% reduce 31%
16/12/06 20:53:12 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 20:53:13 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 20:53:14 INFO mapreduce.Job:  map 100% reduce 37%
16/12/06 20:53:15 INFO mapreduce.Job:  map 100% reduce 50%
16/12/06 20:53:16 INFO mapreduce.Job:  map 100% reduce 55%
16/12/06 20:53:17 INFO mapreduce.Job:  map 100% reduce 61%
16/12/06 20:53:18 INFO mapreduce.Job:  map 100% reduce 69%
16/12/06 20:53:19 INFO mapreduce.Job:  map 100% reduce 72%
16/12/06 20:53:20 INFO mapreduce.Job:  map 100% reduce 75%
16/12/06 20:53:22 INFO mapreduce.Job:  map 100% reduce 80%
16/12/06 20:53:23 INFO mapreduce.Job:  map 100% reduce 84%
16/12/06 20:53:24 INFO mapreduce.Job:  map 100% reduce 88%
16/12/06 20:53:25 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 20:53:26 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 20:53:27 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 20:53:29 INFO mapreduce.Job: Job job_1480588584072_4888 completed successfully
16/12/06 20:53:29 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=918487074
		FILE: Number of bytes written=1869356113
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=779638807
		WASB: Number of bytes written=476297391
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13098884
		Total time spent by all reduces in occupied slots (ms)=2901706
		Total time spent by all map tasks (ms)=6549442
		Total time spent by all reduce tasks (ms)=1450853
		Total vcore-seconds taken by all map tasks=6549442
		Total vcore-seconds taken by all reduce tasks=1450853
		Total megabyte-seconds taken by all map tasks=6706628608
		Total megabyte-seconds taken by all reduce tasks=1485673472
	Map-Reduce Framework
		Map input records=2575138
		Map output records=2300004
		Map output bytes=909727709
		Map output materialized bytes=918510594
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2028459
		Reduce shuffle bytes=918510594
		Reduce input records=2300004
		Reduce output records=1415227
		Spilled Records=4600008
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=85208
		CPU time spent (ms)=990070
		Physical memory (bytes) snapshot=324923551744
		Virtual memory (bytes) snapshot=742545461248
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=776942803
	File Output Format Counters 
		Bytes Written=476297391
16/12/06 20:53:29 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1700
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051400 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1800 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051400
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1800': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob407714918808434088.jar tmpDir=null
16/12/06 20:54:06 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:54:07 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:54:08 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 20:54:09 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 20:54:10 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 20:54:10 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4889
16/12/06 20:54:11 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4889
16/12/06 20:54:11 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4889/
16/12/06 20:54:11 INFO mapreduce.Job: Running job: job_1480588584072_4889
16/12/06 20:54:23 INFO mapreduce.Job: Job job_1480588584072_4889 running in uber mode : false
16/12/06 20:54:23 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 20:54:33 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 20:54:34 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 20:54:42 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 20:54:50 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 20:54:51 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 20:54:52 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 20:54:53 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 20:54:54 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 20:54:58 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 20:54:59 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 20:55:06 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 20:55:07 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 20:55:08 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 20:55:09 INFO mapreduce.Job:  map 21% reduce 1%
16/12/06 20:55:10 INFO mapreduce.Job:  map 25% reduce 2%
16/12/06 20:55:11 INFO mapreduce.Job:  map 27% reduce 2%
16/12/06 20:55:12 INFO mapreduce.Job:  map 32% reduce 3%
16/12/06 20:55:13 INFO mapreduce.Job:  map 35% reduce 4%
16/12/06 20:55:14 INFO mapreduce.Job:  map 37% reduce 4%
16/12/06 20:55:15 INFO mapreduce.Job:  map 38% reduce 5%
16/12/06 20:55:16 INFO mapreduce.Job:  map 40% reduce 6%
16/12/06 20:55:17 INFO mapreduce.Job:  map 40% reduce 7%
16/12/06 20:55:18 INFO mapreduce.Job:  map 41% reduce 7%
16/12/06 20:55:19 INFO mapreduce.Job:  map 42% reduce 8%
16/12/06 20:55:20 INFO mapreduce.Job:  map 44% reduce 8%
16/12/06 20:55:22 INFO mapreduce.Job:  map 46% reduce 9%
16/12/06 20:55:23 INFO mapreduce.Job:  map 47% reduce 9%
16/12/06 20:55:24 INFO mapreduce.Job:  map 48% reduce 9%
16/12/06 20:55:25 INFO mapreduce.Job:  map 49% reduce 9%
16/12/06 20:55:26 INFO mapreduce.Job:  map 50% reduce 9%
16/12/06 20:55:27 INFO mapreduce.Job:  map 51% reduce 9%
16/12/06 20:55:28 INFO mapreduce.Job:  map 52% reduce 10%
16/12/06 20:55:29 INFO mapreduce.Job:  map 53% reduce 10%
16/12/06 20:55:30 INFO mapreduce.Job:  map 53% reduce 11%
16/12/06 20:55:31 INFO mapreduce.Job:  map 54% reduce 12%
16/12/06 20:55:35 INFO mapreduce.Job:  map 55% reduce 12%
16/12/06 20:55:36 INFO mapreduce.Job:  map 55% reduce 13%
16/12/06 20:55:37 INFO mapreduce.Job:  map 56% reduce 13%
16/12/06 20:55:38 INFO mapreduce.Job:  map 56% reduce 15%
16/12/06 20:55:39 INFO mapreduce.Job:  map 58% reduce 16%
16/12/06 20:55:40 INFO mapreduce.Job:  map 61% reduce 18%
16/12/06 20:55:41 INFO mapreduce.Job:  map 63% reduce 19%
16/12/06 20:55:42 INFO mapreduce.Job:  map 66% reduce 20%
16/12/06 20:55:43 INFO mapreduce.Job:  map 67% reduce 20%
16/12/06 20:55:44 INFO mapreduce.Job:  map 67% reduce 21%
16/12/06 20:55:45 INFO mapreduce.Job:  map 69% reduce 22%
16/12/06 20:55:46 INFO mapreduce.Job:  map 70% reduce 22%
16/12/06 20:55:47 INFO mapreduce.Job:  map 72% reduce 23%
16/12/06 20:55:49 INFO mapreduce.Job:  map 73% reduce 24%
16/12/06 20:55:51 INFO mapreduce.Job:  map 75% reduce 24%
16/12/06 20:55:52 INFO mapreduce.Job:  map 76% reduce 24%
16/12/06 20:55:53 INFO mapreduce.Job:  map 78% reduce 25%
16/12/06 20:55:54 INFO mapreduce.Job:  map 79% reduce 25%
16/12/06 20:55:55 INFO mapreduce.Job:  map 80% reduce 26%
16/12/06 20:55:56 INFO mapreduce.Job:  map 83% reduce 26%
16/12/06 20:55:57 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 20:55:58 INFO mapreduce.Job:  map 86% reduce 28%
16/12/06 20:55:59 INFO mapreduce.Job:  map 87% reduce 28%
16/12/06 20:56:00 INFO mapreduce.Job:  map 89% reduce 29%
16/12/06 20:56:01 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 20:56:02 INFO mapreduce.Job:  map 93% reduce 29%
16/12/06 20:56:03 INFO mapreduce.Job:  map 96% reduce 30%
16/12/06 20:56:04 INFO mapreduce.Job:  map 98% reduce 31%
16/12/06 20:56:05 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 20:56:07 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 20:56:08 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 20:56:09 INFO mapreduce.Job:  map 100% reduce 36%
16/12/06 20:56:10 INFO mapreduce.Job:  map 100% reduce 43%
16/12/06 20:56:11 INFO mapreduce.Job:  map 100% reduce 47%
16/12/06 20:56:12 INFO mapreduce.Job:  map 100% reduce 59%
16/12/06 20:56:13 INFO mapreduce.Job:  map 100% reduce 68%
16/12/06 20:56:14 INFO mapreduce.Job:  map 100% reduce 72%
16/12/06 20:56:16 INFO mapreduce.Job:  map 100% reduce 78%
16/12/06 20:56:17 INFO mapreduce.Job:  map 100% reduce 83%
16/12/06 20:56:18 INFO mapreduce.Job:  map 100% reduce 85%
16/12/06 20:56:19 INFO mapreduce.Job:  map 100% reduce 88%
16/12/06 20:56:20 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 20:56:21 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 20:56:23 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 20:56:24 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 20:56:25 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 20:56:26 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 20:56:27 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 20:56:29 INFO mapreduce.Job: Job job_1480588584072_4889 completed successfully
16/12/06 20:56:29 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=892490240
		FILE: Number of bytes written=1817362445
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=761283117
		WASB: Number of bytes written=443552885
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13301376
		Total time spent by all reduces in occupied slots (ms)=3108580
		Total time spent by all map tasks (ms)=6650688
		Total time spent by all reduce tasks (ms)=1554290
		Total vcore-seconds taken by all map tasks=6650688
		Total vcore-seconds taken by all reduce tasks=1554290
		Total megabyte-seconds taken by all map tasks=6810304512
		Total megabyte-seconds taken by all reduce tasks=1591592960
	Map-Reduce Framework
		Map input records=2560158
		Map output records=2267676
		Map output bytes=883903889
		Map output materialized bytes=892513760
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1996404
		Reduce shuffle bytes=892513760
		Reduce input records=2267676
		Reduce output records=1347567
		Spilled Records=4535352
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=75447
		CPU time spent (ms)=985610
		Physical memory (bytes) snapshot=325017542656
		Virtual memory (bytes) snapshot=742607142912
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=758587113
	File Output Format Counters 
		Bytes Written=443552885
16/12/06 20:56:29 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1800
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051500 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1900 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051500
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1900': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2693586218917518907.jar tmpDir=null
16/12/06 20:57:06 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:57:07 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:57:07 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 20:57:09 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 20:57:09 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 20:57:10 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4890
16/12/06 20:57:10 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4890
16/12/06 20:57:10 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4890/
16/12/06 20:57:10 INFO mapreduce.Job: Running job: job_1480588584072_4890
16/12/06 20:57:23 INFO mapreduce.Job: Job job_1480588584072_4890 running in uber mode : false
16/12/06 20:57:23 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 20:57:43 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 20:57:44 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 20:57:48 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 20:57:49 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 20:57:50 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 20:57:51 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 20:57:52 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 20:57:53 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 20:57:54 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 20:57:57 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 20:57:58 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 20:58:07 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 20:58:09 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 20:58:10 INFO mapreduce.Job:  map 25% reduce 0%
16/12/06 20:58:11 INFO mapreduce.Job:  map 29% reduce 1%
16/12/06 20:58:12 INFO mapreduce.Job:  map 31% reduce 2%
16/12/06 20:58:13 INFO mapreduce.Job:  map 33% reduce 2%
16/12/06 20:58:14 INFO mapreduce.Job:  map 39% reduce 2%
16/12/06 20:58:15 INFO mapreduce.Job:  map 44% reduce 3%
16/12/06 20:58:16 INFO mapreduce.Job:  map 51% reduce 4%
16/12/06 20:58:17 INFO mapreduce.Job:  map 53% reduce 4%
16/12/06 20:58:18 INFO mapreduce.Job:  map 55% reduce 5%
16/12/06 20:58:19 INFO mapreduce.Job:  map 55% reduce 6%
16/12/06 20:58:20 INFO mapreduce.Job:  map 56% reduce 8%
16/12/06 20:58:21 INFO mapreduce.Job:  map 57% reduce 11%
16/12/06 20:58:23 INFO mapreduce.Job:  map 58% reduce 13%
16/12/06 20:58:29 INFO mapreduce.Job:  map 58% reduce 14%
16/12/06 20:58:31 INFO mapreduce.Job:  map 61% reduce 15%
16/12/06 20:58:32 INFO mapreduce.Job:  map 63% reduce 15%
16/12/06 20:58:33 INFO mapreduce.Job:  map 65% reduce 15%
16/12/06 20:58:34 INFO mapreduce.Job:  map 66% reduce 16%
16/12/06 20:58:36 INFO mapreduce.Job:  map 66% reduce 17%
16/12/06 20:58:38 INFO mapreduce.Job:  map 67% reduce 19%
16/12/06 20:58:39 INFO mapreduce.Job:  map 67% reduce 21%
16/12/06 20:58:42 INFO mapreduce.Job:  map 69% reduce 21%
16/12/06 20:58:43 INFO mapreduce.Job:  map 73% reduce 21%
16/12/06 20:58:44 INFO mapreduce.Job:  map 75% reduce 22%
16/12/06 20:58:45 INFO mapreduce.Job:  map 77% reduce 23%
16/12/06 20:58:46 INFO mapreduce.Job:  map 78% reduce 23%
16/12/06 20:58:47 INFO mapreduce.Job:  map 79% reduce 24%
16/12/06 20:58:48 INFO mapreduce.Job:  map 83% reduce 26%
16/12/06 20:58:49 INFO mapreduce.Job:  map 85% reduce 26%
16/12/06 20:58:50 INFO mapreduce.Job:  map 88% reduce 27%
16/12/06 20:58:51 INFO mapreduce.Job:  map 89% reduce 28%
16/12/06 20:58:52 INFO mapreduce.Job:  map 92% reduce 28%
16/12/06 20:58:53 INFO mapreduce.Job:  map 96% reduce 29%
16/12/06 20:58:54 INFO mapreduce.Job:  map 98% reduce 31%
16/12/06 20:58:55 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 20:58:56 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 20:58:57 INFO mapreduce.Job:  map 100% reduce 37%
16/12/06 20:58:58 INFO mapreduce.Job:  map 100% reduce 43%
16/12/06 20:58:59 INFO mapreduce.Job:  map 100% reduce 51%
16/12/06 20:59:00 INFO mapreduce.Job:  map 100% reduce 61%
16/12/06 20:59:01 INFO mapreduce.Job:  map 100% reduce 69%
16/12/06 20:59:02 INFO mapreduce.Job:  map 100% reduce 73%
16/12/06 20:59:03 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 20:59:04 INFO mapreduce.Job:  map 100% reduce 80%
16/12/06 20:59:05 INFO mapreduce.Job:  map 100% reduce 84%
16/12/06 20:59:06 INFO mapreduce.Job:  map 100% reduce 88%
16/12/06 20:59:07 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 20:59:08 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 20:59:09 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 20:59:12 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 20:59:14 INFO mapreduce.Job: Job job_1480588584072_4890 completed successfully
16/12/06 20:59:14 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=980241378
		FILE: Number of bytes written=1992864721
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=827941245
		WASB: Number of bytes written=509817553
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12350948
		Total time spent by all reduces in occupied slots (ms)=2558696
		Total time spent by all map tasks (ms)=6175474
		Total time spent by all reduce tasks (ms)=1279348
		Total vcore-seconds taken by all map tasks=6175474
		Total vcore-seconds taken by all reduce tasks=1279348
		Total megabyte-seconds taken by all map tasks=6323685376
		Total megabyte-seconds taken by all reduce tasks=1310052352
	Map-Reduce Framework
		Map input records=2778424
		Map output records=2491917
		Map output bytes=970826313
		Map output materialized bytes=980264898
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2193771
		Reduce shuffle bytes=980264898
		Reduce input records=2491917
		Reduce output records=1548951
		Spilled Records=4983834
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=78107
		CPU time spent (ms)=1001640
		Physical memory (bytes) snapshot=325359325184
		Virtual memory (bytes) snapshot=742691405824
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=825245241
	File Output Format Counters 
		Bytes Written=509817553
16/12/06 20:59:14 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/1900
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051600 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/2000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051600
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/2000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4152684769717760681.jar tmpDir=null
16/12/06 20:59:51 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:59:52 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 20:59:52 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 20:59:54 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 20:59:54 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 20:59:54 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4891
16/12/06 20:59:55 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4891
16/12/06 20:59:55 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4891/
16/12/06 20:59:55 INFO mapreduce.Job: Running job: job_1480588584072_4891
16/12/06 21:00:07 INFO mapreduce.Job: Job job_1480588584072_4891 running in uber mode : false
16/12/06 21:00:07 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 21:00:30 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 21:00:31 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 21:00:37 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 21:00:38 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 21:00:39 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 21:00:40 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 21:00:41 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 21:00:42 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 21:00:43 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 21:00:44 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 21:00:51 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 21:00:52 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 21:00:54 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 21:00:56 INFO mapreduce.Job:  map 28% reduce 1%
16/12/06 21:00:57 INFO mapreduce.Job:  map 33% reduce 1%
16/12/06 21:00:58 INFO mapreduce.Job:  map 38% reduce 2%
16/12/06 21:00:59 INFO mapreduce.Job:  map 41% reduce 3%
16/12/06 21:01:00 INFO mapreduce.Job:  map 43% reduce 3%
16/12/06 21:01:01 INFO mapreduce.Job:  map 44% reduce 4%
16/12/06 21:01:02 INFO mapreduce.Job:  map 45% reduce 4%
16/12/06 21:01:03 INFO mapreduce.Job:  map 46% reduce 4%
16/12/06 21:01:04 INFO mapreduce.Job:  map 47% reduce 6%
16/12/06 21:01:05 INFO mapreduce.Job:  map 49% reduce 7%
16/12/06 21:01:06 INFO mapreduce.Job:  map 50% reduce 8%
16/12/06 21:01:07 INFO mapreduce.Job:  map 51% reduce 10%
16/12/06 21:01:08 INFO mapreduce.Job:  map 51% reduce 12%
16/12/06 21:01:09 INFO mapreduce.Job:  map 53% reduce 12%
16/12/06 21:01:11 INFO mapreduce.Job:  map 54% reduce 13%
16/12/06 21:01:12 INFO mapreduce.Job:  map 56% reduce 13%
16/12/06 21:01:14 INFO mapreduce.Job:  map 56% reduce 14%
16/12/06 21:01:15 INFO mapreduce.Job:  map 58% reduce 14%
16/12/06 21:01:16 INFO mapreduce.Job:  map 61% reduce 16%
16/12/06 21:01:17 INFO mapreduce.Job:  map 61% reduce 17%
16/12/06 21:01:18 INFO mapreduce.Job:  map 62% reduce 17%
16/12/06 21:01:19 INFO mapreduce.Job:  map 63% reduce 19%
16/12/06 21:01:21 INFO mapreduce.Job:  map 64% reduce 19%
16/12/06 21:01:22 INFO mapreduce.Job:  map 65% reduce 21%
16/12/06 21:01:24 INFO mapreduce.Job:  map 67% reduce 21%
16/12/06 21:01:25 INFO mapreduce.Job:  map 68% reduce 22%
16/12/06 21:01:26 INFO mapreduce.Job:  map 69% reduce 22%
16/12/06 21:01:27 INFO mapreduce.Job:  map 70% reduce 22%
16/12/06 21:01:28 INFO mapreduce.Job:  map 72% reduce 23%
16/12/06 21:01:29 INFO mapreduce.Job:  map 77% reduce 23%
16/12/06 21:01:30 INFO mapreduce.Job:  map 78% reduce 23%
16/12/06 21:01:31 INFO mapreduce.Job:  map 84% reduce 24%
16/12/06 21:01:32 INFO mapreduce.Job:  map 86% reduce 26%
16/12/06 21:01:33 INFO mapreduce.Job:  map 89% reduce 26%
16/12/06 21:01:34 INFO mapreduce.Job:  map 89% reduce 28%
16/12/06 21:01:35 INFO mapreduce.Job:  map 89% reduce 30%
16/12/06 21:01:36 INFO mapreduce.Job:  map 90% reduce 30%
16/12/06 21:01:38 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 21:01:43 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 21:01:44 INFO mapreduce.Job:  map 94% reduce 30%
16/12/06 21:01:45 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 21:01:46 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 21:01:47 INFO mapreduce.Job:  map 97% reduce 32%
16/12/06 21:01:48 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 21:01:50 INFO mapreduce.Job:  map 99% reduce 33%
16/12/06 21:01:51 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 21:01:52 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 21:01:53 INFO mapreduce.Job:  map 100% reduce 45%
16/12/06 21:01:54 INFO mapreduce.Job:  map 100% reduce 47%
16/12/06 21:01:55 INFO mapreduce.Job:  map 100% reduce 55%
16/12/06 21:01:56 INFO mapreduce.Job:  map 100% reduce 67%
16/12/06 21:01:57 INFO mapreduce.Job:  map 100% reduce 70%
16/12/06 21:01:58 INFO mapreduce.Job:  map 100% reduce 74%
16/12/06 21:01:59 INFO mapreduce.Job:  map 100% reduce 81%
16/12/06 21:02:00 INFO mapreduce.Job:  map 100% reduce 83%
16/12/06 21:02:01 INFO mapreduce.Job:  map 100% reduce 86%
16/12/06 21:02:02 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 21:02:03 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 21:02:05 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 21:02:06 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 21:02:07 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 21:02:08 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 21:02:09 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 21:02:13 INFO mapreduce.Job: Job job_1480588584072_4891 completed successfully
16/12/06 21:02:13 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=951106837
		FILE: Number of bytes written=1934595639
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=800265949
		WASB: Number of bytes written=504490699
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12273568
		Total time spent by all reduces in occupied slots (ms)=3104872
		Total time spent by all map tasks (ms)=6136784
		Total time spent by all reduce tasks (ms)=1552436
		Total vcore-seconds taken by all map tasks=6136784
		Total vcore-seconds taken by all reduce tasks=1552436
		Total megabyte-seconds taken by all map tasks=6284066816
		Total megabyte-seconds taken by all reduce tasks=1589694464
	Map-Reduce Framework
		Map input records=2668477
		Map output records=2409378
		Map output bytes=941992024
		Map output materialized bytes=951130357
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2114039
		Reduce shuffle bytes=951130357
		Reduce input records=2409378
		Reduce output records=1515958
		Spilled Records=4818756
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=79217
		CPU time spent (ms)=1025720
		Physical memory (bytes) snapshot=325479510016
		Virtual memory (bytes) snapshot=742348886016
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=797569945
	File Output Format Counters 
		Bytes Written=504490699
16/12/06 21:02:13 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/2000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051700 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/2100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051700
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/2100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7934070496492685305.jar tmpDir=null
16/12/06 21:02:49 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 21:02:50 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 21:02:51 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 21:02:52 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 21:02:52 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 21:02:53 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4893
16/12/06 21:02:54 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4893
16/12/06 21:02:54 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4893/
16/12/06 21:02:54 INFO mapreduce.Job: Running job: job_1480588584072_4893
16/12/06 21:05:13 INFO mapreduce.Job: Job job_1480588584072_4893 running in uber mode : false
16/12/06 21:05:13 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 21:05:34 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 21:05:35 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 21:05:36 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 21:05:40 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 21:05:43 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 21:05:44 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 21:05:45 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 21:05:47 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 21:05:48 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 21:05:49 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 21:05:50 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 21:05:51 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 21:05:55 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 21:05:57 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 21:05:58 INFO mapreduce.Job:  map 24% reduce 1%
16/12/06 21:05:59 INFO mapreduce.Job:  map 26% reduce 1%
16/12/06 21:06:00 INFO mapreduce.Job:  map 27% reduce 2%
16/12/06 21:06:01 INFO mapreduce.Job:  map 29% reduce 3%
16/12/06 21:06:02 INFO mapreduce.Job:  map 33% reduce 3%
16/12/06 21:06:03 INFO mapreduce.Job:  map 34% reduce 3%
16/12/06 21:06:04 INFO mapreduce.Job:  map 39% reduce 4%
16/12/06 21:06:06 INFO mapreduce.Job:  map 41% reduce 5%
16/12/06 21:06:07 INFO mapreduce.Job:  map 43% reduce 5%
16/12/06 21:06:08 INFO mapreduce.Job:  map 46% reduce 6%
16/12/06 21:06:09 INFO mapreduce.Job:  map 46% reduce 8%
16/12/06 21:06:10 INFO mapreduce.Job:  map 47% reduce 8%
16/12/06 21:06:11 INFO mapreduce.Job:  map 48% reduce 9%
16/12/06 21:06:12 INFO mapreduce.Job:  map 49% reduce 10%
16/12/06 21:06:13 INFO mapreduce.Job:  map 53% reduce 10%
16/12/06 21:06:14 INFO mapreduce.Job:  map 54% reduce 11%
16/12/06 21:06:15 INFO mapreduce.Job:  map 57% reduce 12%
16/12/06 21:06:16 INFO mapreduce.Job:  map 57% reduce 15%
16/12/06 21:06:17 INFO mapreduce.Job:  map 58% reduce 15%
16/12/06 21:06:20 INFO mapreduce.Job:  map 59% reduce 16%
16/12/06 21:06:22 INFO mapreduce.Job:  map 60% reduce 16%
16/12/06 21:06:23 INFO mapreduce.Job:  map 61% reduce 17%
16/12/06 21:06:25 INFO mapreduce.Job:  map 61% reduce 18%
16/12/06 21:06:28 INFO mapreduce.Job:  map 63% reduce 19%
16/12/06 21:06:29 INFO mapreduce.Job:  map 65% reduce 19%
16/12/06 21:06:30 INFO mapreduce.Job:  map 67% reduce 20%
16/12/06 21:06:31 INFO mapreduce.Job:  map 68% reduce 20%
16/12/06 21:06:32 INFO mapreduce.Job:  map 70% reduce 22%
16/12/06 21:06:33 INFO mapreduce.Job:  map 71% reduce 22%
16/12/06 21:06:34 INFO mapreduce.Job:  map 75% reduce 23%
16/12/06 21:06:35 INFO mapreduce.Job:  map 79% reduce 23%
16/12/06 21:06:36 INFO mapreduce.Job:  map 81% reduce 24%
16/12/06 21:06:37 INFO mapreduce.Job:  map 82% reduce 25%
16/12/06 21:06:38 INFO mapreduce.Job:  map 83% reduce 26%
16/12/06 21:06:39 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 21:06:40 INFO mapreduce.Job:  map 85% reduce 28%
16/12/06 21:06:42 INFO mapreduce.Job:  map 86% reduce 28%
16/12/06 21:06:43 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 21:06:44 INFO mapreduce.Job:  map 91% reduce 28%
16/12/06 21:06:45 INFO mapreduce.Job:  map 92% reduce 29%
16/12/06 21:06:46 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 21:06:47 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 21:06:48 INFO mapreduce.Job:  map 93% reduce 31%
16/12/06 21:06:49 INFO mapreduce.Job:  map 94% reduce 31%
16/12/06 21:06:50 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 21:06:51 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 21:06:52 INFO mapreduce.Job:  map 97% reduce 32%
16/12/06 21:06:53 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 21:06:54 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 21:06:55 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 21:06:56 INFO mapreduce.Job:  map 100% reduce 38%
16/12/06 21:06:57 INFO mapreduce.Job:  map 100% reduce 55%
16/12/06 21:06:58 INFO mapreduce.Job:  map 100% reduce 61%
16/12/06 21:06:59 INFO mapreduce.Job:  map 100% reduce 70%
16/12/06 21:07:00 INFO mapreduce.Job:  map 100% reduce 77%
16/12/06 21:07:01 INFO mapreduce.Job:  map 100% reduce 79%
16/12/06 21:07:02 INFO mapreduce.Job:  map 100% reduce 85%
16/12/06 21:07:03 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 21:07:04 INFO mapreduce.Job:  map 100% reduce 97%
16/12/06 21:07:05 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 21:07:07 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 21:07:09 INFO mapreduce.Job: Job job_1480588584072_4893 completed successfully
16/12/06 21:07:10 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=816251685
		FILE: Number of bytes written=1664885335
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=683352881
		WASB: Number of bytes written=434752119
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=11880702
		Total time spent by all reduces in occupied slots (ms)=2918526
		Total time spent by all map tasks (ms)=5940351
		Total time spent by all reduce tasks (ms)=1459263
		Total vcore-seconds taken by all map tasks=5940351
		Total vcore-seconds taken by all reduce tasks=1459263
		Total megabyte-seconds taken by all map tasks=6082919424
		Total megabyte-seconds taken by all reduce tasks=1494285312
	Map-Reduce Framework
		Map input records=2297895
		Map output records=2089600
		Map output bytes=808394302
		Map output materialized bytes=816275205
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1836040
		Reduce shuffle bytes=816275205
		Reduce input records=2089600
		Reduce output records=1322617
		Spilled Records=4179200
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=75413
		CPU time spent (ms)=947880
		Physical memory (bytes) snapshot=324729106432
		Virtual memory (bytes) snapshot=742674345984
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=680656877
	File Output Format Counters 
		Bytes Written=434752119
16/12/06 21:07:10 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/2100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051800 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/2200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051800
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/2200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob6846809021286029014.jar tmpDir=null
16/12/06 21:07:47 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 21:07:48 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 21:07:49 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 21:07:50 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 21:07:50 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 21:07:51 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4895
16/12/06 21:07:51 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4895
16/12/06 21:07:52 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4895/
16/12/06 21:07:52 INFO mapreduce.Job: Running job: job_1480588584072_4895
16/12/06 21:10:19 INFO mapreduce.Job: Job job_1480588584072_4895 running in uber mode : false
16/12/06 21:10:19 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 21:10:40 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 21:10:41 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 21:10:42 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 21:10:43 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 21:10:47 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 21:10:50 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 21:10:51 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 21:10:52 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 21:10:56 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 21:10:57 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 21:11:01 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 21:11:02 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 21:11:04 INFO mapreduce.Job:  map 23% reduce 1%
16/12/06 21:11:05 INFO mapreduce.Job:  map 24% reduce 1%
16/12/06 21:11:06 INFO mapreduce.Job:  map 25% reduce 2%
16/12/06 21:11:07 INFO mapreduce.Job:  map 28% reduce 2%
16/12/06 21:11:08 INFO mapreduce.Job:  map 32% reduce 4%
16/12/06 21:11:09 INFO mapreduce.Job:  map 35% reduce 5%
16/12/06 21:11:10 INFO mapreduce.Job:  map 38% reduce 5%
16/12/06 21:11:12 INFO mapreduce.Job:  map 41% reduce 6%
16/12/06 21:11:13 INFO mapreduce.Job:  map 44% reduce 7%
16/12/06 21:11:15 INFO mapreduce.Job:  map 45% reduce 8%
16/12/06 21:11:16 INFO mapreduce.Job:  map 47% reduce 8%
16/12/06 21:11:17 INFO mapreduce.Job:  map 49% reduce 8%
16/12/06 21:11:18 INFO mapreduce.Job:  map 50% reduce 9%
16/12/06 21:11:19 INFO mapreduce.Job:  map 52% reduce 9%
16/12/06 21:11:20 INFO mapreduce.Job:  map 53% reduce 11%
16/12/06 21:11:21 INFO mapreduce.Job:  map 55% reduce 13%
16/12/06 21:11:22 INFO mapreduce.Job:  map 56% reduce 14%
16/12/06 21:11:23 INFO mapreduce.Job:  map 57% reduce 15%
16/12/06 21:11:24 INFO mapreduce.Job:  map 59% reduce 16%
16/12/06 21:11:25 INFO mapreduce.Job:  map 59% reduce 18%
16/12/06 21:11:26 INFO mapreduce.Job:  map 59% reduce 19%
16/12/06 21:11:27 INFO mapreduce.Job:  map 60% reduce 19%
16/12/06 21:11:29 INFO mapreduce.Job:  map 60% reduce 20%
16/12/06 21:11:30 INFO mapreduce.Job:  map 62% reduce 20%
16/12/06 21:11:31 INFO mapreduce.Job:  map 64% reduce 20%
16/12/06 21:11:32 INFO mapreduce.Job:  map 64% reduce 21%
16/12/06 21:11:34 INFO mapreduce.Job:  map 65% reduce 21%
16/12/06 21:11:35 INFO mapreduce.Job:  map 66% reduce 21%
16/12/06 21:11:36 INFO mapreduce.Job:  map 67% reduce 21%
16/12/06 21:11:37 INFO mapreduce.Job:  map 69% reduce 22%
16/12/06 21:11:38 INFO mapreduce.Job:  map 71% reduce 22%
16/12/06 21:11:39 INFO mapreduce.Job:  map 74% reduce 23%
16/12/06 21:11:40 INFO mapreduce.Job:  map 77% reduce 23%
16/12/06 21:11:41 INFO mapreduce.Job:  map 80% reduce 24%
16/12/06 21:11:42 INFO mapreduce.Job:  map 80% reduce 26%
16/12/06 21:11:43 INFO mapreduce.Job:  map 81% reduce 26%
16/12/06 21:11:44 INFO mapreduce.Job:  map 84% reduce 27%
16/12/06 21:11:45 INFO mapreduce.Job:  map 84% reduce 28%
16/12/06 21:11:46 INFO mapreduce.Job:  map 85% reduce 28%
16/12/06 21:11:47 INFO mapreduce.Job:  map 87% reduce 28%
16/12/06 21:11:48 INFO mapreduce.Job:  map 88% reduce 29%
16/12/06 21:11:49 INFO mapreduce.Job:  map 89% reduce 29%
16/12/06 21:11:50 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 21:11:51 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 21:11:52 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 21:11:54 INFO mapreduce.Job:  map 93% reduce 31%
16/12/06 21:11:55 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 21:11:57 INFO mapreduce.Job:  map 97% reduce 32%
16/12/06 21:11:58 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 21:12:00 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 21:12:02 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 21:12:03 INFO mapreduce.Job:  map 100% reduce 50%
16/12/06 21:12:04 INFO mapreduce.Job:  map 100% reduce 61%
16/12/06 21:12:05 INFO mapreduce.Job:  map 100% reduce 68%
16/12/06 21:12:06 INFO mapreduce.Job:  map 100% reduce 74%
16/12/06 21:12:07 INFO mapreduce.Job:  map 100% reduce 78%
16/12/06 21:12:08 INFO mapreduce.Job:  map 100% reduce 81%
16/12/06 21:12:09 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 21:12:10 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 21:12:11 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 21:12:13 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 21:12:14 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 21:12:15 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 21:12:18 INFO mapreduce.Job: Job job_1480588584072_4895 completed successfully
16/12/06 21:12:19 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=703975696
		FILE: Number of bytes written=1440333357
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=585987808
		WASB: Number of bytes written=392430015
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=11848250
		Total time spent by all reduces in occupied slots (ms)=3011842
		Total time spent by all map tasks (ms)=5924125
		Total time spent by all reduce tasks (ms)=1505921
		Total vcore-seconds taken by all map tasks=5924125
		Total vcore-seconds taken by all reduce tasks=1505921
		Total megabyte-seconds taken by all map tasks=6066304000
		Total megabyte-seconds taken by all reduce tasks=1542063104
	Map-Reduce Framework
		Map input records=1970026
		Map output records=1808062
		Map output bytes=697197619
		Map output materialized bytes=703999216
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1600525
		Reduce shuffle bytes=703999216
		Reduce input records=1808062
		Reduce output records=1189401
		Spilled Records=3616124
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=72267
		CPU time spent (ms)=916910
		Physical memory (bytes) snapshot=324403601408
		Virtual memory (bytes) snapshot=742540390400
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=583291804
	File Output Format Counters 
		Bytes Written=392430015
16/12/06 21:12:19 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/2200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051900 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/2300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161205/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051900
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/2300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob9116057392358686742.jar tmpDir=null
16/12/06 21:12:57 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 21:12:57 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 21:12:58 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 21:12:59 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 21:13:00 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 21:13:00 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4896
16/12/06 21:13:01 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4896
16/12/06 21:13:01 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4896/
16/12/06 21:13:01 INFO mapreduce.Job: Running job: job_1480588584072_4896
16/12/06 21:13:14 INFO mapreduce.Job: Job job_1480588584072_4896 running in uber mode : false
16/12/06 21:13:14 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 21:13:30 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 21:13:31 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 21:13:37 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 21:13:38 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 21:13:42 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 21:13:43 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 21:13:44 INFO mapreduce.Job:  map 11% reduce 0%
16/12/06 21:13:50 INFO mapreduce.Job:  map 14% reduce 0%
16/12/06 21:13:55 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 21:13:57 INFO mapreduce.Job:  map 15% reduce 1%
16/12/06 21:13:58 INFO mapreduce.Job:  map 17% reduce 2%
16/12/06 21:13:59 INFO mapreduce.Job:  map 20% reduce 2%
16/12/06 21:14:00 INFO mapreduce.Job:  map 21% reduce 2%
16/12/06 21:14:01 INFO mapreduce.Job:  map 24% reduce 2%
16/12/06 21:14:02 INFO mapreduce.Job:  map 30% reduce 2%
16/12/06 21:14:03 INFO mapreduce.Job:  map 33% reduce 2%
16/12/06 21:14:04 INFO mapreduce.Job:  map 36% reduce 3%
16/12/06 21:14:05 INFO mapreduce.Job:  map 38% reduce 4%
16/12/06 21:14:06 INFO mapreduce.Job:  map 40% reduce 5%
16/12/06 21:14:07 INFO mapreduce.Job:  map 42% reduce 5%
16/12/06 21:14:09 INFO mapreduce.Job:  map 45% reduce 5%
16/12/06 21:14:10 INFO mapreduce.Job:  map 47% reduce 6%
16/12/06 21:14:11 INFO mapreduce.Job:  map 49% reduce 6%
16/12/06 21:14:12 INFO mapreduce.Job:  map 52% reduce 6%
16/12/06 21:14:13 INFO mapreduce.Job:  map 53% reduce 7%
16/12/06 21:14:14 INFO mapreduce.Job:  map 54% reduce 8%
16/12/06 21:14:15 INFO mapreduce.Job:  map 54% reduce 9%
16/12/06 21:14:16 INFO mapreduce.Job:  map 55% reduce 9%
16/12/06 21:14:19 INFO mapreduce.Job:  map 56% reduce 9%
16/12/06 21:14:20 INFO mapreduce.Job:  map 58% reduce 9%
16/12/06 21:14:21 INFO mapreduce.Job:  map 58% reduce 10%
16/12/06 21:14:23 INFO mapreduce.Job:  map 58% reduce 12%
16/12/06 21:14:26 INFO mapreduce.Job:  map 59% reduce 12%
16/12/06 21:14:27 INFO mapreduce.Job:  map 60% reduce 13%
16/12/06 21:14:28 INFO mapreduce.Job:  map 61% reduce 14%
16/12/06 21:14:29 INFO mapreduce.Job:  map 63% reduce 15%
16/12/06 21:14:30 INFO mapreduce.Job:  map 64% reduce 17%
16/12/06 21:14:31 INFO mapreduce.Job:  map 66% reduce 19%
16/12/06 21:14:32 INFO mapreduce.Job:  map 67% reduce 20%
16/12/06 21:14:33 INFO mapreduce.Job:  map 68% reduce 22%
16/12/06 21:14:34 INFO mapreduce.Job:  map 69% reduce 22%
16/12/06 21:14:35 INFO mapreduce.Job:  map 71% reduce 22%
16/12/06 21:14:36 INFO mapreduce.Job:  map 74% reduce 23%
16/12/06 21:14:37 INFO mapreduce.Job:  map 76% reduce 23%
16/12/06 21:14:38 INFO mapreduce.Job:  map 79% reduce 24%
16/12/06 21:14:39 INFO mapreduce.Job:  map 81% reduce 25%
16/12/06 21:14:40 INFO mapreduce.Job:  map 81% reduce 26%
16/12/06 21:14:41 INFO mapreduce.Job:  map 83% reduce 27%
16/12/06 21:14:42 INFO mapreduce.Job:  map 87% reduce 27%
16/12/06 21:14:43 INFO mapreduce.Job:  map 90% reduce 28%
16/12/06 21:14:44 INFO mapreduce.Job:  map 94% reduce 29%
16/12/06 21:14:45 INFO mapreduce.Job:  map 98% reduce 30%
16/12/06 21:14:46 INFO mapreduce.Job:  map 100% reduce 31%
16/12/06 21:14:47 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 21:14:48 INFO mapreduce.Job:  map 100% reduce 41%
16/12/06 21:14:49 INFO mapreduce.Job:  map 100% reduce 53%
16/12/06 21:14:50 INFO mapreduce.Job:  map 100% reduce 65%
16/12/06 21:14:51 INFO mapreduce.Job:  map 100% reduce 77%
16/12/06 21:14:52 INFO mapreduce.Job:  map 100% reduce 85%
16/12/06 21:14:53 INFO mapreduce.Job:  map 100% reduce 90%
16/12/06 21:14:54 INFO mapreduce.Job:  map 100% reduce 96%
16/12/06 21:14:55 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 21:14:56 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 21:14:58 INFO mapreduce.Job: Job job_1480588584072_4896 completed successfully
16/12/06 21:14:58 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=445580848
		FILE: Number of bytes written=923543661
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=372129925
		WASB: Number of bytes written=229961144
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12234538
		Total time spent by all reduces in occupied slots (ms)=2372700
		Total time spent by all map tasks (ms)=6117269
		Total time spent by all reduce tasks (ms)=1186350
		Total vcore-seconds taken by all map tasks=6117269
		Total vcore-seconds taken by all reduce tasks=1186350
		Total megabyte-seconds taken by all map tasks=6264083456
		Total megabyte-seconds taken by all reduce tasks=1214822400
	Map-Reduce Framework
		Map input records=1299143
		Map output records=1185415
		Map output bytes=441199391
		Map output materialized bytes=445604368
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1047524
		Reduce shuffle bytes=445604368
		Reduce input records=1185415
		Reduce output records=714924
		Spilled Records=2370830
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=70626
		CPU time spent (ms)=810560
		Physical memory (bytes) snapshot=323184037888
		Virtual memory (bytes) snapshot=742658211840
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=369433921
	File Output Format Counters 
		Bytes Written=229961144
16/12/06 21:14:58 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161205/2300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161205/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3692920618530782583.jar tmpDir=null
16/12/06 21:15:35 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 21:15:36 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 21:15:36 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 21:15:38 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 21:15:38 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 21:15:38 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4897
16/12/06 21:15:39 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4897
16/12/06 21:15:39 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4897/
16/12/06 21:15:39 INFO mapreduce.Job: Running job: job_1480588584072_4897
16/12/06 21:15:51 INFO mapreduce.Job: Job job_1480588584072_4897 running in uber mode : false
16/12/06 21:15:51 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 21:16:13 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 21:16:15 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 21:16:20 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 21:16:21 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 21:16:22 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 21:16:23 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 21:16:25 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 21:16:26 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 21:16:27 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 21:16:34 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 21:16:37 INFO mapreduce.Job:  map 22% reduce 0%
16/12/06 21:16:38 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 21:16:39 INFO mapreduce.Job:  map 34% reduce 0%
16/12/06 21:16:41 INFO mapreduce.Job:  map 37% reduce 1%
16/12/06 21:16:42 INFO mapreduce.Job:  map 38% reduce 1%
16/12/06 21:16:43 INFO mapreduce.Job:  map 41% reduce 5%
16/12/06 21:16:44 INFO mapreduce.Job:  map 44% reduce 6%
16/12/06 21:16:45 INFO mapreduce.Job:  map 46% reduce 7%
16/12/06 21:16:46 INFO mapreduce.Job:  map 48% reduce 8%
16/12/06 21:16:47 INFO mapreduce.Job:  map 53% reduce 9%
16/12/06 21:16:48 INFO mapreduce.Job:  map 55% reduce 10%
16/12/06 21:16:49 INFO mapreduce.Job:  map 56% reduce 11%
16/12/06 21:16:50 INFO mapreduce.Job:  map 58% reduce 13%
16/12/06 21:16:51 INFO mapreduce.Job:  map 59% reduce 14%
16/12/06 21:16:52 INFO mapreduce.Job:  map 60% reduce 14%
16/12/06 21:16:53 INFO mapreduce.Job:  map 61% reduce 15%
16/12/06 21:16:56 INFO mapreduce.Job:  map 61% reduce 16%
16/12/06 21:16:57 INFO mapreduce.Job:  map 62% reduce 17%
16/12/06 21:17:00 INFO mapreduce.Job:  map 66% reduce 18%
16/12/06 21:17:02 INFO mapreduce.Job:  map 69% reduce 18%
16/12/06 21:17:03 INFO mapreduce.Job:  map 70% reduce 19%
16/12/06 21:17:04 INFO mapreduce.Job:  map 71% reduce 19%
16/12/06 21:17:05 INFO mapreduce.Job:  map 71% reduce 20%
16/12/06 21:17:06 INFO mapreduce.Job:  map 72% reduce 21%
16/12/06 21:17:07 INFO mapreduce.Job:  map 76% reduce 22%
16/12/06 21:17:08 INFO mapreduce.Job:  map 82% reduce 23%
16/12/06 21:17:09 INFO mapreduce.Job:  map 84% reduce 25%
16/12/06 21:17:10 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 21:17:11 INFO mapreduce.Job:  map 86% reduce 28%
16/12/06 21:17:12 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 21:17:13 INFO mapreduce.Job:  map 90% reduce 29%
16/12/06 21:17:15 INFO mapreduce.Job:  map 91% reduce 30%
16/12/06 21:17:16 INFO mapreduce.Job:  map 92% reduce 30%
16/12/06 21:17:18 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 21:17:19 INFO mapreduce.Job:  map 94% reduce 31%
16/12/06 21:17:20 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 21:17:21 INFO mapreduce.Job:  map 98% reduce 31%
16/12/06 21:17:23 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 21:17:24 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 21:17:25 INFO mapreduce.Job:  map 100% reduce 35%
16/12/06 21:17:26 INFO mapreduce.Job:  map 100% reduce 47%
16/12/06 21:17:27 INFO mapreduce.Job:  map 100% reduce 51%
16/12/06 21:17:28 INFO mapreduce.Job:  map 100% reduce 76%
16/12/06 21:17:29 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 21:17:30 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 21:17:33 INFO mapreduce.Job: Job job_1480588584072_4897 completed successfully
16/12/06 21:17:33 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=282952470
		FILE: Number of bytes written=598286905
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=235084112
		WASB: Number of bytes written=141557322
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=11263784
		Total time spent by all reduces in occupied slots (ms)=2409716
		Total time spent by all map tasks (ms)=5631892
		Total time spent by all reduce tasks (ms)=1204858
		Total vcore-seconds taken by all map tasks=5631892
		Total vcore-seconds taken by all reduce tasks=1204858
		Total megabyte-seconds taken by all map tasks=5767057408
		Total megabyte-seconds taken by all reduce tasks=1233774592
	Map-Reduce Framework
		Map input records=849044
		Map output records=779855
		Map output bytes=280117677
		Map output materialized bytes=282975990
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=699140
		Reduce shuffle bytes=282975990
		Reduce input records=779855
		Reduce output records=442811
		Spilled Records=1559710
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=75644
		CPU time spent (ms)=756230
		Physical memory (bytes) snapshot=322651717632
		Virtual memory (bytes) snapshot=742412152832
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=232388108
	File Output Format Counters 
		Bytes Written=141557322
16/12/06 21:17:33 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7691822205157109050.jar tmpDir=null
16/12/06 21:18:10 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 21:18:11 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 21:18:11 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 21:18:13 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 21:18:13 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 21:18:13 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4898
16/12/06 21:18:14 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4898
16/12/06 21:18:14 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4898/
16/12/06 21:18:14 INFO mapreduce.Job: Running job: job_1480588584072_4898
16/12/06 21:18:26 INFO mapreduce.Job: Job job_1480588584072_4898 running in uber mode : false
16/12/06 21:18:26 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 21:18:49 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 21:18:50 INFO mapreduce.Job:  map 3% reduce 0%
16/12/06 21:18:51 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 21:18:53 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 21:18:54 INFO mapreduce.Job:  map 7% reduce 0%
16/12/06 21:18:55 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 21:18:56 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 21:18:57 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 21:19:00 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 21:19:01 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 21:19:02 INFO mapreduce.Job:  map 19% reduce 0%
16/12/06 21:19:10 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 21:19:12 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 21:19:13 INFO mapreduce.Job:  map 24% reduce 0%
16/12/06 21:19:14 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 21:19:15 INFO mapreduce.Job:  map 31% reduce 1%
16/12/06 21:19:16 INFO mapreduce.Job:  map 34% reduce 4%
16/12/06 21:19:17 INFO mapreduce.Job:  map 39% reduce 5%
16/12/06 21:19:18 INFO mapreduce.Job:  map 43% reduce 7%
16/12/06 21:19:19 INFO mapreduce.Job:  map 45% reduce 9%
16/12/06 21:19:20 INFO mapreduce.Job:  map 51% reduce 10%
16/12/06 21:19:21 INFO mapreduce.Job:  map 52% reduce 11%
16/12/06 21:19:22 INFO mapreduce.Job:  map 54% reduce 12%
16/12/06 21:19:23 INFO mapreduce.Job:  map 55% reduce 13%
16/12/06 21:19:25 INFO mapreduce.Job:  map 56% reduce 13%
16/12/06 21:19:28 INFO mapreduce.Job:  map 56% reduce 14%
16/12/06 21:19:29 INFO mapreduce.Job:  map 57% reduce 15%
16/12/06 21:19:34 INFO mapreduce.Job:  map 58% reduce 15%
16/12/06 21:19:38 INFO mapreduce.Job:  map 58% reduce 16%
16/12/06 21:19:39 INFO mapreduce.Job:  map 59% reduce 17%
16/12/06 21:19:40 INFO mapreduce.Job:  map 59% reduce 18%
16/12/06 21:19:41 INFO mapreduce.Job:  map 61% reduce 18%
16/12/06 21:19:42 INFO mapreduce.Job:  map 64% reduce 18%
16/12/06 21:19:43 INFO mapreduce.Job:  map 67% reduce 18%
16/12/06 21:19:44 INFO mapreduce.Job:  map 70% reduce 19%
16/12/06 21:19:45 INFO mapreduce.Job:  map 70% reduce 20%
16/12/06 21:19:46 INFO mapreduce.Job:  map 74% reduce 21%
16/12/06 21:19:47 INFO mapreduce.Job:  map 77% reduce 23%
16/12/06 21:19:49 INFO mapreduce.Job:  map 80% reduce 24%
16/12/06 21:19:50 INFO mapreduce.Job:  map 83% reduce 25%
16/12/06 21:19:51 INFO mapreduce.Job:  map 84% reduce 26%
16/12/06 21:19:52 INFO mapreduce.Job:  map 84% reduce 27%
16/12/06 21:19:53 INFO mapreduce.Job:  map 87% reduce 28%
16/12/06 21:19:54 INFO mapreduce.Job:  map 89% reduce 28%
16/12/06 21:19:55 INFO mapreduce.Job:  map 90% reduce 28%
16/12/06 21:19:56 INFO mapreduce.Job:  map 92% reduce 29%
16/12/06 21:19:57 INFO mapreduce.Job:  map 95% reduce 30%
16/12/06 21:19:58 INFO mapreduce.Job:  map 99% reduce 30%
16/12/06 21:19:59 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 21:20:00 INFO mapreduce.Job:  map 100% reduce 34%
16/12/06 21:20:01 INFO mapreduce.Job:  map 100% reduce 39%
16/12/06 21:20:02 INFO mapreduce.Job:  map 100% reduce 52%
16/12/06 21:20:03 INFO mapreduce.Job:  map 100% reduce 72%
16/12/06 21:20:04 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 21:20:05 INFO mapreduce.Job:  map 100% reduce 91%
16/12/06 21:20:06 INFO mapreduce.Job:  map 100% reduce 95%
16/12/06 21:20:07 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 21:20:10 INFO mapreduce.Job: Job job_1480588584072_4898 completed successfully
16/12/06 21:20:10 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=200259277
		FILE: Number of bytes written=432900519
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=167109232
		WASB: Number of bytes written=92801672
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=11763656
		Total time spent by all reduces in occupied slots (ms)=2467236
		Total time spent by all map tasks (ms)=5881828
		Total time spent by all reduce tasks (ms)=1233618
		Total vcore-seconds taken by all map tasks=5881828
		Total vcore-seconds taken by all reduce tasks=1233618
		Total megabyte-seconds taken by all map tasks=6022991872
		Total megabyte-seconds taken by all reduce tasks=1263224832
	Map-Reduce Framework
		Map input records=642005
		Map output records=587258
		Map output bytes=198180026
		Map output materialized bytes=200282797
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=536087
		Reduce shuffle bytes=200282797
		Reduce input records=587258
		Reduce output records=307844
		Spilled Records=1174516
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=73490
		CPU time spent (ms)=725100
		Physical memory (bytes) snapshot=322579759104
		Virtual memory (bytes) snapshot=742439497728
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=164413228
	File Output Format Counters 
		Bytes Written=92801672
16/12/06 21:20:10 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1617427962421878289.jar tmpDir=null
16/12/06 21:20:48 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 21:20:49 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 21:20:49 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 21:20:51 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 21:20:52 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 21:20:52 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4899
16/12/06 21:20:53 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4899
16/12/06 21:20:53 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4899/
16/12/06 21:20:53 INFO mapreduce.Job: Running job: job_1480588584072_4899
16/12/06 21:21:05 INFO mapreduce.Job: Job job_1480588584072_4899 running in uber mode : false
16/12/06 21:21:05 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 21:21:28 INFO mapreduce.Job:  map 1% reduce 0%
16/12/06 21:21:29 INFO mapreduce.Job:  map 2% reduce 0%
16/12/06 21:21:30 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 21:21:32 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 21:21:33 INFO mapreduce.Job:  map 6% reduce 0%
16/12/06 21:21:36 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 21:21:37 INFO mapreduce.Job:  map 10% reduce 0%
16/12/06 21:21:38 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 21:21:39 INFO mapreduce.Job:  map 15% reduce 0%
16/12/06 21:21:40 INFO mapreduce.Job:  map 16% reduce 0%
16/12/06 21:21:41 INFO mapreduce.Job:  map 18% reduce 0%
16/12/06 21:21:43 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 21:21:49 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 21:21:50 INFO mapreduce.Job:  map 26% reduce 0%
16/12/06 21:21:51 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 21:21:54 INFO mapreduce.Job:  map 39% reduce 1%
16/12/06 21:21:55 INFO mapreduce.Job:  map 44% reduce 1%
16/12/06 21:21:56 INFO mapreduce.Job:  map 49% reduce 1%
16/12/06 21:21:57 INFO mapreduce.Job:  map 51% reduce 3%
16/12/06 21:21:59 INFO mapreduce.Job:  map 52% reduce 4%
16/12/06 21:22:00 INFO mapreduce.Job:  map 53% reduce 6%
16/12/06 21:22:01 INFO mapreduce.Job:  map 54% reduce 6%
16/12/06 21:22:03 INFO mapreduce.Job:  map 55% reduce 6%
16/12/06 21:22:04 INFO mapreduce.Job:  map 55% reduce 9%
16/12/06 21:22:05 INFO mapreduce.Job:  map 57% reduce 12%
16/12/06 21:22:06 INFO mapreduce.Job:  map 60% reduce 12%
16/12/06 21:22:08 INFO mapreduce.Job:  map 61% reduce 14%
16/12/06 21:22:09 INFO mapreduce.Job:  map 61% reduce 16%
16/12/06 21:22:10 INFO mapreduce.Job:  map 63% reduce 18%
16/12/06 21:22:12 INFO mapreduce.Job:  map 64% reduce 20%
16/12/06 21:22:13 INFO mapreduce.Job:  map 65% reduce 20%
16/12/06 21:22:14 INFO mapreduce.Job:  map 66% reduce 20%
16/12/06 21:22:16 INFO mapreduce.Job:  map 68% reduce 21%
16/12/06 21:22:17 INFO mapreduce.Job:  map 69% reduce 21%
16/12/06 21:22:18 INFO mapreduce.Job:  map 70% reduce 21%
16/12/06 21:22:19 INFO mapreduce.Job:  map 71% reduce 22%
16/12/06 21:22:20 INFO mapreduce.Job:  map 76% reduce 22%
16/12/06 21:22:21 INFO mapreduce.Job:  map 80% reduce 23%
16/12/06 21:22:22 INFO mapreduce.Job:  map 82% reduce 24%
16/12/06 21:22:23 INFO mapreduce.Job:  map 86% reduce 24%
16/12/06 21:22:24 INFO mapreduce.Job:  map 87% reduce 26%
16/12/06 21:22:25 INFO mapreduce.Job:  map 89% reduce 28%
16/12/06 21:22:26 INFO mapreduce.Job:  map 92% reduce 29%
16/12/06 21:22:27 INFO mapreduce.Job:  map 94% reduce 29%
16/12/06 21:22:28 INFO mapreduce.Job:  map 98% reduce 30%
16/12/06 21:22:29 INFO mapreduce.Job:  map 99% reduce 31%
16/12/06 21:22:30 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 21:22:31 INFO mapreduce.Job:  map 99% reduce 33%
16/12/06 21:22:32 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 21:22:34 INFO mapreduce.Job:  map 100% reduce 42%
16/12/06 21:22:35 INFO mapreduce.Job:  map 100% reduce 49%
16/12/06 21:22:36 INFO mapreduce.Job:  map 100% reduce 60%
16/12/06 21:22:37 INFO mapreduce.Job:  map 100% reduce 73%
16/12/06 21:22:38 INFO mapreduce.Job:  map 100% reduce 93%
16/12/06 21:22:41 INFO mapreduce.Job:  map 100% reduce 99%
16/12/06 21:22:42 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 21:22:44 INFO mapreduce.Job: Job job_1480588584072_4899 completed successfully
16/12/06 21:22:44 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=174783610
		FILE: Number of bytes written=381949185
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=147869769
		WASB: Number of bytes written=70686933
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=10846070
		Total time spent by all reduces in occupied slots (ms)=2249144
		Total time spent by all map tasks (ms)=5423035
		Total time spent by all reduce tasks (ms)=1124572
		Total vcore-seconds taken by all map tasks=5423035
		Total vcore-seconds taken by all reduce tasks=1124572
		Total megabyte-seconds taken by all map tasks=5553187840
		Total megabyte-seconds taken by all reduce tasks=1151561728
	Map-Reduce Framework
		Map input records=585187
		Map output records=525171
		Map output bytes=172936466
		Map output materialized bytes=174807130
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=480895
		Reduce shuffle bytes=174807130
		Reduce input records=525171
		Reduce output records=237803
		Spilled Records=1050342
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=65716
		CPU time spent (ms)=712330
		Physical memory (bytes) snapshot=322385973248
		Virtual memory (bytes) snapshot=742668034048
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=145173765
	File Output Format Counters 
		Bytes Written=70686933
16/12/06 21:22:44 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612051900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5653098495653884241.jar tmpDir=null
16/12/06 21:23:21 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 21:23:22 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/06 21:23:22 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/06 21:23:24 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/06 21:23:24 INFO mapreduce.JobSubmitter: number of splits:197
16/12/06 21:23:25 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_4900
16/12/06 21:23:25 INFO impl.YarnClientImpl: Submitted application application_1480588584072_4900
16/12/06 21:23:25 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_4900/
16/12/06 21:23:25 INFO mapreduce.Job: Running job: job_1480588584072_4900
16/12/06 21:23:38 INFO mapreduce.Job: Job job_1480588584072_4900 running in uber mode : false
16/12/06 21:23:39 INFO mapreduce.Job:  map 0% reduce 0%
16/12/06 21:24:01 INFO mapreduce.Job:  map 4% reduce 0%
16/12/06 21:24:06 INFO mapreduce.Job:  map 5% reduce 0%
16/12/06 21:24:07 INFO mapreduce.Job:  map 8% reduce 0%
16/12/06 21:24:09 INFO mapreduce.Job:  map 9% reduce 0%
16/12/06 21:24:10 INFO mapreduce.Job:  map 12% reduce 0%
16/12/06 21:24:11 INFO mapreduce.Job:  map 13% reduce 0%
16/12/06 21:24:12 INFO mapreduce.Job:  map 17% reduce 0%
16/12/06 21:24:13 INFO mapreduce.Job:  map 20% reduce 0%
16/12/06 21:24:14 INFO mapreduce.Job:  map 21% reduce 0%
16/12/06 21:24:20 INFO mapreduce.Job:  map 23% reduce 0%
16/12/06 21:24:22 INFO mapreduce.Job:  map 28% reduce 0%
16/12/06 21:24:23 INFO mapreduce.Job:  map 34% reduce 0%
16/12/06 21:24:25 INFO mapreduce.Job:  map 36% reduce 0%
16/12/06 21:24:26 INFO mapreduce.Job:  map 41% reduce 0%
16/12/06 21:24:28 INFO mapreduce.Job:  map 42% reduce 0%
16/12/06 21:24:29 INFO mapreduce.Job:  map 47% reduce 0%
16/12/06 21:24:30 INFO mapreduce.Job:  map 51% reduce 3%
16/12/06 21:24:31 INFO mapreduce.Job:  map 53% reduce 3%
16/12/06 21:24:33 INFO mapreduce.Job:  map 53% reduce 5%
16/12/06 21:24:34 INFO mapreduce.Job:  map 54% reduce 6%
16/12/06 21:24:35 INFO mapreduce.Job:  map 55% reduce 7%
16/12/06 21:24:36 INFO mapreduce.Job:  map 57% reduce 8%
16/12/06 21:24:37 INFO mapreduce.Job:  map 58% reduce 9%
16/12/06 21:24:38 INFO mapreduce.Job:  map 58% reduce 12%
16/12/06 21:24:39 INFO mapreduce.Job:  map 59% reduce 14%
16/12/06 21:24:40 INFO mapreduce.Job:  map 61% reduce 16%
16/12/06 21:24:41 INFO mapreduce.Job:  map 61% reduce 17%
16/12/06 21:24:42 INFO mapreduce.Job:  map 61% reduce 18%
16/12/06 21:24:44 INFO mapreduce.Job:  map 62% reduce 18%
16/12/06 21:24:45 INFO mapreduce.Job:  map 65% reduce 19%
16/12/06 21:24:46 INFO mapreduce.Job:  map 65% reduce 20%
16/12/06 21:24:49 INFO mapreduce.Job:  map 67% reduce 21%
16/12/06 21:24:50 INFO mapreduce.Job:  map 69% reduce 21%
16/12/06 21:24:51 INFO mapreduce.Job:  map 71% reduce 21%
16/12/06 21:24:52 INFO mapreduce.Job:  map 76% reduce 22%
16/12/06 21:24:53 INFO mapreduce.Job:  map 80% reduce 22%
16/12/06 21:24:54 INFO mapreduce.Job:  map 83% reduce 24%
16/12/06 21:24:55 INFO mapreduce.Job:  map 85% reduce 27%
16/12/06 21:24:56 INFO mapreduce.Job:  map 86% reduce 27%
16/12/06 21:24:57 INFO mapreduce.Job:  map 88% reduce 28%
16/12/06 21:24:58 INFO mapreduce.Job:  map 91% reduce 29%
16/12/06 21:24:59 INFO mapreduce.Job:  map 93% reduce 29%
16/12/06 21:25:00 INFO mapreduce.Job:  map 93% reduce 30%
16/12/06 21:25:01 INFO mapreduce.Job:  map 95% reduce 31%
16/12/06 21:25:02 INFO mapreduce.Job:  map 96% reduce 31%
16/12/06 21:25:03 INFO mapreduce.Job:  map 97% reduce 31%
16/12/06 21:25:04 INFO mapreduce.Job:  map 99% reduce 32%
16/12/06 21:25:05 INFO mapreduce.Job:  map 100% reduce 32%
16/12/06 21:25:06 INFO mapreduce.Job:  map 100% reduce 33%
16/12/06 21:25:07 INFO mapreduce.Job:  map 100% reduce 51%
16/12/06 21:25:08 INFO mapreduce.Job:  map 100% reduce 57%
16/12/06 21:25:09 INFO mapreduce.Job:  map 100% reduce 62%
16/12/06 21:25:10 INFO mapreduce.Job:  map 100% reduce 87%
16/12/06 21:25:11 INFO mapreduce.Job:  map 100% reduce 92%
16/12/06 21:25:12 INFO mapreduce.Job:  map 100% reduce 94%
16/12/06 21:25:13 INFO mapreduce.Job:  map 100% reduce 98%
16/12/06 21:25:14 INFO mapreduce.Job:  map 100% reduce 100%
16/12/06 21:25:18 INFO mapreduce.Job: Job job_1480588584072_4900 completed successfully
16/12/06 21:25:18 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=190611522
		FILE: Number of bytes written=413605009
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=162149644
		WASB: Number of bytes written=72568461
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=11013744
		Total time spent by all reduces in occupied slots (ms)=2215900
		Total time spent by all map tasks (ms)=5506872
		Total time spent by all reduce tasks (ms)=1107950
		Total vcore-seconds taken by all map tasks=5506872
		Total vcore-seconds taken by all reduce tasks=1107950
		Total megabyte-seconds taken by all map tasks=5639036928
		Total megabyte-seconds taken by all reduce tasks=1134540800
	Map-Reduce Framework
		Map input records=647659
		Map output records=577204
		Map output bytes=188587181
		Map output materialized bytes=190635042
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=527471
		Reduce shuffle bytes=190635042
		Reduce input records=577204
		Reduce output records=256685
		Spilled Records=1154408
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=68024
		CPU time spent (ms)=728220
		Physical memory (bytes) snapshot=322257641472
		Virtual memory (bytes) snapshot=742839996416
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=159453640
	File Output Format Counters 
		Bytes Written=72568461
16/12/06 21:25:18 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
16/12/07 00:47:40 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
16/12/07 09:17:23 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0400 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0400': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob79841227945679373.jar tmpDir=null
16/12/07 11:08:32 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 11:08:33 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 11:08:33 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 11:08:35 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 11:08:35 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 11:08:35 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5055
16/12/07 11:08:36 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5055
16/12/07 11:08:36 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5055/
16/12/07 11:08:36 INFO mapreduce.Job: Running job: job_1480588584072_5055
16/12/07 11:08:48 INFO mapreduce.Job: Job job_1480588584072_5055 running in uber mode : false
16/12/07 11:08:48 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 11:09:05 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 11:09:07 INFO mapreduce.Job:  map 2% reduce 0%
16/12/07 11:09:14 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 11:09:15 INFO mapreduce.Job:  map 4% reduce 0%
16/12/07 11:09:16 INFO mapreduce.Job:  map 6% reduce 0%
16/12/07 11:09:17 INFO mapreduce.Job:  map 8% reduce 0%
16/12/07 11:09:18 INFO mapreduce.Job:  map 13% reduce 0%
16/12/07 11:09:19 INFO mapreduce.Job:  map 16% reduce 0%
16/12/07 11:09:22 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 11:09:24 INFO mapreduce.Job:  map 19% reduce 0%
16/12/07 11:09:26 INFO mapreduce.Job:  map 20% reduce 0%
16/12/07 11:09:27 INFO mapreduce.Job:  map 21% reduce 0%
16/12/07 11:09:28 INFO mapreduce.Job:  map 23% reduce 0%
16/12/07 11:09:29 INFO mapreduce.Job:  map 24% reduce 0%
16/12/07 11:09:30 INFO mapreduce.Job:  map 25% reduce 0%
16/12/07 11:09:32 INFO mapreduce.Job:  map 26% reduce 0%
16/12/07 11:09:34 INFO mapreduce.Job:  map 27% reduce 1%
16/12/07 11:09:35 INFO mapreduce.Job:  map 30% reduce 1%
16/12/07 11:09:37 INFO mapreduce.Job:  map 30% reduce 2%
16/12/07 11:09:38 INFO mapreduce.Job:  map 34% reduce 3%
16/12/07 11:09:39 INFO mapreduce.Job:  map 38% reduce 3%
16/12/07 11:09:40 INFO mapreduce.Job:  map 39% reduce 3%
16/12/07 11:09:41 INFO mapreduce.Job:  map 40% reduce 3%
16/12/07 11:09:42 INFO mapreduce.Job:  map 46% reduce 4%
16/12/07 11:09:43 INFO mapreduce.Job:  map 48% reduce 4%
16/12/07 11:09:44 INFO mapreduce.Job:  map 51% reduce 6%
16/12/07 11:09:45 INFO mapreduce.Job:  map 51% reduce 8%
16/12/07 11:09:46 INFO mapreduce.Job:  map 52% reduce 10%
16/12/07 11:09:47 INFO mapreduce.Job:  map 52% reduce 13%
16/12/07 11:09:48 INFO mapreduce.Job:  map 53% reduce 13%
16/12/07 11:09:50 INFO mapreduce.Job:  map 55% reduce 13%
16/12/07 11:09:51 INFO mapreduce.Job:  map 58% reduce 13%
16/12/07 11:09:52 INFO mapreduce.Job:  map 59% reduce 14%
16/12/07 11:09:53 INFO mapreduce.Job:  map 60% reduce 15%
16/12/07 11:09:54 INFO mapreduce.Job:  map 61% reduce 16%
16/12/07 11:09:55 INFO mapreduce.Job:  map 62% reduce 17%
16/12/07 11:09:56 INFO mapreduce.Job:  map 63% reduce 19%
16/12/07 11:09:57 INFO mapreduce.Job:  map 64% reduce 20%
16/12/07 11:09:58 INFO mapreduce.Job:  map 64% reduce 21%
16/12/07 11:10:01 INFO mapreduce.Job:  map 65% reduce 21%
16/12/07 11:10:02 INFO mapreduce.Job:  map 67% reduce 21%
16/12/07 11:10:03 INFO mapreduce.Job:  map 68% reduce 22%
16/12/07 11:10:04 INFO mapreduce.Job:  map 69% reduce 22%
16/12/07 11:10:05 INFO mapreduce.Job:  map 70% reduce 23%
16/12/07 11:10:06 INFO mapreduce.Job:  map 71% reduce 23%
16/12/07 11:10:07 INFO mapreduce.Job:  map 73% reduce 23%
16/12/07 11:10:08 INFO mapreduce.Job:  map 77% reduce 24%
16/12/07 11:10:09 INFO mapreduce.Job:  map 79% reduce 24%
16/12/07 11:10:10 INFO mapreduce.Job:  map 81% reduce 25%
16/12/07 11:10:11 INFO mapreduce.Job:  map 81% reduce 26%
16/12/07 11:10:12 INFO mapreduce.Job:  map 84% reduce 26%
16/12/07 11:10:13 INFO mapreduce.Job:  map 87% reduce 27%
16/12/07 11:10:14 INFO mapreduce.Job:  map 89% reduce 28%
16/12/07 11:10:15 INFO mapreduce.Job:  map 91% reduce 29%
16/12/07 11:10:16 INFO mapreduce.Job:  map 94% reduce 30%
16/12/07 11:10:17 INFO mapreduce.Job:  map 95% reduce 30%
16/12/07 11:10:18 INFO mapreduce.Job:  map 96% reduce 31%
16/12/07 11:10:19 INFO mapreduce.Job:  map 99% reduce 32%
16/12/07 11:10:20 INFO mapreduce.Job:  map 100% reduce 32%
16/12/07 11:10:21 INFO mapreduce.Job:  map 100% reduce 38%
16/12/07 11:10:22 INFO mapreduce.Job:  map 100% reduce 49%
16/12/07 11:10:23 INFO mapreduce.Job:  map 100% reduce 68%
16/12/07 11:10:24 INFO mapreduce.Job:  map 100% reduce 75%
16/12/07 11:10:25 INFO mapreduce.Job:  map 100% reduce 92%
16/12/07 11:10:26 INFO mapreduce.Job:  map 100% reduce 97%
16/12/07 11:10:27 INFO mapreduce.Job:  map 100% reduce 99%
16/12/07 11:10:28 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 11:10:30 INFO mapreduce.Job: Job job_1480588584072_5055 completed successfully
16/12/07 11:10:30 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=247980581
		FILE: Number of bytes written=528343127
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=211805583
		WASB: Number of bytes written=99661571
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=10851710
		Total time spent by all reduces in occupied slots (ms)=2430960
		Total time spent by all map tasks (ms)=5425855
		Total time spent by all reduce tasks (ms)=1215480
		Total vcore-seconds taken by all map tasks=5425855
		Total vcore-seconds taken by all reduce tasks=1215480
		Total megabyte-seconds taken by all map tasks=5556075520
		Total megabyte-seconds taken by all reduce tasks=1244651520
	Map-Reduce Framework
		Map input records=806820
		Map output records=715571
		Map output bytes=245415263
		Map output materialized bytes=248004101
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=645489
		Reduce shuffle bytes=248004101
		Reduce input records=715571
		Reduce output records=334610
		Spilled Records=1431142
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=71044
		CPU time spent (ms)=758510
		Physical memory (bytes) snapshot=322635890688
		Virtual memory (bytes) snapshot=742584520704
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=209109579
	File Output Format Counters 
		Bytes Written=99661571
16/12/07 11:10:30 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0400
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0500 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0500': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5342881161627398382.jar tmpDir=null
16/12/07 11:11:09 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 11:11:10 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 11:11:10 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 11:11:12 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 11:11:12 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 11:11:13 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5057
16/12/07 11:11:13 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5057
16/12/07 11:11:13 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5057/
16/12/07 11:11:13 INFO mapreduce.Job: Running job: job_1480588584072_5057
16/12/07 11:11:25 INFO mapreduce.Job: Job job_1480588584072_5057 running in uber mode : false
16/12/07 11:11:25 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 11:11:48 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 11:11:49 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 11:11:50 INFO mapreduce.Job:  map 4% reduce 0%
16/12/07 11:11:54 INFO mapreduce.Job:  map 7% reduce 0%
16/12/07 11:11:55 INFO mapreduce.Job:  map 10% reduce 0%
16/12/07 11:11:56 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 11:11:58 INFO mapreduce.Job:  map 14% reduce 0%
16/12/07 11:11:59 INFO mapreduce.Job:  map 16% reduce 0%
16/12/07 11:12:00 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 11:12:04 INFO mapreduce.Job:  map 20% reduce 0%
16/12/07 11:12:06 INFO mapreduce.Job:  map 21% reduce 0%
16/12/07 11:12:07 INFO mapreduce.Job:  map 26% reduce 0%
16/12/07 11:12:08 INFO mapreduce.Job:  map 27% reduce 0%
16/12/07 11:12:11 INFO mapreduce.Job:  map 28% reduce 0%
16/12/07 11:12:12 INFO mapreduce.Job:  map 30% reduce 0%
16/12/07 11:12:13 INFO mapreduce.Job:  map 33% reduce 0%
16/12/07 11:12:14 INFO mapreduce.Job:  map 36% reduce 0%
16/12/07 11:12:15 INFO mapreduce.Job:  map 38% reduce 1%
16/12/07 11:12:16 INFO mapreduce.Job:  map 39% reduce 1%
16/12/07 11:12:17 INFO mapreduce.Job:  map 40% reduce 2%
16/12/07 11:12:18 INFO mapreduce.Job:  map 41% reduce 3%
16/12/07 11:12:20 INFO mapreduce.Job:  map 46% reduce 3%
16/12/07 11:12:21 INFO mapreduce.Job:  map 48% reduce 4%
16/12/07 11:12:22 INFO mapreduce.Job:  map 52% reduce 6%
16/12/07 11:12:23 INFO mapreduce.Job:  map 53% reduce 8%
16/12/07 11:12:24 INFO mapreduce.Job:  map 54% reduce 11%
16/12/07 11:12:25 INFO mapreduce.Job:  map 54% reduce 13%
16/12/07 11:12:26 INFO mapreduce.Job:  map 56% reduce 14%
16/12/07 11:12:27 INFO mapreduce.Job:  map 57% reduce 15%
16/12/07 11:12:28 INFO mapreduce.Job:  map 57% reduce 16%
16/12/07 11:12:29 INFO mapreduce.Job:  map 57% reduce 18%
16/12/07 11:12:34 INFO mapreduce.Job:  map 58% reduce 18%
16/12/07 11:12:35 INFO mapreduce.Job:  map 59% reduce 18%
16/12/07 11:12:36 INFO mapreduce.Job:  map 61% reduce 18%
16/12/07 11:12:37 INFO mapreduce.Job:  map 62% reduce 19%
16/12/07 11:12:38 INFO mapreduce.Job:  map 63% reduce 19%
16/12/07 11:12:39 INFO mapreduce.Job:  map 64% reduce 20%
16/12/07 11:12:40 INFO mapreduce.Job:  map 65% reduce 21%
16/12/07 11:12:43 INFO mapreduce.Job:  map 66% reduce 22%
16/12/07 11:12:45 INFO mapreduce.Job:  map 68% reduce 22%
16/12/07 11:12:47 INFO mapreduce.Job:  map 70% reduce 22%
16/12/07 11:12:48 INFO mapreduce.Job:  map 71% reduce 23%
16/12/07 11:12:49 INFO mapreduce.Job:  map 74% reduce 23%
16/12/07 11:12:50 INFO mapreduce.Job:  map 76% reduce 23%
16/12/07 11:12:51 INFO mapreduce.Job:  map 78% reduce 24%
16/12/07 11:12:52 INFO mapreduce.Job:  map 81% reduce 25%
16/12/07 11:12:53 INFO mapreduce.Job:  map 82% reduce 26%
16/12/07 11:12:54 INFO mapreduce.Job:  map 85% reduce 26%
16/12/07 11:12:55 INFO mapreduce.Job:  map 87% reduce 27%
16/12/07 11:12:56 INFO mapreduce.Job:  map 87% reduce 28%
16/12/07 11:12:57 INFO mapreduce.Job:  map 88% reduce 29%
16/12/07 11:12:58 INFO mapreduce.Job:  map 89% reduce 29%
16/12/07 11:12:59 INFO mapreduce.Job:  map 90% reduce 29%
16/12/07 11:13:00 INFO mapreduce.Job:  map 92% reduce 30%
16/12/07 11:13:01 INFO mapreduce.Job:  map 95% reduce 30%
16/12/07 11:13:02 INFO mapreduce.Job:  map 95% reduce 31%
16/12/07 11:13:06 INFO mapreduce.Job:  map 97% reduce 32%
16/12/07 11:13:11 INFO mapreduce.Job:  map 98% reduce 33%
16/12/07 11:13:13 INFO mapreduce.Job:  map 99% reduce 33%
16/12/07 11:13:14 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 11:13:16 INFO mapreduce.Job:  map 100% reduce 39%
16/12/07 11:13:17 INFO mapreduce.Job:  map 100% reduce 49%
16/12/07 11:13:18 INFO mapreduce.Job:  map 100% reduce 67%
16/12/07 11:13:19 INFO mapreduce.Job:  map 100% reduce 72%
16/12/07 11:13:20 INFO mapreduce.Job:  map 100% reduce 85%
16/12/07 11:13:21 INFO mapreduce.Job:  map 100% reduce 92%
16/12/07 11:13:22 INFO mapreduce.Job:  map 100% reduce 96%
16/12/07 11:13:23 INFO mapreduce.Job:  map 100% reduce 99%
16/12/07 11:13:24 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 11:13:26 INFO mapreduce.Job: Job job_1480588584072_5057 completed successfully
16/12/07 11:13:26 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=358952086
		FILE: Number of bytes written=750286137
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=307738778
		WASB: Number of bytes written=159106845
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=10961438
		Total time spent by all reduces in occupied slots (ms)=3042048
		Total time spent by all map tasks (ms)=5480719
		Total time spent by all reduce tasks (ms)=1521024
		Total vcore-seconds taken by all map tasks=5480719
		Total vcore-seconds taken by all reduce tasks=1521024
		Total megabyte-seconds taken by all map tasks=5612256256
		Total megabyte-seconds taken by all reduce tasks=1557528576
	Map-Reduce Framework
		Map input records=1112470
		Map output records=982433
		Map output bytes=355353341
		Map output materialized bytes=358975606
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=877546
		Reduce shuffle bytes=358975606
		Reduce input records=982433
		Reduce output records=507405
		Spilled Records=1964866
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=78157
		CPU time spent (ms)=814420
		Physical memory (bytes) snapshot=322957672448
		Virtual memory (bytes) snapshot=742639259648
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=305042774
	File Output Format Counters 
		Bytes Written=159106845
16/12/07 11:13:26 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0500
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0600 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0600': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3225324045381756573.jar tmpDir=null
16/12/07 11:14:05 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 11:14:06 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 11:14:06 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 11:14:08 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 11:14:09 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 11:14:09 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5059
16/12/07 11:14:10 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5059
16/12/07 11:14:10 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5059/
16/12/07 11:14:10 INFO mapreduce.Job: Running job: job_1480588584072_5059
16/12/07 11:24:29 INFO mapreduce.Job: Job job_1480588584072_5059 running in uber mode : false
16/12/07 11:24:29 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 11:24:44 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 11:24:53 INFO mapreduce.Job:  map 2% reduce 0%
16/12/07 11:24:54 INFO mapreduce.Job:  map 4% reduce 0%
16/12/07 11:24:55 INFO mapreduce.Job:  map 5% reduce 0%
16/12/07 11:24:56 INFO mapreduce.Job:  map 6% reduce 0%
16/12/07 11:24:57 INFO mapreduce.Job:  map 8% reduce 0%
16/12/07 11:25:02 INFO mapreduce.Job:  map 10% reduce 0%
16/12/07 11:25:03 INFO mapreduce.Job:  map 11% reduce 0%
16/12/07 11:25:04 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 11:25:06 INFO mapreduce.Job:  map 13% reduce 0%
16/12/07 11:25:07 INFO mapreduce.Job:  map 16% reduce 0%
16/12/07 11:25:08 INFO mapreduce.Job:  map 19% reduce 0%
16/12/07 11:25:09 INFO mapreduce.Job:  map 20% reduce 0%
16/12/07 11:25:10 INFO mapreduce.Job:  map 21% reduce 0%
16/12/07 11:25:13 INFO mapreduce.Job:  map 22% reduce 0%
16/12/07 11:25:14 INFO mapreduce.Job:  map 23% reduce 0%
16/12/07 11:25:17 INFO mapreduce.Job:  map 24% reduce 0%
16/12/07 11:25:20 INFO mapreduce.Job:  map 26% reduce 1%
16/12/07 11:25:21 INFO mapreduce.Job:  map 27% reduce 1%
16/12/07 11:25:22 INFO mapreduce.Job:  map 30% reduce 1%
16/12/07 11:25:23 INFO mapreduce.Job:  map 32% reduce 1%
16/12/07 11:25:24 INFO mapreduce.Job:  map 32% reduce 2%
16/12/07 11:25:26 INFO mapreduce.Job:  map 33% reduce 3%
16/12/07 11:25:28 INFO mapreduce.Job:  map 34% reduce 3%
16/12/07 11:25:29 INFO mapreduce.Job:  map 35% reduce 3%
16/12/07 11:25:31 INFO mapreduce.Job:  map 36% reduce 3%
16/12/07 11:25:32 INFO mapreduce.Job:  map 37% reduce 3%
16/12/07 11:25:33 INFO mapreduce.Job:  map 37% reduce 4%
16/12/07 11:25:34 INFO mapreduce.Job:  map 39% reduce 4%
16/12/07 11:25:35 INFO mapreduce.Job:  map 41% reduce 4%
16/12/07 11:25:36 INFO mapreduce.Job:  map 43% reduce 5%
16/12/07 11:25:37 INFO mapreduce.Job:  map 44% reduce 5%
16/12/07 11:25:38 INFO mapreduce.Job:  map 45% reduce 6%
16/12/07 11:25:39 INFO mapreduce.Job:  map 45% reduce 7%
16/12/07 11:25:41 INFO mapreduce.Job:  map 45% reduce 8%
16/12/07 11:25:43 INFO mapreduce.Job:  map 46% reduce 8%
16/12/07 11:25:45 INFO mapreduce.Job:  map 47% reduce 8%
16/12/07 11:25:47 INFO mapreduce.Job:  map 49% reduce 9%
16/12/07 11:25:48 INFO mapreduce.Job:  map 50% reduce 9%
16/12/07 11:25:49 INFO mapreduce.Job:  map 52% reduce 10%
16/12/07 11:25:50 INFO mapreduce.Job:  map 53% reduce 10%
16/12/07 11:25:51 INFO mapreduce.Job:  map 54% reduce 11%
16/12/07 11:25:52 INFO mapreduce.Job:  map 54% reduce 12%
16/12/07 11:25:53 INFO mapreduce.Job:  map 55% reduce 12%
16/12/07 11:25:54 INFO mapreduce.Job:  map 55% reduce 13%
16/12/07 11:25:57 INFO mapreduce.Job:  map 56% reduce 13%
16/12/07 11:25:59 INFO mapreduce.Job:  map 57% reduce 14%
16/12/07 11:26:01 INFO mapreduce.Job:  map 58% reduce 14%
16/12/07 11:26:02 INFO mapreduce.Job:  map 60% reduce 15%
16/12/07 11:26:03 INFO mapreduce.Job:  map 60% reduce 16%
16/12/07 11:26:04 INFO mapreduce.Job:  map 61% reduce 16%
16/12/07 11:26:06 INFO mapreduce.Job:  map 62% reduce 16%
16/12/07 11:26:08 INFO mapreduce.Job:  map 63% reduce 17%
16/12/07 11:26:09 INFO mapreduce.Job:  map 64% reduce 17%
16/12/07 11:26:10 INFO mapreduce.Job:  map 65% reduce 17%
16/12/07 11:26:14 INFO mapreduce.Job:  map 66% reduce 17%
16/12/07 11:26:15 INFO mapreduce.Job:  map 67% reduce 18%
16/12/07 11:26:16 INFO mapreduce.Job:  map 68% reduce 18%
16/12/07 11:26:21 INFO mapreduce.Job:  map 69% reduce 18%
16/12/07 11:26:22 INFO mapreduce.Job:  map 70% reduce 18%
16/12/07 11:26:25 INFO mapreduce.Job:  map 71% reduce 19%
16/12/07 11:26:26 INFO mapreduce.Job:  map 73% reduce 19%
16/12/07 11:26:27 INFO mapreduce.Job:  map 77% reduce 19%
16/12/07 11:26:28 INFO mapreduce.Job:  map 80% reduce 20%
16/12/07 11:26:29 INFO mapreduce.Job:  map 81% reduce 20%
16/12/07 11:26:30 INFO mapreduce.Job:  map 81% reduce 21%
16/12/07 11:26:31 INFO mapreduce.Job:  map 81% reduce 22%
16/12/07 11:26:32 INFO mapreduce.Job:  map 82% reduce 22%
16/12/07 11:26:33 INFO mapreduce.Job:  map 83% reduce 22%
16/12/07 11:26:35 INFO mapreduce.Job:  map 85% reduce 22%
16/12/07 11:26:36 INFO mapreduce.Job:  map 90% reduce 22%
16/12/07 11:26:37 INFO mapreduce.Job:  map 94% reduce 24%
16/12/07 11:26:38 INFO mapreduce.Job:  map 95% reduce 24%
16/12/07 11:26:39 INFO mapreduce.Job:  map 99% reduce 26%
16/12/07 11:26:40 INFO mapreduce.Job:  map 100% reduce 31%
16/12/07 11:26:41 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 11:26:42 INFO mapreduce.Job:  map 100% reduce 42%
16/12/07 11:26:43 INFO mapreduce.Job:  map 100% reduce 56%
16/12/07 11:26:44 INFO mapreduce.Job:  map 100% reduce 69%
16/12/07 11:26:45 INFO mapreduce.Job:  map 100% reduce 76%
16/12/07 11:26:46 INFO mapreduce.Job:  map 100% reduce 85%
16/12/07 11:26:47 INFO mapreduce.Job:  map 100% reduce 95%
16/12/07 11:26:48 INFO mapreduce.Job:  map 100% reduce 99%
16/12/07 11:26:49 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 11:26:52 INFO mapreduce.Job: Job job_1480588584072_5059 completed successfully
16/12/07 11:26:52 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=427686088
		FILE: Number of bytes written=887754141
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=366245718
		WASB: Number of bytes written=195290880
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=7195426
		Total time spent by all reduces in occupied slots (ms)=2955614
		Total time spent by all map tasks (ms)=3597713
		Total time spent by all reduce tasks (ms)=1477807
		Total vcore-seconds taken by all map tasks=3597713
		Total vcore-seconds taken by all reduce tasks=1477807
		Total megabyte-seconds taken by all map tasks=3684058112
		Total megabyte-seconds taken by all reduce tasks=1513274368
	Map-Reduce Framework
		Map input records=1289583
		Map output records=1140736
		Map output bytes=423459704
		Map output materialized bytes=427709608
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1011547
		Reduce shuffle bytes=427709608
		Reduce input records=1140736
		Reduce output records=615456
		Spilled Records=2281472
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=51148
		CPU time spent (ms)=796340
		Physical memory (bytes) snapshot=323059703808
		Virtual memory (bytes) snapshot=742895493120
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=363549714
	File Output Format Counters 
		Bytes Written=195290880
16/12/07 11:26:52 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0600
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0700 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161205/201612052300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0700': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8857884630714435939.jar tmpDir=null
16/12/07 11:27:31 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 11:27:31 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 11:27:32 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 11:27:33 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 11:27:33 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 11:27:34 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5064
16/12/07 11:27:35 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5064
16/12/07 11:27:35 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5064/
16/12/07 11:27:35 INFO mapreduce.Job: Running job: job_1480588584072_5064
16/12/07 11:27:48 INFO mapreduce.Job: Job job_1480588584072_5064 running in uber mode : false
16/12/07 11:27:48 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 11:28:03 INFO mapreduce.Job:  map 2% reduce 0%
16/12/07 11:28:06 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 11:28:07 INFO mapreduce.Job:  map 4% reduce 0%
16/12/07 11:28:10 INFO mapreduce.Job:  map 5% reduce 0%
16/12/07 11:28:12 INFO mapreduce.Job:  map 9% reduce 0%
16/12/07 11:28:13 INFO mapreduce.Job:  map 10% reduce 0%
16/12/07 11:28:14 INFO mapreduce.Job:  map 14% reduce 0%
16/12/07 11:28:15 INFO mapreduce.Job:  map 16% reduce 0%
16/12/07 11:28:17 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 11:28:18 INFO mapreduce.Job:  map 19% reduce 0%
16/12/07 11:28:19 INFO mapreduce.Job:  map 21% reduce 0%
16/12/07 11:28:20 INFO mapreduce.Job:  map 22% reduce 0%
16/12/07 11:28:21 INFO mapreduce.Job:  map 23% reduce 0%
16/12/07 11:28:25 INFO mapreduce.Job:  map 26% reduce 1%
16/12/07 11:28:26 INFO mapreduce.Job:  map 28% reduce 1%
16/12/07 11:28:27 INFO mapreduce.Job:  map 30% reduce 1%
16/12/07 11:28:28 INFO mapreduce.Job:  map 31% reduce 1%
16/12/07 11:28:31 INFO mapreduce.Job:  map 31% reduce 3%
16/12/07 11:28:33 INFO mapreduce.Job:  map 31% reduce 4%
16/12/07 11:28:35 INFO mapreduce.Job:  map 33% reduce 4%
16/12/07 11:28:36 INFO mapreduce.Job:  map 35% reduce 4%
16/12/07 11:28:37 INFO mapreduce.Job:  map 37% reduce 4%
16/12/07 11:28:38 INFO mapreduce.Job:  map 41% reduce 4%
16/12/07 11:28:39 INFO mapreduce.Job:  map 42% reduce 4%
16/12/07 11:28:40 INFO mapreduce.Job:  map 43% reduce 6%
16/12/07 11:28:43 INFO mapreduce.Job:  map 44% reduce 6%
16/12/07 11:28:45 INFO mapreduce.Job:  map 45% reduce 6%
16/12/07 11:28:46 INFO mapreduce.Job:  map 45% reduce 7%
16/12/07 11:28:48 INFO mapreduce.Job:  map 45% reduce 8%
16/12/07 11:28:49 INFO mapreduce.Job:  map 46% reduce 8%
16/12/07 11:28:50 INFO mapreduce.Job:  map 49% reduce 8%
16/12/07 11:28:51 INFO mapreduce.Job:  map 50% reduce 8%
16/12/07 11:28:52 INFO mapreduce.Job:  map 52% reduce 8%
16/12/07 11:28:53 INFO mapreduce.Job:  map 54% reduce 8%
16/12/07 11:28:54 INFO mapreduce.Job:  map 54% reduce 9%
16/12/07 11:28:55 INFO mapreduce.Job:  map 54% reduce 10%
16/12/07 11:28:56 INFO mapreduce.Job:  map 54% reduce 11%
16/12/07 11:28:57 INFO mapreduce.Job:  map 55% reduce 12%
16/12/07 11:28:59 INFO mapreduce.Job:  map 55% reduce 13%
16/12/07 11:29:00 INFO mapreduce.Job:  map 56% reduce 13%
16/12/07 11:29:01 INFO mapreduce.Job:  map 57% reduce 13%
16/12/07 11:29:02 INFO mapreduce.Job:  map 60% reduce 13%
16/12/07 11:29:03 INFO mapreduce.Job:  map 61% reduce 14%
16/12/07 11:29:04 INFO mapreduce.Job:  map 62% reduce 15%
16/12/07 11:29:07 INFO mapreduce.Job:  map 63% reduce 17%
16/12/07 11:29:08 INFO mapreduce.Job:  map 64% reduce 17%
16/12/07 11:29:12 INFO mapreduce.Job:  map 65% reduce 17%
16/12/07 11:29:13 INFO mapreduce.Job:  map 68% reduce 17%
16/12/07 11:29:14 INFO mapreduce.Job:  map 70% reduce 18%
16/12/07 11:29:15 INFO mapreduce.Job:  map 72% reduce 18%
16/12/07 11:29:16 INFO mapreduce.Job:  map 72% reduce 19%
16/12/07 11:29:18 INFO mapreduce.Job:  map 73% reduce 19%
16/12/07 11:29:21 INFO mapreduce.Job:  map 74% reduce 19%
16/12/07 11:29:22 INFO mapreduce.Job:  map 74% reduce 20%
16/12/07 11:29:23 INFO mapreduce.Job:  map 75% reduce 20%
16/12/07 11:29:25 INFO mapreduce.Job:  map 78% reduce 20%
16/12/07 11:29:26 INFO mapreduce.Job:  map 80% reduce 20%
16/12/07 11:29:27 INFO mapreduce.Job:  map 82% reduce 21%
16/12/07 11:29:28 INFO mapreduce.Job:  map 83% reduce 21%
16/12/07 11:29:29 INFO mapreduce.Job:  map 83% reduce 22%
16/12/07 11:29:31 INFO mapreduce.Job:  map 84% reduce 23%
16/12/07 11:29:32 INFO mapreduce.Job:  map 85% reduce 24%
16/12/07 11:29:34 INFO mapreduce.Job:  map 86% reduce 24%
16/12/07 11:29:35 INFO mapreduce.Job:  map 87% reduce 24%
16/12/07 11:29:36 INFO mapreduce.Job:  map 89% reduce 24%
16/12/07 11:29:37 INFO mapreduce.Job:  map 91% reduce 25%
16/12/07 11:29:38 INFO mapreduce.Job:  map 92% reduce 25%
16/12/07 11:29:39 INFO mapreduce.Job:  map 93% reduce 26%
16/12/07 11:29:40 INFO mapreduce.Job:  map 94% reduce 26%
16/12/07 11:29:43 INFO mapreduce.Job:  map 95% reduce 27%
16/12/07 11:29:46 INFO mapreduce.Job:  map 97% reduce 27%
16/12/07 11:29:47 INFO mapreduce.Job:  map 99% reduce 27%
16/12/07 11:29:48 INFO mapreduce.Job:  map 100% reduce 27%
16/12/07 11:29:49 INFO mapreduce.Job:  map 100% reduce 32%
16/12/07 11:29:50 INFO mapreduce.Job:  map 100% reduce 41%
16/12/07 11:29:51 INFO mapreduce.Job:  map 100% reduce 51%
16/12/07 11:29:52 INFO mapreduce.Job:  map 100% reduce 78%
16/12/07 11:29:53 INFO mapreduce.Job:  map 100% reduce 84%
16/12/07 11:29:54 INFO mapreduce.Job:  map 100% reduce 94%
16/12/07 11:29:55 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 11:29:58 INFO mapreduce.Job: Job job_1480588584072_5064 completed successfully
16/12/07 11:29:59 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=523823468
		FILE: Number of bytes written=1080028901
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=450234196
		WASB: Number of bytes written=252026502
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=4526030
		Total time spent by all reduces in occupied slots (ms)=2845642
		Total time spent by all map tasks (ms)=2263015
		Total time spent by all reduce tasks (ms)=1422821
		Total vcore-seconds taken by all map tasks=2263015
		Total vcore-seconds taken by all reduce tasks=1422821
		Total megabyte-seconds taken by all map tasks=2317327360
		Total megabyte-seconds taken by all reduce tasks=1456968704
	Map-Reduce Framework
		Map input records=1531681
		Map output records=1353062
		Map output bytes=518741374
		Map output materialized bytes=523846988
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1194398
		Reduce shuffle bytes=523846988
		Reduce input records=1353062
		Reduce output records=775250
		Spilled Records=2706124
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=27113
		CPU time spent (ms)=788840
		Physical memory (bytes) snapshot=323425144832
		Virtual memory (bytes) snapshot=743225659392
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=447538192
	File Output Format Counters 
		Bytes Written=252026502
16/12/07 11:29:59 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0700
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060400 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0800 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060400
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0800': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob464083963385418380.jar tmpDir=null
16/12/07 11:30:38 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 11:30:39 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 11:30:39 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 11:30:41 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 11:30:42 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 11:30:42 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5066
16/12/07 11:30:43 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5066
16/12/07 11:30:43 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5066/
16/12/07 11:30:43 INFO mapreduce.Job: Running job: job_1480588584072_5066
16/12/07 11:30:56 INFO mapreduce.Job: Job job_1480588584072_5066 running in uber mode : false
16/12/07 11:30:56 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 11:31:09 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 11:31:16 INFO mapreduce.Job:  map 5% reduce 0%
16/12/07 11:31:17 INFO mapreduce.Job:  map 7% reduce 0%
16/12/07 11:31:18 INFO mapreduce.Job:  map 11% reduce 0%
16/12/07 11:31:19 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 11:31:23 INFO mapreduce.Job:  map 16% reduce 0%
16/12/07 11:31:24 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 11:31:25 INFO mapreduce.Job:  map 19% reduce 0%
16/12/07 11:31:26 INFO mapreduce.Job:  map 21% reduce 0%
16/12/07 11:31:27 INFO mapreduce.Job:  map 24% reduce 0%
16/12/07 11:31:28 INFO mapreduce.Job:  map 26% reduce 0%
16/12/07 11:31:30 INFO mapreduce.Job:  map 27% reduce 0%
16/12/07 11:31:31 INFO mapreduce.Job:  map 29% reduce 0%
16/12/07 11:31:32 INFO mapreduce.Job:  map 31% reduce 0%
16/12/07 11:31:34 INFO mapreduce.Job:  map 32% reduce 1%
16/12/07 11:31:36 INFO mapreduce.Job:  map 33% reduce 2%
16/12/07 11:31:37 INFO mapreduce.Job:  map 34% reduce 2%
16/12/07 11:31:38 INFO mapreduce.Job:  map 36% reduce 2%
16/12/07 11:31:39 INFO mapreduce.Job:  map 37% reduce 2%
16/12/07 11:31:41 INFO mapreduce.Job:  map 39% reduce 2%
16/12/07 11:31:42 INFO mapreduce.Job:  map 40% reduce 3%
16/12/07 11:31:43 INFO mapreduce.Job:  map 42% reduce 5%
16/12/07 11:31:44 INFO mapreduce.Job:  map 46% reduce 5%
16/12/07 11:31:45 INFO mapreduce.Job:  map 47% reduce 6%
16/12/07 11:31:47 INFO mapreduce.Job:  map 48% reduce 8%
16/12/07 11:31:48 INFO mapreduce.Job:  map 49% reduce 9%
16/12/07 11:31:49 INFO mapreduce.Job:  map 50% reduce 9%
16/12/07 11:31:50 INFO mapreduce.Job:  map 51% reduce 9%
16/12/07 11:31:51 INFO mapreduce.Job:  map 53% reduce 10%
16/12/07 11:31:52 INFO mapreduce.Job:  map 54% reduce 10%
16/12/07 11:31:54 INFO mapreduce.Job:  map 56% reduce 11%
16/12/07 11:31:55 INFO mapreduce.Job:  map 58% reduce 12%
16/12/07 11:31:56 INFO mapreduce.Job:  map 59% reduce 12%
16/12/07 11:31:57 INFO mapreduce.Job:  map 60% reduce 13%
16/12/07 11:31:58 INFO mapreduce.Job:  map 61% reduce 15%
16/12/07 11:32:00 INFO mapreduce.Job:  map 62% reduce 15%
16/12/07 11:32:01 INFO mapreduce.Job:  map 64% reduce 18%
16/12/07 11:32:02 INFO mapreduce.Job:  map 65% reduce 18%
16/12/07 11:32:03 INFO mapreduce.Job:  map 67% reduce 18%
16/12/07 11:32:04 INFO mapreduce.Job:  map 69% reduce 19%
16/12/07 11:32:05 INFO mapreduce.Job:  map 70% reduce 19%
16/12/07 11:32:07 INFO mapreduce.Job:  map 70% reduce 20%
16/12/07 11:32:08 INFO mapreduce.Job:  map 71% reduce 20%
16/12/07 11:32:09 INFO mapreduce.Job:  map 72% reduce 21%
16/12/07 11:32:10 INFO mapreduce.Job:  map 74% reduce 21%
16/12/07 11:32:11 INFO mapreduce.Job:  map 76% reduce 22%
16/12/07 11:32:12 INFO mapreduce.Job:  map 78% reduce 22%
16/12/07 11:32:13 INFO mapreduce.Job:  map 78% reduce 23%
16/12/07 11:32:14 INFO mapreduce.Job:  map 79% reduce 23%
16/12/07 11:32:16 INFO mapreduce.Job:  map 80% reduce 24%
16/12/07 11:32:17 INFO mapreduce.Job:  map 82% reduce 24%
16/12/07 11:32:18 INFO mapreduce.Job:  map 83% reduce 24%
16/12/07 11:32:19 INFO mapreduce.Job:  map 85% reduce 25%
16/12/07 11:32:20 INFO mapreduce.Job:  map 86% reduce 25%
16/12/07 11:32:21 INFO mapreduce.Job:  map 87% reduce 25%
16/12/07 11:32:22 INFO mapreduce.Job:  map 87% reduce 26%
16/12/07 11:32:23 INFO mapreduce.Job:  map 88% reduce 26%
16/12/07 11:32:24 INFO mapreduce.Job:  map 89% reduce 26%
16/12/07 11:32:25 INFO mapreduce.Job:  map 90% reduce 26%
16/12/07 11:32:26 INFO mapreduce.Job:  map 91% reduce 27%
16/12/07 11:32:27 INFO mapreduce.Job:  map 93% reduce 27%
16/12/07 11:32:28 INFO mapreduce.Job:  map 94% reduce 27%
16/12/07 11:32:29 INFO mapreduce.Job:  map 95% reduce 28%
16/12/07 11:32:30 INFO mapreduce.Job:  map 96% reduce 28%
16/12/07 11:32:31 INFO mapreduce.Job:  map 98% reduce 29%
16/12/07 11:32:33 INFO mapreduce.Job:  map 100% reduce 29%
16/12/07 11:32:34 INFO mapreduce.Job:  map 100% reduce 31%
16/12/07 11:32:35 INFO mapreduce.Job:  map 100% reduce 35%
16/12/07 11:32:36 INFO mapreduce.Job:  map 100% reduce 46%
16/12/07 11:32:37 INFO mapreduce.Job:  map 100% reduce 56%
16/12/07 11:32:38 INFO mapreduce.Job:  map 100% reduce 65%
16/12/07 11:32:39 INFO mapreduce.Job:  map 100% reduce 71%
16/12/07 11:32:40 INFO mapreduce.Job:  map 100% reduce 88%
16/12/07 11:32:41 INFO mapreduce.Job:  map 100% reduce 93%
16/12/07 11:32:42 INFO mapreduce.Job:  map 100% reduce 95%
16/12/07 11:32:43 INFO mapreduce.Job:  map 100% reduce 96%
16/12/07 11:32:44 INFO mapreduce.Job:  map 100% reduce 99%
16/12/07 11:32:45 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 11:32:48 INFO mapreduce.Job: Job job_1480588584072_5066 completed successfully
16/12/07 11:32:49 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=654543241
		FILE: Number of bytes written=1341468447
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=557585666
		WASB: Number of bytes written=342851697
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=4094760
		Total time spent by all reduces in occupied slots (ms)=2458614
		Total time spent by all map tasks (ms)=2047380
		Total time spent by all reduce tasks (ms)=1229307
		Total vcore-seconds taken by all map tasks=2047380
		Total vcore-seconds taken by all reduce tasks=1229307
		Total megabyte-seconds taken by all map tasks=2096517120
		Total megabyte-seconds taken by all reduce tasks=1258810368
	Map-Reduce Framework
		Map input records=1852151
		Map output records=1659034
		Map output bytes=648270854
		Map output materialized bytes=654566761
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1466407
		Reduce shuffle bytes=654566761
		Reduce input records=1659034
		Reduce output records=1049634
		Spilled Records=3318068
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=24413
		CPU time spent (ms)=832590
		Physical memory (bytes) snapshot=323589500928
		Virtual memory (bytes) snapshot=743409344512
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=554889662
	File Output Format Counters 
		Bytes Written=342851697
16/12/07 11:32:49 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0800
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060500 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0900 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060500
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0900': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5439409823266300839.jar tmpDir=null
16/12/07 11:33:27 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 11:33:28 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 11:33:28 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 11:33:30 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 11:33:30 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 11:33:31 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5068
16/12/07 11:33:32 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5068
16/12/07 11:33:32 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5068/
16/12/07 11:33:32 INFO mapreduce.Job: Running job: job_1480588584072_5068
16/12/07 11:33:45 INFO mapreduce.Job: Job job_1480588584072_5068 running in uber mode : false
16/12/07 11:33:45 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 11:33:56 INFO mapreduce.Job:  map 2% reduce 0%
16/12/07 11:34:04 INFO mapreduce.Job:  map 4% reduce 0%
16/12/07 11:34:06 INFO mapreduce.Job:  map 5% reduce 0%
16/12/07 11:34:07 INFO mapreduce.Job:  map 9% reduce 0%
16/12/07 11:34:08 INFO mapreduce.Job:  map 13% reduce 0%
16/12/07 11:34:09 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 11:34:13 INFO mapreduce.Job:  map 18% reduce 0%
16/12/07 11:34:14 INFO mapreduce.Job:  map 19% reduce 0%
16/12/07 11:34:15 INFO mapreduce.Job:  map 21% reduce 0%
16/12/07 11:34:16 INFO mapreduce.Job:  map 22% reduce 0%
16/12/07 11:34:18 INFO mapreduce.Job:  map 23% reduce 0%
16/12/07 11:34:19 INFO mapreduce.Job:  map 25% reduce 0%
16/12/07 11:34:20 INFO mapreduce.Job:  map 31% reduce 0%
16/12/07 11:34:21 INFO mapreduce.Job:  map 32% reduce 0%
16/12/07 11:34:23 INFO mapreduce.Job:  map 32% reduce 1%
16/12/07 11:34:24 INFO mapreduce.Job:  map 32% reduce 3%
16/12/07 11:34:28 INFO mapreduce.Job:  map 33% reduce 3%
16/12/07 11:34:29 INFO mapreduce.Job:  map 35% reduce 3%
16/12/07 11:34:30 INFO mapreduce.Job:  map 39% reduce 3%
16/12/07 11:34:31 INFO mapreduce.Job:  map 40% reduce 4%
16/12/07 11:34:32 INFO mapreduce.Job:  map 41% reduce 4%
16/12/07 11:34:33 INFO mapreduce.Job:  map 43% reduce 4%
16/12/07 11:34:34 INFO mapreduce.Job:  map 45% reduce 6%
16/12/07 11:34:35 INFO mapreduce.Job:  map 46% reduce 6%
16/12/07 11:34:36 INFO mapreduce.Job:  map 46% reduce 7%
16/12/07 11:34:38 INFO mapreduce.Job:  map 47% reduce 7%
16/12/07 11:34:39 INFO mapreduce.Job:  map 50% reduce 8%
16/12/07 11:34:40 INFO mapreduce.Job:  map 51% reduce 9%
16/12/07 11:34:42 INFO mapreduce.Job:  map 52% reduce 10%
16/12/07 11:34:43 INFO mapreduce.Job:  map 53% reduce 11%
16/12/07 11:34:45 INFO mapreduce.Job:  map 54% reduce 11%
16/12/07 11:34:46 INFO mapreduce.Job:  map 54% reduce 12%
16/12/07 11:34:47 INFO mapreduce.Job:  map 57% reduce 12%
16/12/07 11:34:48 INFO mapreduce.Job:  map 59% reduce 12%
16/12/07 11:34:49 INFO mapreduce.Job:  map 60% reduce 14%
16/12/07 11:34:50 INFO mapreduce.Job:  map 60% reduce 15%
16/12/07 11:34:51 INFO mapreduce.Job:  map 61% reduce 15%
16/12/07 11:34:52 INFO mapreduce.Job:  map 62% reduce 17%
16/12/07 11:34:53 INFO mapreduce.Job:  map 63% reduce 17%
16/12/07 11:34:54 INFO mapreduce.Job:  map 64% reduce 18%
16/12/07 11:34:55 INFO mapreduce.Job:  map 65% reduce 19%
16/12/07 11:34:56 INFO mapreduce.Job:  map 66% reduce 19%
16/12/07 11:34:58 INFO mapreduce.Job:  map 66% reduce 20%
16/12/07 11:34:59 INFO mapreduce.Job:  map 68% reduce 20%
16/12/07 11:35:00 INFO mapreduce.Job:  map 70% reduce 20%
16/12/07 11:35:01 INFO mapreduce.Job:  map 73% reduce 21%
16/12/07 11:35:04 INFO mapreduce.Job:  map 75% reduce 22%
16/12/07 11:35:06 INFO mapreduce.Job:  map 76% reduce 22%
16/12/07 11:35:07 INFO mapreduce.Job:  map 76% reduce 23%
16/12/07 11:35:08 INFO mapreduce.Job:  map 78% reduce 23%
16/12/07 11:35:10 INFO mapreduce.Job:  map 79% reduce 23%
16/12/07 11:35:12 INFO mapreduce.Job:  map 80% reduce 24%
16/12/07 11:35:13 INFO mapreduce.Job:  map 84% reduce 24%
16/12/07 11:35:14 INFO mapreduce.Job:  map 86% reduce 24%
16/12/07 11:35:15 INFO mapreduce.Job:  map 87% reduce 25%
16/12/07 11:35:16 INFO mapreduce.Job:  map 87% reduce 26%
16/12/07 11:35:17 INFO mapreduce.Job:  map 88% reduce 26%
16/12/07 11:35:20 INFO mapreduce.Job:  map 91% reduce 26%
16/12/07 11:35:21 INFO mapreduce.Job:  map 91% reduce 27%
16/12/07 11:35:22 INFO mapreduce.Job:  map 92% reduce 27%
16/12/07 11:35:24 INFO mapreduce.Job:  map 93% reduce 28%
16/12/07 11:35:25 INFO mapreduce.Job:  map 95% reduce 28%
16/12/07 11:35:26 INFO mapreduce.Job:  map 97% reduce 28%
16/12/07 11:35:27 INFO mapreduce.Job:  map 99% reduce 29%
16/12/07 11:35:28 INFO mapreduce.Job:  map 100% reduce 29%
16/12/07 11:35:29 INFO mapreduce.Job:  map 100% reduce 30%
16/12/07 11:35:30 INFO mapreduce.Job:  map 100% reduce 37%
16/12/07 11:35:31 INFO mapreduce.Job:  map 100% reduce 48%
16/12/07 11:35:32 INFO mapreduce.Job:  map 100% reduce 64%
16/12/07 11:35:33 INFO mapreduce.Job:  map 100% reduce 73%
16/12/07 11:35:34 INFO mapreduce.Job:  map 100% reduce 85%
16/12/07 11:35:35 INFO mapreduce.Job:  map 100% reduce 98%
16/12/07 11:35:36 INFO mapreduce.Job:  map 100% reduce 99%
16/12/07 11:35:37 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 11:35:39 INFO mapreduce.Job: Job job_1480588584072_5068 completed successfully
16/12/07 11:35:39 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=610936603
		FILE: Number of bytes written=1254255171
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=528641734
		WASB: Number of bytes written=293085595
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=4528076
		Total time spent by all reduces in occupied slots (ms)=2615768
		Total time spent by all map tasks (ms)=2264038
		Total time spent by all reduce tasks (ms)=1307884
		Total vcore-seconds taken by all map tasks=2264038
		Total vcore-seconds taken by all reduce tasks=1307884
		Total megabyte-seconds taken by all map tasks=2318374912
		Total megabyte-seconds taken by all reduce tasks=1339273216
	Map-Reduce Framework
		Map input records=1732640
		Map output records=1518509
		Map output bytes=605115129
		Map output materialized bytes=610960123
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1321867
		Reduce shuffle bytes=610960123
		Reduce input records=1518509
		Reduce output records=874336
		Spilled Records=3037018
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=25832
		CPU time spent (ms)=821440
		Physical memory (bytes) snapshot=323500765184
		Virtual memory (bytes) snapshot=743090679808
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=525945730
	File Output Format Counters 
		Bytes Written=293085595
16/12/07 11:35:39 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/0900
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060600 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060600
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1355266797129023239.jar tmpDir=null
16/12/07 11:36:17 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 11:36:18 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 11:36:18 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 11:36:20 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 11:36:20 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 11:36:20 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5070
16/12/07 11:36:21 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5070
16/12/07 11:36:21 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5070/
16/12/07 11:36:21 INFO mapreduce.Job: Running job: job_1480588584072_5070
16/12/07 11:36:34 INFO mapreduce.Job: Job job_1480588584072_5070 running in uber mode : false
16/12/07 11:36:34 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 11:36:46 INFO mapreduce.Job:  map 2% reduce 0%
16/12/07 11:36:54 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 11:36:55 INFO mapreduce.Job:  map 4% reduce 0%
16/12/07 11:36:56 INFO mapreduce.Job:  map 5% reduce 0%
16/12/07 11:36:57 INFO mapreduce.Job:  map 7% reduce 0%
16/12/07 11:36:58 INFO mapreduce.Job:  map 13% reduce 0%
16/12/07 11:36:59 INFO mapreduce.Job:  map 14% reduce 0%
16/12/07 11:37:00 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 11:37:02 INFO mapreduce.Job:  map 16% reduce 0%
16/12/07 11:37:03 INFO mapreduce.Job:  map 18% reduce 0%
16/12/07 11:37:04 INFO mapreduce.Job:  map 20% reduce 0%
16/12/07 11:37:06 INFO mapreduce.Job:  map 21% reduce 0%
16/12/07 11:37:07 INFO mapreduce.Job:  map 22% reduce 0%
16/12/07 11:37:08 INFO mapreduce.Job:  map 23% reduce 0%
16/12/07 11:37:09 INFO mapreduce.Job:  map 25% reduce 0%
16/12/07 11:37:10 INFO mapreduce.Job:  map 28% reduce 0%
16/12/07 11:37:11 INFO mapreduce.Job:  map 32% reduce 0%
16/12/07 11:37:12 INFO mapreduce.Job:  map 33% reduce 1%
16/12/07 11:37:13 INFO mapreduce.Job:  map 33% reduce 2%
16/12/07 11:37:15 INFO mapreduce.Job:  map 33% reduce 3%
16/12/07 11:37:17 INFO mapreduce.Job:  map 34% reduce 3%
16/12/07 11:37:18 INFO mapreduce.Job:  map 35% reduce 3%
16/12/07 11:37:19 INFO mapreduce.Job:  map 36% reduce 3%
16/12/07 11:37:21 INFO mapreduce.Job:  map 40% reduce 4%
16/12/07 11:37:22 INFO mapreduce.Job:  map 43% reduce 4%
16/12/07 11:37:23 INFO mapreduce.Job:  map 43% reduce 5%
16/12/07 11:37:24 INFO mapreduce.Job:  map 44% reduce 7%
16/12/07 11:37:25 INFO mapreduce.Job:  map 47% reduce 7%
16/12/07 11:37:26 INFO mapreduce.Job:  map 48% reduce 8%
16/12/07 11:37:28 INFO mapreduce.Job:  map 48% reduce 9%
16/12/07 11:37:30 INFO mapreduce.Job:  map 49% reduce 10%
16/12/07 11:37:32 INFO mapreduce.Job:  map 51% reduce 10%
16/12/07 11:37:33 INFO mapreduce.Job:  map 53% reduce 10%
16/12/07 11:37:34 INFO mapreduce.Job:  map 54% reduce 10%
16/12/07 11:37:35 INFO mapreduce.Job:  map 55% reduce 10%
16/12/07 11:37:36 INFO mapreduce.Job:  map 56% reduce 11%
16/12/07 11:37:37 INFO mapreduce.Job:  map 56% reduce 12%
16/12/07 11:37:38 INFO mapreduce.Job:  map 58% reduce 12%
16/12/07 11:37:39 INFO mapreduce.Job:  map 60% reduce 13%
16/12/07 11:37:40 INFO mapreduce.Job:  map 61% reduce 14%
16/12/07 11:37:41 INFO mapreduce.Job:  map 61% reduce 16%
16/12/07 11:37:42 INFO mapreduce.Job:  map 61% reduce 17%
16/12/07 11:37:44 INFO mapreduce.Job:  map 62% reduce 17%
16/12/07 11:37:45 INFO mapreduce.Job:  map 64% reduce 17%
16/12/07 11:37:46 INFO mapreduce.Job:  map 68% reduce 18%
16/12/07 11:37:48 INFO mapreduce.Job:  map 68% reduce 20%
16/12/07 11:37:49 INFO mapreduce.Job:  map 69% reduce 20%
16/12/07 11:37:50 INFO mapreduce.Job:  map 70% reduce 20%
16/12/07 11:37:51 INFO mapreduce.Job:  map 70% reduce 21%
16/12/07 11:37:52 INFO mapreduce.Job:  map 71% reduce 21%
16/12/07 11:37:53 INFO mapreduce.Job:  map 73% reduce 21%
16/12/07 11:37:54 INFO mapreduce.Job:  map 74% reduce 21%
16/12/07 11:37:55 INFO mapreduce.Job:  map 75% reduce 22%
16/12/07 11:37:56 INFO mapreduce.Job:  map 76% reduce 22%
16/12/07 11:37:57 INFO mapreduce.Job:  map 77% reduce 22%
16/12/07 11:37:58 INFO mapreduce.Job:  map 77% reduce 23%
16/12/07 11:37:59 INFO mapreduce.Job:  map 78% reduce 23%
16/12/07 11:38:00 INFO mapreduce.Job:  map 81% reduce 23%
16/12/07 11:38:01 INFO mapreduce.Job:  map 82% reduce 24%
16/12/07 11:38:03 INFO mapreduce.Job:  map 82% reduce 25%
16/12/07 11:38:05 INFO mapreduce.Job:  map 83% reduce 25%
16/12/07 11:38:06 INFO mapreduce.Job:  map 84% reduce 25%
16/12/07 11:38:07 INFO mapreduce.Job:  map 85% reduce 25%
16/12/07 11:38:08 INFO mapreduce.Job:  map 89% reduce 25%
16/12/07 11:38:09 INFO mapreduce.Job:  map 89% reduce 26%
16/12/07 11:38:10 INFO mapreduce.Job:  map 90% reduce 26%
16/12/07 11:38:11 INFO mapreduce.Job:  map 90% reduce 27%
16/12/07 11:38:12 INFO mapreduce.Job:  map 91% reduce 27%
16/12/07 11:38:14 INFO mapreduce.Job:  map 92% reduce 27%
16/12/07 11:38:15 INFO mapreduce.Job:  map 95% reduce 28%
16/12/07 11:38:16 INFO mapreduce.Job:  map 96% reduce 28%
16/12/07 11:38:17 INFO mapreduce.Job:  map 96% reduce 29%
16/12/07 11:38:18 INFO mapreduce.Job:  map 98% reduce 29%
16/12/07 11:38:19 INFO mapreduce.Job:  map 99% reduce 29%
16/12/07 11:38:20 INFO mapreduce.Job:  map 100% reduce 30%
16/12/07 11:38:21 INFO mapreduce.Job:  map 100% reduce 32%
16/12/07 11:38:22 INFO mapreduce.Job:  map 100% reduce 35%
16/12/07 11:38:23 INFO mapreduce.Job:  map 100% reduce 50%
16/12/07 11:38:24 INFO mapreduce.Job:  map 100% reduce 57%
16/12/07 11:38:25 INFO mapreduce.Job:  map 100% reduce 68%
16/12/07 11:38:26 INFO mapreduce.Job:  map 100% reduce 78%
16/12/07 11:38:27 INFO mapreduce.Job:  map 100% reduce 82%
16/12/07 11:38:28 INFO mapreduce.Job:  map 100% reduce 88%
16/12/07 11:38:29 INFO mapreduce.Job:  map 100% reduce 95%
16/12/07 11:38:30 INFO mapreduce.Job:  map 100% reduce 98%
16/12/07 11:38:31 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 11:38:33 INFO mapreduce.Job: Job job_1480588584072_5070 completed successfully
16/12/07 11:38:33 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=740682928
		FILE: Number of bytes written=1513747821
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=631579087
		WASB: Number of bytes written=394567073
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=4581920
		Total time spent by all reduces in occupied slots (ms)=2767434
		Total time spent by all map tasks (ms)=2290960
		Total time spent by all reduce tasks (ms)=1383717
		Total vcore-seconds taken by all map tasks=2290960
		Total vcore-seconds taken by all reduce tasks=1383717
		Total megabyte-seconds taken by all map tasks=2345943040
		Total megabyte-seconds taken by all reduce tasks=1416926208
	Map-Reduce Framework
		Map input records=2004819
		Map output records=1795039
		Map output bytes=733743400
		Map output materialized bytes=740706448
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1571285
		Reduce shuffle bytes=740706448
		Reduce input records=1795039
		Reduce output records=1156883
		Spilled Records=3590078
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=28002
		CPU time spent (ms)=860460
		Physical memory (bytes) snapshot=323951181824
		Virtual memory (bytes) snapshot=743093620736
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=628883083
	File Output Format Counters 
		Bytes Written=394567073
16/12/07 11:38:33 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060700 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060700
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8875358821758911621.jar tmpDir=null
16/12/07 11:39:13 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 11:39:13 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 11:39:14 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 11:39:15 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 11:39:16 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 11:39:16 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5074
16/12/07 11:39:17 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5074
16/12/07 11:39:17 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5074/
16/12/07 11:39:17 INFO mapreduce.Job: Running job: job_1480588584072_5074
16/12/07 11:39:29 INFO mapreduce.Job: Job job_1480588584072_5074 running in uber mode : false
16/12/07 11:39:29 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 11:39:39 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 11:39:45 INFO mapreduce.Job:  map 2% reduce 0%
16/12/07 11:39:46 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 11:39:47 INFO mapreduce.Job:  map 5% reduce 0%
16/12/07 11:39:50 INFO mapreduce.Job:  map 6% reduce 0%
16/12/07 11:39:54 INFO mapreduce.Job:  map 7% reduce 0%
16/12/07 11:39:55 INFO mapreduce.Job:  map 8% reduce 0%
16/12/07 11:39:58 INFO mapreduce.Job:  map 9% reduce 0%
16/12/07 11:39:59 INFO mapreduce.Job:  map 10% reduce 0%
16/12/07 11:40:05 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 11:40:06 INFO mapreduce.Job:  map 13% reduce 0%
16/12/07 11:40:07 INFO mapreduce.Job:  map 14% reduce 0%
16/12/07 11:40:08 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 11:40:09 INFO mapreduce.Job:  map 18% reduce 0%
16/12/07 11:40:10 INFO mapreduce.Job:  map 21% reduce 0%
16/12/07 11:40:11 INFO mapreduce.Job:  map 23% reduce 0%
16/12/07 11:40:12 INFO mapreduce.Job:  map 25% reduce 0%
16/12/07 11:40:14 INFO mapreduce.Job:  map 25% reduce 1%
16/12/07 11:40:16 INFO mapreduce.Job:  map 26% reduce 1%
16/12/07 11:40:17 INFO mapreduce.Job:  map 28% reduce 1%
16/12/07 11:40:18 INFO mapreduce.Job:  map 29% reduce 1%
16/12/07 11:40:19 INFO mapreduce.Job:  map 30% reduce 1%
16/12/07 11:40:21 INFO mapreduce.Job:  map 31% reduce 1%
16/12/07 11:40:22 INFO mapreduce.Job:  map 31% reduce 2%
16/12/07 11:40:23 INFO mapreduce.Job:  map 34% reduce 2%
16/12/07 11:40:24 INFO mapreduce.Job:  map 36% reduce 3%
16/12/07 11:40:25 INFO mapreduce.Job:  map 37% reduce 3%
16/12/07 11:40:26 INFO mapreduce.Job:  map 38% reduce 3%
16/12/07 11:40:28 INFO mapreduce.Job:  map 40% reduce 5%
16/12/07 11:40:29 INFO mapreduce.Job:  map 41% reduce 5%
16/12/07 11:40:30 INFO mapreduce.Job:  map 43% reduce 6%
16/12/07 11:40:34 INFO mapreduce.Job:  map 44% reduce 6%
16/12/07 11:40:35 INFO mapreduce.Job:  map 46% reduce 6%
16/12/07 11:40:36 INFO mapreduce.Job:  map 48% reduce 7%
16/12/07 11:40:37 INFO mapreduce.Job:  map 49% reduce 8%
16/12/07 11:40:38 INFO mapreduce.Job:  map 49% reduce 9%
16/12/07 11:40:39 INFO mapreduce.Job:  map 51% reduce 10%
16/12/07 11:40:41 INFO mapreduce.Job:  map 52% reduce 10%
16/12/07 11:40:42 INFO mapreduce.Job:  map 53% reduce 10%
16/12/07 11:40:43 INFO mapreduce.Job:  map 54% reduce 11%
16/12/07 11:40:44 INFO mapreduce.Job:  map 54% reduce 12%
16/12/07 11:40:45 INFO mapreduce.Job:  map 56% reduce 12%
16/12/07 11:40:46 INFO mapreduce.Job:  map 56% reduce 13%
16/12/07 11:40:48 INFO mapreduce.Job:  map 58% reduce 13%
16/12/07 11:40:49 INFO mapreduce.Job:  map 60% reduce 13%
16/12/07 11:40:50 INFO mapreduce.Job:  map 60% reduce 14%
16/12/07 11:40:51 INFO mapreduce.Job:  map 62% reduce 16%
16/12/07 11:40:52 INFO mapreduce.Job:  map 63% reduce 16%
16/12/07 11:40:54 INFO mapreduce.Job:  map 64% reduce 17%
16/12/07 11:40:55 INFO mapreduce.Job:  map 65% reduce 17%
16/12/07 11:40:57 INFO mapreduce.Job:  map 66% reduce 17%
16/12/07 11:40:58 INFO mapreduce.Job:  map 68% reduce 17%
16/12/07 11:40:59 INFO mapreduce.Job:  map 70% reduce 18%
16/12/07 11:41:00 INFO mapreduce.Job:  map 71% reduce 18%
16/12/07 11:41:02 INFO mapreduce.Job:  map 72% reduce 19%
16/12/07 11:41:03 INFO mapreduce.Job:  map 73% reduce 19%
16/12/07 11:41:04 INFO mapreduce.Job:  map 74% reduce 19%
16/12/07 11:41:06 INFO mapreduce.Job:  map 75% reduce 20%
16/12/07 11:41:07 INFO mapreduce.Job:  map 77% reduce 20%
16/12/07 11:41:08 INFO mapreduce.Job:  map 79% reduce 20%
16/12/07 11:41:10 INFO mapreduce.Job:  map 79% reduce 21%
16/12/07 11:41:11 INFO mapreduce.Job:  map 80% reduce 21%
16/12/07 11:41:12 INFO mapreduce.Job:  map 81% reduce 21%
16/12/07 11:41:13 INFO mapreduce.Job:  map 82% reduce 21%
16/12/07 11:41:14 INFO mapreduce.Job:  map 82% reduce 22%
16/12/07 11:41:15 INFO mapreduce.Job:  map 84% reduce 22%
16/12/07 11:41:17 INFO mapreduce.Job:  map 86% reduce 22%
16/12/07 11:41:18 INFO mapreduce.Job:  map 86% reduce 23%
16/12/07 11:41:19 INFO mapreduce.Job:  map 88% reduce 23%
16/12/07 11:41:20 INFO mapreduce.Job:  map 89% reduce 23%
16/12/07 11:41:22 INFO mapreduce.Job:  map 90% reduce 24%
16/12/07 11:41:24 INFO mapreduce.Job:  map 91% reduce 24%
16/12/07 11:41:26 INFO mapreduce.Job:  map 92% reduce 24%
16/12/07 11:41:27 INFO mapreduce.Job:  map 93% reduce 24%
16/12/07 11:41:28 INFO mapreduce.Job:  map 93% reduce 25%
16/12/07 11:41:29 INFO mapreduce.Job:  map 95% reduce 25%
16/12/07 11:41:30 INFO mapreduce.Job:  map 96% reduce 25%
16/12/07 11:41:31 INFO mapreduce.Job:  map 97% reduce 25%
16/12/07 11:41:32 INFO mapreduce.Job:  map 97% reduce 26%
16/12/07 11:41:33 INFO mapreduce.Job:  map 98% reduce 26%
16/12/07 11:41:35 INFO mapreduce.Job:  map 99% reduce 26%
16/12/07 11:41:36 INFO mapreduce.Job:  map 100% reduce 26%
16/12/07 11:41:37 INFO mapreduce.Job:  map 100% reduce 28%
16/12/07 11:41:38 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 11:41:39 INFO mapreduce.Job:  map 100% reduce 36%
16/12/07 11:41:40 INFO mapreduce.Job:  map 100% reduce 48%
16/12/07 11:41:41 INFO mapreduce.Job:  map 100% reduce 56%
16/12/07 11:41:42 INFO mapreduce.Job:  map 100% reduce 74%
16/12/07 11:41:43 INFO mapreduce.Job:  map 100% reduce 83%
16/12/07 11:41:44 INFO mapreduce.Job:  map 100% reduce 86%
16/12/07 11:41:45 INFO mapreduce.Job:  map 100% reduce 91%
16/12/07 11:41:46 INFO mapreduce.Job:  map 100% reduce 94%
16/12/07 11:41:47 INFO mapreduce.Job:  map 100% reduce 97%
16/12/07 11:41:49 INFO mapreduce.Job:  map 100% reduce 99%
16/12/07 11:41:50 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 11:41:54 INFO mapreduce.Job: Job job_1480588584072_5074 completed successfully
16/12/07 11:41:54 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=695859622
		FILE: Number of bytes written=1424101209
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=597036887
		WASB: Number of bytes written=350648639
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=4006718
		Total time spent by all reduces in occupied slots (ms)=2936858
		Total time spent by all map tasks (ms)=2003359
		Total time spent by all reduce tasks (ms)=1468429
		Total vcore-seconds taken by all map tasks=2003359
		Total vcore-seconds taken by all reduce tasks=1468429
		Total megabyte-seconds taken by all map tasks=2051439616
		Total megabyte-seconds taken by all reduce tasks=1503671296
	Map-Reduce Framework
		Map input records=1898280
		Map output records=1683890
		Map output bytes=689327446
		Map output materialized bytes=695883142
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1461102
		Reduce shuffle bytes=695883142
		Reduce input records=1683890
		Reduce output records=1026222
		Spilled Records=3367780
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=29532
		CPU time spent (ms)=833950
		Physical memory (bytes) snapshot=323768844288
		Virtual memory (bytes) snapshot=743172030464
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=594340883
	File Output Format Counters 
		Bytes Written=350648639
16/12/07 11:41:54 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060800 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060800
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5748946634495802287.jar tmpDir=null
16/12/07 11:42:32 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 11:42:33 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 11:42:33 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 11:42:35 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 11:42:35 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 11:42:36 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5077
16/12/07 11:42:36 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5077
16/12/07 11:42:36 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5077/
16/12/07 11:42:36 INFO mapreduce.Job: Running job: job_1480588584072_5077
16/12/07 11:53:49 INFO mapreduce.Job: Job job_1480588584072_5077 running in uber mode : false
16/12/07 11:53:49 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 11:54:10 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 11:54:11 INFO mapreduce.Job:  map 2% reduce 0%
16/12/07 11:54:18 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 11:54:28 INFO mapreduce.Job:  map 5% reduce 0%
16/12/07 11:54:37 INFO mapreduce.Job:  map 6% reduce 0%
16/12/07 11:54:46 INFO mapreduce.Job:  map 7% reduce 0%
16/12/07 11:54:47 INFO mapreduce.Job:  map 8% reduce 0%
16/12/07 11:54:56 INFO mapreduce.Job:  map 11% reduce 0%
16/12/07 11:54:57 INFO mapreduce.Job:  map 13% reduce 0%
16/12/07 11:55:03 INFO mapreduce.Job:  map 13% reduce 1%
16/12/07 11:55:04 INFO mapreduce.Job:  map 14% reduce 1%
16/12/07 11:55:05 INFO mapreduce.Job:  map 15% reduce 1%
16/12/07 11:55:06 INFO mapreduce.Job:  map 19% reduce 1%
16/12/07 11:55:07 INFO mapreduce.Job:  map 22% reduce 1%
16/12/07 11:55:09 INFO mapreduce.Job:  map 24% reduce 1%
16/12/07 11:55:10 INFO mapreduce.Job:  map 25% reduce 2%
16/12/07 11:55:13 INFO mapreduce.Job:  map 25% reduce 3%
16/12/07 11:55:16 INFO mapreduce.Job:  map 25% reduce 4%
16/12/07 11:55:19 INFO mapreduce.Job:  map 26% reduce 4%
16/12/07 11:55:20 INFO mapreduce.Job:  map 29% reduce 4%
16/12/07 11:55:21 INFO mapreduce.Job:  map 30% reduce 5%
16/12/07 11:55:22 INFO mapreduce.Job:  map 30% reduce 6%
16/12/07 11:55:23 INFO mapreduce.Job:  map 30% reduce 9%
16/12/07 11:55:24 INFO mapreduce.Job:  map 30% reduce 10%
16/12/07 11:55:28 INFO mapreduce.Job:  map 32% reduce 10%
16/12/07 11:55:31 INFO mapreduce.Job:  map 32% reduce 11%
16/12/07 11:55:32 INFO mapreduce.Job:  map 34% reduce 11%
16/12/07 11:55:33 INFO mapreduce.Job:  map 36% reduce 11%
16/12/07 11:55:35 INFO mapreduce.Job:  map 37% reduce 12%
16/12/07 11:55:38 INFO mapreduce.Job:  map 38% reduce 12%
16/12/07 11:55:41 INFO mapreduce.Job:  map 38% reduce 13%
16/12/07 11:55:42 INFO mapreduce.Job:  map 40% reduce 13%
16/12/07 11:55:44 INFO mapreduce.Job:  map 43% reduce 13%
16/12/07 11:55:45 INFO mapreduce.Job:  map 44% reduce 13%
16/12/07 11:55:46 INFO mapreduce.Job:  map 45% reduce 14%
16/12/07 11:55:48 INFO mapreduce.Job:  map 50% reduce 14%
16/12/07 11:55:49 INFO mapreduce.Job:  map 53% reduce 15%
16/12/07 11:55:50 INFO mapreduce.Job:  map 54% reduce 15%
16/12/07 11:55:51 INFO mapreduce.Job:  map 55% reduce 16%
16/12/07 11:55:52 INFO mapreduce.Job:  map 55% reduce 17%
16/12/07 11:55:53 INFO mapreduce.Job:  map 56% reduce 18%
16/12/07 11:55:54 INFO mapreduce.Job:  map 57% reduce 18%
16/12/07 11:55:55 INFO mapreduce.Job:  map 58% reduce 18%
16/12/07 11:55:57 INFO mapreduce.Job:  map 63% reduce 19%
16/12/07 11:55:58 INFO mapreduce.Job:  map 64% reduce 19%
16/12/07 11:55:59 INFO mapreduce.Job:  map 66% reduce 20%
16/12/07 11:56:00 INFO mapreduce.Job:  map 67% reduce 21%
16/12/07 11:56:02 INFO mapreduce.Job:  map 68% reduce 21%
16/12/07 11:56:03 INFO mapreduce.Job:  map 69% reduce 22%
16/12/07 11:56:04 INFO mapreduce.Job:  map 72% reduce 22%
16/12/07 11:56:05 INFO mapreduce.Job:  map 73% reduce 23%
16/12/07 11:56:06 INFO mapreduce.Job:  map 74% reduce 23%
16/12/07 11:56:07 INFO mapreduce.Job:  map 75% reduce 24%
16/12/07 11:56:08 INFO mapreduce.Job:  map 76% reduce 24%
16/12/07 11:56:09 INFO mapreduce.Job:  map 79% reduce 25%
16/12/07 11:56:10 INFO mapreduce.Job:  map 80% reduce 25%
16/12/07 11:56:11 INFO mapreduce.Job:  map 80% reduce 26%
16/12/07 11:56:12 INFO mapreduce.Job:  map 81% reduce 26%
16/12/07 11:56:14 INFO mapreduce.Job:  map 81% reduce 27%
16/12/07 11:56:23 INFO mapreduce.Job:  map 82% reduce 27%
16/12/07 11:56:27 INFO mapreduce.Job:  map 83% reduce 27%
16/12/07 11:56:28 INFO mapreduce.Job:  map 85% reduce 27%
16/12/07 11:56:29 INFO mapreduce.Job:  map 87% reduce 28%
16/12/07 11:56:30 INFO mapreduce.Job:  map 89% reduce 28%
16/12/07 11:56:31 INFO mapreduce.Job:  map 89% reduce 29%
16/12/07 11:56:32 INFO mapreduce.Job:  map 91% reduce 29%
16/12/07 11:56:33 INFO mapreduce.Job:  map 91% reduce 30%
16/12/07 11:56:34 INFO mapreduce.Job:  map 94% reduce 30%
16/12/07 11:56:35 INFO mapreduce.Job:  map 96% reduce 30%
16/12/07 11:56:36 INFO mapreduce.Job:  map 97% reduce 31%
16/12/07 11:56:37 INFO mapreduce.Job:  map 99% reduce 32%
16/12/07 11:56:38 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 11:56:39 INFO mapreduce.Job:  map 100% reduce 36%
16/12/07 11:56:40 INFO mapreduce.Job:  map 100% reduce 45%
16/12/07 11:56:41 INFO mapreduce.Job:  map 100% reduce 53%
16/12/07 11:56:42 INFO mapreduce.Job:  map 100% reduce 64%
16/12/07 11:56:43 INFO mapreduce.Job:  map 100% reduce 69%
16/12/07 11:56:44 INFO mapreduce.Job:  map 100% reduce 74%
16/12/07 11:56:45 INFO mapreduce.Job:  map 100% reduce 79%
16/12/07 11:56:46 INFO mapreduce.Job:  map 100% reduce 83%
16/12/07 11:56:47 INFO mapreduce.Job:  map 100% reduce 88%
16/12/07 11:56:48 INFO mapreduce.Job:  map 100% reduce 94%
16/12/07 11:56:49 INFO mapreduce.Job:  map 100% reduce 98%
16/12/07 11:56:50 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 11:56:52 INFO mapreduce.Job: Job job_1480588584072_5077 completed successfully
16/12/07 11:56:52 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=772072370
		FILE: Number of bytes written=1576526705
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=660208454
		WASB: Number of bytes written=404561708
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13091896
		Total time spent by all reduces in occupied slots (ms)=4178578
		Total time spent by all map tasks (ms)=6545948
		Total time spent by all reduce tasks (ms)=2089289
		Total vcore-seconds taken by all map tasks=6545948
		Total vcore-seconds taken by all reduce tasks=2089289
		Total megabyte-seconds taken by all map tasks=6703050752
		Total megabyte-seconds taken by all reduce tasks=2139431936
	Map-Reduce Framework
		Map input records=2094349
		Map output records=1867973
		Map output bytes=764840131
		Map output materialized bytes=772095890
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1629207
		Reduce shuffle bytes=772095890
		Reduce input records=1867973
		Reduce output records=1187248
		Spilled Records=3735946
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=66060
		CPU time spent (ms)=925080
		Physical memory (bytes) snapshot=324436713472
		Virtual memory (bytes) snapshot=742997405696
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=657512450
	File Output Format Counters 
		Bytes Written=404561708
16/12/07 11:56:52 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060900 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060900
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5533593732039344037.jar tmpDir=null
16/12/07 11:57:31 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 11:57:32 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 11:57:32 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 11:57:34 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 11:57:34 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 11:57:35 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5082
16/12/07 11:57:35 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5082
16/12/07 11:57:35 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5082/
16/12/07 11:57:35 INFO mapreduce.Job: Running job: job_1480588584072_5082
16/12/07 11:58:00 INFO mapreduce.Job: Job job_1480588584072_5082 running in uber mode : false
16/12/07 11:58:00 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 11:58:11 INFO mapreduce.Job:  map 2% reduce 0%
16/12/07 11:58:12 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 11:58:20 INFO mapreduce.Job:  map 5% reduce 0%
16/12/07 11:58:23 INFO mapreduce.Job:  map 8% reduce 0%
16/12/07 11:58:24 INFO mapreduce.Job:  map 11% reduce 0%
16/12/07 11:58:25 INFO mapreduce.Job:  map 13% reduce 0%
16/12/07 11:58:29 INFO mapreduce.Job:  map 14% reduce 0%
16/12/07 11:58:30 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 11:58:31 INFO mapreduce.Job:  map 16% reduce 0%
16/12/07 11:58:34 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 11:58:35 INFO mapreduce.Job:  map 18% reduce 0%
16/12/07 11:58:36 INFO mapreduce.Job:  map 19% reduce 1%
16/12/07 11:58:37 INFO mapreduce.Job:  map 21% reduce 1%
16/12/07 11:58:40 INFO mapreduce.Job:  map 21% reduce 3%
16/12/07 11:58:42 INFO mapreduce.Job:  map 23% reduce 3%
16/12/07 11:58:43 INFO mapreduce.Job:  map 23% reduce 4%
16/12/07 11:58:45 INFO mapreduce.Job:  map 24% reduce 4%
16/12/07 11:58:46 INFO mapreduce.Job:  map 26% reduce 5%
16/12/07 11:58:47 INFO mapreduce.Job:  map 28% reduce 5%
16/12/07 11:58:48 INFO mapreduce.Job:  map 31% reduce 6%
16/12/07 11:58:50 INFO mapreduce.Job:  map 32% reduce 7%
16/12/07 11:58:51 INFO mapreduce.Job:  map 33% reduce 7%
16/12/07 11:58:52 INFO mapreduce.Job:  map 33% reduce 8%
16/12/07 11:58:54 INFO mapreduce.Job:  map 34% reduce 8%
16/12/07 11:58:55 INFO mapreduce.Job:  map 35% reduce 8%
16/12/07 11:58:56 INFO mapreduce.Job:  map 35% reduce 9%
16/12/07 11:58:57 INFO mapreduce.Job:  map 36% reduce 9%
16/12/07 11:58:58 INFO mapreduce.Job:  map 37% reduce 9%
16/12/07 11:58:59 INFO mapreduce.Job:  map 38% reduce 9%
16/12/07 11:59:01 INFO mapreduce.Job:  map 39% reduce 9%
16/12/07 11:59:02 INFO mapreduce.Job:  map 40% reduce 9%
16/12/07 11:59:03 INFO mapreduce.Job:  map 41% reduce 10%
16/12/07 11:59:04 INFO mapreduce.Job:  map 44% reduce 10%
16/12/07 11:59:05 INFO mapreduce.Job:  map 45% reduce 10%
16/12/07 11:59:06 INFO mapreduce.Job:  map 47% reduce 11%
16/12/07 11:59:07 INFO mapreduce.Job:  map 49% reduce 11%
16/12/07 11:59:08 INFO mapreduce.Job:  map 49% reduce 12%
16/12/07 11:59:09 INFO mapreduce.Job:  map 50% reduce 12%
16/12/07 11:59:11 INFO mapreduce.Job:  map 51% reduce 13%
16/12/07 11:59:12 INFO mapreduce.Job:  map 54% reduce 13%
16/12/07 11:59:13 INFO mapreduce.Job:  map 55% reduce 13%
16/12/07 11:59:14 INFO mapreduce.Job:  map 57% reduce 14%
16/12/07 11:59:15 INFO mapreduce.Job:  map 61% reduce 14%
16/12/07 11:59:16 INFO mapreduce.Job:  map 62% reduce 14%
16/12/07 11:59:17 INFO mapreduce.Job:  map 64% reduce 15%
16/12/07 11:59:18 INFO mapreduce.Job:  map 64% reduce 16%
16/12/07 11:59:19 INFO mapreduce.Job:  map 66% reduce 16%
16/12/07 11:59:20 INFO mapreduce.Job:  map 68% reduce 17%
16/12/07 11:59:21 INFO mapreduce.Job:  map 69% reduce 20%
16/12/07 11:59:22 INFO mapreduce.Job:  map 71% reduce 20%
16/12/07 11:59:23 INFO mapreduce.Job:  map 72% reduce 20%
16/12/07 11:59:24 INFO mapreduce.Job:  map 74% reduce 21%
16/12/07 11:59:25 INFO mapreduce.Job:  map 76% reduce 21%
16/12/07 11:59:26 INFO mapreduce.Job:  map 76% reduce 22%
16/12/07 11:59:28 INFO mapreduce.Job:  map 76% reduce 23%
16/12/07 11:59:29 INFO mapreduce.Job:  map 76% reduce 24%
16/12/07 11:59:31 INFO mapreduce.Job:  map 76% reduce 25%
16/12/07 11:59:33 INFO mapreduce.Job:  map 77% reduce 25%
16/12/07 11:59:36 INFO mapreduce.Job:  map 77% reduce 26%
16/12/07 11:59:42 INFO mapreduce.Job:  map 78% reduce 26%
16/12/07 11:59:43 INFO mapreduce.Job:  map 79% reduce 26%
16/12/07 11:59:46 INFO mapreduce.Job:  map 80% reduce 26%
16/12/07 11:59:48 INFO mapreduce.Job:  map 81% reduce 27%
16/12/07 11:59:50 INFO mapreduce.Job:  map 82% reduce 27%
16/12/07 11:59:51 INFO mapreduce.Job:  map 84% reduce 27%
16/12/07 11:59:53 INFO mapreduce.Job:  map 85% reduce 28%
16/12/07 11:59:54 INFO mapreduce.Job:  map 87% reduce 28%
16/12/07 11:59:55 INFO mapreduce.Job:  map 89% reduce 28%
16/12/07 11:59:56 INFO mapreduce.Job:  map 90% reduce 29%
16/12/07 11:59:57 INFO mapreduce.Job:  map 91% reduce 29%
16/12/07 11:59:59 INFO mapreduce.Job:  map 92% reduce 30%
16/12/07 12:00:00 INFO mapreduce.Job:  map 93% reduce 30%
16/12/07 12:00:01 INFO mapreduce.Job:  map 95% reduce 30%
16/12/07 12:00:02 INFO mapreduce.Job:  map 97% reduce 31%
16/12/07 12:00:04 INFO mapreduce.Job:  map 99% reduce 32%
16/12/07 12:00:05 INFO mapreduce.Job:  map 100% reduce 32%
16/12/07 12:00:06 INFO mapreduce.Job:  map 100% reduce 34%
16/12/07 12:00:07 INFO mapreduce.Job:  map 100% reduce 39%
16/12/07 12:00:08 INFO mapreduce.Job:  map 100% reduce 53%
16/12/07 12:00:09 INFO mapreduce.Job:  map 100% reduce 66%
16/12/07 12:00:10 INFO mapreduce.Job:  map 100% reduce 72%
16/12/07 12:00:11 INFO mapreduce.Job:  map 100% reduce 79%
16/12/07 12:00:12 INFO mapreduce.Job:  map 100% reduce 86%
16/12/07 12:00:13 INFO mapreduce.Job:  map 100% reduce 94%
16/12/07 12:00:14 INFO mapreduce.Job:  map 100% reduce 97%
16/12/07 12:00:15 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 12:00:17 INFO mapreduce.Job: Job job_1480588584072_5082 completed successfully
16/12/07 12:00:17 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=732384167
		FILE: Number of bytes written=1497150299
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=630246309
		WASB: Number of bytes written=373710358
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12771772
		Total time spent by all reduces in occupied slots (ms)=4028096
		Total time spent by all map tasks (ms)=6385886
		Total time spent by all reduce tasks (ms)=2014048
		Total vcore-seconds taken by all map tasks=6385886
		Total vcore-seconds taken by all reduce tasks=2014048
		Total megabyte-seconds taken by all map tasks=6539147264
		Total megabyte-seconds taken by all reduce tasks=2062385152
	Map-Reduce Framework
		Map input records=2001116
		Map output records=1770663
		Map output bytes=725517644
		Map output materialized bytes=732407687
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1536567
		Reduce shuffle bytes=732407687
		Reduce input records=1770663
		Reduce output records=1092795
		Spilled Records=3541326
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=88746
		CPU time spent (ms)=930900
		Physical memory (bytes) snapshot=324303831040
		Virtual memory (bytes) snapshot=742610972672
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=627550305
	File Output Format Counters 
		Bytes Written=373710358
16/12/07 12:00:17 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1400 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1400': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5206826807180573851.jar tmpDir=null
16/12/07 12:00:56 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:00:57 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:00:58 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 12:00:59 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 12:01:00 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 12:01:00 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5086
16/12/07 12:01:01 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5086
16/12/07 12:01:01 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5086/
16/12/07 12:01:01 INFO mapreduce.Job: Running job: job_1480588584072_5086
16/12/07 12:03:55 INFO mapreduce.Job: Job job_1480588584072_5086 running in uber mode : false
16/12/07 12:03:55 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 12:04:16 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 12:04:19 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 12:04:20 INFO mapreduce.Job:  map 6% reduce 0%
16/12/07 12:04:24 INFO mapreduce.Job:  map 7% reduce 0%
16/12/07 12:04:25 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 12:04:29 INFO mapreduce.Job:  map 16% reduce 0%
16/12/07 12:04:31 INFO mapreduce.Job:  map 18% reduce 0%
16/12/07 12:04:36 INFO mapreduce.Job:  map 20% reduce 0%
16/12/07 12:04:37 INFO mapreduce.Job:  map 22% reduce 0%
16/12/07 12:04:38 INFO mapreduce.Job:  map 24% reduce 0%
16/12/07 12:04:40 INFO mapreduce.Job:  map 26% reduce 0%
16/12/07 12:04:42 INFO mapreduce.Job:  map 27% reduce 0%
16/12/07 12:04:43 INFO mapreduce.Job:  map 30% reduce 1%
16/12/07 12:04:44 INFO mapreduce.Job:  map 31% reduce 1%
16/12/07 12:04:45 INFO mapreduce.Job:  map 33% reduce 1%
16/12/07 12:04:46 INFO mapreduce.Job:  map 35% reduce 4%
16/12/07 12:04:48 INFO mapreduce.Job:  map 37% reduce 4%
16/12/07 12:04:49 INFO mapreduce.Job:  map 38% reduce 5%
16/12/07 12:04:52 INFO mapreduce.Job:  map 41% reduce 8%
16/12/07 12:04:55 INFO mapreduce.Job:  map 42% reduce 12%
16/12/07 12:04:56 INFO mapreduce.Job:  map 43% reduce 12%
16/12/07 12:04:58 INFO mapreduce.Job:  map 46% reduce 13%
16/12/07 12:05:01 INFO mapreduce.Job:  map 46% reduce 14%
16/12/07 12:05:06 INFO mapreduce.Job:  map 47% reduce 14%
16/12/07 12:05:07 INFO mapreduce.Job:  map 48% reduce 15%
16/12/07 12:05:10 INFO mapreduce.Job:  map 49% reduce 15%
16/12/07 12:05:11 INFO mapreduce.Job:  map 49% reduce 16%
16/12/07 12:05:12 INFO mapreduce.Job:  map 50% reduce 16%
16/12/07 12:05:13 INFO mapreduce.Job:  map 52% reduce 16%
16/12/07 12:05:15 INFO mapreduce.Job:  map 54% reduce 16%
16/12/07 12:05:17 INFO mapreduce.Job:  map 56% reduce 17%
16/12/07 12:05:18 INFO mapreduce.Job:  map 58% reduce 17%
16/12/07 12:05:19 INFO mapreduce.Job:  map 59% reduce 17%
16/12/07 12:05:20 INFO mapreduce.Job:  map 60% reduce 18%
16/12/07 12:05:21 INFO mapreduce.Job:  map 63% reduce 19%
16/12/07 12:05:23 INFO mapreduce.Job:  map 64% reduce 19%
16/12/07 12:05:24 INFO mapreduce.Job:  map 65% reduce 20%
16/12/07 12:05:25 INFO mapreduce.Job:  map 67% reduce 20%
16/12/07 12:05:26 INFO mapreduce.Job:  map 67% reduce 21%
16/12/07 12:05:27 INFO mapreduce.Job:  map 69% reduce 21%
16/12/07 12:05:28 INFO mapreduce.Job:  map 71% reduce 22%
16/12/07 12:05:30 INFO mapreduce.Job:  map 71% reduce 23%
16/12/07 12:05:31 INFO mapreduce.Job:  map 72% reduce 23%
16/12/07 12:05:32 INFO mapreduce.Job:  map 73% reduce 23%
16/12/07 12:05:33 INFO mapreduce.Job:  map 74% reduce 24%
16/12/07 12:05:35 INFO mapreduce.Job:  map 77% reduce 24%
16/12/07 12:05:36 INFO mapreduce.Job:  map 78% reduce 25%
16/12/07 12:05:38 INFO mapreduce.Job:  map 83% reduce 26%
16/12/07 12:05:39 INFO mapreduce.Job:  map 84% reduce 26%
16/12/07 12:05:40 INFO mapreduce.Job:  map 85% reduce 26%
16/12/07 12:05:41 INFO mapreduce.Job:  map 85% reduce 27%
16/12/07 12:05:42 INFO mapreduce.Job:  map 85% reduce 28%
16/12/07 12:05:43 INFO mapreduce.Job:  map 86% reduce 28%
16/12/07 12:05:47 INFO mapreduce.Job:  map 86% reduce 29%
16/12/07 12:05:57 INFO mapreduce.Job:  map 87% reduce 29%
16/12/07 12:06:01 INFO mapreduce.Job:  map 88% reduce 29%
16/12/07 12:06:03 INFO mapreduce.Job:  map 89% reduce 29%
16/12/07 12:06:05 INFO mapreduce.Job:  map 90% reduce 29%
16/12/07 12:06:07 INFO mapreduce.Job:  map 91% reduce 30%
16/12/07 12:06:08 INFO mapreduce.Job:  map 92% reduce 30%
16/12/07 12:06:10 INFO mapreduce.Job:  map 93% reduce 30%
16/12/07 12:06:11 INFO mapreduce.Job:  map 94% reduce 30%
16/12/07 12:06:12 INFO mapreduce.Job:  map 95% reduce 31%
16/12/07 12:06:14 INFO mapreduce.Job:  map 97% reduce 31%
16/12/07 12:06:15 INFO mapreduce.Job:  map 97% reduce 32%
16/12/07 12:06:17 INFO mapreduce.Job:  map 98% reduce 32%
16/12/07 12:06:19 INFO mapreduce.Job:  map 99% reduce 32%
16/12/07 12:06:20 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 12:06:22 INFO mapreduce.Job:  map 100% reduce 35%
16/12/07 12:06:23 INFO mapreduce.Job:  map 100% reduce 53%
16/12/07 12:06:25 INFO mapreduce.Job:  map 100% reduce 68%
16/12/07 12:06:26 INFO mapreduce.Job:  map 100% reduce 69%
16/12/07 12:06:27 INFO mapreduce.Job:  map 100% reduce 78%
16/12/07 12:06:28 INFO mapreduce.Job:  map 100% reduce 89%
16/12/07 12:06:29 INFO mapreduce.Job:  map 100% reduce 91%
16/12/07 12:06:30 INFO mapreduce.Job:  map 100% reduce 93%
16/12/07 12:06:31 INFO mapreduce.Job:  map 100% reduce 97%
16/12/07 12:06:32 INFO mapreduce.Job:  map 100% reduce 98%
16/12/07 12:06:33 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 12:06:37 INFO mapreduce.Job: Job job_1480588584072_5086 completed successfully
16/12/07 12:06:37 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=696225932
		FILE: Number of bytes written=1424833829
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=602994344
		WASB: Number of bytes written=344351117
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13802950
		Total time spent by all reduces in occupied slots (ms)=4543916
		Total time spent by all map tasks (ms)=6901475
		Total time spent by all reduce tasks (ms)=2271958
		Total vcore-seconds taken by all map tasks=6901475
		Total vcore-seconds taken by all reduce tasks=2271958
		Total megabyte-seconds taken by all map tasks=7067110400
		Total megabyte-seconds taken by all reduce tasks=2326484992
	Map-Reduce Framework
		Map input records=1920626
		Map output records=1685054
		Map output bytes=689686059
		Map output materialized bytes=696249452
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1455391
		Reduce shuffle bytes=696249452
		Reduce input records=1685054
		Reduce output records=1006317
		Spilled Records=3370108
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=74617
		CPU time spent (ms)=935740
		Physical memory (bytes) snapshot=324297814016
		Virtual memory (bytes) snapshot=742718636032
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=600298340
	File Output Format Counters 
		Bytes Written=344351117
16/12/07 12:06:37 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1400
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1500 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1500': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3615099933267019709.jar tmpDir=null
16/12/07 12:07:14 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:07:15 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:07:15 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 12:07:17 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 12:07:17 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 12:07:17 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5090
16/12/07 12:07:18 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5090
16/12/07 12:07:18 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5090/
16/12/07 12:07:18 INFO mapreduce.Job: Running job: job_1480588584072_5090
16/12/07 12:09:13 INFO mapreduce.Job: Job job_1480588584072_5090 running in uber mode : false
16/12/07 12:09:13 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 12:09:22 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 12:09:28 INFO mapreduce.Job:  map 2% reduce 0%
16/12/07 12:09:35 INFO mapreduce.Job:  map 5% reduce 0%
16/12/07 12:09:36 INFO mapreduce.Job:  map 7% reduce 0%
16/12/07 12:09:37 INFO mapreduce.Job:  map 9% reduce 0%
16/12/07 12:09:38 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 12:09:40 INFO mapreduce.Job:  map 13% reduce 0%
16/12/07 12:09:49 INFO mapreduce.Job:  map 16% reduce 0%
16/12/07 12:09:50 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 12:09:54 INFO mapreduce.Job:  map 17% reduce 1%
16/12/07 12:09:55 INFO mapreduce.Job:  map 17% reduce 2%
16/12/07 12:09:57 INFO mapreduce.Job:  map 18% reduce 2%
16/12/07 12:10:01 INFO mapreduce.Job:  map 20% reduce 2%
16/12/07 12:10:03 INFO mapreduce.Job:  map 20% reduce 3%
16/12/07 12:10:07 INFO mapreduce.Job:  map 20% reduce 4%
16/12/07 12:10:09 INFO mapreduce.Job:  map 21% reduce 4%
16/12/07 12:10:16 INFO mapreduce.Job:  map 22% reduce 4%
16/12/07 12:10:19 INFO mapreduce.Job:  map 23% reduce 5%
16/12/07 12:10:22 INFO mapreduce.Job:  map 24% reduce 5%
16/12/07 12:10:24 INFO mapreduce.Job:  map 25% reduce 5%
16/12/07 12:10:25 INFO mapreduce.Job:  map 27% reduce 5%
16/12/07 12:10:26 INFO mapreduce.Job:  map 28% reduce 6%
16/12/07 12:10:27 INFO mapreduce.Job:  map 29% reduce 6%
16/12/07 12:10:28 INFO mapreduce.Job:  map 30% reduce 6%
16/12/07 12:10:29 INFO mapreduce.Job:  map 31% reduce 7%
16/12/07 12:10:32 INFO mapreduce.Job:  map 33% reduce 7%
16/12/07 12:10:33 INFO mapreduce.Job:  map 35% reduce 7%
16/12/07 12:10:34 INFO mapreduce.Job:  map 37% reduce 7%
16/12/07 12:10:35 INFO mapreduce.Job:  map 39% reduce 8%
16/12/07 12:10:36 INFO mapreduce.Job:  map 41% reduce 8%
16/12/07 12:10:37 INFO mapreduce.Job:  map 42% reduce 9%
16/12/07 12:10:38 INFO mapreduce.Job:  map 43% reduce 9%
16/12/07 12:10:39 INFO mapreduce.Job:  map 44% reduce 10%
16/12/07 12:10:40 INFO mapreduce.Job:  map 47% reduce 10%
16/12/07 12:10:41 INFO mapreduce.Job:  map 48% reduce 10%
16/12/07 12:10:42 INFO mapreduce.Job:  map 49% reduce 10%
16/12/07 12:10:43 INFO mapreduce.Job:  map 53% reduce 11%
16/12/07 12:10:44 INFO mapreduce.Job:  map 55% reduce 11%
16/12/07 12:10:45 INFO mapreduce.Job:  map 56% reduce 12%
16/12/07 12:10:46 INFO mapreduce.Job:  map 58% reduce 12%
16/12/07 12:10:47 INFO mapreduce.Job:  map 58% reduce 13%
16/12/07 12:10:49 INFO mapreduce.Job:  map 59% reduce 14%
16/12/07 12:10:52 INFO mapreduce.Job:  map 60% reduce 14%
16/12/07 12:10:53 INFO mapreduce.Job:  map 61% reduce 15%
16/12/07 12:10:58 INFO mapreduce.Job:  map 62% reduce 15%
16/12/07 12:11:00 INFO mapreduce.Job:  map 63% reduce 15%
16/12/07 12:11:01 INFO mapreduce.Job:  map 65% reduce 16%
16/12/07 12:11:02 INFO mapreduce.Job:  map 68% reduce 17%
16/12/07 12:11:04 INFO mapreduce.Job:  map 68% reduce 18%
16/12/07 12:11:06 INFO mapreduce.Job:  map 68% reduce 19%
16/12/07 12:11:07 INFO mapreduce.Job:  map 69% reduce 19%
16/12/07 12:11:16 INFO mapreduce.Job:  map 70% reduce 19%
16/12/07 12:11:17 INFO mapreduce.Job:  map 71% reduce 19%
16/12/07 12:11:18 INFO mapreduce.Job:  map 74% reduce 20%
16/12/07 12:11:19 INFO mapreduce.Job:  map 78% reduce 20%
16/12/07 12:11:20 INFO mapreduce.Job:  map 79% reduce 22%
16/12/07 12:11:21 INFO mapreduce.Job:  map 81% reduce 23%
16/12/07 12:11:22 INFO mapreduce.Job:  map 81% reduce 25%
16/12/07 12:11:24 INFO mapreduce.Job:  map 82% reduce 25%
16/12/07 12:11:25 INFO mapreduce.Job:  map 82% reduce 26%
16/12/07 12:11:26 INFO mapreduce.Job:  map 83% reduce 26%
16/12/07 12:11:27 INFO mapreduce.Job:  map 84% reduce 26%
16/12/07 12:11:28 INFO mapreduce.Job:  map 86% reduce 26%
16/12/07 12:11:29 INFO mapreduce.Job:  map 87% reduce 26%
16/12/07 12:11:30 INFO mapreduce.Job:  map 89% reduce 27%
16/12/07 12:11:31 INFO mapreduce.Job:  map 91% reduce 27%
16/12/07 12:11:32 INFO mapreduce.Job:  map 93% reduce 28%
16/12/07 12:11:33 INFO mapreduce.Job:  map 94% reduce 28%
16/12/07 12:11:34 INFO mapreduce.Job:  map 95% reduce 29%
16/12/07 12:11:35 INFO mapreduce.Job:  map 97% reduce 29%
16/12/07 12:11:36 INFO mapreduce.Job:  map 98% reduce 30%
16/12/07 12:11:38 INFO mapreduce.Job:  map 98% reduce 31%
16/12/07 12:11:39 INFO mapreduce.Job:  map 99% reduce 33%
16/12/07 12:11:43 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 12:11:44 INFO mapreduce.Job:  map 100% reduce 35%
16/12/07 12:11:45 INFO mapreduce.Job:  map 100% reduce 39%
16/12/07 12:11:46 INFO mapreduce.Job:  map 100% reduce 45%
16/12/07 12:11:47 INFO mapreduce.Job:  map 100% reduce 53%
16/12/07 12:11:48 INFO mapreduce.Job:  map 100% reduce 61%
16/12/07 12:11:49 INFO mapreduce.Job:  map 100% reduce 69%
16/12/07 12:11:50 INFO mapreduce.Job:  map 100% reduce 71%
16/12/07 12:11:51 INFO mapreduce.Job:  map 100% reduce 75%
16/12/07 12:11:52 INFO mapreduce.Job:  map 100% reduce 78%
16/12/07 12:11:53 INFO mapreduce.Job:  map 100% reduce 81%
16/12/07 12:11:54 INFO mapreduce.Job:  map 100% reduce 86%
16/12/07 12:11:55 INFO mapreduce.Job:  map 100% reduce 91%
16/12/07 12:11:56 INFO mapreduce.Job:  map 100% reduce 96%
16/12/07 12:11:57 INFO mapreduce.Job:  map 100% reduce 98%
16/12/07 12:11:58 INFO mapreduce.Job:  map 100% reduce 99%
16/12/07 12:11:59 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 12:12:02 INFO mapreduce.Job: Job job_1480588584072_5090 completed successfully
16/12/07 12:12:02 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=805481067
		FILE: Number of bytes written=1643344099
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=690167291
		WASB: Number of bytes written=431366864
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=16898088
		Total time spent by all reduces in occupied slots (ms)=4633926
		Total time spent by all map tasks (ms)=8449044
		Total time spent by all reduce tasks (ms)=2316963
		Total vcore-seconds taken by all map tasks=8449044
		Total vcore-seconds taken by all reduce tasks=2316963
		Total megabyte-seconds taken by all map tasks=8651821056
		Total megabyte-seconds taken by all reduce tasks=2372570112
	Map-Reduce Framework
		Map input records=2178857
		Map output records=1941848
		Map output bytes=797957347
		Map output materialized bytes=805504587
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1700994
		Reduce shuffle bytes=805504587
		Reduce input records=1941848
		Reduce output records=1259177
		Spilled Records=3883696
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=88840
		CPU time spent (ms)=973960
		Physical memory (bytes) snapshot=324904955904
		Virtual memory (bytes) snapshot=742794432512
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=687471287
	File Output Format Counters 
		Bytes Written=431366864
16/12/07 12:12:02 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1500
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1600 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1600': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob869952865854443144.jar tmpDir=null
16/12/07 12:12:40 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:12:41 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:12:42 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 12:12:44 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 12:12:44 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 12:12:44 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5093
16/12/07 12:12:45 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5093
16/12/07 12:12:45 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5093/
16/12/07 12:12:45 INFO mapreduce.Job: Running job: job_1480588584072_5093
16/12/07 12:12:58 INFO mapreduce.Job: Job job_1480588584072_5093 running in uber mode : false
16/12/07 12:12:58 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 12:13:15 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 12:13:26 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 12:13:27 INFO mapreduce.Job:  map 4% reduce 0%
16/12/07 12:13:35 INFO mapreduce.Job:  map 5% reduce 0%
16/12/07 12:13:37 INFO mapreduce.Job:  map 7% reduce 0%
16/12/07 12:13:41 INFO mapreduce.Job:  map 10% reduce 0%
16/12/07 12:13:47 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 12:13:52 INFO mapreduce.Job:  map 16% reduce 0%
16/12/07 12:13:54 INFO mapreduce.Job:  map 20% reduce 0%
16/12/07 12:13:57 INFO mapreduce.Job:  map 23% reduce 1%
16/12/07 12:13:59 INFO mapreduce.Job:  map 25% reduce 1%
16/12/07 12:14:01 INFO mapreduce.Job:  map 26% reduce 2%
16/12/07 12:14:02 INFO mapreduce.Job:  map 27% reduce 2%
16/12/07 12:14:08 INFO mapreduce.Job:  map 28% reduce 3%
16/12/07 12:14:09 INFO mapreduce.Job:  map 29% reduce 5%
16/12/07 12:14:10 INFO mapreduce.Job:  map 30% reduce 6%
16/12/07 12:14:13 INFO mapreduce.Job:  map 31% reduce 8%
16/12/07 12:14:14 INFO mapreduce.Job:  map 33% reduce 9%
16/12/07 12:14:16 INFO mapreduce.Job:  map 34% reduce 9%
16/12/07 12:14:19 INFO mapreduce.Job:  map 35% reduce 11%
16/12/07 12:14:21 INFO mapreduce.Job:  map 38% reduce 11%
16/12/07 12:14:23 INFO mapreduce.Job:  map 40% reduce 11%
16/12/07 12:14:24 INFO mapreduce.Job:  map 40% reduce 12%
16/12/07 12:14:25 INFO mapreduce.Job:  map 42% reduce 12%
16/12/07 12:14:26 INFO mapreduce.Job:  map 43% reduce 12%
16/12/07 12:14:27 INFO mapreduce.Job:  map 47% reduce 13%
16/12/07 12:14:28 INFO mapreduce.Job:  map 51% reduce 13%
16/12/07 12:14:29 INFO mapreduce.Job:  map 53% reduce 14%
16/12/07 12:14:30 INFO mapreduce.Job:  map 55% reduce 14%
16/12/07 12:14:32 INFO mapreduce.Job:  map 55% reduce 16%
16/12/07 12:14:34 INFO mapreduce.Job:  map 56% reduce 17%
16/12/07 12:14:36 INFO mapreduce.Job:  map 58% reduce 18%
16/12/07 12:14:37 INFO mapreduce.Job:  map 60% reduce 18%
16/12/07 12:14:38 INFO mapreduce.Job:  map 61% reduce 19%
16/12/07 12:14:40 INFO mapreduce.Job:  map 62% reduce 19%
16/12/07 12:14:41 INFO mapreduce.Job:  map 64% reduce 19%
16/12/07 12:14:42 INFO mapreduce.Job:  map 64% reduce 20%
16/12/07 12:14:43 INFO mapreduce.Job:  map 65% reduce 21%
16/12/07 12:14:44 INFO mapreduce.Job:  map 66% reduce 21%
16/12/07 12:14:45 INFO mapreduce.Job:  map 68% reduce 21%
16/12/07 12:14:46 INFO mapreduce.Job:  map 69% reduce 21%
16/12/07 12:14:47 INFO mapreduce.Job:  map 72% reduce 22%
16/12/07 12:14:49 INFO mapreduce.Job:  map 74% reduce 22%
16/12/07 12:14:51 INFO mapreduce.Job:  map 78% reduce 23%
16/12/07 12:14:52 INFO mapreduce.Job:  map 80% reduce 23%
16/12/07 12:14:54 INFO mapreduce.Job:  map 82% reduce 24%
16/12/07 12:14:55 INFO mapreduce.Job:  map 84% reduce 26%
16/12/07 12:14:58 INFO mapreduce.Job:  map 84% reduce 28%
16/12/07 12:15:02 INFO mapreduce.Job:  map 86% reduce 28%
16/12/07 12:15:03 INFO mapreduce.Job:  map 88% reduce 28%
16/12/07 12:15:06 INFO mapreduce.Job:  map 89% reduce 29%
16/12/07 12:15:08 INFO mapreduce.Job:  map 90% reduce 29%
16/12/07 12:15:10 INFO mapreduce.Job:  map 91% reduce 29%
16/12/07 12:15:11 INFO mapreduce.Job:  map 91% reduce 30%
16/12/07 12:15:14 INFO mapreduce.Job:  map 92% reduce 30%
16/12/07 12:15:17 INFO mapreduce.Job:  map 93% reduce 30%
16/12/07 12:15:18 INFO mapreduce.Job:  map 95% reduce 30%
16/12/07 12:15:19 INFO mapreduce.Job:  map 96% reduce 31%
16/12/07 12:15:20 INFO mapreduce.Job:  map 98% reduce 31%
16/12/07 12:15:21 INFO mapreduce.Job:  map 99% reduce 31%
16/12/07 12:15:22 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 12:15:25 INFO mapreduce.Job:  map 100% reduce 55%
16/12/07 12:15:26 INFO mapreduce.Job:  map 100% reduce 59%
16/12/07 12:15:27 INFO mapreduce.Job:  map 100% reduce 66%
16/12/07 12:15:28 INFO mapreduce.Job:  map 100% reduce 78%
16/12/07 12:15:29 INFO mapreduce.Job:  map 100% reduce 80%
16/12/07 12:15:30 INFO mapreduce.Job:  map 100% reduce 87%
16/12/07 12:15:31 INFO mapreduce.Job:  map 100% reduce 96%
16/12/07 12:15:32 INFO mapreduce.Job:  map 100% reduce 97%
16/12/07 12:15:33 INFO mapreduce.Job:  map 100% reduce 98%
16/12/07 12:15:34 INFO mapreduce.Job:  map 100% reduce 99%
16/12/07 12:15:37 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 12:15:42 INFO mapreduce.Job: Job job_1480588584072_5093 completed successfully
16/12/07 12:15:42 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=686404992
		FILE: Number of bytes written=1405191949
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=599984767
		WASB: Number of bytes written=323361618
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12044268
		Total time spent by all reduces in occupied slots (ms)=3912116
		Total time spent by all map tasks (ms)=6022134
		Total time spent by all reduce tasks (ms)=1956058
		Total vcore-seconds taken by all map tasks=6022134
		Total vcore-seconds taken by all reduce tasks=1956058
		Total megabyte-seconds taken by all map tasks=6166665216
		Total megabyte-seconds taken by all reduce tasks=2003003392
	Map-Reduce Framework
		Map input records=1935305
		Map output records=1672726
		Map output bytes=679929744
		Map output materialized bytes=686428512
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1449484
		Reduce shuffle bytes=686428512
		Reduce input records=1672726
		Reduce output records=945880
		Spilled Records=3345452
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=66025
		CPU time spent (ms)=871730
		Physical memory (bytes) snapshot=324180852736
		Virtual memory (bytes) snapshot=742649266176
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=597288763
	File Output Format Counters 
		Bytes Written=323361618
16/12/07 12:15:42 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1600
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1700 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612060900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1700': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8189420743795007984.jar tmpDir=null
16/12/07 12:16:20 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:16:20 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:16:21 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 12:16:23 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 12:16:23 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 12:16:24 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5096
16/12/07 12:16:24 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5096
16/12/07 12:16:24 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5096/
16/12/07 12:16:24 INFO mapreduce.Job: Running job: job_1480588584072_5096
16/12/07 12:16:57 INFO mapreduce.Job: Job job_1480588584072_5096 running in uber mode : false
16/12/07 12:16:57 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 12:17:08 INFO mapreduce.Job:  map 2% reduce 0%
16/12/07 12:17:09 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 12:17:17 INFO mapreduce.Job:  map 5% reduce 0%
16/12/07 12:17:18 INFO mapreduce.Job:  map 9% reduce 0%
16/12/07 12:17:20 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 12:17:22 INFO mapreduce.Job:  map 13% reduce 0%
16/12/07 12:17:25 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 12:17:26 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 12:17:27 INFO mapreduce.Job:  map 20% reduce 0%
16/12/07 12:17:29 INFO mapreduce.Job:  map 22% reduce 0%
16/12/07 12:17:31 INFO mapreduce.Job:  map 23% reduce 0%
16/12/07 12:17:32 INFO mapreduce.Job:  map 24% reduce 0%
16/12/07 12:17:34 INFO mapreduce.Job:  map 25% reduce 0%
16/12/07 12:17:35 INFO mapreduce.Job:  map 25% reduce 2%
16/12/07 12:17:36 INFO mapreduce.Job:  map 26% reduce 2%
16/12/07 12:17:37 INFO mapreduce.Job:  map 26% reduce 3%
16/12/07 12:17:40 INFO mapreduce.Job:  map 26% reduce 4%
16/12/07 12:17:41 INFO mapreduce.Job:  map 27% reduce 4%
16/12/07 12:17:42 INFO mapreduce.Job:  map 30% reduce 6%
16/12/07 12:17:43 INFO mapreduce.Job:  map 31% reduce 7%
16/12/07 12:17:44 INFO mapreduce.Job:  map 31% reduce 8%
16/12/07 12:17:45 INFO mapreduce.Job:  map 31% reduce 10%
16/12/07 12:17:48 INFO mapreduce.Job:  map 32% reduce 10%
16/12/07 12:17:49 INFO mapreduce.Job:  map 33% reduce 11%
16/12/07 12:17:50 INFO mapreduce.Job:  map 34% reduce 11%
16/12/07 12:17:51 INFO mapreduce.Job:  map 35% reduce 11%
16/12/07 12:17:53 INFO mapreduce.Job:  map 36% reduce 11%
16/12/07 12:17:54 INFO mapreduce.Job:  map 37% reduce 12%
16/12/07 12:17:55 INFO mapreduce.Job:  map 38% reduce 12%
16/12/07 12:17:56 INFO mapreduce.Job:  map 39% reduce 12%
16/12/07 12:17:58 INFO mapreduce.Job:  map 39% reduce 13%
16/12/07 12:18:02 INFO mapreduce.Job:  map 42% reduce 13%
16/12/07 12:18:03 INFO mapreduce.Job:  map 44% reduce 13%
16/12/07 12:18:04 INFO mapreduce.Job:  map 45% reduce 14%
16/12/07 12:18:07 INFO mapreduce.Job:  map 46% reduce 15%
16/12/07 12:18:08 INFO mapreduce.Job:  map 47% reduce 15%
16/12/07 12:18:09 INFO mapreduce.Job:  map 50% reduce 15%
16/12/07 12:18:10 INFO mapreduce.Job:  map 52% reduce 15%
16/12/07 12:18:11 INFO mapreduce.Job:  map 53% reduce 16%
16/12/07 12:18:13 INFO mapreduce.Job:  map 54% reduce 16%
16/12/07 12:18:14 INFO mapreduce.Job:  map 55% reduce 17%
16/12/07 12:18:15 INFO mapreduce.Job:  map 57% reduce 17%
16/12/07 12:18:16 INFO mapreduce.Job:  map 59% reduce 18%
16/12/07 12:18:17 INFO mapreduce.Job:  map 62% reduce 19%
16/12/07 12:18:18 INFO mapreduce.Job:  map 63% reduce 19%
16/12/07 12:18:19 INFO mapreduce.Job:  map 64% reduce 19%
16/12/07 12:18:20 INFO mapreduce.Job:  map 65% reduce 20%
16/12/07 12:18:21 INFO mapreduce.Job:  map 66% reduce 20%
16/12/07 12:18:22 INFO mapreduce.Job:  map 67% reduce 20%
16/12/07 12:18:23 INFO mapreduce.Job:  map 68% reduce 21%
16/12/07 12:18:24 INFO mapreduce.Job:  map 71% reduce 21%
16/12/07 12:18:25 INFO mapreduce.Job:  map 73% reduce 21%
16/12/07 12:18:26 INFO mapreduce.Job:  map 74% reduce 22%
16/12/07 12:18:27 INFO mapreduce.Job:  map 77% reduce 23%
16/12/07 12:18:28 INFO mapreduce.Job:  map 79% reduce 23%
16/12/07 12:18:29 INFO mapreduce.Job:  map 80% reduce 24%
16/12/07 12:18:30 INFO mapreduce.Job:  map 80% reduce 25%
16/12/07 12:18:31 INFO mapreduce.Job:  map 82% reduce 25%
16/12/07 12:18:32 INFO mapreduce.Job:  map 83% reduce 26%
16/12/07 12:18:33 INFO mapreduce.Job:  map 84% reduce 26%
16/12/07 12:18:35 INFO mapreduce.Job:  map 85% reduce 27%
16/12/07 12:18:36 INFO mapreduce.Job:  map 86% reduce 27%
16/12/07 12:18:38 INFO mapreduce.Job:  map 87% reduce 28%
16/12/07 12:18:41 INFO mapreduce.Job:  map 87% reduce 29%
16/12/07 12:18:43 INFO mapreduce.Job:  map 89% reduce 29%
16/12/07 12:18:44 INFO mapreduce.Job:  map 90% reduce 29%
16/12/07 12:18:45 INFO mapreduce.Job:  map 90% reduce 30%
16/12/07 12:18:50 INFO mapreduce.Job:  map 91% reduce 30%
16/12/07 12:18:51 INFO mapreduce.Job:  map 92% reduce 30%
16/12/07 12:18:52 INFO mapreduce.Job:  map 94% reduce 30%
16/12/07 12:18:53 INFO mapreduce.Job:  map 96% reduce 31%
16/12/07 12:18:54 INFO mapreduce.Job:  map 97% reduce 31%
16/12/07 12:18:55 INFO mapreduce.Job:  map 98% reduce 31%
16/12/07 12:18:56 INFO mapreduce.Job:  map 99% reduce 32%
16/12/07 12:18:57 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 12:18:58 INFO mapreduce.Job:  map 100% reduce 34%
16/12/07 12:18:59 INFO mapreduce.Job:  map 100% reduce 44%
16/12/07 12:19:00 INFO mapreduce.Job:  map 100% reduce 51%
16/12/07 12:19:01 INFO mapreduce.Job:  map 100% reduce 63%
16/12/07 12:19:02 INFO mapreduce.Job:  map 100% reduce 71%
16/12/07 12:19:03 INFO mapreduce.Job:  map 100% reduce 74%
16/12/07 12:19:04 INFO mapreduce.Job:  map 100% reduce 78%
16/12/07 12:19:05 INFO mapreduce.Job:  map 100% reduce 85%
16/12/07 12:19:06 INFO mapreduce.Job:  map 100% reduce 88%
16/12/07 12:19:07 INFO mapreduce.Job:  map 100% reduce 95%
16/12/07 12:19:08 INFO mapreduce.Job:  map 100% reduce 98%
16/12/07 12:19:09 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 12:19:13 INFO mapreduce.Job: Job job_1480588584072_5096 completed successfully
16/12/07 12:19:13 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=780856316
		FILE: Number of bytes written=1594094597
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=672385301
		WASB: Number of bytes written=389836280
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=14060086
		Total time spent by all reduces in occupied slots (ms)=4036708
		Total time spent by all map tasks (ms)=7030043
		Total time spent by all reduce tasks (ms)=2018354
		Total vcore-seconds taken by all map tasks=7030043
		Total vcore-seconds taken by all reduce tasks=2018354
		Total megabyte-seconds taken by all map tasks=7198764032
		Total megabyte-seconds taken by all reduce tasks=2066794496
	Map-Reduce Framework
		Map input records=2170050
		Map output records=1907217
		Map output bytes=773503295
		Map output materialized bytes=780879836
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1666244
		Reduce shuffle bytes=780879836
		Reduce input records=1907217
		Reduce output records=1142698
		Spilled Records=3814434
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=62231
		CPU time spent (ms)=962290
		Physical memory (bytes) snapshot=324720656384
		Virtual memory (bytes) snapshot=742722236416
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=669689297
	File Output Format Counters 
		Bytes Written=389836280
16/12/07 12:19:13 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1700
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061400 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1800 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061400
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1800': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1106463251880821.jar tmpDir=null
16/12/07 12:19:50 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:19:51 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:19:51 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 12:19:53 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 12:19:53 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 12:19:54 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5099
16/12/07 12:19:54 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5099
16/12/07 12:19:54 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5099/
16/12/07 12:19:54 INFO mapreduce.Job: Running job: job_1480588584072_5099
16/12/07 12:20:08 INFO mapreduce.Job: Job job_1480588584072_5099 running in uber mode : false
16/12/07 12:20:08 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 12:20:17 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 12:20:22 INFO mapreduce.Job:  map 2% reduce 0%
16/12/07 12:20:30 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 12:20:32 INFO mapreduce.Job:  map 4% reduce 0%
16/12/07 12:20:33 INFO mapreduce.Job:  map 7% reduce 0%
16/12/07 12:20:34 INFO mapreduce.Job:  map 8% reduce 0%
16/12/07 12:20:37 INFO mapreduce.Job:  map 9% reduce 0%
16/12/07 12:20:38 INFO mapreduce.Job:  map 11% reduce 0%
16/12/07 12:20:39 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 12:20:40 INFO mapreduce.Job:  map 13% reduce 0%
16/12/07 12:20:41 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 12:20:44 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 12:20:45 INFO mapreduce.Job:  map 19% reduce 0%
16/12/07 12:20:46 INFO mapreduce.Job:  map 21% reduce 0%
16/12/07 12:20:47 INFO mapreduce.Job:  map 22% reduce 0%
16/12/07 12:20:48 INFO mapreduce.Job:  map 24% reduce 0%
16/12/07 12:20:55 INFO mapreduce.Job:  map 24% reduce 1%
16/12/07 12:20:56 INFO mapreduce.Job:  map 28% reduce 1%
16/12/07 12:20:57 INFO mapreduce.Job:  map 30% reduce 1%
16/12/07 12:20:58 INFO mapreduce.Job:  map 33% reduce 1%
16/12/07 12:20:59 INFO mapreduce.Job:  map 36% reduce 1%
16/12/07 12:21:00 INFO mapreduce.Job:  map 37% reduce 2%
16/12/07 12:21:04 INFO mapreduce.Job:  map 37% reduce 4%
16/12/07 12:21:07 INFO mapreduce.Job:  map 38% reduce 4%
16/12/07 12:21:08 INFO mapreduce.Job:  map 39% reduce 6%
16/12/07 12:21:09 INFO mapreduce.Job:  map 39% reduce 7%
16/12/07 12:21:10 INFO mapreduce.Job:  map 41% reduce 8%
16/12/07 12:21:11 INFO mapreduce.Job:  map 44% reduce 9%
16/12/07 12:21:12 INFO mapreduce.Job:  map 46% reduce 9%
16/12/07 12:21:13 INFO mapreduce.Job:  map 46% reduce 10%
16/12/07 12:21:16 INFO mapreduce.Job:  map 47% reduce 10%
16/12/07 12:21:18 INFO mapreduce.Job:  map 48% reduce 10%
16/12/07 12:21:19 INFO mapreduce.Job:  map 49% reduce 10%
16/12/07 12:21:20 INFO mapreduce.Job:  map 50% reduce 10%
16/12/07 12:21:21 INFO mapreduce.Job:  map 52% reduce 11%
16/12/07 12:21:25 INFO mapreduce.Job:  map 54% reduce 11%
16/12/07 12:21:26 INFO mapreduce.Job:  map 57% reduce 11%
16/12/07 12:21:27 INFO mapreduce.Job:  map 58% reduce 11%
16/12/07 12:21:28 INFO mapreduce.Job:  map 59% reduce 12%
16/12/07 12:21:29 INFO mapreduce.Job:  map 60% reduce 13%
16/12/07 12:21:30 INFO mapreduce.Job:  map 63% reduce 13%
16/12/07 12:21:33 INFO mapreduce.Job:  map 64% reduce 13%
16/12/07 12:21:34 INFO mapreduce.Job:  map 65% reduce 14%
16/12/07 12:21:35 INFO mapreduce.Job:  map 67% reduce 15%
16/12/07 12:21:36 INFO mapreduce.Job:  map 69% reduce 15%
16/12/07 12:21:37 INFO mapreduce.Job:  map 71% reduce 18%
16/12/07 12:21:38 INFO mapreduce.Job:  map 73% reduce 21%
16/12/07 12:21:39 INFO mapreduce.Job:  map 75% reduce 22%
16/12/07 12:21:40 INFO mapreduce.Job:  map 78% reduce 22%
16/12/07 12:21:41 INFO mapreduce.Job:  map 82% reduce 23%
16/12/07 12:21:42 INFO mapreduce.Job:  map 85% reduce 26%
16/12/07 12:21:43 INFO mapreduce.Job:  map 89% reduce 26%
16/12/07 12:21:44 INFO mapreduce.Job:  map 92% reduce 28%
16/12/07 12:21:45 INFO mapreduce.Job:  map 93% reduce 29%
16/12/07 12:21:46 INFO mapreduce.Job:  map 96% reduce 30%
16/12/07 12:21:47 INFO mapreduce.Job:  map 96% reduce 31%
16/12/07 12:21:48 INFO mapreduce.Job:  map 96% reduce 32%
16/12/07 12:21:49 INFO mapreduce.Job:  map 97% reduce 32%
16/12/07 12:21:53 INFO mapreduce.Job:  map 98% reduce 32%
16/12/07 12:21:54 INFO mapreduce.Job:  map 99% reduce 32%
16/12/07 12:21:55 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 12:21:56 INFO mapreduce.Job:  map 100% reduce 34%
16/12/07 12:21:57 INFO mapreduce.Job:  map 100% reduce 43%
16/12/07 12:21:58 INFO mapreduce.Job:  map 100% reduce 48%
16/12/07 12:21:59 INFO mapreduce.Job:  map 100% reduce 59%
16/12/07 12:22:00 INFO mapreduce.Job:  map 100% reduce 74%
16/12/07 12:22:01 INFO mapreduce.Job:  map 100% reduce 77%
16/12/07 12:22:02 INFO mapreduce.Job:  map 100% reduce 84%
16/12/07 12:22:03 INFO mapreduce.Job:  map 100% reduce 95%
16/12/07 12:22:04 INFO mapreduce.Job:  map 100% reduce 98%
16/12/07 12:22:05 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 12:22:08 INFO mapreduce.Job: Job job_1480588584072_5099 completed successfully
16/12/07 12:22:08 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=777405086
		FILE: Number of bytes written=1587192137
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=668606532
		WASB: Number of bytes written=371542839
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=9249338
		Total time spent by all reduces in occupied slots (ms)=2958276
		Total time spent by all map tasks (ms)=4624669
		Total time spent by all reduce tasks (ms)=1479138
		Total vcore-seconds taken by all map tasks=4624669
		Total vcore-seconds taken by all reduce tasks=1479138
		Total megabyte-seconds taken by all map tasks=4735661056
		Total megabyte-seconds taken by all reduce tasks=1514637312
	Map-Reduce Framework
		Map input records=2183931
		Map output records=1913847
		Map output bytes=770046837
		Map output materialized bytes=777428606
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1667659
		Reduce shuffle bytes=777428606
		Reduce input records=1913847
		Reduce output records=1089570
		Spilled Records=3827694
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=70709
		CPU time spent (ms)=900680
		Physical memory (bytes) snapshot=323898241024
		Virtual memory (bytes) snapshot=742823804928
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=665910528
	File Output Format Counters 
		Bytes Written=371542839
16/12/07 12:22:08 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1800
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061500 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1900 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061500
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1900': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2812125315447329084.jar tmpDir=null
16/12/07 12:22:45 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:22:46 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:22:46 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 12:22:48 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 12:22:48 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 12:22:49 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5101
16/12/07 12:22:50 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5101
16/12/07 12:22:50 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5101/
16/12/07 12:22:50 INFO mapreduce.Job: Running job: job_1480588584072_5101
16/12/07 12:23:03 INFO mapreduce.Job: Job job_1480588584072_5101 running in uber mode : false
16/12/07 12:23:03 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 12:23:15 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 12:23:16 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 12:23:24 INFO mapreduce.Job:  map 7% reduce 0%
16/12/07 12:23:25 INFO mapreduce.Job:  map 9% reduce 0%
16/12/07 12:23:26 INFO mapreduce.Job:  map 11% reduce 0%
16/12/07 12:23:27 INFO mapreduce.Job:  map 13% reduce 0%
16/12/07 12:23:32 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 12:23:33 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 12:23:34 INFO mapreduce.Job:  map 20% reduce 0%
16/12/07 12:23:37 INFO mapreduce.Job:  map 22% reduce 0%
16/12/07 12:23:38 INFO mapreduce.Job:  map 24% reduce 0%
16/12/07 12:23:41 INFO mapreduce.Job:  map 25% reduce 0%
16/12/07 12:23:42 INFO mapreduce.Job:  map 25% reduce 1%
16/12/07 12:23:43 INFO mapreduce.Job:  map 25% reduce 2%
16/12/07 12:23:44 INFO mapreduce.Job:  map 26% reduce 3%
16/12/07 12:23:45 INFO mapreduce.Job:  map 27% reduce 3%
16/12/07 12:23:48 INFO mapreduce.Job:  map 28% reduce 4%
16/12/07 12:23:49 INFO mapreduce.Job:  map 29% reduce 5%
16/12/07 12:23:51 INFO mapreduce.Job:  map 30% reduce 7%
16/12/07 12:23:52 INFO mapreduce.Job:  map 31% reduce 8%
16/12/07 12:23:53 INFO mapreduce.Job:  map 32% reduce 10%
16/12/07 12:23:55 INFO mapreduce.Job:  map 32% reduce 11%
16/12/07 12:23:56 INFO mapreduce.Job:  map 34% reduce 11%
16/12/07 12:23:57 INFO mapreduce.Job:  map 35% reduce 11%
16/12/07 12:23:58 INFO mapreduce.Job:  map 36% reduce 11%
16/12/07 12:23:59 INFO mapreduce.Job:  map 37% reduce 11%
16/12/07 12:24:00 INFO mapreduce.Job:  map 37% reduce 12%
16/12/07 12:24:02 INFO mapreduce.Job:  map 38% reduce 12%
16/12/07 12:24:03 INFO mapreduce.Job:  map 39% reduce 12%
16/12/07 12:24:04 INFO mapreduce.Job:  map 39% reduce 13%
16/12/07 12:24:05 INFO mapreduce.Job:  map 40% reduce 13%
16/12/07 12:24:06 INFO mapreduce.Job:  map 41% reduce 13%
16/12/07 12:24:07 INFO mapreduce.Job:  map 42% reduce 13%
16/12/07 12:24:08 INFO mapreduce.Job:  map 43% reduce 14%
16/12/07 12:24:10 INFO mapreduce.Job:  map 45% reduce 14%
16/12/07 12:24:11 INFO mapreduce.Job:  map 46% reduce 14%
16/12/07 12:24:12 INFO mapreduce.Job:  map 47% reduce 14%
16/12/07 12:24:13 INFO mapreduce.Job:  map 49% reduce 15%
16/12/07 12:24:14 INFO mapreduce.Job:  map 51% reduce 15%
16/12/07 12:24:15 INFO mapreduce.Job:  map 51% reduce 16%
16/12/07 12:24:16 INFO mapreduce.Job:  map 54% reduce 16%
16/12/07 12:24:17 INFO mapreduce.Job:  map 55% reduce 16%
16/12/07 12:24:18 INFO mapreduce.Job:  map 58% reduce 17%
16/12/07 12:24:19 INFO mapreduce.Job:  map 59% reduce 18%
16/12/07 12:24:20 INFO mapreduce.Job:  map 61% reduce 18%
16/12/07 12:24:21 INFO mapreduce.Job:  map 63% reduce 19%
16/12/07 12:24:22 INFO mapreduce.Job:  map 65% reduce 19%
16/12/07 12:24:23 INFO mapreduce.Job:  map 67% reduce 19%
16/12/07 12:24:24 INFO mapreduce.Job:  map 69% reduce 20%
16/12/07 12:24:25 INFO mapreduce.Job:  map 72% reduce 21%
16/12/07 12:24:26 INFO mapreduce.Job:  map 74% reduce 21%
16/12/07 12:24:27 INFO mapreduce.Job:  map 75% reduce 22%
16/12/07 12:24:28 INFO mapreduce.Job:  map 77% reduce 23%
16/12/07 12:24:29 INFO mapreduce.Job:  map 79% reduce 23%
16/12/07 12:24:30 INFO mapreduce.Job:  map 81% reduce 24%
16/12/07 12:24:31 INFO mapreduce.Job:  map 82% reduce 25%
16/12/07 12:24:32 INFO mapreduce.Job:  map 85% reduce 25%
16/12/07 12:24:33 INFO mapreduce.Job:  map 85% reduce 26%
16/12/07 12:24:34 INFO mapreduce.Job:  map 86% reduce 27%
16/12/07 12:24:35 INFO mapreduce.Job:  map 87% reduce 27%
16/12/07 12:24:36 INFO mapreduce.Job:  map 87% reduce 28%
16/12/07 12:24:37 INFO mapreduce.Job:  map 87% reduce 29%
16/12/07 12:24:42 INFO mapreduce.Job:  map 88% reduce 29%
16/12/07 12:24:43 INFO mapreduce.Job:  map 90% reduce 29%
16/12/07 12:24:45 INFO mapreduce.Job:  map 90% reduce 30%
16/12/07 12:24:52 INFO mapreduce.Job:  map 92% reduce 30%
16/12/07 12:24:56 INFO mapreduce.Job:  map 93% reduce 31%
16/12/07 12:24:58 INFO mapreduce.Job:  map 94% reduce 31%
16/12/07 12:24:59 INFO mapreduce.Job:  map 96% reduce 31%
16/12/07 12:25:00 INFO mapreduce.Job:  map 97% reduce 31%
16/12/07 12:25:01 INFO mapreduce.Job:  map 98% reduce 32%
16/12/07 12:25:02 INFO mapreduce.Job:  map 100% reduce 32%
16/12/07 12:25:03 INFO mapreduce.Job:  map 100% reduce 35%
16/12/07 12:25:04 INFO mapreduce.Job:  map 100% reduce 41%
16/12/07 12:25:05 INFO mapreduce.Job:  map 100% reduce 48%
16/12/07 12:25:06 INFO mapreduce.Job:  map 100% reduce 60%
16/12/07 12:25:07 INFO mapreduce.Job:  map 100% reduce 64%
16/12/07 12:25:08 INFO mapreduce.Job:  map 100% reduce 71%
16/12/07 12:25:09 INFO mapreduce.Job:  map 100% reduce 75%
16/12/07 12:25:10 INFO mapreduce.Job:  map 100% reduce 79%
16/12/07 12:25:11 INFO mapreduce.Job:  map 100% reduce 84%
16/12/07 12:25:12 INFO mapreduce.Job:  map 100% reduce 88%
16/12/07 12:25:13 INFO mapreduce.Job:  map 100% reduce 89%
16/12/07 12:25:14 INFO mapreduce.Job:  map 100% reduce 95%
16/12/07 12:25:15 INFO mapreduce.Job:  map 100% reduce 97%
16/12/07 12:25:16 INFO mapreduce.Job:  map 100% reduce 98%
16/12/07 12:25:17 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 12:25:19 INFO mapreduce.Job: Job job_1480588584072_5101 completed successfully
16/12/07 12:25:20 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=865490380
		FILE: Number of bytes written=1763362725
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=735175213
		WASB: Number of bytes written=433680651
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13015990
		Total time spent by all reduces in occupied slots (ms)=4056804
		Total time spent by all map tasks (ms)=6507995
		Total time spent by all reduce tasks (ms)=2028402
		Total vcore-seconds taken by all map tasks=6507995
		Total vcore-seconds taken by all reduce tasks=2028402
		Total megabyte-seconds taken by all map tasks=6664186880
		Total megabyte-seconds taken by all reduce tasks=2077083648
	Map-Reduce Framework
		Map input records=2429072
		Map output records=2156614
		Map output bytes=857288363
		Map output materialized bytes=865513900
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1900146
		Reduce shuffle bytes=865513900
		Reduce input records=2156614
		Reduce output records=1302210
		Spilled Records=4313228
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=62806
		CPU time spent (ms)=982830
		Physical memory (bytes) snapshot=324945002496
		Virtual memory (bytes) snapshot=742850994176
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=732479209
	File Output Format Counters 
		Bytes Written=433680651
16/12/07 12:25:20 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/1900
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061600 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/2000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061600
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/2000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1628864186934614201.jar tmpDir=null
16/12/07 12:25:58 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:25:58 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:25:59 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 12:26:01 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 12:26:01 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 12:26:01 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5104
16/12/07 12:26:02 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5104
16/12/07 12:26:02 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5104/
16/12/07 12:26:02 INFO mapreduce.Job: Running job: job_1480588584072_5104
16/12/07 12:26:34 INFO mapreduce.Job: Job job_1480588584072_5104 running in uber mode : false
16/12/07 12:26:34 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 12:26:49 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 12:26:50 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 12:26:51 INFO mapreduce.Job:  map 4% reduce 0%
16/12/07 12:26:56 INFO mapreduce.Job:  map 7% reduce 0%
16/12/07 12:26:57 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 12:26:58 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 12:27:02 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 12:27:03 INFO mapreduce.Job:  map 18% reduce 0%
16/12/07 12:27:05 INFO mapreduce.Job:  map 19% reduce 0%
16/12/07 12:27:08 INFO mapreduce.Job:  map 20% reduce 0%
16/12/07 12:27:09 INFO mapreduce.Job:  map 22% reduce 0%
16/12/07 12:27:10 INFO mapreduce.Job:  map 23% reduce 0%
16/12/07 12:27:11 INFO mapreduce.Job:  map 26% reduce 0%
16/12/07 12:27:12 INFO mapreduce.Job:  map 27% reduce 0%
16/12/07 12:27:14 INFO mapreduce.Job:  map 27% reduce 1%
16/12/07 12:27:15 INFO mapreduce.Job:  map 27% reduce 2%
16/12/07 12:27:16 INFO mapreduce.Job:  map 27% reduce 3%
16/12/07 12:27:18 INFO mapreduce.Job:  map 28% reduce 5%
16/12/07 12:27:19 INFO mapreduce.Job:  map 28% reduce 6%
16/12/07 12:27:20 INFO mapreduce.Job:  map 30% reduce 6%
16/12/07 12:27:21 INFO mapreduce.Job:  map 30% reduce 7%
16/12/07 12:27:22 INFO mapreduce.Job:  map 31% reduce 8%
16/12/07 12:27:23 INFO mapreduce.Job:  map 32% reduce 8%
16/12/07 12:27:24 INFO mapreduce.Job:  map 33% reduce 9%
16/12/07 12:27:25 INFO mapreduce.Job:  map 34% reduce 10%
16/12/07 12:27:27 INFO mapreduce.Job:  map 34% reduce 11%
16/12/07 12:27:28 INFO mapreduce.Job:  map 35% reduce 11%
16/12/07 12:27:30 INFO mapreduce.Job:  map 35% reduce 12%
16/12/07 12:27:31 INFO mapreduce.Job:  map 36% reduce 12%
16/12/07 12:27:33 INFO mapreduce.Job:  map 37% reduce 12%
16/12/07 12:27:34 INFO mapreduce.Job:  map 40% reduce 12%
16/12/07 12:27:35 INFO mapreduce.Job:  map 40% reduce 13%
16/12/07 12:27:37 INFO mapreduce.Job:  map 41% reduce 13%
16/12/07 12:27:41 INFO mapreduce.Job:  map 43% reduce 14%
16/12/07 12:27:42 INFO mapreduce.Job:  map 44% reduce 14%
16/12/07 12:27:43 INFO mapreduce.Job:  map 45% reduce 14%
16/12/07 12:27:44 INFO mapreduce.Job:  map 47% reduce 14%
16/12/07 12:27:45 INFO mapreduce.Job:  map 48% reduce 15%
16/12/07 12:27:46 INFO mapreduce.Job:  map 49% reduce 15%
16/12/07 12:27:48 INFO mapreduce.Job:  map 50% reduce 16%
16/12/07 12:27:49 INFO mapreduce.Job:  map 52% reduce 16%
16/12/07 12:27:50 INFO mapreduce.Job:  map 53% reduce 16%
16/12/07 12:27:51 INFO mapreduce.Job:  map 55% reduce 17%
16/12/07 12:27:52 INFO mapreduce.Job:  map 57% reduce 17%
16/12/07 12:27:53 INFO mapreduce.Job:  map 58% reduce 17%
16/12/07 12:27:54 INFO mapreduce.Job:  map 61% reduce 18%
16/12/07 12:27:55 INFO mapreduce.Job:  map 63% reduce 18%
16/12/07 12:27:56 INFO mapreduce.Job:  map 67% reduce 19%
16/12/07 12:27:58 INFO mapreduce.Job:  map 68% reduce 20%
16/12/07 12:27:59 INFO mapreduce.Job:  map 70% reduce 21%
16/12/07 12:28:00 INFO mapreduce.Job:  map 71% reduce 21%
16/12/07 12:28:01 INFO mapreduce.Job:  map 71% reduce 22%
16/12/07 12:28:02 INFO mapreduce.Job:  map 73% reduce 22%
16/12/07 12:28:03 INFO mapreduce.Job:  map 75% reduce 22%
16/12/07 12:28:04 INFO mapreduce.Job:  map 77% reduce 23%
16/12/07 12:28:05 INFO mapreduce.Job:  map 79% reduce 23%
16/12/07 12:28:06 INFO mapreduce.Job:  map 80% reduce 23%
16/12/07 12:28:07 INFO mapreduce.Job:  map 80% reduce 24%
16/12/07 12:28:08 INFO mapreduce.Job:  map 81% reduce 25%
16/12/07 12:28:09 INFO mapreduce.Job:  map 82% reduce 25%
16/12/07 12:28:10 INFO mapreduce.Job:  map 83% reduce 25%
16/12/07 12:28:11 INFO mapreduce.Job:  map 84% reduce 25%
16/12/07 12:28:12 INFO mapreduce.Job:  map 84% reduce 26%
16/12/07 12:28:13 INFO mapreduce.Job:  map 85% reduce 26%
16/12/07 12:28:14 INFO mapreduce.Job:  map 86% reduce 27%
16/12/07 12:28:15 INFO mapreduce.Job:  map 87% reduce 27%
16/12/07 12:28:16 INFO mapreduce.Job:  map 87% reduce 28%
16/12/07 12:28:17 INFO mapreduce.Job:  map 87% reduce 29%
16/12/07 12:28:24 INFO mapreduce.Job:  map 88% reduce 29%
16/12/07 12:28:31 INFO mapreduce.Job:  map 89% reduce 29%
16/12/07 12:28:33 INFO mapreduce.Job:  map 90% reduce 29%
16/12/07 12:28:34 INFO mapreduce.Job:  map 90% reduce 30%
16/12/07 12:28:35 INFO mapreduce.Job:  map 91% reduce 30%
16/12/07 12:28:38 INFO mapreduce.Job:  map 92% reduce 30%
16/12/07 12:28:39 INFO mapreduce.Job:  map 93% reduce 30%
16/12/07 12:28:41 INFO mapreduce.Job:  map 95% reduce 30%
16/12/07 12:28:42 INFO mapreduce.Job:  map 95% reduce 31%
16/12/07 12:28:44 INFO mapreduce.Job:  map 97% reduce 32%
16/12/07 12:28:45 INFO mapreduce.Job:  map 98% reduce 32%
16/12/07 12:28:47 INFO mapreduce.Job:  map 99% reduce 32%
16/12/07 12:28:48 INFO mapreduce.Job:  map 99% reduce 33%
16/12/07 12:28:55 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 12:28:56 INFO mapreduce.Job:  map 100% reduce 35%
16/12/07 12:28:57 INFO mapreduce.Job:  map 100% reduce 46%
16/12/07 12:28:58 INFO mapreduce.Job:  map 100% reduce 49%
16/12/07 12:28:59 INFO mapreduce.Job:  map 100% reduce 59%
16/12/07 12:29:00 INFO mapreduce.Job:  map 100% reduce 71%
16/12/07 12:29:01 INFO mapreduce.Job:  map 100% reduce 73%
16/12/07 12:29:02 INFO mapreduce.Job:  map 100% reduce 76%
16/12/07 12:29:03 INFO mapreduce.Job:  map 100% reduce 85%
16/12/07 12:29:04 INFO mapreduce.Job:  map 100% reduce 87%
16/12/07 12:29:05 INFO mapreduce.Job:  map 100% reduce 90%
16/12/07 12:29:06 INFO mapreduce.Job:  map 100% reduce 95%
16/12/07 12:29:07 INFO mapreduce.Job:  map 100% reduce 98%
16/12/07 12:29:08 INFO mapreduce.Job:  map 100% reduce 99%
16/12/07 12:29:09 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 12:29:11 INFO mapreduce.Job: Job job_1480588584072_5104 completed successfully
16/12/07 12:29:11 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=869372803
		FILE: Number of bytes written=1771127571
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=733701070
		WASB: Number of bytes written=451066866
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=14670290
		Total time spent by all reduces in occupied slots (ms)=4832282
		Total time spent by all map tasks (ms)=7335145
		Total time spent by all reduce tasks (ms)=2416141
		Total vcore-seconds taken by all map tasks=7335145
		Total vcore-seconds taken by all reduce tasks=2416141
		Total megabyte-seconds taken by all map tasks=7511188480
		Total megabyte-seconds taken by all reduce tasks=2474128384
	Map-Reduce Framework
		Map input records=2426093
		Map output records=2170471
		Map output bytes=861141131
		Map output materialized bytes=869396323
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1914769
		Reduce shuffle bytes=869396323
		Reduce input records=2170471
		Reduce output records=1352765
		Spilled Records=4340942
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=71483
		CPU time spent (ms)=1001440
		Physical memory (bytes) snapshot=325405388800
		Virtual memory (bytes) snapshot=742799552512
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=731005066
	File Output Format Counters 
		Bytes Written=451066866
16/12/07 12:29:11 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/2000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061700 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/2100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061700
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/2100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7858940411905165200.jar tmpDir=null
16/12/07 12:29:49 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:29:50 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:29:50 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 12:29:52 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 12:29:52 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 12:29:52 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5107
16/12/07 12:29:53 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5107
16/12/07 12:29:53 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5107/
16/12/07 12:29:53 INFO mapreduce.Job: Running job: job_1480588584072_5107
16/12/07 12:30:21 INFO mapreduce.Job: Job job_1480588584072_5107 running in uber mode : false
16/12/07 12:30:21 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 12:30:33 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 12:30:34 INFO mapreduce.Job:  map 2% reduce 0%
16/12/07 12:30:43 INFO mapreduce.Job:  map 4% reduce 0%
16/12/07 12:30:44 INFO mapreduce.Job:  map 5% reduce 0%
16/12/07 12:30:45 INFO mapreduce.Job:  map 8% reduce 0%
16/12/07 12:30:46 INFO mapreduce.Job:  map 9% reduce 0%
16/12/07 12:30:47 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 12:30:50 INFO mapreduce.Job:  map 14% reduce 0%
16/12/07 12:30:51 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 12:30:52 INFO mapreduce.Job:  map 19% reduce 0%
16/12/07 12:30:57 INFO mapreduce.Job:  map 20% reduce 0%
16/12/07 12:30:58 INFO mapreduce.Job:  map 21% reduce 0%
16/12/07 12:30:59 INFO mapreduce.Job:  map 24% reduce 0%
16/12/07 12:31:00 INFO mapreduce.Job:  map 25% reduce 0%
16/12/07 12:31:02 INFO mapreduce.Job:  map 25% reduce 2%
16/12/07 12:31:04 INFO mapreduce.Job:  map 25% reduce 3%
16/12/07 12:31:05 INFO mapreduce.Job:  map 25% reduce 4%
16/12/07 12:31:07 INFO mapreduce.Job:  map 26% reduce 5%
16/12/07 12:31:08 INFO mapreduce.Job:  map 27% reduce 5%
16/12/07 12:31:09 INFO mapreduce.Job:  map 28% reduce 6%
16/12/07 12:31:10 INFO mapreduce.Job:  map 28% reduce 8%
16/12/07 12:31:11 INFO mapreduce.Job:  map 30% reduce 8%
16/12/07 12:31:14 INFO mapreduce.Job:  map 30% reduce 9%
16/12/07 12:31:15 INFO mapreduce.Job:  map 31% reduce 10%
16/12/07 12:31:16 INFO mapreduce.Job:  map 32% reduce 10%
16/12/07 12:31:17 INFO mapreduce.Job:  map 32% reduce 11%
16/12/07 12:31:18 INFO mapreduce.Job:  map 33% reduce 11%
16/12/07 12:31:19 INFO mapreduce.Job:  map 34% reduce 11%
16/12/07 12:31:20 INFO mapreduce.Job:  map 35% reduce 11%
16/12/07 12:31:21 INFO mapreduce.Job:  map 36% reduce 11%
16/12/07 12:31:23 INFO mapreduce.Job:  map 36% reduce 12%
16/12/07 12:31:24 INFO mapreduce.Job:  map 38% reduce 12%
16/12/07 12:31:27 INFO mapreduce.Job:  map 39% reduce 13%
16/12/07 12:31:29 INFO mapreduce.Job:  map 41% reduce 13%
16/12/07 12:31:30 INFO mapreduce.Job:  map 42% reduce 13%
16/12/07 12:31:31 INFO mapreduce.Job:  map 43% reduce 13%
16/12/07 12:31:32 INFO mapreduce.Job:  map 44% reduce 14%
16/12/07 12:31:33 INFO mapreduce.Job:  map 45% reduce 14%
16/12/07 12:31:35 INFO mapreduce.Job:  map 45% reduce 15%
16/12/07 12:31:36 INFO mapreduce.Job:  map 47% reduce 15%
16/12/07 12:31:37 INFO mapreduce.Job:  map 50% reduce 15%
16/12/07 12:31:38 INFO mapreduce.Job:  map 52% reduce 15%
16/12/07 12:31:39 INFO mapreduce.Job:  map 54% reduce 16%
16/12/07 12:31:40 INFO mapreduce.Job:  map 55% reduce 16%
16/12/07 12:31:41 INFO mapreduce.Job:  map 57% reduce 17%
16/12/07 12:31:42 INFO mapreduce.Job:  map 59% reduce 17%
16/12/07 12:31:43 INFO mapreduce.Job:  map 61% reduce 17%
16/12/07 12:31:44 INFO mapreduce.Job:  map 63% reduce 18%
16/12/07 12:31:45 INFO mapreduce.Job:  map 65% reduce 19%
16/12/07 12:31:46 INFO mapreduce.Job:  map 66% reduce 19%
16/12/07 12:31:47 INFO mapreduce.Job:  map 69% reduce 20%
16/12/07 12:31:49 INFO mapreduce.Job:  map 72% reduce 21%
16/12/07 12:31:50 INFO mapreduce.Job:  map 75% reduce 22%
16/12/07 12:31:51 INFO mapreduce.Job:  map 76% reduce 22%
16/12/07 12:31:52 INFO mapreduce.Job:  map 78% reduce 23%
16/12/07 12:31:53 INFO mapreduce.Job:  map 80% reduce 24%
16/12/07 12:31:54 INFO mapreduce.Job:  map 81% reduce 25%
16/12/07 12:31:55 INFO mapreduce.Job:  map 82% reduce 25%
16/12/07 12:31:56 INFO mapreduce.Job:  map 84% reduce 26%
16/12/07 12:31:57 INFO mapreduce.Job:  map 85% reduce 26%
16/12/07 12:31:58 INFO mapreduce.Job:  map 85% reduce 27%
16/12/07 12:31:59 INFO mapreduce.Job:  map 86% reduce 28%
16/12/07 12:32:02 INFO mapreduce.Job:  map 86% reduce 29%
16/12/07 12:32:06 INFO mapreduce.Job:  map 88% reduce 29%
16/12/07 12:32:07 INFO mapreduce.Job:  map 89% reduce 29%
16/12/07 12:32:08 INFO mapreduce.Job:  map 90% reduce 30%
16/12/07 12:32:09 INFO mapreduce.Job:  map 91% reduce 30%
16/12/07 12:32:17 INFO mapreduce.Job:  map 92% reduce 30%
16/12/07 12:32:18 INFO mapreduce.Job:  map 93% reduce 30%
16/12/07 12:32:19 INFO mapreduce.Job:  map 95% reduce 30%
16/12/07 12:32:20 INFO mapreduce.Job:  map 96% reduce 31%
16/12/07 12:32:21 INFO mapreduce.Job:  map 97% reduce 31%
16/12/07 12:32:22 INFO mapreduce.Job:  map 98% reduce 32%
16/12/07 12:32:24 INFO mapreduce.Job:  map 99% reduce 32%
16/12/07 12:32:25 INFO mapreduce.Job:  map 99% reduce 33%
16/12/07 12:32:26 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 12:32:27 INFO mapreduce.Job:  map 100% reduce 36%
16/12/07 12:32:28 INFO mapreduce.Job:  map 100% reduce 40%
16/12/07 12:32:29 INFO mapreduce.Job:  map 100% reduce 47%
16/12/07 12:32:30 INFO mapreduce.Job:  map 100% reduce 60%
16/12/07 12:32:31 INFO mapreduce.Job:  map 100% reduce 71%
16/12/07 12:32:32 INFO mapreduce.Job:  map 100% reduce 76%
16/12/07 12:32:33 INFO mapreduce.Job:  map 100% reduce 82%
16/12/07 12:32:34 INFO mapreduce.Job:  map 100% reduce 87%
16/12/07 12:32:35 INFO mapreduce.Job:  map 100% reduce 90%
16/12/07 12:32:36 INFO mapreduce.Job:  map 100% reduce 93%
16/12/07 12:32:37 INFO mapreduce.Job:  map 100% reduce 97%
16/12/07 12:32:38 INFO mapreduce.Job:  map 100% reduce 98%
16/12/07 12:32:39 INFO mapreduce.Job:  map 100% reduce 99%
16/12/07 12:32:40 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 12:32:43 INFO mapreduce.Job: Job job_1480588584072_5107 completed successfully
16/12/07 12:32:43 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=740912610
		FILE: Number of bytes written=1514207185
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=621911720
		WASB: Number of bytes written=381060725
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=14092604
		Total time spent by all reduces in occupied slots (ms)=4140074
		Total time spent by all map tasks (ms)=7046302
		Total time spent by all reduce tasks (ms)=2070037
		Total vcore-seconds taken by all map tasks=7046302
		Total vcore-seconds taken by all reduce tasks=2070037
		Total megabyte-seconds taken by all map tasks=7215413248
		Total megabyte-seconds taken by all reduce tasks=2119717888
	Map-Reduce Framework
		Map input records=2081894
		Map output records=1870356
		Map output bytes=733873306
		Map output materialized bytes=740936130
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1647108
		Reduce shuffle bytes=740936130
		Reduce input records=1870356
		Reduce output records=1157251
		Spilled Records=3740712
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=64926
		CPU time spent (ms)=936500
		Physical memory (bytes) snapshot=324454518784
		Virtual memory (bytes) snapshot=743011954688
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=619215716
	File Output Format Counters 
		Bytes Written=381060725
16/12/07 12:32:43 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/2100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061800 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/2200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061800
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/2200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob6275141346739014095.jar tmpDir=null
16/12/07 12:33:20 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:33:20 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:33:21 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 12:33:23 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 12:33:24 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 12:33:24 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5110
16/12/07 12:33:25 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5110
16/12/07 12:33:25 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5110/
16/12/07 12:33:25 INFO mapreduce.Job: Running job: job_1480588584072_5110
16/12/07 12:33:37 INFO mapreduce.Job: Job job_1480588584072_5110 running in uber mode : false
16/12/07 12:33:37 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 12:33:56 INFO mapreduce.Job:  map 2% reduce 0%
16/12/07 12:33:58 INFO mapreduce.Job:  map 4% reduce 0%
16/12/07 12:34:00 INFO mapreduce.Job:  map 5% reduce 0%
16/12/07 12:34:05 INFO mapreduce.Job:  map 6% reduce 0%
16/12/07 12:34:11 INFO mapreduce.Job:  map 8% reduce 0%
16/12/07 12:34:12 INFO mapreduce.Job:  map 11% reduce 0%
16/12/07 12:34:14 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 12:34:15 INFO mapreduce.Job:  map 14% reduce 0%
16/12/07 12:34:16 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 12:34:18 INFO mapreduce.Job:  map 16% reduce 0%
16/12/07 12:34:19 INFO mapreduce.Job:  map 18% reduce 0%
16/12/07 12:34:20 INFO mapreduce.Job:  map 21% reduce 0%
16/12/07 12:34:22 INFO mapreduce.Job:  map 23% reduce 0%
16/12/07 12:34:23 INFO mapreduce.Job:  map 25% reduce 0%
16/12/07 12:34:24 INFO mapreduce.Job:  map 27% reduce 1%
16/12/07 12:34:25 INFO mapreduce.Job:  map 29% reduce 1%
16/12/07 12:34:26 INFO mapreduce.Job:  map 31% reduce 1%
16/12/07 12:34:29 INFO mapreduce.Job:  map 32% reduce 1%
16/12/07 12:34:30 INFO mapreduce.Job:  map 33% reduce 1%
16/12/07 12:34:31 INFO mapreduce.Job:  map 35% reduce 1%
16/12/07 12:34:33 INFO mapreduce.Job:  map 36% reduce 2%
16/12/07 12:34:35 INFO mapreduce.Job:  map 37% reduce 3%
16/12/07 12:34:36 INFO mapreduce.Job:  map 37% reduce 4%
16/12/07 12:34:38 INFO mapreduce.Job:  map 38% reduce 4%
16/12/07 12:34:42 INFO mapreduce.Job:  map 40% reduce 6%
16/12/07 12:34:43 INFO mapreduce.Job:  map 41% reduce 7%
16/12/07 12:34:47 INFO mapreduce.Job:  map 42% reduce 7%
16/12/07 12:34:49 INFO mapreduce.Job:  map 44% reduce 7%
16/12/07 12:34:50 INFO mapreduce.Job:  map 46% reduce 8%
16/12/07 12:34:52 INFO mapreduce.Job:  map 47% reduce 8%
16/12/07 12:34:54 INFO mapreduce.Job:  map 48% reduce 8%
16/12/07 12:34:55 INFO mapreduce.Job:  map 49% reduce 8%
16/12/07 12:34:56 INFO mapreduce.Job:  map 50% reduce 9%
16/12/07 12:34:57 INFO mapreduce.Job:  map 53% reduce 9%
16/12/07 12:34:59 INFO mapreduce.Job:  map 56% reduce 9%
16/12/07 12:35:00 INFO mapreduce.Job:  map 59% reduce 10%
16/12/07 12:35:03 INFO mapreduce.Job:  map 60% reduce 12%
16/12/07 12:35:05 INFO mapreduce.Job:  map 61% reduce 13%
16/12/07 12:35:06 INFO mapreduce.Job:  map 63% reduce 15%
16/12/07 12:35:07 INFO mapreduce.Job:  map 65% reduce 16%
16/12/07 12:35:08 INFO mapreduce.Job:  map 65% reduce 17%
16/12/07 12:35:09 INFO mapreduce.Job:  map 66% reduce 19%
16/12/07 12:35:10 INFO mapreduce.Job:  map 70% reduce 19%
16/12/07 12:35:11 INFO mapreduce.Job:  map 73% reduce 21%
16/12/07 12:35:12 INFO mapreduce.Job:  map 77% reduce 22%
16/12/07 12:35:14 INFO mapreduce.Job:  map 78% reduce 23%
16/12/07 12:35:15 INFO mapreduce.Job:  map 82% reduce 24%
16/12/07 12:35:16 INFO mapreduce.Job:  map 85% reduce 25%
16/12/07 12:35:17 INFO mapreduce.Job:  map 88% reduce 26%
16/12/07 12:35:18 INFO mapreduce.Job:  map 89% reduce 27%
16/12/07 12:35:19 INFO mapreduce.Job:  map 90% reduce 28%
16/12/07 12:35:20 INFO mapreduce.Job:  map 91% reduce 29%
16/12/07 12:35:21 INFO mapreduce.Job:  map 92% reduce 30%
16/12/07 12:35:22 INFO mapreduce.Job:  map 95% reduce 30%
16/12/07 12:35:24 INFO mapreduce.Job:  map 96% reduce 31%
16/12/07 12:35:25 INFO mapreduce.Job:  map 96% reduce 32%
16/12/07 12:35:27 INFO mapreduce.Job:  map 97% reduce 32%
16/12/07 12:35:28 INFO mapreduce.Job:  map 98% reduce 32%
16/12/07 12:35:29 INFO mapreduce.Job:  map 99% reduce 32%
16/12/07 12:35:30 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 12:35:32 INFO mapreduce.Job:  map 100% reduce 35%
16/12/07 12:35:33 INFO mapreduce.Job:  map 100% reduce 54%
16/12/07 12:35:34 INFO mapreduce.Job:  map 100% reduce 69%
16/12/07 12:35:35 INFO mapreduce.Job:  map 100% reduce 71%
16/12/07 12:35:36 INFO mapreduce.Job:  map 100% reduce 80%
16/12/07 12:35:37 INFO mapreduce.Job:  map 100% reduce 89%
16/12/07 12:35:38 INFO mapreduce.Job:  map 100% reduce 93%
16/12/07 12:35:39 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 12:35:43 INFO mapreduce.Job: Job job_1480588584072_5110 completed successfully
16/12/07 12:35:44 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=687521221
		FILE: Number of bytes written=1407424407
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=570907385
		WASB: Number of bytes written=384907620
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=8473330
		Total time spent by all reduces in occupied slots (ms)=3050540
		Total time spent by all map tasks (ms)=4236665
		Total time spent by all reduce tasks (ms)=1525270
		Total vcore-seconds taken by all map tasks=4236665
		Total vcore-seconds taken by all reduce tasks=1525270
		Total megabyte-seconds taken by all map tasks=4338344960
		Total megabyte-seconds taken by all reduce tasks=1561876480
	Map-Reduce Framework
		Map input records=1882309
		Map output records=1722022
		Map output bytes=681037041
		Map output materialized bytes=687544741
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1529404
		Reduce shuffle bytes=687544741
		Reduce input records=1722022
		Reduce output records=1152138
		Spilled Records=3444044
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=55884
		CPU time spent (ms)=861050
		Physical memory (bytes) snapshot=323973496832
		Virtual memory (bytes) snapshot=743019618304
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=568211381
	File Output Format Counters 
		Bytes Written=384907620
16/12/07 12:35:44 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/2200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/00.done
16/12/07 12:35:55 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061900 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/2300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161206/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061900
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/2300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob6204997631501149213.jar tmpDir=null
16/12/07 12:36:20 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:36:21 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:36:21 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 12:36:23 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 12:36:23 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 12:36:24 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5111
16/12/07 12:36:24 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5111
16/12/07 12:36:24 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5111/
16/12/07 12:36:24 INFO mapreduce.Job: Running job: job_1480588584072_5111
16/12/07 12:36:39 INFO mapreduce.Job: Job job_1480588584072_5111 running in uber mode : false
16/12/07 12:36:39 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 12:37:04 INFO mapreduce.Job:  map 2% reduce 0%
16/12/07 12:37:05 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 12:37:07 INFO mapreduce.Job:  map 11% reduce 0%
16/12/07 12:37:08 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 12:37:10 INFO mapreduce.Job:  map 13% reduce 0%
16/12/07 12:37:12 INFO mapreduce.Job:  map 16% reduce 0%
16/12/07 12:37:13 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 12:37:19 INFO mapreduce.Job:  map 19% reduce 0%
16/12/07 12:37:21 INFO mapreduce.Job:  map 23% reduce 0%
16/12/07 12:37:23 INFO mapreduce.Job:  map 26% reduce 0%
16/12/07 12:37:24 INFO mapreduce.Job:  map 29% reduce 0%
16/12/07 12:37:25 INFO mapreduce.Job:  map 30% reduce 0%
16/12/07 12:37:27 INFO mapreduce.Job:  map 31% reduce 0%
16/12/07 12:37:28 INFO mapreduce.Job:  map 32% reduce 0%
16/12/07 12:37:29 INFO mapreduce.Job:  map 34% reduce 0%
16/12/07 12:37:30 INFO mapreduce.Job:  map 36% reduce 0%
16/12/07 12:37:32 INFO mapreduce.Job:  map 36% reduce 1%
16/12/07 12:37:33 INFO mapreduce.Job:  map 38% reduce 1%
16/12/07 12:37:34 INFO mapreduce.Job:  map 41% reduce 3%
16/12/07 12:37:35 INFO mapreduce.Job:  map 42% reduce 3%
16/12/07 12:37:36 INFO mapreduce.Job:  map 43% reduce 3%
16/12/07 12:37:37 INFO mapreduce.Job:  map 44% reduce 9%
16/12/07 12:37:38 INFO mapreduce.Job:  map 45% reduce 9%
16/12/07 12:37:40 INFO mapreduce.Job:  map 47% reduce 13%
16/12/07 12:37:41 INFO mapreduce.Job:  map 49% reduce 13%
16/12/07 12:37:42 INFO mapreduce.Job:  map 50% reduce 13%
16/12/07 12:37:43 INFO mapreduce.Job:  map 52% reduce 15%
16/12/07 12:37:44 INFO mapreduce.Job:  map 53% reduce 15%
16/12/07 12:37:46 INFO mapreduce.Job:  map 55% reduce 16%
16/12/07 12:37:47 INFO mapreduce.Job:  map 57% reduce 17%
16/12/07 12:37:49 INFO mapreduce.Job:  map 58% reduce 17%
16/12/07 12:37:50 INFO mapreduce.Job:  map 59% reduce 18%
16/12/07 12:37:51 INFO mapreduce.Job:  map 60% reduce 19%
16/12/07 12:37:54 INFO mapreduce.Job:  map 64% reduce 19%
16/12/07 12:37:55 INFO mapreduce.Job:  map 67% reduce 19%
16/12/07 12:37:57 INFO mapreduce.Job:  map 70% reduce 21%
16/12/07 12:37:58 INFO mapreduce.Job:  map 72% reduce 22%
16/12/07 12:38:01 INFO mapreduce.Job:  map 78% reduce 23%
16/12/07 12:38:04 INFO mapreduce.Job:  map 79% reduce 25%
16/12/07 12:38:05 INFO mapreduce.Job:  map 80% reduce 25%
16/12/07 12:38:06 INFO mapreduce.Job:  map 80% reduce 26%
16/12/07 12:38:07 INFO mapreduce.Job:  map 80% reduce 27%
16/12/07 12:38:12 INFO mapreduce.Job:  map 81% reduce 27%
16/12/07 12:38:16 INFO mapreduce.Job:  map 82% reduce 27%
16/12/07 12:38:17 INFO mapreduce.Job:  map 83% reduce 27%
16/12/07 12:38:18 INFO mapreduce.Job:  map 86% reduce 27%
16/12/07 12:38:19 INFO mapreduce.Job:  map 88% reduce 27%
16/12/07 12:38:21 INFO mapreduce.Job:  map 91% reduce 29%
16/12/07 12:38:23 INFO mapreduce.Job:  map 93% reduce 30%
16/12/07 12:38:24 INFO mapreduce.Job:  map 94% reduce 30%
16/12/07 12:38:25 INFO mapreduce.Job:  map 95% reduce 30%
16/12/07 12:38:26 INFO mapreduce.Job:  map 96% reduce 31%
16/12/07 12:38:27 INFO mapreduce.Job:  map 96% reduce 32%
16/12/07 12:38:28 INFO mapreduce.Job:  map 99% reduce 32%
16/12/07 12:38:30 INFO mapreduce.Job:  map 99% reduce 33%
16/12/07 12:38:32 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 12:38:33 INFO mapreduce.Job:  map 100% reduce 50%
16/12/07 12:38:35 INFO mapreduce.Job:  map 100% reduce 59%
16/12/07 12:38:36 INFO mapreduce.Job:  map 100% reduce 79%
16/12/07 12:38:37 INFO mapreduce.Job:  map 100% reduce 83%
16/12/07 12:38:38 INFO mapreduce.Job:  map 100% reduce 93%
16/12/07 12:38:39 INFO mapreduce.Job:  map 100% reduce 97%
16/12/07 12:38:40 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 12:38:43 INFO mapreduce.Job: Job job_1480588584072_5111 completed successfully
16/12/07 12:38:43 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=417934997
		FILE: Number of bytes written=868251959
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=350729959
		WASB: Number of bytes written=211368105
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13328158
		Total time spent by all reduces in occupied slots (ms)=2995600
		Total time spent by all map tasks (ms)=6664079
		Total time spent by all reduce tasks (ms)=1497800
		Total vcore-seconds taken by all map tasks=6664079
		Total vcore-seconds taken by all reduce tasks=1497800
		Total megabyte-seconds taken by all map tasks=6824016896
		Total megabyte-seconds taken by all reduce tasks=1533747200
	Map-Reduce Framework
		Map input records=1195969
		Map output records=1073417
		Map output bytes=413942075
		Map output materialized bytes=417958517
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=950797
		Reduce shuffle bytes=417958517
		Reduce input records=1073417
		Reduce output records=642934
		Spilled Records=2146834
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=72203
		CPU time spent (ms)=821660
		Physical memory (bytes) snapshot=323159048192
		Virtual memory (bytes) snapshot=742812286976
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=348033955
	File Output Format Counters 
		Bytes Written=211368105
16/12/07 12:38:43 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161206/2300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161206/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4238705708935407712.jar tmpDir=null
16/12/07 12:39:19 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:39:20 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:39:20 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 12:39:22 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 12:39:22 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 12:39:23 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5112
16/12/07 12:39:23 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5112
16/12/07 12:39:23 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5112/
16/12/07 12:39:23 INFO mapreduce.Job: Running job: job_1480588584072_5112
16/12/07 12:39:36 INFO mapreduce.Job: Job job_1480588584072_5112 running in uber mode : false
16/12/07 12:39:36 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 12:39:46 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 12:39:47 INFO mapreduce.Job:  map 2% reduce 0%
16/12/07 12:39:54 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 12:39:55 INFO mapreduce.Job:  map 4% reduce 0%
16/12/07 12:39:58 INFO mapreduce.Job:  map 6% reduce 0%
16/12/07 12:39:59 INFO mapreduce.Job:  map 8% reduce 0%
16/12/07 12:40:00 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 12:40:02 INFO mapreduce.Job:  map 13% reduce 0%
16/12/07 12:40:03 INFO mapreduce.Job:  map 14% reduce 0%
16/12/07 12:40:04 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 12:40:05 INFO mapreduce.Job:  map 18% reduce 0%
16/12/07 12:40:06 INFO mapreduce.Job:  map 19% reduce 0%
16/12/07 12:40:10 INFO mapreduce.Job:  map 20% reduce 0%
16/12/07 12:40:11 INFO mapreduce.Job:  map 23% reduce 0%
16/12/07 12:40:12 INFO mapreduce.Job:  map 24% reduce 0%
16/12/07 12:40:14 INFO mapreduce.Job:  map 24% reduce 1%
16/12/07 12:40:15 INFO mapreduce.Job:  map 24% reduce 2%
16/12/07 12:40:16 INFO mapreduce.Job:  map 24% reduce 4%
16/12/07 12:40:17 INFO mapreduce.Job:  map 25% reduce 4%
16/12/07 12:40:22 INFO mapreduce.Job:  map 28% reduce 5%
16/12/07 12:40:23 INFO mapreduce.Job:  map 31% reduce 6%
16/12/07 12:40:24 INFO mapreduce.Job:  map 31% reduce 7%
16/12/07 12:40:26 INFO mapreduce.Job:  map 31% reduce 8%
16/12/07 12:40:28 INFO mapreduce.Job:  map 31% reduce 9%
16/12/07 12:40:30 INFO mapreduce.Job:  map 32% reduce 9%
16/12/07 12:40:31 INFO mapreduce.Job:  map 32% reduce 10%
16/12/07 12:40:32 INFO mapreduce.Job:  map 33% reduce 10%
16/12/07 12:40:33 INFO mapreduce.Job:  map 33% reduce 11%
16/12/07 12:40:34 INFO mapreduce.Job:  map 34% reduce 11%
16/12/07 12:40:35 INFO mapreduce.Job:  map 36% reduce 11%
16/12/07 12:40:37 INFO mapreduce.Job:  map 37% reduce 11%
16/12/07 12:40:38 INFO mapreduce.Job:  map 38% reduce 12%
16/12/07 12:40:41 INFO mapreduce.Job:  map 38% reduce 13%
16/12/07 12:40:43 INFO mapreduce.Job:  map 39% reduce 13%
16/12/07 12:40:44 INFO mapreduce.Job:  map 40% reduce 13%
16/12/07 12:40:45 INFO mapreduce.Job:  map 41% reduce 13%
16/12/07 12:40:46 INFO mapreduce.Job:  map 42% reduce 13%
16/12/07 12:40:47 INFO mapreduce.Job:  map 44% reduce 14%
16/12/07 12:40:48 INFO mapreduce.Job:  map 46% reduce 14%
16/12/07 12:40:49 INFO mapreduce.Job:  map 47% reduce 14%
16/12/07 12:40:50 INFO mapreduce.Job:  map 48% reduce 15%
16/12/07 12:40:51 INFO mapreduce.Job:  map 50% reduce 15%
16/12/07 12:40:52 INFO mapreduce.Job:  map 52% reduce 16%
16/12/07 12:40:53 INFO mapreduce.Job:  map 53% reduce 16%
16/12/07 12:40:54 INFO mapreduce.Job:  map 54% reduce 16%
16/12/07 12:40:55 INFO mapreduce.Job:  map 56% reduce 17%
16/12/07 12:40:56 INFO mapreduce.Job:  map 57% reduce 17%
16/12/07 12:40:57 INFO mapreduce.Job:  map 59% reduce 17%
16/12/07 12:40:58 INFO mapreduce.Job:  map 63% reduce 18%
16/12/07 12:40:59 INFO mapreduce.Job:  map 65% reduce 19%
16/12/07 12:41:00 INFO mapreduce.Job:  map 68% reduce 19%
16/12/07 12:41:01 INFO mapreduce.Job:  map 71% reduce 20%
16/12/07 12:41:02 INFO mapreduce.Job:  map 72% reduce 21%
16/12/07 12:41:03 INFO mapreduce.Job:  map 73% reduce 22%
16/12/07 12:41:04 INFO mapreduce.Job:  map 76% reduce 22%
16/12/07 12:41:05 INFO mapreduce.Job:  map 78% reduce 23%
16/12/07 12:41:06 INFO mapreduce.Job:  map 79% reduce 24%
16/12/07 12:41:07 INFO mapreduce.Job:  map 80% reduce 25%
16/12/07 12:41:08 INFO mapreduce.Job:  map 80% reduce 26%
16/12/07 12:41:09 INFO mapreduce.Job:  map 81% reduce 26%
16/12/07 12:41:10 INFO mapreduce.Job:  map 82% reduce 27%
16/12/07 12:41:11 INFO mapreduce.Job:  map 83% reduce 27%
16/12/07 12:41:13 INFO mapreduce.Job:  map 83% reduce 28%
16/12/07 12:41:19 INFO mapreduce.Job:  map 85% reduce 28%
16/12/07 12:41:20 INFO mapreduce.Job:  map 86% reduce 28%
16/12/07 12:41:21 INFO mapreduce.Job:  map 89% reduce 28%
16/12/07 12:41:22 INFO mapreduce.Job:  map 89% reduce 29%
16/12/07 12:41:26 INFO mapreduce.Job:  map 90% reduce 30%
16/12/07 12:41:32 INFO mapreduce.Job:  map 91% reduce 30%
16/12/07 12:41:33 INFO mapreduce.Job:  map 92% reduce 30%
16/12/07 12:41:34 INFO mapreduce.Job:  map 94% reduce 30%
16/12/07 12:41:35 INFO mapreduce.Job:  map 94% reduce 31%
16/12/07 12:41:37 INFO mapreduce.Job:  map 95% reduce 31%
16/12/07 12:41:38 INFO mapreduce.Job:  map 97% reduce 31%
16/12/07 12:41:39 INFO mapreduce.Job:  map 99% reduce 32%
16/12/07 12:41:40 INFO mapreduce.Job:  map 100% reduce 32%
16/12/07 12:41:41 INFO mapreduce.Job:  map 100% reduce 35%
16/12/07 12:41:42 INFO mapreduce.Job:  map 100% reduce 44%
16/12/07 12:41:43 INFO mapreduce.Job:  map 100% reduce 62%
16/12/07 12:41:44 INFO mapreduce.Job:  map 100% reduce 77%
16/12/07 12:41:45 INFO mapreduce.Job:  map 100% reduce 92%
16/12/07 12:41:47 INFO mapreduce.Job:  map 100% reduce 99%
16/12/07 12:41:48 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 12:41:50 INFO mapreduce.Job: Job job_1480588584072_5112 completed successfully
16/12/07 12:41:50 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=257466611
		FILE: Number of bytes written=547315187
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=213556102
		WASB: Number of bytes written=122057905
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=14124856
		Total time spent by all reduces in occupied slots (ms)=3935530
		Total time spent by all map tasks (ms)=7062428
		Total time spent by all reduce tasks (ms)=1967765
		Total vcore-seconds taken by all map tasks=7062428
		Total vcore-seconds taken by all reduce tasks=1967765
		Total megabyte-seconds taken by all map tasks=7231926272
		Total megabyte-seconds taken by all reduce tasks=2014991360
	Map-Reduce Framework
		Map input records=767489
		Map output records=691794
		Map output bytes=254967095
		Map output materialized bytes=257490131
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=619083
		Reduce shuffle bytes=257490131
		Reduce input records=691794
		Reduce output records=386726
		Spilled Records=1383588
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=67861
		CPU time spent (ms)=767960
		Physical memory (bytes) snapshot=323005341696
		Virtual memory (bytes) snapshot=742779027456
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=210860098
	File Output Format Counters 
		Bytes Written=122057905
16/12/07 12:41:50 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5908062224393182996.jar tmpDir=null
16/12/07 12:42:27 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:42:28 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:42:28 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 12:42:30 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 12:42:30 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 12:42:31 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5113
16/12/07 12:42:31 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5113
16/12/07 12:42:31 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5113/
16/12/07 12:42:31 INFO mapreduce.Job: Running job: job_1480588584072_5113
16/12/07 12:42:44 INFO mapreduce.Job: Job job_1480588584072_5113 running in uber mode : false
16/12/07 12:42:44 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 12:43:05 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 12:43:07 INFO mapreduce.Job:  map 4% reduce 0%
16/12/07 12:43:08 INFO mapreduce.Job:  map 7% reduce 0%
16/12/07 12:43:11 INFO mapreduce.Job:  map 10% reduce 0%
16/12/07 12:43:13 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 12:43:22 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 12:43:23 INFO mapreduce.Job:  map 19% reduce 0%
16/12/07 12:43:26 INFO mapreduce.Job:  map 21% reduce 0%
16/12/07 12:43:27 INFO mapreduce.Job:  map 22% reduce 0%
16/12/07 12:43:28 INFO mapreduce.Job:  map 24% reduce 0%
16/12/07 12:43:29 INFO mapreduce.Job:  map 26% reduce 0%
16/12/07 12:43:31 INFO mapreduce.Job:  map 27% reduce 0%
16/12/07 12:43:33 INFO mapreduce.Job:  map 30% reduce 0%
16/12/07 12:43:34 INFO mapreduce.Job:  map 35% reduce 0%
16/12/07 12:43:35 INFO mapreduce.Job:  map 39% reduce 0%
16/12/07 12:43:36 INFO mapreduce.Job:  map 40% reduce 0%
16/12/07 12:43:37 INFO mapreduce.Job:  map 41% reduce 1%
16/12/07 12:43:38 INFO mapreduce.Job:  map 41% reduce 4%
16/12/07 12:43:39 INFO mapreduce.Job:  map 43% reduce 4%
16/12/07 12:43:41 INFO mapreduce.Job:  map 43% reduce 6%
16/12/07 12:43:42 INFO mapreduce.Job:  map 43% reduce 8%
16/12/07 12:43:43 INFO mapreduce.Job:  map 43% reduce 9%
16/12/07 12:43:44 INFO mapreduce.Job:  map 44% reduce 9%
16/12/07 12:43:45 INFO mapreduce.Job:  map 44% reduce 10%
16/12/07 12:43:49 INFO mapreduce.Job:  map 46% reduce 10%
16/12/07 12:43:52 INFO mapreduce.Job:  map 53% reduce 10%
16/12/07 12:43:53 INFO mapreduce.Job:  map 54% reduce 10%
16/12/07 12:43:54 INFO mapreduce.Job:  map 55% reduce 10%
16/12/07 12:43:56 INFO mapreduce.Job:  map 57% reduce 10%
16/12/07 12:43:57 INFO mapreduce.Job:  map 57% reduce 11%
16/12/07 12:44:00 INFO mapreduce.Job:  map 59% reduce 11%
16/12/07 12:44:02 INFO mapreduce.Job:  map 60% reduce 14%
16/12/07 12:44:04 INFO mapreduce.Job:  map 65% reduce 15%
16/12/07 12:44:06 INFO mapreduce.Job:  map 68% reduce 16%
16/12/07 12:44:07 INFO mapreduce.Job:  map 70% reduce 18%
16/12/07 12:44:09 INFO mapreduce.Job:  map 76% reduce 20%
16/12/07 12:44:10 INFO mapreduce.Job:  map 79% reduce 21%
16/12/07 12:44:12 INFO mapreduce.Job:  map 79% reduce 22%
16/12/07 12:44:13 INFO mapreduce.Job:  map 81% reduce 26%
16/12/07 12:44:15 INFO mapreduce.Job:  map 85% reduce 26%
16/12/07 12:44:16 INFO mapreduce.Job:  map 86% reduce 27%
16/12/07 12:44:17 INFO mapreduce.Job:  map 88% reduce 28%
16/12/07 12:44:19 INFO mapreduce.Job:  map 89% reduce 29%
16/12/07 12:44:20 INFO mapreduce.Job:  map 90% reduce 29%
16/12/07 12:44:21 INFO mapreduce.Job:  map 91% reduce 30%
16/12/07 12:44:25 INFO mapreduce.Job:  map 92% reduce 30%
16/12/07 12:44:28 INFO mapreduce.Job:  map 93% reduce 31%
16/12/07 12:44:32 INFO mapreduce.Job:  map 94% reduce 31%
16/12/07 12:44:33 INFO mapreduce.Job:  map 95% reduce 31%
16/12/07 12:44:34 INFO mapreduce.Job:  map 97% reduce 32%
16/12/07 12:44:35 INFO mapreduce.Job:  map 98% reduce 32%
16/12/07 12:44:36 INFO mapreduce.Job:  map 100% reduce 32%
16/12/07 12:44:37 INFO mapreduce.Job:  map 100% reduce 41%
16/12/07 12:44:38 INFO mapreduce.Job:  map 100% reduce 52%
16/12/07 12:44:39 INFO mapreduce.Job:  map 100% reduce 64%
16/12/07 12:44:40 INFO mapreduce.Job:  map 100% reduce 92%
16/12/07 12:44:41 INFO mapreduce.Job:  map 100% reduce 97%
16/12/07 12:44:42 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 12:44:44 INFO mapreduce.Job: Job job_1480588584072_5113 completed successfully
16/12/07 12:44:44 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=179836808
		FILE: Number of bytes written=392055581
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=149835173
		WASB: Number of bytes written=77110802
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12893422
		Total time spent by all reduces in occupied slots (ms)=2927598
		Total time spent by all map tasks (ms)=6446711
		Total time spent by all reduce tasks (ms)=1463799
		Total vcore-seconds taken by all map tasks=6446711
		Total vcore-seconds taken by all reduce tasks=1463799
		Total megabyte-seconds taken by all map tasks=6601432064
		Total megabyte-seconds taken by all reduce tasks=1498930176
	Map-Reduce Framework
		Map input records=569175
		Map output records=505043
		Map output bytes=178059191
		Map output materialized bytes=179860328
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=452014
		Reduce shuffle bytes=179860328
		Reduce input records=505043
		Reduce output records=254971
		Spilled Records=1010086
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=61734
		CPU time spent (ms)=711160
		Physical memory (bytes) snapshot=322241363968
		Virtual memory (bytes) snapshot=742534246400
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=147139169
	File Output Format Counters 
		Bytes Written=77110802
16/12/07 12:44:44 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2406248447789542511.jar tmpDir=null
16/12/07 12:45:20 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:45:21 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:45:21 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 12:45:23 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 12:45:23 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 12:45:24 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5114
16/12/07 12:45:24 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5114
16/12/07 12:45:24 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5114/
16/12/07 12:45:24 INFO mapreduce.Job: Running job: job_1480588584072_5114
16/12/07 12:45:36 INFO mapreduce.Job: Job job_1480588584072_5114 running in uber mode : false
16/12/07 12:45:36 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 12:45:47 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 12:45:48 INFO mapreduce.Job:  map 2% reduce 0%
16/12/07 12:45:51 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 12:45:57 INFO mapreduce.Job:  map 5% reduce 0%
16/12/07 12:45:58 INFO mapreduce.Job:  map 8% reduce 0%
16/12/07 12:45:59 INFO mapreduce.Job:  map 11% reduce 0%
16/12/07 12:46:00 INFO mapreduce.Job:  map 13% reduce 0%
16/12/07 12:46:05 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 12:46:06 INFO mapreduce.Job:  map 20% reduce 0%
16/12/07 12:46:08 INFO mapreduce.Job:  map 21% reduce 0%
16/12/07 12:46:09 INFO mapreduce.Job:  map 22% reduce 0%
16/12/07 12:46:10 INFO mapreduce.Job:  map 25% reduce 0%
16/12/07 12:46:11 INFO mapreduce.Job:  map 26% reduce 0%
16/12/07 12:46:14 INFO mapreduce.Job:  map 26% reduce 1%
16/12/07 12:46:16 INFO mapreduce.Job:  map 26% reduce 2%
16/12/07 12:46:18 INFO mapreduce.Job:  map 27% reduce 3%
16/12/07 12:46:19 INFO mapreduce.Job:  map 29% reduce 3%
16/12/07 12:46:20 INFO mapreduce.Job:  map 30% reduce 5%
16/12/07 12:46:22 INFO mapreduce.Job:  map 31% reduce 6%
16/12/07 12:46:23 INFO mapreduce.Job:  map 31% reduce 7%
16/12/07 12:46:25 INFO mapreduce.Job:  map 31% reduce 10%
16/12/07 12:46:26 INFO mapreduce.Job:  map 33% reduce 10%
16/12/07 12:46:27 INFO mapreduce.Job:  map 34% reduce 10%
16/12/07 12:46:28 INFO mapreduce.Job:  map 35% reduce 10%
16/12/07 12:46:29 INFO mapreduce.Job:  map 36% reduce 11%
16/12/07 12:46:30 INFO mapreduce.Job:  map 36% reduce 12%
16/12/07 12:46:31 INFO mapreduce.Job:  map 37% reduce 12%
16/12/07 12:46:33 INFO mapreduce.Job:  map 39% reduce 12%
16/12/07 12:46:35 INFO mapreduce.Job:  map 39% reduce 13%
16/12/07 12:46:36 INFO mapreduce.Job:  map 40% reduce 13%
16/12/07 12:46:37 INFO mapreduce.Job:  map 41% reduce 13%
16/12/07 12:46:39 INFO mapreduce.Job:  map 42% reduce 13%
16/12/07 12:46:40 INFO mapreduce.Job:  map 44% reduce 14%
16/12/07 12:46:41 INFO mapreduce.Job:  map 45% reduce 14%
16/12/07 12:46:43 INFO mapreduce.Job:  map 46% reduce 15%
16/12/07 12:46:44 INFO mapreduce.Job:  map 47% reduce 15%
16/12/07 12:46:45 INFO mapreduce.Job:  map 48% reduce 15%
16/12/07 12:46:46 INFO mapreduce.Job:  map 50% reduce 15%
16/12/07 12:46:47 INFO mapreduce.Job:  map 51% reduce 16%
16/12/07 12:46:48 INFO mapreduce.Job:  map 54% reduce 16%
16/12/07 12:46:49 INFO mapreduce.Job:  map 56% reduce 17%
16/12/07 12:46:51 INFO mapreduce.Job:  map 58% reduce 18%
16/12/07 12:46:52 INFO mapreduce.Job:  map 60% reduce 18%
16/12/07 12:46:53 INFO mapreduce.Job:  map 62% reduce 18%
16/12/07 12:46:54 INFO mapreduce.Job:  map 68% reduce 19%
16/12/07 12:46:55 INFO mapreduce.Job:  map 70% reduce 21%
16/12/07 12:46:56 INFO mapreduce.Job:  map 71% reduce 21%
16/12/07 12:46:57 INFO mapreduce.Job:  map 73% reduce 23%
16/12/07 12:46:58 INFO mapreduce.Job:  map 76% reduce 23%
16/12/07 12:46:59 INFO mapreduce.Job:  map 79% reduce 24%
16/12/07 12:47:00 INFO mapreduce.Job:  map 81% reduce 25%
16/12/07 12:47:01 INFO mapreduce.Job:  map 83% reduce 25%
16/12/07 12:47:02 INFO mapreduce.Job:  map 85% reduce 26%
16/12/07 12:47:04 INFO mapreduce.Job:  map 86% reduce 27%
16/12/07 12:47:05 INFO mapreduce.Job:  map 87% reduce 28%
16/12/07 12:47:07 INFO mapreduce.Job:  map 87% reduce 29%
16/12/07 12:47:10 INFO mapreduce.Job:  map 88% reduce 29%
16/12/07 12:47:13 INFO mapreduce.Job:  map 90% reduce 29%
16/12/07 12:47:14 INFO mapreduce.Job:  map 90% reduce 30%
16/12/07 12:47:16 INFO mapreduce.Job:  map 91% reduce 30%
16/12/07 12:47:17 INFO mapreduce.Job:  map 92% reduce 30%
16/12/07 12:47:19 INFO mapreduce.Job:  map 92% reduce 31%
16/12/07 12:47:20 INFO mapreduce.Job:  map 93% reduce 31%
16/12/07 12:47:22 INFO mapreduce.Job:  map 94% reduce 31%
16/12/07 12:47:24 INFO mapreduce.Job:  map 97% reduce 31%
16/12/07 12:47:25 INFO mapreduce.Job:  map 100% reduce 32%
16/12/07 12:47:26 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 12:47:27 INFO mapreduce.Job:  map 100% reduce 37%
16/12/07 12:47:28 INFO mapreduce.Job:  map 100% reduce 58%
16/12/07 12:47:29 INFO mapreduce.Job:  map 100% reduce 74%
16/12/07 12:47:30 INFO mapreduce.Job:  map 100% reduce 92%
16/12/07 12:47:31 INFO mapreduce.Job:  map 100% reduce 96%
16/12/07 12:47:32 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 12:47:35 INFO mapreduce.Job: Job job_1480588584072_5114 completed successfully
16/12/07 12:47:35 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=159190869
		FILE: Number of bytes written=350763703
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=134378371
		WASB: Number of bytes written=60235485
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12573972
		Total time spent by all reduces in occupied slots (ms)=3339466
		Total time spent by all map tasks (ms)=6286986
		Total time spent by all reduce tasks (ms)=1669733
		Total vcore-seconds taken by all map tasks=6286986
		Total vcore-seconds taken by all reduce tasks=1669733
		Total megabyte-seconds taken by all map tasks=6437873664
		Total megabyte-seconds taken by all reduce tasks=1709806592
	Map-Reduce Framework
		Map input records=518885
		Map output records=452917
		Map output bytes=157603375
		Map output materialized bytes=159214389
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=406048
		Reduce shuffle bytes=159214389
		Reduce input records=452917
		Reduce output records=204206
		Spilled Records=905834
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=59790
		CPU time spent (ms)=699640
		Physical memory (bytes) snapshot=322482110464
		Virtual memory (bytes) snapshot=742767681536
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=131682367
	File Output Format Counters 
		Bytes Written=60235485
16/12/07 12:47:35 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612061900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob9020546971227363572.jar tmpDir=null
16/12/07 12:48:11 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:48:12 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:48:12 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 12:48:14 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 12:48:14 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 12:48:15 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5115
16/12/07 12:48:15 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5115
16/12/07 12:48:15 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5115/
16/12/07 12:48:15 INFO mapreduce.Job: Running job: job_1480588584072_5115
16/12/07 12:48:28 INFO mapreduce.Job: Job job_1480588584072_5115 running in uber mode : false
16/12/07 12:48:28 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 12:48:52 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 12:48:54 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 12:48:55 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 12:49:01 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 12:49:02 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 12:49:06 INFO mapreduce.Job:  map 18% reduce 0%
16/12/07 12:49:07 INFO mapreduce.Job:  map 19% reduce 0%
16/12/07 12:49:08 INFO mapreduce.Job:  map 20% reduce 0%
16/12/07 12:49:11 INFO mapreduce.Job:  map 24% reduce 0%
16/12/07 12:49:13 INFO mapreduce.Job:  map 28% reduce 0%
16/12/07 12:49:14 INFO mapreduce.Job:  map 31% reduce 0%
16/12/07 12:49:15 INFO mapreduce.Job:  map 32% reduce 0%
16/12/07 12:49:16 INFO mapreduce.Job:  map 34% reduce 0%
16/12/07 12:49:17 INFO mapreduce.Job:  map 36% reduce 0%
16/12/07 12:49:18 INFO mapreduce.Job:  map 37% reduce 1%
16/12/07 12:49:19 INFO mapreduce.Job:  map 38% reduce 1%
16/12/07 12:49:20 INFO mapreduce.Job:  map 39% reduce 4%
16/12/07 12:49:22 INFO mapreduce.Job:  map 40% reduce 6%
16/12/07 12:49:24 INFO mapreduce.Job:  map 41% reduce 8%
16/12/07 12:49:25 INFO mapreduce.Job:  map 41% reduce 9%
16/12/07 12:49:26 INFO mapreduce.Job:  map 44% reduce 9%
16/12/07 12:49:27 INFO mapreduce.Job:  map 48% reduce 10%
16/12/07 12:49:29 INFO mapreduce.Job:  map 48% reduce 11%
16/12/07 12:49:31 INFO mapreduce.Job:  map 50% reduce 15%
16/12/07 12:49:34 INFO mapreduce.Job:  map 51% reduce 15%
16/12/07 12:49:35 INFO mapreduce.Job:  map 52% reduce 15%
16/12/07 12:49:37 INFO mapreduce.Job:  map 53% reduce 15%
16/12/07 12:49:38 INFO mapreduce.Job:  map 53% reduce 16%
16/12/07 12:49:43 INFO mapreduce.Job:  map 60% reduce 18%
16/12/07 12:49:44 INFO mapreduce.Job:  map 62% reduce 18%
16/12/07 12:49:45 INFO mapreduce.Job:  map 64% reduce 19%
16/12/07 12:49:48 INFO mapreduce.Job:  map 64% reduce 21%
16/12/07 12:49:49 INFO mapreduce.Job:  map 65% reduce 21%
16/12/07 12:49:50 INFO mapreduce.Job:  map 66% reduce 21%
16/12/07 12:49:51 INFO mapreduce.Job:  map 67% reduce 21%
16/12/07 12:49:52 INFO mapreduce.Job:  map 68% reduce 21%
16/12/07 12:49:53 INFO mapreduce.Job:  map 71% reduce 21%
16/12/07 12:49:54 INFO mapreduce.Job:  map 72% reduce 21%
16/12/07 12:49:55 INFO mapreduce.Job:  map 74% reduce 21%
16/12/07 12:49:56 INFO mapreduce.Job:  map 78% reduce 24%
16/12/07 12:49:57 INFO mapreduce.Job:  map 80% reduce 24%
16/12/07 12:49:58 INFO mapreduce.Job:  map 83% reduce 24%
16/12/07 12:49:59 INFO mapreduce.Job:  map 84% reduce 26%
16/12/07 12:50:00 INFO mapreduce.Job:  map 85% reduce 27%
16/12/07 12:50:01 INFO mapreduce.Job:  map 86% reduce 27%
16/12/07 12:50:02 INFO mapreduce.Job:  map 87% reduce 28%
16/12/07 12:50:03 INFO mapreduce.Job:  map 89% reduce 28%
16/12/07 12:50:04 INFO mapreduce.Job:  map 90% reduce 28%
16/12/07 12:50:05 INFO mapreduce.Job:  map 91% reduce 30%
16/12/07 12:50:06 INFO mapreduce.Job:  map 93% reduce 30%
16/12/07 12:50:07 INFO mapreduce.Job:  map 94% reduce 30%
16/12/07 12:50:08 INFO mapreduce.Job:  map 94% reduce 31%
16/12/07 12:50:11 INFO mapreduce.Job:  map 95% reduce 31%
16/12/07 12:50:12 INFO mapreduce.Job:  map 96% reduce 32%
16/12/07 12:50:13 INFO mapreduce.Job:  map 97% reduce 32%
16/12/07 12:50:14 INFO mapreduce.Job:  map 99% reduce 33%
16/12/07 12:50:15 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 12:50:17 INFO mapreduce.Job:  map 100% reduce 54%
16/12/07 12:50:18 INFO mapreduce.Job:  map 100% reduce 79%
16/12/07 12:50:20 INFO mapreduce.Job:  map 100% reduce 94%
16/12/07 12:50:21 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 12:50:24 INFO mapreduce.Job: Job job_1480588584072_5115 completed successfully
16/12/07 12:50:24 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=181095450
		FILE: Number of bytes written=394572865
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=153365710
		WASB: Number of bytes written=65158227
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12648382
		Total time spent by all reduces in occupied slots (ms)=2881576
		Total time spent by all map tasks (ms)=6324191
		Total time spent by all reduce tasks (ms)=1440788
		Total vcore-seconds taken by all map tasks=6324191
		Total vcore-seconds taken by all reduce tasks=1440788
		Total megabyte-seconds taken by all map tasks=6475971584
		Total megabyte-seconds taken by all reduce tasks=1475366912
	Map-Reduce Framework
		Map input records=585844
		Map output records=510054
		Map output bytes=179293627
		Map output materialized bytes=181118970
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=456273
		Reduce shuffle bytes=181118970
		Reduce input records=510054
		Reduce output records=220646
		Spilled Records=1020108
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=68991
		CPU time spent (ms)=705750
		Physical memory (bytes) snapshot=322266812416
		Virtual memory (bytes) snapshot=742774870016
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=150669706
	File Output Format Counters 
		Bytes Written=65158227
16/12/07 12:50:24 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0400 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0400': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3113546656588853022.jar tmpDir=null
16/12/07 12:51:01 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:51:02 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:51:02 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 12:51:04 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 12:51:05 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 12:51:05 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5116
16/12/07 12:51:06 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5116
16/12/07 12:51:06 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5116/
16/12/07 12:51:06 INFO mapreduce.Job: Running job: job_1480588584072_5116
16/12/07 12:51:19 INFO mapreduce.Job: Job job_1480588584072_5116 running in uber mode : false
16/12/07 12:51:19 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 12:51:46 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 12:51:50 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 12:51:54 INFO mapreduce.Job:  map 13% reduce 0%
16/12/07 12:51:55 INFO mapreduce.Job:  map 14% reduce 0%
16/12/07 12:52:00 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 12:52:01 INFO mapreduce.Job:  map 18% reduce 0%
16/12/07 12:52:06 INFO mapreduce.Job:  map 20% reduce 0%
16/12/07 12:52:09 INFO mapreduce.Job:  map 22% reduce 0%
16/12/07 12:52:10 INFO mapreduce.Job:  map 26% reduce 0%
16/12/07 12:52:12 INFO mapreduce.Job:  map 29% reduce 0%
16/12/07 12:52:13 INFO mapreduce.Job:  map 36% reduce 0%
16/12/07 12:52:16 INFO mapreduce.Job:  map 38% reduce 0%
16/12/07 12:52:19 INFO mapreduce.Job:  map 43% reduce 0%
16/12/07 12:52:20 INFO mapreduce.Job:  map 44% reduce 0%
16/12/07 12:52:21 INFO mapreduce.Job:  map 46% reduce 0%
16/12/07 12:52:24 INFO mapreduce.Job:  map 47% reduce 1%
16/12/07 12:52:25 INFO mapreduce.Job:  map 48% reduce 1%
16/12/07 12:52:26 INFO mapreduce.Job:  map 51% reduce 2%
16/12/07 12:52:30 INFO mapreduce.Job:  map 53% reduce 10%
16/12/07 12:52:31 INFO mapreduce.Job:  map 54% reduce 10%
16/12/07 12:52:32 INFO mapreduce.Job:  map 55% reduce 12%
16/12/07 12:52:33 INFO mapreduce.Job:  map 56% reduce 12%
16/12/07 12:52:35 INFO mapreduce.Job:  map 60% reduce 13%
16/12/07 12:52:37 INFO mapreduce.Job:  map 64% reduce 14%
16/12/07 12:52:38 INFO mapreduce.Job:  map 68% reduce 14%
16/12/07 12:52:41 INFO mapreduce.Job:  map 70% reduce 15%
16/12/07 12:52:42 INFO mapreduce.Job:  map 73% reduce 17%
16/12/07 12:52:43 INFO mapreduce.Job:  map 73% reduce 18%
16/12/07 12:52:45 INFO mapreduce.Job:  map 74% reduce 18%
16/12/07 12:52:48 INFO mapreduce.Job:  map 79% reduce 22%
16/12/07 12:52:49 INFO mapreduce.Job:  map 80% reduce 23%
16/12/07 12:52:50 INFO mapreduce.Job:  map 81% reduce 23%
16/12/07 12:52:51 INFO mapreduce.Job:  map 82% reduce 25%
16/12/07 12:52:52 INFO mapreduce.Job:  map 83% reduce 25%
16/12/07 12:52:53 INFO mapreduce.Job:  map 84% reduce 25%
16/12/07 12:52:54 INFO mapreduce.Job:  map 84% reduce 26%
16/12/07 12:52:55 INFO mapreduce.Job:  map 85% reduce 27%
16/12/07 12:52:56 INFO mapreduce.Job:  map 86% reduce 27%
16/12/07 12:52:57 INFO mapreduce.Job:  map 87% reduce 27%
16/12/07 12:52:58 INFO mapreduce.Job:  map 88% reduce 27%
16/12/07 12:52:59 INFO mapreduce.Job:  map 93% reduce 29%
16/12/07 12:53:00 INFO mapreduce.Job:  map 94% reduce 30%
16/12/07 12:53:01 INFO mapreduce.Job:  map 96% reduce 30%
16/12/07 12:53:02 INFO mapreduce.Job:  map 96% reduce 31%
16/12/07 12:53:03 INFO mapreduce.Job:  map 98% reduce 32%
16/12/07 12:53:04 INFO mapreduce.Job:  map 99% reduce 32%
16/12/07 12:53:05 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 12:53:06 INFO mapreduce.Job:  map 100% reduce 35%
16/12/07 12:53:07 INFO mapreduce.Job:  map 100% reduce 42%
16/12/07 12:53:08 INFO mapreduce.Job:  map 100% reduce 53%
16/12/07 12:53:10 INFO mapreduce.Job:  map 100% reduce 80%
16/12/07 12:53:11 INFO mapreduce.Job:  map 100% reduce 89%
16/12/07 12:53:12 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 12:53:15 INFO mapreduce.Job: Job job_1480588584072_5116 completed successfully
16/12/07 12:53:15 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=232776271
		FILE: Number of bytes written=497934507
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=197720934
		WASB: Number of bytes written=88509327
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12958964
		Total time spent by all reduces in occupied slots (ms)=2301928
		Total time spent by all map tasks (ms)=6479482
		Total time spent by all reduce tasks (ms)=1150964
		Total vcore-seconds taken by all map tasks=6479482
		Total vcore-seconds taken by all reduce tasks=1150964
		Total megabyte-seconds taken by all map tasks=6634989568
		Total megabyte-seconds taken by all reduce tasks=1178587136
	Map-Reduce Framework
		Map input records=727259
		Map output records=635341
		Map output bytes=230486752
		Map output materialized bytes=232799791
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=568944
		Reduce shuffle bytes=232799791
		Reduce input records=635341
		Reduce output records=288139
		Spilled Records=1270682
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=75257
		CPU time spent (ms)=725950
		Physical memory (bytes) snapshot=321985150976
		Virtual memory (bytes) snapshot=742669451264
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=195024930
	File Output Format Counters 
		Bytes Written=88509327
16/12/07 12:53:15 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0400
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0500 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0500': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1422582609639737209.jar tmpDir=null
16/12/07 12:53:52 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:53:53 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:53:54 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 12:53:55 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 12:53:55 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 12:53:56 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5117
16/12/07 12:53:57 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5117
16/12/07 12:53:57 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5117/
16/12/07 12:53:57 INFO mapreduce.Job: Running job: job_1480588584072_5117
16/12/07 12:54:10 INFO mapreduce.Job: Job job_1480588584072_5117 running in uber mode : false
16/12/07 12:54:10 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 12:54:21 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 12:54:29 INFO mapreduce.Job:  map 4% reduce 0%
16/12/07 12:54:30 INFO mapreduce.Job:  map 8% reduce 0%
16/12/07 12:54:31 INFO mapreduce.Job:  map 9% reduce 0%
16/12/07 12:54:32 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 12:54:33 INFO mapreduce.Job:  map 13% reduce 0%
16/12/07 12:54:38 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 12:54:39 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 12:54:40 INFO mapreduce.Job:  map 20% reduce 0%
16/12/07 12:54:43 INFO mapreduce.Job:  map 22% reduce 0%
16/12/07 12:54:44 INFO mapreduce.Job:  map 24% reduce 0%
16/12/07 12:54:48 INFO mapreduce.Job:  map 24% reduce 2%
16/12/07 12:54:49 INFO mapreduce.Job:  map 25% reduce 2%
16/12/07 12:54:50 INFO mapreduce.Job:  map 25% reduce 3%
16/12/07 12:54:51 INFO mapreduce.Job:  map 25% reduce 4%
16/12/07 12:54:52 INFO mapreduce.Job:  map 25% reduce 5%
16/12/07 12:54:53 INFO mapreduce.Job:  map 26% reduce 5%
16/12/07 12:54:55 INFO mapreduce.Job:  map 27% reduce 5%
16/12/07 12:54:56 INFO mapreduce.Job:  map 28% reduce 5%
16/12/07 12:54:57 INFO mapreduce.Job:  map 30% reduce 6%
16/12/07 12:54:58 INFO mapreduce.Job:  map 30% reduce 7%
16/12/07 12:54:59 INFO mapreduce.Job:  map 30% reduce 8%
16/12/07 12:55:00 INFO mapreduce.Job:  map 31% reduce 9%
16/12/07 12:55:01 INFO mapreduce.Job:  map 32% reduce 10%
16/12/07 12:55:02 INFO mapreduce.Job:  map 33% reduce 10%
16/12/07 12:55:03 INFO mapreduce.Job:  map 33% reduce 11%
16/12/07 12:55:07 INFO mapreduce.Job:  map 35% reduce 11%
16/12/07 12:55:08 INFO mapreduce.Job:  map 37% reduce 11%
16/12/07 12:55:09 INFO mapreduce.Job:  map 38% reduce 12%
16/12/07 12:55:11 INFO mapreduce.Job:  map 38% reduce 13%
16/12/07 12:55:13 INFO mapreduce.Job:  map 39% reduce 13%
16/12/07 12:55:14 INFO mapreduce.Job:  map 40% reduce 13%
16/12/07 12:55:16 INFO mapreduce.Job:  map 41% reduce 13%
16/12/07 12:55:18 INFO mapreduce.Job:  map 43% reduce 13%
16/12/07 12:55:19 INFO mapreduce.Job:  map 45% reduce 14%
16/12/07 12:55:20 INFO mapreduce.Job:  map 47% reduce 14%
16/12/07 12:55:21 INFO mapreduce.Job:  map 48% reduce 14%
16/12/07 12:55:22 INFO mapreduce.Job:  map 49% reduce 15%
16/12/07 12:55:23 INFO mapreduce.Job:  map 50% reduce 15%
16/12/07 12:55:24 INFO mapreduce.Job:  map 50% reduce 16%
16/12/07 12:55:25 INFO mapreduce.Job:  map 51% reduce 16%
16/12/07 12:55:26 INFO mapreduce.Job:  map 54% reduce 16%
16/12/07 12:55:27 INFO mapreduce.Job:  map 55% reduce 17%
16/12/07 12:55:28 INFO mapreduce.Job:  map 56% reduce 17%
16/12/07 12:55:29 INFO mapreduce.Job:  map 59% reduce 17%
16/12/07 12:55:30 INFO mapreduce.Job:  map 62% reduce 18%
16/12/07 12:55:31 INFO mapreduce.Job:  map 64% reduce 19%
16/12/07 12:55:32 INFO mapreduce.Job:  map 67% reduce 19%
16/12/07 12:55:33 INFO mapreduce.Job:  map 69% reduce 20%
16/12/07 12:55:34 INFO mapreduce.Job:  map 70% reduce 21%
16/12/07 12:55:35 INFO mapreduce.Job:  map 73% reduce 21%
16/12/07 12:55:36 INFO mapreduce.Job:  map 75% reduce 22%
16/12/07 12:55:37 INFO mapreduce.Job:  map 77% reduce 23%
16/12/07 12:55:38 INFO mapreduce.Job:  map 78% reduce 24%
16/12/07 12:55:39 INFO mapreduce.Job:  map 80% reduce 25%
16/12/07 12:55:40 INFO mapreduce.Job:  map 81% reduce 25%
16/12/07 12:55:41 INFO mapreduce.Job:  map 84% reduce 26%
16/12/07 12:55:42 INFO mapreduce.Job:  map 85% reduce 27%
16/12/07 12:55:43 INFO mapreduce.Job:  map 85% reduce 28%
16/12/07 12:55:44 INFO mapreduce.Job:  map 86% reduce 28%
16/12/07 12:55:47 INFO mapreduce.Job:  map 86% reduce 29%
16/12/07 12:55:52 INFO mapreduce.Job:  map 87% reduce 29%
16/12/07 12:55:53 INFO mapreduce.Job:  map 88% reduce 29%
16/12/07 12:55:55 INFO mapreduce.Job:  map 89% reduce 29%
16/12/07 12:55:56 INFO mapreduce.Job:  map 91% reduce 30%
16/12/07 12:55:57 INFO mapreduce.Job:  map 93% reduce 30%
16/12/07 12:55:58 INFO mapreduce.Job:  map 94% reduce 30%
16/12/07 12:55:59 INFO mapreduce.Job:  map 96% reduce 31%
16/12/07 12:56:00 INFO mapreduce.Job:  map 97% reduce 32%
16/12/07 12:56:01 INFO mapreduce.Job:  map 99% reduce 32%
16/12/07 12:56:02 INFO mapreduce.Job:  map 100% reduce 32%
16/12/07 12:56:03 INFO mapreduce.Job:  map 100% reduce 43%
16/12/07 12:56:04 INFO mapreduce.Job:  map 100% reduce 51%
16/12/07 12:56:05 INFO mapreduce.Job:  map 100% reduce 63%
16/12/07 12:56:06 INFO mapreduce.Job:  map 100% reduce 78%
16/12/07 12:56:07 INFO mapreduce.Job:  map 100% reduce 91%
16/12/07 12:56:08 INFO mapreduce.Job:  map 100% reduce 96%
16/12/07 12:56:09 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 12:56:13 INFO mapreduce.Job: Job job_1480588584072_5117 completed successfully
16/12/07 12:56:14 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=340934557
		FILE: Number of bytes written=714251079
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=293312033
		WASB: Number of bytes written=142770862
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13436998
		Total time spent by all reduces in occupied slots (ms)=3566864
		Total time spent by all map tasks (ms)=6718499
		Total time spent by all reduce tasks (ms)=1783432
		Total vcore-seconds taken by all map tasks=6718499
		Total vcore-seconds taken by all reduce tasks=1783432
		Total megabyte-seconds taken by all map tasks=6879742976
		Total megabyte-seconds taken by all reduce tasks=1826234368
	Map-Reduce Framework
		Map input records=1027826
		Map output records=893456
		Map output bytes=337634109
		Map output materialized bytes=340958077
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=792891
		Reduce shuffle bytes=340958077
		Reduce input records=893456
		Reduce output records=441784
		Spilled Records=1786912
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=65118
		CPU time spent (ms)=810010
		Physical memory (bytes) snapshot=323128725504
		Virtual memory (bytes) snapshot=742735712256
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=290616029
	File Output Format Counters 
		Bytes Written=142770862
16/12/07 12:56:14 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0500
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0600 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0600': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3045309186037272357.jar tmpDir=null
16/12/07 12:56:50 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:56:51 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:56:51 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 12:56:53 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 12:56:53 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 12:56:53 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5118
16/12/07 12:56:54 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5118
16/12/07 12:56:54 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5118/
16/12/07 12:56:54 INFO mapreduce.Job: Running job: job_1480588584072_5118
16/12/07 12:57:06 INFO mapreduce.Job: Job job_1480588584072_5118 running in uber mode : false
16/12/07 12:57:06 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 12:57:27 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 12:57:30 INFO mapreduce.Job:  map 4% reduce 0%
16/12/07 12:57:31 INFO mapreduce.Job:  map 5% reduce 0%
16/12/07 12:57:32 INFO mapreduce.Job:  map 8% reduce 0%
16/12/07 12:57:34 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 12:57:40 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 12:57:41 INFO mapreduce.Job:  map 18% reduce 0%
16/12/07 12:57:45 INFO mapreduce.Job:  map 19% reduce 0%
16/12/07 12:57:46 INFO mapreduce.Job:  map 22% reduce 0%
16/12/07 12:57:47 INFO mapreduce.Job:  map 24% reduce 0%
16/12/07 12:57:48 INFO mapreduce.Job:  map 27% reduce 0%
16/12/07 12:57:49 INFO mapreduce.Job:  map 28% reduce 0%
16/12/07 12:57:50 INFO mapreduce.Job:  map 31% reduce 0%
16/12/07 12:57:52 INFO mapreduce.Job:  map 32% reduce 0%
16/12/07 12:57:55 INFO mapreduce.Job:  map 33% reduce 0%
16/12/07 12:57:56 INFO mapreduce.Job:  map 33% reduce 1%
16/12/07 12:57:57 INFO mapreduce.Job:  map 35% reduce 2%
16/12/07 12:58:00 INFO mapreduce.Job:  map 37% reduce 4%
16/12/07 12:58:01 INFO mapreduce.Job:  map 41% reduce 6%
16/12/07 12:58:03 INFO mapreduce.Job:  map 45% reduce 8%
16/12/07 12:58:04 INFO mapreduce.Job:  map 46% reduce 9%
16/12/07 12:58:05 INFO mapreduce.Job:  map 48% reduce 9%
16/12/07 12:58:07 INFO mapreduce.Job:  map 49% reduce 13%
16/12/07 12:58:09 INFO mapreduce.Job:  map 50% reduce 14%
16/12/07 12:58:10 INFO mapreduce.Job:  map 51% reduce 15%
16/12/07 12:58:16 INFO mapreduce.Job:  map 53% reduce 15%
16/12/07 12:58:18 INFO mapreduce.Job:  map 55% reduce 16%
16/12/07 12:58:20 INFO mapreduce.Job:  map 56% reduce 17%
16/12/07 12:58:21 INFO mapreduce.Job:  map 58% reduce 17%
16/12/07 12:58:23 INFO mapreduce.Job:  map 60% reduce 17%
16/12/07 12:58:24 INFO mapreduce.Job:  map 62% reduce 17%
16/12/07 12:58:25 INFO mapreduce.Job:  map 63% reduce 17%
16/12/07 12:58:26 INFO mapreduce.Job:  map 64% reduce 20%
16/12/07 12:58:29 INFO mapreduce.Job:  map 69% reduce 20%
16/12/07 12:58:30 INFO mapreduce.Job:  map 72% reduce 20%
16/12/07 12:58:32 INFO mapreduce.Job:  map 75% reduce 21%
16/12/07 12:58:33 INFO mapreduce.Job:  map 76% reduce 23%
16/12/07 12:58:35 INFO mapreduce.Job:  map 78% reduce 23%
16/12/07 12:58:36 INFO mapreduce.Job:  map 81% reduce 25%
16/12/07 12:58:37 INFO mapreduce.Job:  map 83% reduce 25%
16/12/07 12:58:41 INFO mapreduce.Job:  map 88% reduce 27%
16/12/07 12:58:44 INFO mapreduce.Job:  map 90% reduce 29%
16/12/07 12:58:45 INFO mapreduce.Job:  map 91% reduce 29%
16/12/07 12:58:46 INFO mapreduce.Job:  map 92% reduce 30%
16/12/07 12:58:47 INFO mapreduce.Job:  map 93% reduce 30%
16/12/07 12:58:48 INFO mapreduce.Job:  map 94% reduce 30%
16/12/07 12:58:49 INFO mapreduce.Job:  map 95% reduce 31%
16/12/07 12:58:50 INFO mapreduce.Job:  map 97% reduce 31%
16/12/07 12:58:51 INFO mapreduce.Job:  map 98% reduce 31%
16/12/07 12:58:52 INFO mapreduce.Job:  map 98% reduce 33%
16/12/07 12:58:53 INFO mapreduce.Job:  map 99% reduce 33%
16/12/07 12:58:54 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 12:58:55 INFO mapreduce.Job:  map 100% reduce 39%
16/12/07 12:58:56 INFO mapreduce.Job:  map 100% reduce 43%
16/12/07 12:58:58 INFO mapreduce.Job:  map 100% reduce 63%
16/12/07 12:58:59 INFO mapreduce.Job:  map 100% reduce 81%
16/12/07 12:59:00 INFO mapreduce.Job:  map 100% reduce 85%
16/12/07 12:59:01 INFO mapreduce.Job:  map 100% reduce 86%
16/12/07 12:59:02 INFO mapreduce.Job:  map 100% reduce 92%
16/12/07 12:59:04 INFO mapreduce.Job:  map 100% reduce 95%
16/12/07 12:59:06 INFO mapreduce.Job:  map 100% reduce 98%
16/12/07 12:59:07 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 12:59:11 INFO mapreduce.Job: Job job_1480588584072_5118 completed successfully
16/12/07 12:59:11 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=417274205
		FILE: Number of bytes written=866930375
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=357559619
		WASB: Number of bytes written=179661518
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13140960
		Total time spent by all reduces in occupied slots (ms)=3070502
		Total time spent by all map tasks (ms)=6570480
		Total time spent by all reduce tasks (ms)=1535251
		Total vcore-seconds taken by all map tasks=6570480
		Total vcore-seconds taken by all reduce tasks=1535251
		Total megabyte-seconds taken by all map tasks=6728171520
		Total megabyte-seconds taken by all reduce tasks=1572097024
	Map-Reduce Framework
		Map input records=1240606
		Map output records=1084407
		Map output bytes=413250902
		Map output materialized bytes=417297725
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=957717
		Reduce shuffle bytes=417297725
		Reduce input records=1084407
		Reduce output records=558274
		Spilled Records=2168814
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=68203
		CPU time spent (ms)=828280
		Physical memory (bytes) snapshot=323175510016
		Virtual memory (bytes) snapshot=742977384448
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=354863615
	File Output Format Counters 
		Bytes Written=179661518
16/12/07 12:59:11 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0600
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0700 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161206/201612062300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0700': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob573695048892464833.jar tmpDir=null
16/12/07 12:59:48 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:59:49 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 12:59:49 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 12:59:51 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 12:59:52 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 12:59:52 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5121
16/12/07 12:59:53 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5121
16/12/07 12:59:53 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5121/
16/12/07 12:59:53 INFO mapreduce.Job: Running job: job_1480588584072_5121
16/12/07 13:00:05 INFO mapreduce.Job: Job job_1480588584072_5121 running in uber mode : false
16/12/07 13:00:05 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 13:00:17 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 13:00:25 INFO mapreduce.Job:  map 4% reduce 0%
16/12/07 13:00:26 INFO mapreduce.Job:  map 6% reduce 0%
16/12/07 13:00:27 INFO mapreduce.Job:  map 9% reduce 0%
16/12/07 13:00:29 INFO mapreduce.Job:  map 11% reduce 0%
16/12/07 13:00:31 INFO mapreduce.Job:  map 13% reduce 0%
16/12/07 13:00:35 INFO mapreduce.Job:  map 14% reduce 0%
16/12/07 13:00:36 INFO mapreduce.Job:  map 16% reduce 0%
16/12/07 13:00:37 INFO mapreduce.Job:  map 19% reduce 0%
16/12/07 13:00:38 INFO mapreduce.Job:  map 21% reduce 0%
16/12/07 13:00:39 INFO mapreduce.Job:  map 22% reduce 0%
16/12/07 13:00:40 INFO mapreduce.Job:  map 24% reduce 0%
16/12/07 13:00:42 INFO mapreduce.Job:  map 25% reduce 0%
16/12/07 13:00:45 INFO mapreduce.Job:  map 26% reduce 1%
16/12/07 13:00:46 INFO mapreduce.Job:  map 26% reduce 3%
16/12/07 13:00:48 INFO mapreduce.Job:  map 26% reduce 4%
16/12/07 13:00:50 INFO mapreduce.Job:  map 26% reduce 5%
16/12/07 13:00:51 INFO mapreduce.Job:  map 27% reduce 5%
16/12/07 13:00:52 INFO mapreduce.Job:  map 28% reduce 5%
16/12/07 13:00:53 INFO mapreduce.Job:  map 28% reduce 6%
16/12/07 13:00:54 INFO mapreduce.Job:  map 31% reduce 8%
16/12/07 13:00:55 INFO mapreduce.Job:  map 31% reduce 9%
16/12/07 13:00:56 INFO mapreduce.Job:  map 31% reduce 10%
16/12/07 13:00:58 INFO mapreduce.Job:  map 32% reduce 11%
16/12/07 13:00:59 INFO mapreduce.Job:  map 33% reduce 11%
16/12/07 13:01:00 INFO mapreduce.Job:  map 34% reduce 11%
16/12/07 13:01:04 INFO mapreduce.Job:  map 35% reduce 11%
16/12/07 13:01:05 INFO mapreduce.Job:  map 38% reduce 11%
16/12/07 13:01:06 INFO mapreduce.Job:  map 39% reduce 12%
16/12/07 13:01:08 INFO mapreduce.Job:  map 39% reduce 13%
16/12/07 13:01:10 INFO mapreduce.Job:  map 40% reduce 13%
16/12/07 13:01:11 INFO mapreduce.Job:  map 41% reduce 13%
16/12/07 13:01:13 INFO mapreduce.Job:  map 42% reduce 13%
16/12/07 13:01:14 INFO mapreduce.Job:  map 44% reduce 14%
16/12/07 13:01:16 INFO mapreduce.Job:  map 48% reduce 14%
16/12/07 13:01:17 INFO mapreduce.Job:  map 51% reduce 15%
16/12/07 13:01:18 INFO mapreduce.Job:  map 52% reduce 15%
16/12/07 13:01:19 INFO mapreduce.Job:  map 54% reduce 16%
16/12/07 13:01:20 INFO mapreduce.Job:  map 57% reduce 16%
16/12/07 13:01:21 INFO mapreduce.Job:  map 60% reduce 17%
16/12/07 13:01:22 INFO mapreduce.Job:  map 60% reduce 18%
16/12/07 13:01:23 INFO mapreduce.Job:  map 61% reduce 18%
16/12/07 13:01:24 INFO mapreduce.Job:  map 64% reduce 19%
16/12/07 13:01:25 INFO mapreduce.Job:  map 66% reduce 19%
16/12/07 13:01:26 INFO mapreduce.Job:  map 67% reduce 20%
16/12/07 13:01:27 INFO mapreduce.Job:  map 71% reduce 21%
16/12/07 13:01:28 INFO mapreduce.Job:  map 72% reduce 22%
16/12/07 13:01:29 INFO mapreduce.Job:  map 74% reduce 22%
16/12/07 13:01:30 INFO mapreduce.Job:  map 76% reduce 23%
16/12/07 13:01:31 INFO mapreduce.Job:  map 76% reduce 24%
16/12/07 13:01:32 INFO mapreduce.Job:  map 77% reduce 24%
16/12/07 13:01:33 INFO mapreduce.Job:  map 79% reduce 25%
16/12/07 13:01:35 INFO mapreduce.Job:  map 81% reduce 26%
16/12/07 13:01:36 INFO mapreduce.Job:  map 82% reduce 26%
16/12/07 13:01:37 INFO mapreduce.Job:  map 82% reduce 27%
16/12/07 13:01:40 INFO mapreduce.Job:  map 83% reduce 27%
16/12/07 13:01:44 INFO mapreduce.Job:  map 83% reduce 28%
16/12/07 13:01:53 INFO mapreduce.Job:  map 84% reduce 28%
16/12/07 13:01:54 INFO mapreduce.Job:  map 86% reduce 28%
16/12/07 13:01:55 INFO mapreduce.Job:  map 88% reduce 28%
16/12/07 13:01:56 INFO mapreduce.Job:  map 90% reduce 28%
16/12/07 13:01:57 INFO mapreduce.Job:  map 93% reduce 29%
16/12/07 13:01:58 INFO mapreduce.Job:  map 98% reduce 30%
16/12/07 13:01:59 INFO mapreduce.Job:  map 99% reduce 31%
16/12/07 13:02:00 INFO mapreduce.Job:  map 99% reduce 32%
16/12/07 13:02:01 INFO mapreduce.Job:  map 99% reduce 33%
16/12/07 13:02:02 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 13:02:03 INFO mapreduce.Job:  map 100% reduce 37%
16/12/07 13:02:04 INFO mapreduce.Job:  map 100% reduce 44%
16/12/07 13:02:05 INFO mapreduce.Job:  map 100% reduce 56%
16/12/07 13:02:06 INFO mapreduce.Job:  map 100% reduce 68%
16/12/07 13:02:07 INFO mapreduce.Job:  map 100% reduce 75%
16/12/07 13:02:08 INFO mapreduce.Job:  map 100% reduce 80%
16/12/07 13:02:09 INFO mapreduce.Job:  map 100% reduce 88%
16/12/07 13:02:10 INFO mapreduce.Job:  map 100% reduce 98%
16/12/07 13:02:11 INFO mapreduce.Job:  map 100% reduce 99%
16/12/07 13:02:14 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 13:02:17 INFO mapreduce.Job: Job job_1480588584072_5121 completed successfully
16/12/07 13:02:17 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=509239450
		FILE: Number of bytes written=1050860865
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=438887283
		WASB: Number of bytes written=227513485
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12896988
		Total time spent by all reduces in occupied slots (ms)=3769440
		Total time spent by all map tasks (ms)=6448494
		Total time spent by all reduce tasks (ms)=1884720
		Total vcore-seconds taken by all map tasks=6448494
		Total vcore-seconds taken by all reduce tasks=1884720
		Total megabyte-seconds taken by all map tasks=6603257856
		Total megabyte-seconds taken by all reduce tasks=1929953280
	Map-Reduce Framework
		Map input records=1497766
		Map output records=1303680
		Map output bytes=504360085
		Map output materialized bytes=509262970
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1145779
		Reduce shuffle bytes=509262970
		Reduce input records=1303680
		Reduce output records=691406
		Spilled Records=2607360
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=76004
		CPU time spent (ms)=863630
		Physical memory (bytes) snapshot=323738873856
		Virtual memory (bytes) snapshot=742639890432
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=436191279
	File Output Format Counters 
		Bytes Written=227513485
16/12/07 13:02:17 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0700
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070400 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0800 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070400
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0800': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3979094893335871296.jar tmpDir=null
16/12/07 13:43:17 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 13:43:18 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 13:43:18 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 13:43:20 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 13:43:20 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 13:43:20 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5150
16/12/07 13:43:21 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5150
16/12/07 13:43:21 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5150/
16/12/07 13:43:21 INFO mapreduce.Job: Running job: job_1480588584072_5150
16/12/07 13:43:33 INFO mapreduce.Job: Job job_1480588584072_5150 running in uber mode : false
16/12/07 13:43:33 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 13:43:45 INFO mapreduce.Job:  map 2% reduce 0%
16/12/07 13:43:54 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 13:43:55 INFO mapreduce.Job:  map 4% reduce 0%
16/12/07 13:43:56 INFO mapreduce.Job:  map 7% reduce 0%
16/12/07 13:43:57 INFO mapreduce.Job:  map 14% reduce 0%
16/12/07 13:43:58 INFO mapreduce.Job:  map 16% reduce 0%
16/12/07 13:44:03 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 13:44:04 INFO mapreduce.Job:  map 18% reduce 0%
16/12/07 13:44:08 INFO mapreduce.Job:  map 19% reduce 0%
16/12/07 13:44:09 INFO mapreduce.Job:  map 21% reduce 0%
16/12/07 13:44:10 INFO mapreduce.Job:  map 24% reduce 0%
16/12/07 13:44:11 INFO mapreduce.Job:  map 27% reduce 1%
16/12/07 13:44:12 INFO mapreduce.Job:  map 27% reduce 2%
16/12/07 13:44:14 INFO mapreduce.Job:  map 27% reduce 3%
16/12/07 13:44:15 INFO mapreduce.Job:  map 27% reduce 4%
16/12/07 13:44:20 INFO mapreduce.Job:  map 27% reduce 5%
16/12/07 13:44:21 INFO mapreduce.Job:  map 29% reduce 5%
16/12/07 13:44:22 INFO mapreduce.Job:  map 30% reduce 5%
16/12/07 13:44:23 INFO mapreduce.Job:  map 30% reduce 6%
16/12/07 13:44:24 INFO mapreduce.Job:  map 30% reduce 7%
16/12/07 13:44:25 INFO mapreduce.Job:  map 31% reduce 8%
16/12/07 13:44:26 INFO mapreduce.Job:  map 31% reduce 10%
16/12/07 13:44:28 INFO mapreduce.Job:  map 32% reduce 10%
16/12/07 13:44:30 INFO mapreduce.Job:  map 34% reduce 11%
16/12/07 13:44:34 INFO mapreduce.Job:  map 35% reduce 11%
16/12/07 13:44:35 INFO mapreduce.Job:  map 36% reduce 11%
16/12/07 13:44:36 INFO mapreduce.Job:  map 36% reduce 12%
16/12/07 13:44:39 INFO mapreduce.Job:  map 38% reduce 12%
16/12/07 13:44:40 INFO mapreduce.Job:  map 39% reduce 12%
16/12/07 13:44:41 INFO mapreduce.Job:  map 40% reduce 12%
16/12/07 13:44:42 INFO mapreduce.Job:  map 40% reduce 13%
16/12/07 13:44:43 INFO mapreduce.Job:  map 41% reduce 13%
16/12/07 13:44:44 INFO mapreduce.Job:  map 42% reduce 13%
16/12/07 13:44:45 INFO mapreduce.Job:  map 43% reduce 13%
16/12/07 13:44:46 INFO mapreduce.Job:  map 44% reduce 14%
16/12/07 13:44:47 INFO mapreduce.Job:  map 45% reduce 14%
16/12/07 13:44:48 INFO mapreduce.Job:  map 48% reduce 14%
16/12/07 13:44:49 INFO mapreduce.Job:  map 49% reduce 15%
16/12/07 13:44:50 INFO mapreduce.Job:  map 51% reduce 15%
16/12/07 13:44:51 INFO mapreduce.Job:  map 51% reduce 16%
16/12/07 13:44:52 INFO mapreduce.Job:  map 53% reduce 16%
16/12/07 13:44:53 INFO mapreduce.Job:  map 54% reduce 16%
16/12/07 13:44:54 INFO mapreduce.Job:  map 55% reduce 16%
16/12/07 13:44:55 INFO mapreduce.Job:  map 58% reduce 17%
16/12/07 13:44:56 INFO mapreduce.Job:  map 59% reduce 17%
16/12/07 13:44:57 INFO mapreduce.Job:  map 62% reduce 18%
16/12/07 13:44:58 INFO mapreduce.Job:  map 63% reduce 18%
16/12/07 13:44:59 INFO mapreduce.Job:  map 65% reduce 19%
16/12/07 13:45:00 INFO mapreduce.Job:  map 66% reduce 20%
16/12/07 13:45:01 INFO mapreduce.Job:  map 67% reduce 20%
16/12/07 13:45:02 INFO mapreduce.Job:  map 68% reduce 20%
16/12/07 13:45:03 INFO mapreduce.Job:  map 70% reduce 21%
16/12/07 13:45:04 INFO mapreduce.Job:  map 71% reduce 21%
16/12/07 13:45:05 INFO mapreduce.Job:  map 72% reduce 22%
16/12/07 13:45:06 INFO mapreduce.Job:  map 74% reduce 22%
16/12/07 13:45:07 INFO mapreduce.Job:  map 75% reduce 22%
16/12/07 13:45:08 INFO mapreduce.Job:  map 75% reduce 23%
16/12/07 13:45:09 INFO mapreduce.Job:  map 76% reduce 23%
16/12/07 13:45:10 INFO mapreduce.Job:  map 78% reduce 24%
16/12/07 13:45:12 INFO mapreduce.Job:  map 79% reduce 25%
16/12/07 13:45:13 INFO mapreduce.Job:  map 81% reduce 25%
16/12/07 13:45:14 INFO mapreduce.Job:  map 81% reduce 26%
16/12/07 13:45:16 INFO mapreduce.Job:  map 81% reduce 27%
16/12/07 13:45:24 INFO mapreduce.Job:  map 82% reduce 27%
16/12/07 13:45:25 INFO mapreduce.Job:  map 83% reduce 27%
16/12/07 13:45:26 INFO mapreduce.Job:  map 85% reduce 27%
16/12/07 13:45:27 INFO mapreduce.Job:  map 86% reduce 28%
16/12/07 13:45:28 INFO mapreduce.Job:  map 87% reduce 28%
16/12/07 13:45:29 INFO mapreduce.Job:  map 87% reduce 29%
16/12/07 13:45:30 INFO mapreduce.Job:  map 88% reduce 29%
16/12/07 13:45:35 INFO mapreduce.Job:  map 89% reduce 29%
16/12/07 13:45:36 INFO mapreduce.Job:  map 90% reduce 29%
16/12/07 13:45:38 INFO mapreduce.Job:  map 91% reduce 29%
16/12/07 13:45:39 INFO mapreduce.Job:  map 91% reduce 30%
16/12/07 13:45:41 INFO mapreduce.Job:  map 92% reduce 30%
16/12/07 13:45:43 INFO mapreduce.Job:  map 94% reduce 30%
16/12/07 13:45:44 INFO mapreduce.Job:  map 96% reduce 31%
16/12/07 13:45:45 INFO mapreduce.Job:  map 97% reduce 31%
16/12/07 13:45:46 INFO mapreduce.Job:  map 99% reduce 32%
16/12/07 13:45:47 INFO mapreduce.Job:  map 100% reduce 32%
16/12/07 13:45:48 INFO mapreduce.Job:  map 100% reduce 34%
16/12/07 13:45:49 INFO mapreduce.Job:  map 100% reduce 43%
16/12/07 13:45:50 INFO mapreduce.Job:  map 100% reduce 50%
16/12/07 13:45:51 INFO mapreduce.Job:  map 100% reduce 59%
16/12/07 13:45:52 INFO mapreduce.Job:  map 100% reduce 70%
16/12/07 13:45:53 INFO mapreduce.Job:  map 100% reduce 77%
16/12/07 13:45:54 INFO mapreduce.Job:  map 100% reduce 83%
16/12/07 13:45:55 INFO mapreduce.Job:  map 100% reduce 89%
16/12/07 13:45:56 INFO mapreduce.Job:  map 100% reduce 94%
16/12/07 13:45:57 INFO mapreduce.Job:  map 100% reduce 96%
16/12/07 13:45:58 INFO mapreduce.Job:  map 100% reduce 99%
16/12/07 13:45:59 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 13:46:01 INFO mapreduce.Job: Job job_1480588584072_5150 completed successfully
16/12/07 13:46:01 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=701650344
		FILE: Number of bytes written=1435682653
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=595402918
		WASB: Number of bytes written=361602246
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=14935694
		Total time spent by all reduces in occupied slots (ms)=4388150
		Total time spent by all map tasks (ms)=7467847
		Total time spent by all reduce tasks (ms)=2194075
		Total vcore-seconds taken by all map tasks=7467847
		Total vcore-seconds taken by all reduce tasks=2194075
		Total megabyte-seconds taken by all map tasks=7647075328
		Total megabyte-seconds taken by all reduce tasks=2246732800
	Map-Reduce Framework
		Map input records=1979041
		Map output records=1764800
		Map output bytes=694997893
		Map output materialized bytes=701673864
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1565739
		Reduce shuffle bytes=701673864
		Reduce input records=1764800
		Reduce output records=1087713
		Spilled Records=3529600
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=67535
		CPU time spent (ms)=933760
		Physical memory (bytes) snapshot=324466053120
		Virtual memory (bytes) snapshot=742591774720
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=592706914
	File Output Format Counters 
		Bytes Written=361602246
16/12/07 13:46:01 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0800
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070500 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0900 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070500
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0900': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob130851278204379562.jar tmpDir=null
16/12/07 14:47:15 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 14:47:15 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 14:47:16 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 14:47:17 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 14:47:18 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 14:47:18 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5232
16/12/07 14:47:19 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5232
16/12/07 14:47:19 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5232/
16/12/07 14:47:19 INFO mapreduce.Job: Running job: job_1480588584072_5232
16/12/07 14:47:32 INFO mapreduce.Job: Job job_1480588584072_5232 running in uber mode : false
16/12/07 14:47:32 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 14:47:42 INFO mapreduce.Job:  map 2% reduce 0%
16/12/07 14:47:49 INFO mapreduce.Job:  map 4% reduce 0%
16/12/07 14:47:53 INFO mapreduce.Job:  map 5% reduce 0%
16/12/07 14:47:55 INFO mapreduce.Job:  map 8% reduce 0%
16/12/07 14:47:56 INFO mapreduce.Job:  map 9% reduce 0%
16/12/07 14:47:58 INFO mapreduce.Job:  map 10% reduce 0%
16/12/07 14:47:59 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 14:48:01 INFO mapreduce.Job:  map 13% reduce 0%
16/12/07 14:48:02 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 14:48:03 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 14:48:04 INFO mapreduce.Job:  map 18% reduce 0%
16/12/07 14:48:06 INFO mapreduce.Job:  map 19% reduce 0%
16/12/07 14:48:08 INFO mapreduce.Job:  map 22% reduce 0%
16/12/07 14:48:09 INFO mapreduce.Job:  map 23% reduce 0%
16/12/07 14:48:10 INFO mapreduce.Job:  map 23% reduce 1%
16/12/07 14:48:11 INFO mapreduce.Job:  map 23% reduce 2%
16/12/07 14:48:12 INFO mapreduce.Job:  map 24% reduce 2%
16/12/07 14:48:19 INFO mapreduce.Job:  map 26% reduce 2%
16/12/07 14:48:20 INFO mapreduce.Job:  map 29% reduce 3%
16/12/07 14:48:21 INFO mapreduce.Job:  map 31% reduce 3%
16/12/07 14:48:22 INFO mapreduce.Job:  map 32% reduce 5%
16/12/07 14:48:23 INFO mapreduce.Job:  map 32% reduce 6%
16/12/07 14:48:26 INFO mapreduce.Job:  map 33% reduce 6%
16/12/07 14:48:28 INFO mapreduce.Job:  map 34% reduce 6%
16/12/07 14:48:29 INFO mapreduce.Job:  map 35% reduce 6%
16/12/07 14:48:30 INFO mapreduce.Job:  map 35% reduce 7%
16/12/07 14:48:31 INFO mapreduce.Job:  map 37% reduce 7%
16/12/07 14:48:34 INFO mapreduce.Job:  map 39% reduce 9%
16/12/07 14:48:35 INFO mapreduce.Job:  map 40% reduce 9%
16/12/07 14:48:36 INFO mapreduce.Job:  map 43% reduce 9%
16/12/07 14:48:37 INFO mapreduce.Job:  map 44% reduce 9%
16/12/07 14:48:38 INFO mapreduce.Job:  map 47% reduce 10%
16/12/07 14:48:39 INFO mapreduce.Job:  map 48% reduce 11%
16/12/07 14:48:40 INFO mapreduce.Job:  map 49% reduce 11%
16/12/07 14:48:41 INFO mapreduce.Job:  map 50% reduce 12%
16/12/07 14:48:42 INFO mapreduce.Job:  map 52% reduce 12%
16/12/07 14:48:43 INFO mapreduce.Job:  map 54% reduce 12%
16/12/07 14:48:44 INFO mapreduce.Job:  map 56% reduce 13%
16/12/07 14:48:46 INFO mapreduce.Job:  map 57% reduce 13%
16/12/07 14:48:47 INFO mapreduce.Job:  map 59% reduce 15%
16/12/07 14:48:48 INFO mapreduce.Job:  map 61% reduce 15%
16/12/07 14:48:49 INFO mapreduce.Job:  map 64% reduce 15%
16/12/07 14:48:50 INFO mapreduce.Job:  map 64% reduce 16%
16/12/07 14:48:52 INFO mapreduce.Job:  map 65% reduce 17%
16/12/07 14:48:54 INFO mapreduce.Job:  map 66% reduce 18%
16/12/07 14:48:55 INFO mapreduce.Job:  map 68% reduce 18%
16/12/07 14:48:56 INFO mapreduce.Job:  map 68% reduce 19%
16/12/07 14:49:00 INFO mapreduce.Job:  map 69% reduce 20%
16/12/07 14:49:01 INFO mapreduce.Job:  map 70% reduce 21%
16/12/07 14:49:02 INFO mapreduce.Job:  map 72% reduce 23%
16/12/07 14:49:03 INFO mapreduce.Job:  map 74% reduce 23%
16/12/07 14:49:04 INFO mapreduce.Job:  map 74% reduce 24%
16/12/07 14:49:05 INFO mapreduce.Job:  map 75% reduce 24%
16/12/07 14:49:07 INFO mapreduce.Job:  map 76% reduce 25%
16/12/07 14:49:08 INFO mapreduce.Job:  map 77% reduce 25%
16/12/07 14:49:09 INFO mapreduce.Job:  map 78% reduce 25%
16/12/07 14:49:10 INFO mapreduce.Job:  map 80% reduce 25%
16/12/07 14:49:11 INFO mapreduce.Job:  map 81% reduce 26%
16/12/07 14:49:13 INFO mapreduce.Job:  map 82% reduce 26%
16/12/07 14:49:14 INFO mapreduce.Job:  map 85% reduce 27%
16/12/07 14:49:15 INFO mapreduce.Job:  map 86% reduce 27%
16/12/07 14:49:16 INFO mapreduce.Job:  map 87% reduce 28%
16/12/07 14:49:17 INFO mapreduce.Job:  map 89% reduce 29%
16/12/07 14:49:18 INFO mapreduce.Job:  map 90% reduce 29%
16/12/07 14:49:19 INFO mapreduce.Job:  map 91% reduce 29%
16/12/07 14:49:20 INFO mapreduce.Job:  map 91% reduce 30%
16/12/07 14:49:21 INFO mapreduce.Job:  map 93% reduce 30%
16/12/07 14:49:22 INFO mapreduce.Job:  map 95% reduce 30%
16/12/07 14:49:23 INFO mapreduce.Job:  map 96% reduce 31%
16/12/07 14:49:24 INFO mapreduce.Job:  map 97% reduce 32%
16/12/07 14:49:25 INFO mapreduce.Job:  map 98% reduce 32%
16/12/07 14:49:26 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 14:49:27 INFO mapreduce.Job:  map 100% reduce 34%
16/12/07 14:49:28 INFO mapreduce.Job:  map 100% reduce 40%
16/12/07 14:49:29 INFO mapreduce.Job:  map 100% reduce 56%
16/12/07 14:49:30 INFO mapreduce.Job:  map 100% reduce 65%
16/12/07 14:49:31 INFO mapreduce.Job:  map 100% reduce 74%
16/12/07 14:49:32 INFO mapreduce.Job:  map 100% reduce 84%
16/12/07 14:49:33 INFO mapreduce.Job:  map 100% reduce 89%
16/12/07 14:49:34 INFO mapreduce.Job:  map 100% reduce 96%
16/12/07 14:49:35 INFO mapreduce.Job:  map 100% reduce 97%
16/12/07 14:49:36 INFO mapreduce.Job:  map 100% reduce 98%
16/12/07 14:49:37 INFO mapreduce.Job:  map 100% reduce 99%
16/12/07 14:49:40 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 14:49:42 INFO mapreduce.Job: Job job_1480588584072_5232 completed successfully
16/12/07 14:49:42 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=647214512
		FILE: Number of bytes written=1326810989
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=558247066
		WASB: Number of bytes written=297219777
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=9942690
		Total time spent by all reduces in occupied slots (ms)=3373086
		Total time spent by all map tasks (ms)=4971345
		Total time spent by all reduce tasks (ms)=1686543
		Total vcore-seconds taken by all map tasks=4971345
		Total vcore-seconds taken by all reduce tasks=1686543
		Total megabyte-seconds taken by all map tasks=5090657280
		Total megabyte-seconds taken by all reduce tasks=1727020032
	Map-Reduce Framework
		Map input records=1880377
		Map output records=1637560
		Map output bytes=641036792
		Map output materialized bytes=647238032
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1435468
		Reduce shuffle bytes=647238032
		Reduce input records=1637560
		Reduce output records=894821
		Spilled Records=3275120
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=65282
		CPU time spent (ms)=869400
		Physical memory (bytes) snapshot=323571216384
		Virtual memory (bytes) snapshot=742562598912
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=555551062
	File Output Format Counters 
		Bytes Written=297219777
16/12/07 14:49:42 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/0900
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070600 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070600
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4091604755151385938.jar tmpDir=null
16/12/07 15:45:51 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 15:45:52 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 15:45:52 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 15:45:54 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 15:45:54 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 15:45:55 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5267
16/12/07 15:45:55 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5267
16/12/07 15:45:55 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5267/
16/12/07 15:45:55 INFO mapreduce.Job: Running job: job_1480588584072_5267
16/12/07 15:46:08 INFO mapreduce.Job: Job job_1480588584072_5267 running in uber mode : false
16/12/07 15:46:08 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 15:46:20 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 15:46:21 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 15:46:29 INFO mapreduce.Job:  map 6% reduce 0%
16/12/07 15:46:30 INFO mapreduce.Job:  map 9% reduce 0%
16/12/07 15:46:31 INFO mapreduce.Job:  map 14% reduce 0%
16/12/07 15:46:32 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 15:46:34 INFO mapreduce.Job:  map 16% reduce 0%
16/12/07 15:46:36 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 15:46:37 INFO mapreduce.Job:  map 18% reduce 0%
16/12/07 15:46:39 INFO mapreduce.Job:  map 22% reduce 0%
16/12/07 15:46:40 INFO mapreduce.Job:  map 25% reduce 0%
16/12/07 15:46:41 INFO mapreduce.Job:  map 26% reduce 0%
16/12/07 15:46:42 INFO mapreduce.Job:  map 27% reduce 0%
16/12/07 15:46:43 INFO mapreduce.Job:  map 30% reduce 0%
16/12/07 15:46:46 INFO mapreduce.Job:  map 31% reduce 3%
16/12/07 15:46:47 INFO mapreduce.Job:  map 32% reduce 3%
16/12/07 15:46:48 INFO mapreduce.Job:  map 34% reduce 3%
16/12/07 15:46:50 INFO mapreduce.Job:  map 36% reduce 3%
16/12/07 15:46:51 INFO mapreduce.Job:  map 39% reduce 3%
16/12/07 15:46:53 INFO mapreduce.Job:  map 40% reduce 4%
16/12/07 15:46:55 INFO mapreduce.Job:  map 42% reduce 5%
16/12/07 15:46:56 INFO mapreduce.Job:  map 45% reduce 5%
16/12/07 15:46:57 INFO mapreduce.Job:  map 47% reduce 5%
16/12/07 15:46:58 INFO mapreduce.Job:  map 47% reduce 6%
16/12/07 15:47:00 INFO mapreduce.Job:  map 48% reduce 7%
16/12/07 15:47:01 INFO mapreduce.Job:  map 50% reduce 9%
16/12/07 15:47:03 INFO mapreduce.Job:  map 51% reduce 9%
16/12/07 15:47:04 INFO mapreduce.Job:  map 52% reduce 10%
16/12/07 15:47:05 INFO mapreduce.Job:  map 53% reduce 10%
16/12/07 15:47:06 INFO mapreduce.Job:  map 54% reduce 11%
16/12/07 15:47:07 INFO mapreduce.Job:  map 54% reduce 12%
16/12/07 15:47:08 INFO mapreduce.Job:  map 57% reduce 13%
16/12/07 15:47:09 INFO mapreduce.Job:  map 58% reduce 13%
16/12/07 15:47:10 INFO mapreduce.Job:  map 59% reduce 15%
16/12/07 15:47:11 INFO mapreduce.Job:  map 60% reduce 16%
16/12/07 15:47:12 INFO mapreduce.Job:  map 63% reduce 17%
16/12/07 15:47:14 INFO mapreduce.Job:  map 63% reduce 18%
16/12/07 15:47:15 INFO mapreduce.Job:  map 64% reduce 19%
16/12/07 15:47:18 INFO mapreduce.Job:  map 65% reduce 19%
16/12/07 15:47:19 INFO mapreduce.Job:  map 67% reduce 19%
16/12/07 15:47:20 INFO mapreduce.Job:  map 69% reduce 20%
16/12/07 15:47:21 INFO mapreduce.Job:  map 72% reduce 20%
16/12/07 15:47:22 INFO mapreduce.Job:  map 73% reduce 21%
16/12/07 15:47:24 INFO mapreduce.Job:  map 73% reduce 22%
16/12/07 15:47:25 INFO mapreduce.Job:  map 74% reduce 22%
16/12/07 15:47:26 INFO mapreduce.Job:  map 75% reduce 22%
16/12/07 15:47:27 INFO mapreduce.Job:  map 77% reduce 22%
16/12/07 15:47:28 INFO mapreduce.Job:  map 77% reduce 23%
16/12/07 15:47:29 INFO mapreduce.Job:  map 78% reduce 23%
16/12/07 15:47:30 INFO mapreduce.Job:  map 79% reduce 23%
16/12/07 15:47:31 INFO mapreduce.Job:  map 80% reduce 23%
16/12/07 15:47:33 INFO mapreduce.Job:  map 84% reduce 24%
16/12/07 15:47:34 INFO mapreduce.Job:  map 85% reduce 24%
16/12/07 15:47:35 INFO mapreduce.Job:  map 85% reduce 25%
16/12/07 15:47:36 INFO mapreduce.Job:  map 86% reduce 25%
16/12/07 15:47:37 INFO mapreduce.Job:  map 87% reduce 26%
16/12/07 15:47:38 INFO mapreduce.Job:  map 88% reduce 26%
16/12/07 15:47:39 INFO mapreduce.Job:  map 89% reduce 26%
16/12/07 15:47:40 INFO mapreduce.Job:  map 90% reduce 27%
16/12/07 15:47:42 INFO mapreduce.Job:  map 91% reduce 27%
16/12/07 15:47:44 INFO mapreduce.Job:  map 92% reduce 27%
16/12/07 15:47:45 INFO mapreduce.Job:  map 94% reduce 27%
16/12/07 15:47:46 INFO mapreduce.Job:  map 97% reduce 28%
16/12/07 15:47:47 INFO mapreduce.Job:  map 99% reduce 28%
16/12/07 15:47:48 INFO mapreduce.Job:  map 100% reduce 29%
16/12/07 15:47:49 INFO mapreduce.Job:  map 100% reduce 32%
16/12/07 15:47:50 INFO mapreduce.Job:  map 100% reduce 36%
16/12/07 15:47:51 INFO mapreduce.Job:  map 100% reduce 46%
16/12/07 15:47:52 INFO mapreduce.Job:  map 100% reduce 59%
16/12/07 15:47:53 INFO mapreduce.Job:  map 100% reduce 64%
16/12/07 15:47:54 INFO mapreduce.Job:  map 100% reduce 69%
16/12/07 15:47:55 INFO mapreduce.Job:  map 100% reduce 83%
16/12/07 15:47:56 INFO mapreduce.Job:  map 100% reduce 87%
16/12/07 15:47:57 INFO mapreduce.Job:  map 100% reduce 92%
16/12/07 15:47:58 INFO mapreduce.Job:  map 100% reduce 97%
16/12/07 15:47:59 INFO mapreduce.Job:  map 100% reduce 99%
16/12/07 15:48:00 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 15:48:02 INFO mapreduce.Job: Job job_1480588584072_5267 completed successfully
16/12/07 15:48:02 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=747470444
		FILE: Number of bytes written=1527322853
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=636278409
		WASB: Number of bytes written=370653276
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=4394278
		Total time spent by all reduces in occupied slots (ms)=2630440
		Total time spent by all map tasks (ms)=2197139
		Total time spent by all reduce tasks (ms)=1315220
		Total vcore-seconds taken by all map tasks=2197139
		Total vcore-seconds taken by all reduce tasks=1315220
		Total megabyte-seconds taken by all map tasks=2249870336
		Total megabyte-seconds taken by all reduce tasks=1346785280
	Map-Reduce Framework
		Map input records=2119419
		Map output records=1878579
		Map output bytes=740376301
		Map output materialized bytes=747493964
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1655002
		Reduce shuffle bytes=747493964
		Reduce input records=1878579
		Reduce output records=1115293
		Spilled Records=3757158
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=27630
		CPU time spent (ms)=846590
		Physical memory (bytes) snapshot=323775918080
		Virtual memory (bytes) snapshot=743189782528
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=633582405
	File Output Format Counters 
		Bytes Written=370653276
16/12/07 15:48:02 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070700 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070700
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2867246108860968724.jar tmpDir=null
16/12/07 16:44:11 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 16:44:12 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 16:44:12 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 16:44:14 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 16:44:14 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 16:44:14 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5279
16/12/07 16:44:15 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5279
16/12/07 16:44:15 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5279/
16/12/07 16:44:15 INFO mapreduce.Job: Running job: job_1480588584072_5279
16/12/07 16:44:29 INFO mapreduce.Job: Job job_1480588584072_5279 running in uber mode : false
16/12/07 16:44:29 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 16:44:39 INFO mapreduce.Job:  map 2% reduce 0%
16/12/07 16:44:46 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 16:44:48 INFO mapreduce.Job:  map 4% reduce 0%
16/12/07 16:44:49 INFO mapreduce.Job:  map 5% reduce 0%
16/12/07 16:44:51 INFO mapreduce.Job:  map 7% reduce 0%
16/12/07 16:44:52 INFO mapreduce.Job:  map 8% reduce 0%
16/12/07 16:44:53 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 16:44:55 INFO mapreduce.Job:  map 16% reduce 0%
16/12/07 16:44:57 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 16:44:58 INFO mapreduce.Job:  map 18% reduce 0%
16/12/07 16:45:00 INFO mapreduce.Job:  map 20% reduce 0%
16/12/07 16:45:01 INFO mapreduce.Job:  map 21% reduce 0%
16/12/07 16:45:02 INFO mapreduce.Job:  map 23% reduce 0%
16/12/07 16:45:03 INFO mapreduce.Job:  map 24% reduce 0%
16/12/07 16:45:04 INFO mapreduce.Job:  map 25% reduce 0%
16/12/07 16:45:07 INFO mapreduce.Job:  map 27% reduce 0%
16/12/07 16:45:08 INFO mapreduce.Job:  map 33% reduce 1%
16/12/07 16:45:09 INFO mapreduce.Job:  map 34% reduce 1%
16/12/07 16:45:11 INFO mapreduce.Job:  map 35% reduce 2%
16/12/07 16:45:14 INFO mapreduce.Job:  map 36% reduce 2%
16/12/07 16:45:15 INFO mapreduce.Job:  map 37% reduce 2%
16/12/07 16:45:16 INFO mapreduce.Job:  map 38% reduce 4%
16/12/07 16:45:17 INFO mapreduce.Job:  map 40% reduce 4%
16/12/07 16:45:18 INFO mapreduce.Job:  map 41% reduce 4%
16/12/07 16:45:19 INFO mapreduce.Job:  map 42% reduce 5%
16/12/07 16:45:20 INFO mapreduce.Job:  map 45% reduce 6%
16/12/07 16:45:21 INFO mapreduce.Job:  map 46% reduce 6%
16/12/07 16:45:22 INFO mapreduce.Job:  map 48% reduce 7%
16/12/07 16:45:23 INFO mapreduce.Job:  map 49% reduce 9%
16/12/07 16:45:24 INFO mapreduce.Job:  map 49% reduce 10%
16/12/07 16:45:28 INFO mapreduce.Job:  map 52% reduce 10%
16/12/07 16:45:29 INFO mapreduce.Job:  map 53% reduce 10%
16/12/07 16:45:30 INFO mapreduce.Job:  map 55% reduce 10%
16/12/07 16:45:31 INFO mapreduce.Job:  map 55% reduce 11%
16/12/07 16:45:32 INFO mapreduce.Job:  map 55% reduce 14%
16/12/07 16:45:33 INFO mapreduce.Job:  map 56% reduce 15%
16/12/07 16:45:34 INFO mapreduce.Job:  map 58% reduce 15%
16/12/07 16:45:35 INFO mapreduce.Job:  map 59% reduce 15%
16/12/07 16:45:36 INFO mapreduce.Job:  map 61% reduce 16%
16/12/07 16:45:37 INFO mapreduce.Job:  map 62% reduce 17%
16/12/07 16:45:38 INFO mapreduce.Job:  map 63% reduce 17%
16/12/07 16:45:39 INFO mapreduce.Job:  map 64% reduce 18%
16/12/07 16:45:41 INFO mapreduce.Job:  map 65% reduce 18%
16/12/07 16:45:42 INFO mapreduce.Job:  map 65% reduce 19%
16/12/07 16:45:43 INFO mapreduce.Job:  map 66% reduce 19%
16/12/07 16:45:44 INFO mapreduce.Job:  map 68% reduce 20%
16/12/07 16:45:45 INFO mapreduce.Job:  map 69% reduce 20%
16/12/07 16:45:46 INFO mapreduce.Job:  map 71% reduce 20%
16/12/07 16:45:47 INFO mapreduce.Job:  map 72% reduce 21%
16/12/07 16:45:48 INFO mapreduce.Job:  map 73% reduce 21%
16/12/07 16:45:49 INFO mapreduce.Job:  map 74% reduce 21%
16/12/07 16:45:50 INFO mapreduce.Job:  map 75% reduce 22%
16/12/07 16:45:52 INFO mapreduce.Job:  map 76% reduce 22%
16/12/07 16:45:53 INFO mapreduce.Job:  map 77% reduce 23%
16/12/07 16:45:56 INFO mapreduce.Job:  map 79% reduce 23%
16/12/07 16:45:57 INFO mapreduce.Job:  map 82% reduce 23%
16/12/07 16:45:58 INFO mapreduce.Job:  map 83% reduce 24%
16/12/07 16:45:59 INFO mapreduce.Job:  map 84% reduce 24%
16/12/07 16:46:00 INFO mapreduce.Job:  map 85% reduce 25%
16/12/07 16:46:01 INFO mapreduce.Job:  map 86% reduce 25%
16/12/07 16:46:03 INFO mapreduce.Job:  map 86% reduce 26%
16/12/07 16:46:04 INFO mapreduce.Job:  map 87% reduce 26%
16/12/07 16:46:05 INFO mapreduce.Job:  map 88% reduce 26%
16/12/07 16:46:06 INFO mapreduce.Job:  map 90% reduce 26%
16/12/07 16:46:08 INFO mapreduce.Job:  map 91% reduce 27%
16/12/07 16:46:09 INFO mapreduce.Job:  map 94% reduce 27%
16/12/07 16:46:10 INFO mapreduce.Job:  map 95% reduce 28%
16/12/07 16:46:11 INFO mapreduce.Job:  map 96% reduce 28%
16/12/07 16:46:13 INFO mapreduce.Job:  map 97% reduce 29%
16/12/07 16:46:14 INFO mapreduce.Job:  map 98% reduce 29%
16/12/07 16:46:15 INFO mapreduce.Job:  map 99% reduce 29%
16/12/07 16:46:16 INFO mapreduce.Job:  map 100% reduce 29%
16/12/07 16:46:17 INFO mapreduce.Job:  map 100% reduce 34%
16/12/07 16:46:18 INFO mapreduce.Job:  map 100% reduce 43%
16/12/07 16:46:19 INFO mapreduce.Job:  map 100% reduce 53%
16/12/07 16:46:20 INFO mapreduce.Job:  map 100% reduce 69%
16/12/07 16:46:21 INFO mapreduce.Job:  map 100% reduce 76%
16/12/07 16:46:22 INFO mapreduce.Job:  map 100% reduce 82%
16/12/07 16:46:23 INFO mapreduce.Job:  map 100% reduce 91%
16/12/07 16:46:24 INFO mapreduce.Job:  map 100% reduce 97%
16/12/07 16:46:25 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 16:46:29 INFO mapreduce.Job: Job job_1480588584072_5279 completed successfully
16/12/07 16:46:30 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=734425967
		FILE: Number of bytes written=1501233899
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=626402805
		WASB: Number of bytes written=350314476
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=4656292
		Total time spent by all reduces in occupied slots (ms)=2755924
		Total time spent by all map tasks (ms)=2328146
		Total time spent by all reduce tasks (ms)=1377962
		Total vcore-seconds taken by all map tasks=2328146
		Total vcore-seconds taken by all reduce tasks=1377962
		Total megabyte-seconds taken by all map tasks=2384021504
		Total megabyte-seconds taken by all reduce tasks=1411033088
	Map-Reduce Framework
		Map input records=2094174
		Map output records=1848561
		Map output bytes=727438005
		Map output materialized bytes=734449487
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1615577
		Reduce shuffle bytes=734449487
		Reduce input records=1848561
		Reduce output records=1052670
		Spilled Records=3697122
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=26314
		CPU time spent (ms)=838580
		Physical memory (bytes) snapshot=323816153088
		Virtual memory (bytes) snapshot=743278882816
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=623706801
	File Output Format Counters 
		Bytes Written=350314476
16/12/07 16:46:30 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070800 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070800
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4534088084766058775.jar tmpDir=null
16/12/07 17:47:46 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 17:47:47 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 17:47:47 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 17:47:49 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 17:47:49 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 17:47:50 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5372
16/12/07 17:47:50 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5372
16/12/07 17:47:50 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5372/
16/12/07 17:47:50 INFO mapreduce.Job: Running job: job_1480588584072_5372
16/12/07 17:48:32 INFO mapreduce.Job: Job job_1480588584072_5372 running in uber mode : false
16/12/07 17:48:32 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 17:48:48 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 17:48:50 INFO mapreduce.Job:  map 2% reduce 0%
16/12/07 17:48:54 INFO mapreduce.Job:  map 7% reduce 0%
16/12/07 17:48:56 INFO mapreduce.Job:  map 11% reduce 0%
16/12/07 17:48:57 INFO mapreduce.Job:  map 14% reduce 0%
16/12/07 17:49:03 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 17:49:06 INFO mapreduce.Job:  map 16% reduce 0%
16/12/07 17:49:07 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 17:49:08 INFO mapreduce.Job:  map 18% reduce 0%
16/12/07 17:49:10 INFO mapreduce.Job:  map 21% reduce 0%
16/12/07 17:49:11 INFO mapreduce.Job:  map 22% reduce 0%
16/12/07 17:49:13 INFO mapreduce.Job:  map 23% reduce 0%
16/12/07 17:49:42 INFO mapreduce.Job:  map 24% reduce 0%
16/12/07 17:49:50 INFO mapreduce.Job:  map 25% reduce 0%
16/12/07 17:49:54 INFO mapreduce.Job:  map 26% reduce 0%
16/12/07 17:49:56 INFO mapreduce.Job:  map 27% reduce 0%
16/12/07 17:49:57 INFO mapreduce.Job:  map 28% reduce 0%
16/12/07 17:49:59 INFO mapreduce.Job:  map 29% reduce 0%
16/12/07 17:50:01 INFO mapreduce.Job:  map 30% reduce 0%
16/12/07 17:50:02 INFO mapreduce.Job:  map 31% reduce 0%
16/12/07 17:50:03 INFO mapreduce.Job:  map 32% reduce 0%
16/12/07 17:50:04 INFO mapreduce.Job:  map 33% reduce 0%
16/12/07 17:50:05 INFO mapreduce.Job:  map 34% reduce 0%
16/12/07 17:50:06 INFO mapreduce.Job:  map 35% reduce 1%
16/12/07 17:50:07 INFO mapreduce.Job:  map 35% reduce 3%
16/12/07 17:50:10 INFO mapreduce.Job:  map 36% reduce 3%
16/12/07 17:50:12 INFO mapreduce.Job:  map 37% reduce 3%
16/12/07 17:50:15 INFO mapreduce.Job:  map 38% reduce 3%
16/12/07 17:50:16 INFO mapreduce.Job:  map 41% reduce 3%
16/12/07 17:50:17 INFO mapreduce.Job:  map 42% reduce 3%
16/12/07 17:50:20 INFO mapreduce.Job:  map 49% reduce 4%
16/12/07 17:50:21 INFO mapreduce.Job:  map 50% reduce 5%
16/12/07 17:50:28 INFO mapreduce.Job:  map 50% reduce 6%
16/12/07 17:50:30 INFO mapreduce.Job:  map 54% reduce 6%
16/12/07 17:50:35 INFO mapreduce.Job:  map 60% reduce 6%
16/12/07 17:50:37 INFO mapreduce.Job:  map 62% reduce 6%
16/12/07 17:50:39 INFO mapreduce.Job:  map 62% reduce 7%
16/12/07 17:50:40 INFO mapreduce.Job:  map 63% reduce 7%
16/12/07 17:50:41 INFO mapreduce.Job:  map 63% reduce 9%
16/12/07 17:50:42 INFO mapreduce.Job:  map 64% reduce 9%
16/12/07 17:50:43 INFO mapreduce.Job:  map 65% reduce 11%
16/12/07 17:50:44 INFO mapreduce.Job:  map 67% reduce 12%
16/12/07 17:50:45 INFO mapreduce.Job:  map 69% reduce 13%
16/12/07 17:50:46 INFO mapreduce.Job:  map 70% reduce 14%
16/12/07 17:50:48 INFO mapreduce.Job:  map 73% reduce 16%
16/12/07 17:50:50 INFO mapreduce.Job:  map 79% reduce 16%
16/12/07 17:50:51 INFO mapreduce.Job:  map 80% reduce 16%
16/12/07 17:50:52 INFO mapreduce.Job:  map 84% reduce 19%
16/12/07 17:50:53 INFO mapreduce.Job:  map 87% reduce 20%
16/12/07 17:50:54 INFO mapreduce.Job:  map 89% reduce 22%
16/12/07 17:50:55 INFO mapreduce.Job:  map 90% reduce 27%
16/12/07 17:50:57 INFO mapreduce.Job:  map 91% reduce 27%
16/12/07 17:50:58 INFO mapreduce.Job:  map 92% reduce 28%
16/12/07 17:50:59 INFO mapreduce.Job:  map 93% reduce 28%
16/12/07 17:51:00 INFO mapreduce.Job:  map 94% reduce 30%
16/12/07 17:51:01 INFO mapreduce.Job:  map 96% reduce 31%
16/12/07 17:51:04 INFO mapreduce.Job:  map 96% reduce 32%
16/12/07 17:51:05 INFO mapreduce.Job:  map 97% reduce 32%
16/12/07 17:51:07 INFO mapreduce.Job:  map 98% reduce 32%
16/12/07 17:51:09 INFO mapreduce.Job:  map 99% reduce 32%
16/12/07 17:51:10 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 17:51:13 INFO mapreduce.Job:  map 100% reduce 34%
16/12/07 17:51:14 INFO mapreduce.Job:  map 100% reduce 48%
16/12/07 17:51:15 INFO mapreduce.Job:  map 100% reduce 58%
16/12/07 17:51:16 INFO mapreduce.Job:  map 100% reduce 63%
16/12/07 17:51:17 INFO mapreduce.Job:  map 100% reduce 73%
16/12/07 17:51:18 INFO mapreduce.Job:  map 100% reduce 77%
16/12/07 17:51:19 INFO mapreduce.Job:  map 100% reduce 78%
16/12/07 17:51:20 INFO mapreduce.Job:  map 100% reduce 80%
16/12/07 17:51:21 INFO mapreduce.Job:  map 100% reduce 82%
16/12/07 17:51:22 INFO mapreduce.Job:  map 100% reduce 83%
16/12/07 17:51:23 INFO mapreduce.Job:  map 100% reduce 84%
16/12/07 17:51:24 INFO mapreduce.Job:  map 100% reduce 86%
16/12/07 17:51:25 INFO mapreduce.Job:  map 100% reduce 87%
16/12/07 17:51:26 INFO mapreduce.Job:  map 100% reduce 88%
16/12/07 17:51:27 INFO mapreduce.Job:  map 100% reduce 90%
16/12/07 17:51:29 INFO mapreduce.Job:  map 100% reduce 92%
16/12/07 17:51:31 INFO mapreduce.Job:  map 100% reduce 94%
16/12/07 17:51:32 INFO mapreduce.Job:  map 100% reduce 95%
16/12/07 17:51:33 INFO mapreduce.Job:  map 100% reduce 96%
16/12/07 17:51:34 INFO mapreduce.Job:  map 100% reduce 98%
16/12/07 17:51:35 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 17:51:38 INFO mapreduce.Job: Job job_1480588584072_5372 completed successfully
16/12/07 17:51:38 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=809532167
		FILE: Number of bytes written=1651446299
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=681761949
		WASB: Number of bytes written=410067817
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13773282
		Total time spent by all reduces in occupied slots (ms)=3407104
		Total time spent by all map tasks (ms)=6886641
		Total time spent by all reduce tasks (ms)=1703552
		Total vcore-seconds taken by all map tasks=6886641
		Total vcore-seconds taken by all reduce tasks=1703552
		Total megabyte-seconds taken by all map tasks=7051920384
		Total megabyte-seconds taken by all reduce tasks=1744437248
	Map-Reduce Framework
		Map input records=2260459
		Map output records=2030783
		Map output bytes=801855840
		Map output materialized bytes=809555687
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1791686
		Reduce shuffle bytes=809555687
		Reduce input records=2030783
		Reduce output records=1231030
		Spilled Records=4061566
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=76103
		CPU time spent (ms)=976660
		Physical memory (bytes) snapshot=324791185408
		Virtual memory (bytes) snapshot=742890373120
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=679065945
	File Output Format Counters 
		Bytes Written=410067817
16/12/07 17:51:38 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070900 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070900
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1986200530080628748.jar tmpDir=null
16/12/07 18:42:46 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 18:42:47 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 18:42:47 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 18:42:49 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 18:42:50 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 18:42:50 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5475
16/12/07 18:42:51 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5475
16/12/07 18:42:51 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5475/
16/12/07 18:42:51 INFO mapreduce.Job: Running job: job_1480588584072_5475
16/12/07 18:43:05 INFO mapreduce.Job: Job job_1480588584072_5475 running in uber mode : false
16/12/07 18:43:05 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 18:43:19 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 18:43:39 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 18:43:40 INFO mapreduce.Job:  map 4% reduce 0%
16/12/07 18:43:42 INFO mapreduce.Job:  map 5% reduce 0%
16/12/07 18:43:44 INFO mapreduce.Job:  map 6% reduce 0%
16/12/07 18:43:45 INFO mapreduce.Job:  map 7% reduce 0%
16/12/07 18:43:47 INFO mapreduce.Job:  map 9% reduce 0%
16/12/07 18:43:48 INFO mapreduce.Job:  map 10% reduce 0%
16/12/07 18:43:49 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 18:43:50 INFO mapreduce.Job:  map 14% reduce 0%
16/12/07 18:43:51 INFO mapreduce.Job:  map 16% reduce 0%
16/12/07 18:43:52 INFO mapreduce.Job:  map 18% reduce 0%
16/12/07 18:43:53 INFO mapreduce.Job:  map 19% reduce 0%
16/12/07 18:43:54 INFO mapreduce.Job:  map 20% reduce 0%
16/12/07 18:43:59 INFO mapreduce.Job:  map 21% reduce 1%
16/12/07 18:44:00 INFO mapreduce.Job:  map 22% reduce 1%
16/12/07 18:44:01 INFO mapreduce.Job:  map 22% reduce 2%
16/12/07 18:44:02 INFO mapreduce.Job:  map 24% reduce 3%
16/12/07 18:44:04 INFO mapreduce.Job:  map 27% reduce 3%
16/12/07 18:44:06 INFO mapreduce.Job:  map 28% reduce 5%
16/12/07 18:44:07 INFO mapreduce.Job:  map 29% reduce 5%
16/12/07 18:44:08 INFO mapreduce.Job:  map 29% reduce 7%
16/12/07 18:44:09 INFO mapreduce.Job:  map 30% reduce 8%
16/12/07 18:44:12 INFO mapreduce.Job:  map 30% reduce 9%
16/12/07 18:44:13 INFO mapreduce.Job:  map 31% reduce 9%
16/12/07 18:44:14 INFO mapreduce.Job:  map 32% reduce 9%
16/12/07 18:44:15 INFO mapreduce.Job:  map 35% reduce 10%
16/12/07 18:44:16 INFO mapreduce.Job:  map 36% reduce 11%
16/12/07 18:44:18 INFO mapreduce.Job:  map 36% reduce 12%
16/12/07 18:44:21 INFO mapreduce.Job:  map 38% reduce 12%
16/12/07 18:44:22 INFO mapreduce.Job:  map 39% reduce 12%
16/12/07 18:44:23 INFO mapreduce.Job:  map 41% reduce 13%
16/12/07 18:44:26 INFO mapreduce.Job:  map 41% reduce 14%
16/12/07 18:44:28 INFO mapreduce.Job:  map 43% reduce 14%
16/12/07 18:44:31 INFO mapreduce.Job:  map 44% reduce 14%
16/12/07 18:44:32 INFO mapreduce.Job:  map 45% reduce 15%
16/12/07 18:44:33 INFO mapreduce.Job:  map 46% reduce 15%
16/12/07 18:44:35 INFO mapreduce.Job:  map 47% reduce 15%
16/12/07 18:44:36 INFO mapreduce.Job:  map 48% reduce 15%
16/12/07 18:44:37 INFO mapreduce.Job:  map 49% reduce 16%
16/12/07 18:44:39 INFO mapreduce.Job:  map 50% reduce 16%
16/12/07 18:44:40 INFO mapreduce.Job:  map 51% reduce 16%
16/12/07 18:44:41 INFO mapreduce.Job:  map 52% reduce 17%
16/12/07 18:44:42 INFO mapreduce.Job:  map 56% reduce 17%
16/12/07 18:44:43 INFO mapreduce.Job:  map 57% reduce 17%
16/12/07 18:44:44 INFO mapreduce.Job:  map 57% reduce 18%
16/12/07 18:44:45 INFO mapreduce.Job:  map 60% reduce 18%
16/12/07 18:44:46 INFO mapreduce.Job:  map 61% reduce 19%
16/12/07 18:44:47 INFO mapreduce.Job:  map 62% reduce 19%
16/12/07 18:44:48 INFO mapreduce.Job:  map 64% reduce 19%
16/12/07 18:44:49 INFO mapreduce.Job:  map 67% reduce 20%
16/12/07 18:44:50 INFO mapreduce.Job:  map 69% reduce 21%
16/12/07 18:44:51 INFO mapreduce.Job:  map 73% reduce 21%
16/12/07 18:44:52 INFO mapreduce.Job:  map 75% reduce 22%
16/12/07 18:44:53 INFO mapreduce.Job:  map 77% reduce 23%
16/12/07 18:44:54 INFO mapreduce.Job:  map 79% reduce 23%
16/12/07 18:44:55 INFO mapreduce.Job:  map 82% reduce 24%
16/12/07 18:44:56 INFO mapreduce.Job:  map 83% reduce 25%
16/12/07 18:44:57 INFO mapreduce.Job:  map 86% reduce 26%
16/12/07 18:44:58 INFO mapreduce.Job:  map 87% reduce 27%
16/12/07 18:44:59 INFO mapreduce.Job:  map 89% reduce 28%
16/12/07 18:45:00 INFO mapreduce.Job:  map 91% reduce 28%
16/12/07 18:45:01 INFO mapreduce.Job:  map 91% reduce 29%
16/12/07 18:45:02 INFO mapreduce.Job:  map 92% reduce 30%
16/12/07 18:45:05 INFO mapreduce.Job:  map 92% reduce 31%
16/12/07 18:45:06 INFO mapreduce.Job:  map 93% reduce 31%
16/12/07 18:45:14 INFO mapreduce.Job:  map 94% reduce 31%
16/12/07 18:45:17 INFO mapreduce.Job:  map 95% reduce 31%
16/12/07 18:45:18 INFO mapreduce.Job:  map 97% reduce 31%
16/12/07 18:45:19 INFO mapreduce.Job:  map 98% reduce 32%
16/12/07 18:45:20 INFO mapreduce.Job:  map 100% reduce 32%
16/12/07 18:45:21 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 18:45:22 INFO mapreduce.Job:  map 100% reduce 36%
16/12/07 18:45:23 INFO mapreduce.Job:  map 100% reduce 46%
16/12/07 18:45:24 INFO mapreduce.Job:  map 100% reduce 57%
16/12/07 18:45:25 INFO mapreduce.Job:  map 100% reduce 68%
16/12/07 18:45:26 INFO mapreduce.Job:  map 100% reduce 73%
16/12/07 18:45:27 INFO mapreduce.Job:  map 100% reduce 77%
16/12/07 18:45:28 INFO mapreduce.Job:  map 100% reduce 83%
16/12/07 18:45:29 INFO mapreduce.Job:  map 100% reduce 90%
16/12/07 18:45:30 INFO mapreduce.Job:  map 100% reduce 97%
16/12/07 18:45:31 INFO mapreduce.Job:  map 100% reduce 99%
16/12/07 18:45:32 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 18:45:35 INFO mapreduce.Job: Job job_1480588584072_5475 completed successfully
16/12/07 18:45:35 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=781588001
		FILE: Number of bytes written=1595557967
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=657675446
		WASB: Number of bytes written=392492499
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=11399218
		Total time spent by all reduces in occupied slots (ms)=3896866
		Total time spent by all map tasks (ms)=5699609
		Total time spent by all reduce tasks (ms)=1948433
		Total vcore-seconds taken by all map tasks=5699609
		Total vcore-seconds taken by all reduce tasks=1948433
		Total megabyte-seconds taken by all map tasks=5836399616
		Total megabyte-seconds taken by all reduce tasks=1995195392
	Map-Reduce Framework
		Map input records=2180319
		Map output records=1959608
		Map output bytes=774178941
		Map output materialized bytes=781611521
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1724708
		Reduce shuffle bytes=781611521
		Reduce input records=1959608
		Reduce output records=1173789
		Spilled Records=3919216
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=60141
		CPU time spent (ms)=910030
		Physical memory (bytes) snapshot=324320874496
		Virtual memory (bytes) snapshot=742625067008
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=654979442
	File Output Format Counters 
		Bytes Written=392492499
16/12/07 18:45:35 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1400 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1400': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1122011511238228589.jar tmpDir=null
16/12/07 19:51:50 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 19:51:51 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 19:51:51 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 19:51:53 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 19:51:53 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 19:51:54 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5528
16/12/07 19:51:55 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5528
16/12/07 19:51:55 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5528/
16/12/07 19:51:55 INFO mapreduce.Job: Running job: job_1480588584072_5528
16/12/07 19:52:08 INFO mapreduce.Job: Job job_1480588584072_5528 running in uber mode : false
16/12/07 19:52:08 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 19:52:32 INFO mapreduce.Job:  map 8% reduce 0%
16/12/07 19:52:33 INFO mapreduce.Job:  map 10% reduce 0%
16/12/07 19:52:34 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 19:52:40 INFO mapreduce.Job:  map 14% reduce 0%
16/12/07 19:52:41 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 19:52:43 INFO mapreduce.Job:  map 18% reduce 0%
16/12/07 19:52:45 INFO mapreduce.Job:  map 19% reduce 0%
16/12/07 19:52:46 INFO mapreduce.Job:  map 22% reduce 0%
16/12/07 19:52:48 INFO mapreduce.Job:  map 23% reduce 0%
16/12/07 19:52:49 INFO mapreduce.Job:  map 25% reduce 0%
16/12/07 19:52:50 INFO mapreduce.Job:  map 27% reduce 0%
16/12/07 19:52:51 INFO mapreduce.Job:  map 28% reduce 0%
16/12/07 19:52:54 INFO mapreduce.Job:  map 30% reduce 4%
16/12/07 19:52:55 INFO mapreduce.Job:  map 31% reduce 4%
16/12/07 19:52:58 INFO mapreduce.Job:  map 32% reduce 4%
16/12/07 19:52:59 INFO mapreduce.Job:  map 37% reduce 6%
16/12/07 19:53:00 INFO mapreduce.Job:  map 39% reduce 6%
16/12/07 19:53:01 INFO mapreduce.Job:  map 41% reduce 9%
16/12/07 19:53:02 INFO mapreduce.Job:  map 42% reduce 10%
16/12/07 19:53:03 INFO mapreduce.Job:  map 44% reduce 10%
16/12/07 19:53:05 INFO mapreduce.Job:  map 44% reduce 12%
16/12/07 19:53:06 INFO mapreduce.Job:  map 44% reduce 13%
16/12/07 19:53:07 INFO mapreduce.Job:  map 45% reduce 13%
16/12/07 19:53:08 INFO mapreduce.Job:  map 46% reduce 14%
16/12/07 19:53:09 INFO mapreduce.Job:  map 47% reduce 14%
16/12/07 19:53:11 INFO mapreduce.Job:  map 48% reduce 14%
16/12/07 19:53:12 INFO mapreduce.Job:  map 49% reduce 15%
16/12/07 19:53:13 INFO mapreduce.Job:  map 51% reduce 15%
16/12/07 19:53:15 INFO mapreduce.Job:  map 51% reduce 16%
16/12/07 19:53:16 INFO mapreduce.Job:  map 53% reduce 16%
16/12/07 19:53:17 INFO mapreduce.Job:  map 54% reduce 16%
16/12/07 19:53:18 INFO mapreduce.Job:  map 55% reduce 16%
16/12/07 19:53:19 INFO mapreduce.Job:  map 56% reduce 17%
16/12/07 19:53:20 INFO mapreduce.Job:  map 57% reduce 17%
16/12/07 19:53:23 INFO mapreduce.Job:  map 58% reduce 17%
16/12/07 19:53:24 INFO mapreduce.Job:  map 60% reduce 18%
16/12/07 19:53:25 INFO mapreduce.Job:  map 64% reduce 18%
16/12/07 19:53:27 INFO mapreduce.Job:  map 64% reduce 19%
16/12/07 19:53:28 INFO mapreduce.Job:  map 66% reduce 20%
16/12/07 19:53:30 INFO mapreduce.Job:  map 68% reduce 20%
16/12/07 19:53:31 INFO mapreduce.Job:  map 71% reduce 21%
16/12/07 19:53:33 INFO mapreduce.Job:  map 73% reduce 23%
16/12/07 19:53:36 INFO mapreduce.Job:  map 76% reduce 23%
16/12/07 19:53:38 INFO mapreduce.Job:  map 81% reduce 23%
16/12/07 19:53:39 INFO mapreduce.Job:  map 84% reduce 26%
16/12/07 19:53:40 INFO mapreduce.Job:  map 86% reduce 26%
16/12/07 19:53:41 INFO mapreduce.Job:  map 87% reduce 27%
16/12/07 19:53:42 INFO mapreduce.Job:  map 89% reduce 28%
16/12/07 19:53:43 INFO mapreduce.Job:  map 90% reduce 28%
16/12/07 19:53:44 INFO mapreduce.Job:  map 92% reduce 28%
16/12/07 19:53:45 INFO mapreduce.Job:  map 93% reduce 30%
16/12/07 19:53:46 INFO mapreduce.Job:  map 95% reduce 30%
16/12/07 19:53:48 INFO mapreduce.Job:  map 96% reduce 30%
16/12/07 19:53:49 INFO mapreduce.Job:  map 96% reduce 32%
16/12/07 19:53:50 INFO mapreduce.Job:  map 97% reduce 32%
16/12/07 19:53:51 INFO mapreduce.Job:  map 98% reduce 32%
16/12/07 19:53:52 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 19:53:55 INFO mapreduce.Job:  map 100% reduce 53%
16/12/07 19:53:56 INFO mapreduce.Job:  map 100% reduce 68%
16/12/07 19:53:58 INFO mapreduce.Job:  map 100% reduce 74%
16/12/07 19:53:59 INFO mapreduce.Job:  map 100% reduce 84%
16/12/07 19:54:00 INFO mapreduce.Job:  map 100% reduce 86%
16/12/07 19:54:01 INFO mapreduce.Job:  map 100% reduce 90%
16/12/07 19:54:02 INFO mapreduce.Job:  map 100% reduce 95%
16/12/07 19:54:04 INFO mapreduce.Job:  map 100% reduce 98%
16/12/07 19:54:05 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 19:54:08 INFO mapreduce.Job: Job job_1480588584072_5528 completed successfully
16/12/07 19:54:08 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=728833498
		FILE: Number of bytes written=1490048961
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=618516684
		WASB: Number of bytes written=341836419
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13049454
		Total time spent by all reduces in occupied slots (ms)=3099616
		Total time spent by all map tasks (ms)=6524727
		Total time spent by all reduce tasks (ms)=1549808
		Total vcore-seconds taken by all map tasks=6524727
		Total vcore-seconds taken by all reduce tasks=1549808
		Total megabyte-seconds taken by all map tasks=6681320448
		Total megabyte-seconds taken by all reduce tasks=1587003392
	Map-Reduce Framework
		Map input records=2078955
		Map output records=1843503
		Map output bytes=721883116
		Map output materialized bytes=728857018
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1601095
		Reduce shuffle bytes=728857018
		Reduce input records=1843503
		Reduce output records=1032746
		Spilled Records=3687006
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=67963
		CPU time spent (ms)=909150
		Physical memory (bytes) snapshot=324057407488
		Virtual memory (bytes) snapshot=742842781696
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=615820680
	File Output Format Counters 
		Bytes Written=341836419
16/12/07 19:54:08 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1400
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1500 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1500': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8868980280741868984.jar tmpDir=null
16/12/07 20:50:16 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 20:50:16 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 20:50:17 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 20:50:18 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 20:50:19 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 20:50:19 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5531
16/12/07 20:50:20 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5531
16/12/07 20:50:20 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5531/
16/12/07 20:50:20 INFO mapreduce.Job: Running job: job_1480588584072_5531
16/12/07 20:50:33 INFO mapreduce.Job: Job job_1480588584072_5531 running in uber mode : false
16/12/07 20:50:33 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 20:50:43 INFO mapreduce.Job:  map 2% reduce 0%
16/12/07 20:50:51 INFO mapreduce.Job:  map 4% reduce 0%
16/12/07 20:50:56 INFO mapreduce.Job:  map 5% reduce 0%
16/12/07 20:50:57 INFO mapreduce.Job:  map 9% reduce 0%
16/12/07 20:50:58 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 20:50:59 INFO mapreduce.Job:  map 14% reduce 0%
16/12/07 20:51:01 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 20:51:02 INFO mapreduce.Job:  map 19% reduce 0%
16/12/07 20:51:06 INFO mapreduce.Job:  map 20% reduce 0%
16/12/07 20:51:08 INFO mapreduce.Job:  map 21% reduce 0%
16/12/07 20:51:10 INFO mapreduce.Job:  map 23% reduce 0%
16/12/07 20:51:12 INFO mapreduce.Job:  map 25% reduce 0%
16/12/07 20:51:13 INFO mapreduce.Job:  map 26% reduce 1%
16/12/07 20:51:15 INFO mapreduce.Job:  map 27% reduce 2%
16/12/07 20:51:16 INFO mapreduce.Job:  map 27% reduce 3%
16/12/07 20:51:19 INFO mapreduce.Job:  map 29% reduce 4%
16/12/07 20:51:20 INFO mapreduce.Job:  map 29% reduce 6%
16/12/07 20:51:21 INFO mapreduce.Job:  map 30% reduce 6%
16/12/07 20:51:22 INFO mapreduce.Job:  map 30% reduce 8%
16/12/07 20:51:24 INFO mapreduce.Job:  map 31% reduce 9%
16/12/07 20:51:25 INFO mapreduce.Job:  map 32% reduce 9%
16/12/07 20:51:27 INFO mapreduce.Job:  map 34% reduce 10%
16/12/07 20:51:28 INFO mapreduce.Job:  map 35% reduce 11%
16/12/07 20:51:31 INFO mapreduce.Job:  map 36% reduce 12%
16/12/07 20:51:33 INFO mapreduce.Job:  map 38% reduce 12%
16/12/07 20:51:34 INFO mapreduce.Job:  map 39% reduce 12%
16/12/07 20:51:35 INFO mapreduce.Job:  map 40% reduce 12%
16/12/07 20:51:37 INFO mapreduce.Job:  map 40% reduce 13%
16/12/07 20:51:39 INFO mapreduce.Job:  map 41% reduce 13%
16/12/07 20:51:40 INFO mapreduce.Job:  map 42% reduce 13%
16/12/07 20:51:41 INFO mapreduce.Job:  map 44% reduce 14%
16/12/07 20:51:42 INFO mapreduce.Job:  map 46% reduce 14%
16/12/07 20:51:43 INFO mapreduce.Job:  map 48% reduce 15%
16/12/07 20:51:45 INFO mapreduce.Job:  map 49% reduce 15%
16/12/07 20:51:46 INFO mapreduce.Job:  map 50% reduce 15%
16/12/07 20:51:47 INFO mapreduce.Job:  map 51% reduce 15%
16/12/07 20:51:48 INFO mapreduce.Job:  map 56% reduce 15%
16/12/07 20:51:49 INFO mapreduce.Job:  map 57% reduce 17%
16/12/07 20:51:50 INFO mapreduce.Job:  map 60% reduce 17%
16/12/07 20:51:51 INFO mapreduce.Job:  map 62% reduce 18%
16/12/07 20:51:52 INFO mapreduce.Job:  map 63% reduce 19%
16/12/07 20:51:53 INFO mapreduce.Job:  map 65% reduce 19%
16/12/07 20:51:54 INFO mapreduce.Job:  map 67% reduce 20%
16/12/07 20:51:55 INFO mapreduce.Job:  map 70% reduce 21%
16/12/07 20:51:56 INFO mapreduce.Job:  map 72% reduce 21%
16/12/07 20:51:57 INFO mapreduce.Job:  map 75% reduce 21%
16/12/07 20:51:58 INFO mapreduce.Job:  map 75% reduce 23%
16/12/07 20:51:59 INFO mapreduce.Job:  map 78% reduce 23%
16/12/07 20:52:00 INFO mapreduce.Job:  map 79% reduce 24%
16/12/07 20:52:01 INFO mapreduce.Job:  map 81% reduce 25%
16/12/07 20:52:02 INFO mapreduce.Job:  map 83% reduce 25%
16/12/07 20:52:03 INFO mapreduce.Job:  map 84% reduce 26%
16/12/07 20:52:04 INFO mapreduce.Job:  map 85% reduce 27%
16/12/07 20:52:06 INFO mapreduce.Job:  map 86% reduce 27%
16/12/07 20:52:07 INFO mapreduce.Job:  map 86% reduce 28%
16/12/07 20:52:09 INFO mapreduce.Job:  map 86% reduce 29%
16/12/07 20:52:12 INFO mapreduce.Job:  map 87% reduce 29%
16/12/07 20:52:13 INFO mapreduce.Job:  map 89% reduce 29%
16/12/07 20:52:15 INFO mapreduce.Job:  map 89% reduce 30%
16/12/07 20:52:21 INFO mapreduce.Job:  map 90% reduce 30%
16/12/07 20:52:23 INFO mapreduce.Job:  map 91% reduce 30%
16/12/07 20:52:25 INFO mapreduce.Job:  map 92% reduce 30%
16/12/07 20:52:28 INFO mapreduce.Job:  map 92% reduce 31%
16/12/07 20:52:29 INFO mapreduce.Job:  map 94% reduce 31%
16/12/07 20:52:31 INFO mapreduce.Job:  map 97% reduce 31%
16/12/07 20:52:32 INFO mapreduce.Job:  map 99% reduce 32%
16/12/07 20:52:34 INFO mapreduce.Job:  map 99% reduce 33%
16/12/07 20:52:35 INFO mapreduce.Job:  map 100% reduce 34%
16/12/07 20:52:36 INFO mapreduce.Job:  map 100% reduce 36%
16/12/07 20:52:37 INFO mapreduce.Job:  map 100% reduce 46%
16/12/07 20:52:38 INFO mapreduce.Job:  map 100% reduce 58%
16/12/07 20:52:39 INFO mapreduce.Job:  map 100% reduce 67%
16/12/07 20:52:40 INFO mapreduce.Job:  map 100% reduce 70%
16/12/07 20:52:41 INFO mapreduce.Job:  map 100% reduce 78%
16/12/07 20:52:42 INFO mapreduce.Job:  map 100% reduce 82%
16/12/07 20:52:43 INFO mapreduce.Job:  map 100% reduce 86%
16/12/07 20:52:44 INFO mapreduce.Job:  map 100% reduce 87%
16/12/07 20:52:45 INFO mapreduce.Job:  map 100% reduce 88%
16/12/07 20:52:46 INFO mapreduce.Job:  map 100% reduce 90%
16/12/07 20:52:47 INFO mapreduce.Job:  map 100% reduce 91%
16/12/07 20:52:48 INFO mapreduce.Job:  map 100% reduce 95%
16/12/07 20:52:49 INFO mapreduce.Job:  map 100% reduce 96%
16/12/07 20:52:50 INFO mapreduce.Job:  map 100% reduce 98%
16/12/07 20:52:51 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 20:52:54 INFO mapreduce.Job: Job job_1480588584072_5531 completed successfully
16/12/07 20:52:55 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=757897072
		FILE: Number of bytes written=1548176109
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=642292567
		WASB: Number of bytes written=355014784
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13653492
		Total time spent by all reduces in occupied slots (ms)=4087896
		Total time spent by all map tasks (ms)=6826746
		Total time spent by all reduce tasks (ms)=2043948
		Total vcore-seconds taken by all map tasks=6826746
		Total vcore-seconds taken by all reduce tasks=2043948
		Total megabyte-seconds taken by all map tasks=6990587904
		Total megabyte-seconds taken by all reduce tasks=2093002752
	Map-Reduce Framework
		Map input records=2159147
		Map output records=1916887
		Map output bytes=750670177
		Map output materialized bytes=757920592
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1670209
		Reduce shuffle bytes=757920592
		Reduce input records=1916887
		Reduce output records=1071574
		Spilled Records=3833774
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=74127
		CPU time spent (ms)=914950
		Physical memory (bytes) snapshot=324256083968
		Virtual memory (bytes) snapshot=742663368704
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=639596563
	File Output Format Counters 
		Bytes Written=355014784
16/12/07 20:52:55 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1500
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1600 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1600': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3581137660801214330.jar tmpDir=null
16/12/07 21:49:04 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 21:49:05 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 21:49:05 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 21:49:07 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 21:49:07 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 21:49:08 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5534
16/12/07 21:49:08 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5534
16/12/07 21:49:08 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5534/
16/12/07 21:49:08 INFO mapreduce.Job: Running job: job_1480588584072_5534
16/12/07 21:49:20 INFO mapreduce.Job: Job job_1480588584072_5534 running in uber mode : false
16/12/07 21:49:21 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 21:49:46 INFO mapreduce.Job:  map 7% reduce 0%
16/12/07 21:49:47 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 21:49:55 INFO mapreduce.Job:  map 13% reduce 0%
16/12/07 21:49:57 INFO mapreduce.Job:  map 17% reduce 0%
16/12/07 21:50:00 INFO mapreduce.Job:  map 19% reduce 0%
16/12/07 21:50:03 INFO mapreduce.Job:  map 24% reduce 0%
16/12/07 21:50:05 INFO mapreduce.Job:  map 27% reduce 0%
16/12/07 21:50:06 INFO mapreduce.Job:  map 30% reduce 0%
16/12/07 21:50:10 INFO mapreduce.Job:  map 31% reduce 0%
16/12/07 21:50:13 INFO mapreduce.Job:  map 33% reduce 0%
16/12/07 21:50:14 INFO mapreduce.Job:  map 33% reduce 1%
16/12/07 21:50:15 INFO mapreduce.Job:  map 34% reduce 5%
16/12/07 21:50:16 INFO mapreduce.Job:  map 34% reduce 6%
16/12/07 21:50:17 INFO mapreduce.Job:  map 37% reduce 6%
16/12/07 21:50:19 INFO mapreduce.Job:  map 40% reduce 6%
16/12/07 21:50:21 INFO mapreduce.Job:  map 42% reduce 7%
16/12/07 21:50:23 INFO mapreduce.Job:  map 46% reduce 11%
16/12/07 21:50:25 INFO mapreduce.Job:  map 47% reduce 11%
16/12/07 21:50:26 INFO mapreduce.Job:  map 49% reduce 13%
16/12/07 21:50:27 INFO mapreduce.Job:  map 50% reduce 14%
16/12/07 21:50:29 INFO mapreduce.Job:  map 53% reduce 14%
16/12/07 21:50:30 INFO mapreduce.Job:  map 56% reduce 16%
16/12/07 21:50:31 INFO mapreduce.Job:  map 58% reduce 16%
16/12/07 21:50:34 INFO mapreduce.Job:  map 59% reduce 18%
16/12/07 21:50:36 INFO mapreduce.Job:  map 62% reduce 19%
16/12/07 21:50:37 INFO mapreduce.Job:  map 65% reduce 19%
16/12/07 21:50:41 INFO mapreduce.Job:  map 68% reduce 19%
16/12/07 21:50:42 INFO mapreduce.Job:  map 69% reduce 21%
16/12/07 21:50:43 INFO mapreduce.Job:  map 71% reduce 21%
16/12/07 21:50:44 INFO mapreduce.Job:  map 72% reduce 21%
16/12/07 21:50:45 INFO mapreduce.Job:  map 74% reduce 23%
16/12/07 21:50:47 INFO mapreduce.Job:  map 76% reduce 24%
16/12/07 21:50:48 INFO mapreduce.Job:  map 78% reduce 24%
16/12/07 21:50:49 INFO mapreduce.Job:  map 79% reduce 24%
16/12/07 21:50:50 INFO mapreduce.Job:  map 79% reduce 25%
16/12/07 21:50:51 INFO mapreduce.Job:  map 80% reduce 26%
16/12/07 21:50:54 INFO mapreduce.Job:  map 80% reduce 27%
16/12/07 21:50:55 INFO mapreduce.Job:  map 81% reduce 27%
16/12/07 21:51:02 INFO mapreduce.Job:  map 83% reduce 27%
16/12/07 21:51:03 INFO mapreduce.Job:  map 84% reduce 27%
16/12/07 21:51:05 INFO mapreduce.Job:  map 85% reduce 27%
16/12/07 21:51:06 INFO mapreduce.Job:  map 89% reduce 27%
16/12/07 21:51:07 INFO mapreduce.Job:  map 90% reduce 29%
16/12/07 21:51:08 INFO mapreduce.Job:  map 90% reduce 30%
16/12/07 21:51:09 INFO mapreduce.Job:  map 91% reduce 30%
16/12/07 21:51:11 INFO mapreduce.Job:  map 92% reduce 30%
16/12/07 21:51:12 INFO mapreduce.Job:  map 93% reduce 30%
16/12/07 21:51:13 INFO mapreduce.Job:  map 94% reduce 30%
16/12/07 21:51:14 INFO mapreduce.Job:  map 95% reduce 31%
16/12/07 21:51:15 INFO mapreduce.Job:  map 97% reduce 31%
16/12/07 21:51:16 INFO mapreduce.Job:  map 99% reduce 32%
16/12/07 21:51:17 INFO mapreduce.Job:  map 99% reduce 33%
16/12/07 21:51:18 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 21:51:19 INFO mapreduce.Job:  map 100% reduce 40%
16/12/07 21:51:20 INFO mapreduce.Job:  map 100% reduce 47%
16/12/07 21:51:21 INFO mapreduce.Job:  map 100% reduce 51%
16/12/07 21:51:23 INFO mapreduce.Job:  map 100% reduce 64%
16/12/07 21:51:24 INFO mapreduce.Job:  map 100% reduce 71%
16/12/07 21:51:25 INFO mapreduce.Job:  map 100% reduce 76%
16/12/07 21:51:26 INFO mapreduce.Job:  map 100% reduce 84%
16/12/07 21:51:27 INFO mapreduce.Job:  map 100% reduce 86%
16/12/07 21:51:28 INFO mapreduce.Job:  map 100% reduce 87%
16/12/07 21:51:29 INFO mapreduce.Job:  map 100% reduce 88%
16/12/07 21:51:30 INFO mapreduce.Job:  map 100% reduce 90%
16/12/07 21:51:31 INFO mapreduce.Job:  map 100% reduce 93%
16/12/07 21:51:32 INFO mapreduce.Job:  map 100% reduce 94%
16/12/07 21:51:33 INFO mapreduce.Job:  map 100% reduce 98%
16/12/07 21:51:34 INFO mapreduce.Job:  map 100% reduce 99%
16/12/07 21:51:35 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 21:51:37 INFO mapreduce.Job: Job job_1480588584072_5534 completed successfully
16/12/07 21:51:37 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=701834251
		FILE: Number of bytes written=1436050467
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=600504615
		WASB: Number of bytes written=294354017
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13447680
		Total time spent by all reduces in occupied slots (ms)=3526638
		Total time spent by all map tasks (ms)=6723840
		Total time spent by all reduce tasks (ms)=1763319
		Total vcore-seconds taken by all map tasks=6723840
		Total vcore-seconds taken by all reduce tasks=1763319
		Total megabyte-seconds taken by all map tasks=6885212160
		Total megabyte-seconds taken by all reduce tasks=1805638656
	Map-Reduce Framework
		Map input records=2044734
		Map output records=1788321
		Map output bytes=695098923
		Map output materialized bytes=701857771
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1543539
		Reduce shuffle bytes=701857771
		Reduce input records=1788321
		Reduce output records=892968
		Spilled Records=3576642
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=68312
		CPU time spent (ms)=908580
		Physical memory (bytes) snapshot=324043546624
		Virtual memory (bytes) snapshot=742570991616
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=597808611
	File Output Format Counters 
		Bytes Written=294354017
16/12/07 21:51:37 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1600
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071200
16/12/07 22:42:33 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1700 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612070900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1700': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7384548464393701909.jar tmpDir=null
16/12/07 22:42:43 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 22:42:44 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 22:42:44 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 22:42:46 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 22:42:46 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 22:42:46 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5537
16/12/07 22:42:47 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5537
16/12/07 22:42:47 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5537/
16/12/07 22:42:47 INFO mapreduce.Job: Running job: job_1480588584072_5537
16/12/07 22:43:00 INFO mapreduce.Job: Job job_1480588584072_5537 running in uber mode : false
16/12/07 22:43:00 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 22:43:15 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 22:43:23 INFO mapreduce.Job:  map 5% reduce 0%
16/12/07 22:43:24 INFO mapreduce.Job:  map 11% reduce 0%
16/12/07 22:43:25 INFO mapreduce.Job:  map 12% reduce 0%
16/12/07 22:43:26 INFO mapreduce.Job:  map 13% reduce 0%
16/12/07 22:43:30 INFO mapreduce.Job:  map 14% reduce 0%
16/12/07 22:43:31 INFO mapreduce.Job:  map 18% reduce 0%
16/12/07 22:43:33 INFO mapreduce.Job:  map 19% reduce 0%
16/12/07 22:43:34 INFO mapreduce.Job:  map 20% reduce 0%
16/12/07 22:43:35 INFO mapreduce.Job:  map 21% reduce 0%
16/12/07 22:43:37 INFO mapreduce.Job:  map 23% reduce 0%
16/12/07 22:43:38 INFO mapreduce.Job:  map 24% reduce 0%
16/12/07 22:43:39 INFO mapreduce.Job:  map 24% reduce 1%
16/12/07 22:43:40 INFO mapreduce.Job:  map 25% reduce 2%
16/12/07 22:43:41 INFO mapreduce.Job:  map 25% reduce 3%
16/12/07 22:43:46 INFO mapreduce.Job:  map 25% reduce 5%
16/12/07 22:43:47 INFO mapreduce.Job:  map 26% reduce 5%
16/12/07 22:43:48 INFO mapreduce.Job:  map 28% reduce 6%
16/12/07 22:43:49 INFO mapreduce.Job:  map 29% reduce 6%
16/12/07 22:43:50 INFO mapreduce.Job:  map 30% reduce 8%
16/12/07 22:43:52 INFO mapreduce.Job:  map 30% reduce 9%
16/12/07 22:43:53 INFO mapreduce.Job:  map 30% reduce 10%
16/12/07 22:43:56 INFO mapreduce.Job:  map 31% reduce 10%
16/12/07 22:43:58 INFO mapreduce.Job:  map 35% reduce 10%
16/12/07 22:43:59 INFO mapreduce.Job:  map 36% reduce 11%
16/12/07 22:44:01 INFO mapreduce.Job:  map 36% reduce 12%
16/12/07 22:44:06 INFO mapreduce.Job:  map 37% reduce 12%
16/12/07 22:44:07 INFO mapreduce.Job:  map 39% reduce 12%
16/12/07 22:44:08 INFO mapreduce.Job:  map 41% reduce 12%
16/12/07 22:44:09 INFO mapreduce.Job:  map 41% reduce 13%
16/12/07 22:44:11 INFO mapreduce.Job:  map 42% reduce 14%
16/12/07 22:44:12 INFO mapreduce.Job:  map 43% reduce 14%
16/12/07 22:44:14 INFO mapreduce.Job:  map 45% reduce 14%
16/12/07 22:44:15 INFO mapreduce.Job:  map 46% reduce 14%
16/12/07 22:44:16 INFO mapreduce.Job:  map 49% reduce 14%
16/12/07 22:44:17 INFO mapreduce.Job:  map 50% reduce 15%
16/12/07 22:44:18 INFO mapreduce.Job:  map 52% reduce 15%
16/12/07 22:44:19 INFO mapreduce.Job:  map 54% reduce 16%
16/12/07 22:44:20 INFO mapreduce.Job:  map 56% reduce 16%
16/12/07 22:44:21 INFO mapreduce.Job:  map 57% reduce 17%
16/12/07 22:44:22 INFO mapreduce.Job:  map 58% reduce 17%
16/12/07 22:44:23 INFO mapreduce.Job:  map 60% reduce 17%
16/12/07 22:44:24 INFO mapreduce.Job:  map 62% reduce 17%
16/12/07 22:44:25 INFO mapreduce.Job:  map 65% reduce 18%
16/12/07 22:44:26 INFO mapreduce.Job:  map 67% reduce 18%
16/12/07 22:44:28 INFO mapreduce.Job:  map 69% reduce 19%
16/12/07 22:44:29 INFO mapreduce.Job:  map 70% reduce 20%
16/12/07 22:44:30 INFO mapreduce.Job:  map 72% reduce 21%
16/12/07 22:44:31 INFO mapreduce.Job:  map 73% reduce 22%
16/12/07 22:44:33 INFO mapreduce.Job:  map 74% reduce 22%
16/12/07 22:44:34 INFO mapreduce.Job:  map 77% reduce 23%
16/12/07 22:44:35 INFO mapreduce.Job:  map 78% reduce 23%
16/12/07 22:44:36 INFO mapreduce.Job:  map 79% reduce 24%
16/12/07 22:44:37 INFO mapreduce.Job:  map 80% reduce 24%
16/12/07 22:44:38 INFO mapreduce.Job:  map 82% reduce 25%
16/12/07 22:44:39 INFO mapreduce.Job:  map 82% reduce 26%
16/12/07 22:44:40 INFO mapreduce.Job:  map 83% reduce 26%
16/12/07 22:44:41 INFO mapreduce.Job:  map 84% reduce 26%
16/12/07 22:44:42 INFO mapreduce.Job:  map 85% reduce 27%
16/12/07 22:44:44 INFO mapreduce.Job:  map 86% reduce 28%
16/12/07 22:44:46 INFO mapreduce.Job:  map 87% reduce 28%
16/12/07 22:44:47 INFO mapreduce.Job:  map 88% reduce 29%
16/12/07 22:44:57 INFO mapreduce.Job:  map 89% reduce 29%
16/12/07 22:45:01 INFO mapreduce.Job:  map 90% reduce 29%
16/12/07 22:45:02 INFO mapreduce.Job:  map 91% reduce 30%
16/12/07 22:45:04 INFO mapreduce.Job:  map 92% reduce 30%
16/12/07 22:45:07 INFO mapreduce.Job:  map 93% reduce 31%
16/12/07 22:45:08 INFO mapreduce.Job:  map 95% reduce 31%
16/12/07 22:45:09 INFO mapreduce.Job:  map 96% reduce 31%
16/12/07 22:45:10 INFO mapreduce.Job:  map 98% reduce 31%
16/12/07 22:45:11 INFO mapreduce.Job:  map 100% reduce 32%
16/12/07 22:45:12 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 22:45:13 INFO mapreduce.Job:  map 100% reduce 38%
16/12/07 22:45:14 INFO mapreduce.Job:  map 100% reduce 48%
16/12/07 22:45:15 INFO mapreduce.Job:  map 100% reduce 51%
16/12/07 22:45:16 INFO mapreduce.Job:  map 100% reduce 65%
16/12/07 22:45:17 INFO mapreduce.Job:  map 100% reduce 71%
16/12/07 22:45:18 INFO mapreduce.Job:  map 100% reduce 73%
16/12/07 22:45:19 INFO mapreduce.Job:  map 100% reduce 79%
16/12/07 22:45:20 INFO mapreduce.Job:  map 100% reduce 83%
16/12/07 22:45:21 INFO mapreduce.Job:  map 100% reduce 86%
16/12/07 22:45:22 INFO mapreduce.Job:  map 100% reduce 92%
16/12/07 22:45:23 INFO mapreduce.Job:  map 100% reduce 95%
16/12/07 22:45:24 INFO mapreduce.Job:  map 100% reduce 97%
16/12/07 22:45:25 INFO mapreduce.Job:  map 100% reduce 98%
16/12/07 22:45:26 INFO mapreduce.Job:  map 100% reduce 99%
16/12/07 22:45:27 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 22:45:29 INFO mapreduce.Job: Job job_1480588584072_5537 completed successfully
16/12/07 22:45:29 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=1060863911
		FILE: Number of bytes written=2154109787
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=893259776
		WASB: Number of bytes written=554894784
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=14932514
		Total time spent by all reduces in occupied slots (ms)=4450756
		Total time spent by all map tasks (ms)=7466257
		Total time spent by all reduce tasks (ms)=2225378
		Total vcore-seconds taken by all map tasks=7466257
		Total vcore-seconds taken by all reduce tasks=2225378
		Total megabyte-seconds taken by all map tasks=7645447168
		Total megabyte-seconds taken by all reduce tasks=2278787072
	Map-Reduce Framework
		Map input records=2947216
		Map output records=2647596
		Map output bytes=1050845638
		Map output materialized bytes=1060887431
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2337730
		Reduce shuffle bytes=1060887431
		Reduce input records=2647596
		Reduce output records=1664196
		Spilled Records=5295192
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=77945
		CPU time spent (ms)=1064520
		Physical memory (bytes) snapshot=325813542912
		Virtual memory (bytes) snapshot=742704041984
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=890563772
	File Output Format Counters 
		Bytes Written=554894784
16/12/07 22:45:29 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1700
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071400 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1800 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071400
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1800': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2279302980857795033.jar tmpDir=null
16/12/07 23:51:43 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 23:51:44 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/07 23:51:44 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/07 23:51:46 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/07 23:51:47 INFO mapreduce.JobSubmitter: number of splits:197
16/12/07 23:51:47 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5540
16/12/07 23:51:48 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5540
16/12/07 23:51:48 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5540/
16/12/07 23:51:48 INFO mapreduce.Job: Running job: job_1480588584072_5540
16/12/07 23:52:00 INFO mapreduce.Job: Job job_1480588584072_5540 running in uber mode : false
16/12/07 23:52:00 INFO mapreduce.Job:  map 0% reduce 0%
16/12/07 23:52:11 INFO mapreduce.Job:  map 1% reduce 0%
16/12/07 23:52:12 INFO mapreduce.Job:  map 3% reduce 0%
16/12/07 23:52:20 INFO mapreduce.Job:  map 5% reduce 0%
16/12/07 23:52:21 INFO mapreduce.Job:  map 9% reduce 0%
16/12/07 23:52:23 INFO mapreduce.Job:  map 13% reduce 0%
16/12/07 23:52:28 INFO mapreduce.Job:  map 14% reduce 0%
16/12/07 23:52:29 INFO mapreduce.Job:  map 15% reduce 0%
16/12/07 23:52:30 INFO mapreduce.Job:  map 20% reduce 0%
16/12/07 23:52:32 INFO mapreduce.Job:  map 22% reduce 0%
16/12/07 23:52:34 INFO mapreduce.Job:  map 24% reduce 0%
16/12/07 23:52:38 INFO mapreduce.Job:  map 24% reduce 1%
16/12/07 23:52:39 INFO mapreduce.Job:  map 25% reduce 2%
16/12/07 23:52:40 INFO mapreduce.Job:  map 25% reduce 3%
16/12/07 23:52:42 INFO mapreduce.Job:  map 26% reduce 4%
16/12/07 23:52:44 INFO mapreduce.Job:  map 26% reduce 5%
16/12/07 23:52:45 INFO mapreduce.Job:  map 29% reduce 5%
16/12/07 23:52:47 INFO mapreduce.Job:  map 30% reduce 6%
16/12/07 23:52:48 INFO mapreduce.Job:  map 31% reduce 7%
16/12/07 23:52:49 INFO mapreduce.Job:  map 31% reduce 9%
16/12/07 23:52:50 INFO mapreduce.Job:  map 31% reduce 10%
16/12/07 23:52:52 INFO mapreduce.Job:  map 32% reduce 10%
16/12/07 23:52:53 INFO mapreduce.Job:  map 33% reduce 10%
16/12/07 23:52:54 INFO mapreduce.Job:  map 33% reduce 11%
16/12/07 23:52:55 INFO mapreduce.Job:  map 34% reduce 11%
16/12/07 23:52:57 INFO mapreduce.Job:  map 35% reduce 11%
16/12/07 23:52:59 INFO mapreduce.Job:  map 37% reduce 11%
16/12/07 23:53:00 INFO mapreduce.Job:  map 37% reduce 12%
16/12/07 23:53:01 INFO mapreduce.Job:  map 38% reduce 12%
16/12/07 23:53:04 INFO mapreduce.Job:  map 39% reduce 13%
16/12/07 23:53:06 INFO mapreduce.Job:  map 40% reduce 13%
16/12/07 23:53:07 INFO mapreduce.Job:  map 41% reduce 13%
16/12/07 23:53:08 INFO mapreduce.Job:  map 42% reduce 13%
16/12/07 23:53:09 INFO mapreduce.Job:  map 43% reduce 13%
16/12/07 23:53:10 INFO mapreduce.Job:  map 44% reduce 14%
16/12/07 23:53:11 INFO mapreduce.Job:  map 45% reduce 14%
16/12/07 23:53:13 INFO mapreduce.Job:  map 45% reduce 15%
16/12/07 23:53:14 INFO mapreduce.Job:  map 46% reduce 15%
16/12/07 23:53:15 INFO mapreduce.Job:  map 48% reduce 15%
16/12/07 23:53:16 INFO mapreduce.Job:  map 49% reduce 15%
16/12/07 23:53:17 INFO mapreduce.Job:  map 51% reduce 15%
16/12/07 23:53:18 INFO mapreduce.Job:  map 52% reduce 15%
16/12/07 23:53:19 INFO mapreduce.Job:  map 54% reduce 16%
16/12/07 23:53:20 INFO mapreduce.Job:  map 55% reduce 16%
16/12/07 23:53:21 INFO mapreduce.Job:  map 56% reduce 17%
16/12/07 23:53:22 INFO mapreduce.Job:  map 57% reduce 17%
16/12/07 23:53:23 INFO mapreduce.Job:  map 60% reduce 17%
16/12/07 23:53:24 INFO mapreduce.Job:  map 61% reduce 18%
16/12/07 23:53:25 INFO mapreduce.Job:  map 63% reduce 18%
16/12/07 23:53:26 INFO mapreduce.Job:  map 65% reduce 18%
16/12/07 23:53:27 INFO mapreduce.Job:  map 66% reduce 19%
16/12/07 23:53:28 INFO mapreduce.Job:  map 67% reduce 20%
16/12/07 23:53:29 INFO mapreduce.Job:  map 69% reduce 20%
16/12/07 23:53:30 INFO mapreduce.Job:  map 71% reduce 20%
16/12/07 23:53:31 INFO mapreduce.Job:  map 73% reduce 21%
16/12/07 23:53:32 INFO mapreduce.Job:  map 74% reduce 21%
16/12/07 23:53:33 INFO mapreduce.Job:  map 75% reduce 22%
16/12/07 23:53:34 INFO mapreduce.Job:  map 79% reduce 23%
16/12/07 23:53:36 INFO mapreduce.Job:  map 80% reduce 23%
16/12/07 23:53:37 INFO mapreduce.Job:  map 81% reduce 24%
16/12/07 23:53:38 INFO mapreduce.Job:  map 82% reduce 24%
16/12/07 23:53:39 INFO mapreduce.Job:  map 83% reduce 25%
16/12/07 23:53:40 INFO mapreduce.Job:  map 85% reduce 25%
16/12/07 23:53:41 INFO mapreduce.Job:  map 86% reduce 26%
16/12/07 23:53:42 INFO mapreduce.Job:  map 88% reduce 27%
16/12/07 23:53:43 INFO mapreduce.Job:  map 88% reduce 28%
16/12/07 23:53:45 INFO mapreduce.Job:  map 88% reduce 29%
16/12/07 23:53:46 INFO mapreduce.Job:  map 89% reduce 29%
16/12/07 23:53:47 INFO mapreduce.Job:  map 90% reduce 29%
16/12/07 23:53:48 INFO mapreduce.Job:  map 91% reduce 29%
16/12/07 23:53:49 INFO mapreduce.Job:  map 91% reduce 30%
16/12/07 23:53:57 INFO mapreduce.Job:  map 92% reduce 30%
16/12/07 23:53:58 INFO mapreduce.Job:  map 93% reduce 30%
16/12/07 23:53:59 INFO mapreduce.Job:  map 93% reduce 31%
16/12/07 23:54:00 INFO mapreduce.Job:  map 94% reduce 31%
16/12/07 23:54:01 INFO mapreduce.Job:  map 95% reduce 31%
16/12/07 23:54:02 INFO mapreduce.Job:  map 98% reduce 31%
16/12/07 23:54:03 INFO mapreduce.Job:  map 99% reduce 32%
16/12/07 23:54:04 INFO mapreduce.Job:  map 99% reduce 33%
16/12/07 23:54:07 INFO mapreduce.Job:  map 100% reduce 33%
16/12/07 23:54:08 INFO mapreduce.Job:  map 100% reduce 35%
16/12/07 23:54:09 INFO mapreduce.Job:  map 100% reduce 43%
16/12/07 23:54:10 INFO mapreduce.Job:  map 100% reduce 55%
16/12/07 23:54:11 INFO mapreduce.Job:  map 100% reduce 60%
16/12/07 23:54:12 INFO mapreduce.Job:  map 100% reduce 68%
16/12/07 23:54:13 INFO mapreduce.Job:  map 100% reduce 72%
16/12/07 23:54:14 INFO mapreduce.Job:  map 100% reduce 75%
16/12/07 23:54:15 INFO mapreduce.Job:  map 100% reduce 79%
16/12/07 23:54:16 INFO mapreduce.Job:  map 100% reduce 84%
16/12/07 23:54:17 INFO mapreduce.Job:  map 100% reduce 88%
16/12/07 23:54:19 INFO mapreduce.Job:  map 100% reduce 92%
16/12/07 23:54:20 INFO mapreduce.Job:  map 100% reduce 93%
16/12/07 23:54:21 INFO mapreduce.Job:  map 100% reduce 95%
16/12/07 23:54:23 INFO mapreduce.Job:  map 100% reduce 98%
16/12/07 23:54:24 INFO mapreduce.Job:  map 100% reduce 99%
16/12/07 23:54:25 INFO mapreduce.Job:  map 100% reduce 100%
16/12/07 23:54:27 INFO mapreduce.Job: Job job_1480588584072_5540 completed successfully
16/12/07 23:54:27 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=1112995721
		FILE: Number of bytes written=2258373407
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=937497842
		WASB: Number of bytes written=571657052
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=14562296
		Total time spent by all reduces in occupied slots (ms)=4415382
		Total time spent by all map tasks (ms)=7281148
		Total time spent by all reduce tasks (ms)=2207691
		Total vcore-seconds taken by all map tasks=7281148
		Total vcore-seconds taken by all reduce tasks=2207691
		Total megabyte-seconds taken by all map tasks=7455895552
		Total megabyte-seconds taken by all reduce tasks=2260675584
	Map-Reduce Framework
		Map input records=3104072
		Map output records=2784210
		Map output bytes=1102461753
		Map output materialized bytes=1113019241
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2451886
		Reduce shuffle bytes=1113019241
		Reduce input records=2784210
		Reduce output records=1721304
		Spilled Records=5568420
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=86108
		CPU time spent (ms)=1083980
		Physical memory (bytes) snapshot=326239240192
		Virtual memory (bytes) snapshot=742888648704
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=934801838
	File Output Format Counters 
		Bytes Written=571657052
16/12/07 23:54:27 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1800
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071500 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1900 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071500
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1900': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4824180194546182558.jar tmpDir=null
16/12/08 00:50:34 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 00:50:35 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 00:50:36 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 00:50:37 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 00:50:38 INFO mapreduce.JobSubmitter: number of splits:197
16/12/08 00:50:38 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5543
16/12/08 00:50:39 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5543
16/12/08 00:50:39 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5543/
16/12/08 00:50:39 INFO mapreduce.Job: Running job: job_1480588584072_5543
16/12/08 00:50:52 INFO mapreduce.Job: Job job_1480588584072_5543 running in uber mode : false
16/12/08 00:50:52 INFO mapreduce.Job:  map 0% reduce 0%
16/12/08 00:51:14 INFO mapreduce.Job:  map 2% reduce 0%
16/12/08 00:51:16 INFO mapreduce.Job:  map 5% reduce 0%
16/12/08 00:51:17 INFO mapreduce.Job:  map 8% reduce 0%
16/12/08 00:51:21 INFO mapreduce.Job:  map 9% reduce 0%
16/12/08 00:51:22 INFO mapreduce.Job:  map 12% reduce 0%
16/12/08 00:51:24 INFO mapreduce.Job:  map 13% reduce 0%
16/12/08 00:51:27 INFO mapreduce.Job:  map 16% reduce 0%
16/12/08 00:51:29 INFO mapreduce.Job:  map 20% reduce 0%
16/12/08 00:51:31 INFO mapreduce.Job:  map 21% reduce 0%
16/12/08 00:51:34 INFO mapreduce.Job:  map 22% reduce 0%
16/12/08 00:51:38 INFO mapreduce.Job:  map 26% reduce 0%
16/12/08 00:51:39 INFO mapreduce.Job:  map 27% reduce 0%
16/12/08 00:51:40 INFO mapreduce.Job:  map 30% reduce 0%
16/12/08 00:51:42 INFO mapreduce.Job:  map 31% reduce 0%
16/12/08 00:51:43 INFO mapreduce.Job:  map 32% reduce 1%
16/12/08 00:51:44 INFO mapreduce.Job:  map 33% reduce 1%
16/12/08 00:51:45 INFO mapreduce.Job:  map 34% reduce 3%
16/12/08 00:51:47 INFO mapreduce.Job:  map 37% reduce 5%
16/12/08 00:51:48 INFO mapreduce.Job:  map 38% reduce 5%
16/12/08 00:51:49 INFO mapreduce.Job:  map 40% reduce 6%
16/12/08 00:51:51 INFO mapreduce.Job:  map 40% reduce 8%
16/12/08 00:51:53 INFO mapreduce.Job:  map 44% reduce 11%
16/12/08 00:51:54 INFO mapreduce.Job:  map 46% reduce 11%
16/12/08 00:51:55 INFO mapreduce.Job:  map 46% reduce 13%
16/12/08 00:51:56 INFO mapreduce.Job:  map 48% reduce 14%
16/12/08 00:51:57 INFO mapreduce.Job:  map 49% reduce 14%
16/12/08 00:52:00 INFO mapreduce.Job:  map 51% reduce 15%
16/12/08 00:52:02 INFO mapreduce.Job:  map 54% reduce 15%
16/12/08 00:52:04 INFO mapreduce.Job:  map 54% reduce 16%
16/12/08 00:52:05 INFO mapreduce.Job:  map 57% reduce 17%
16/12/08 00:52:06 INFO mapreduce.Job:  map 59% reduce 17%
16/12/08 00:52:07 INFO mapreduce.Job:  map 60% reduce 17%
16/12/08 00:52:08 INFO mapreduce.Job:  map 61% reduce 18%
16/12/08 00:52:10 INFO mapreduce.Job:  map 64% reduce 18%
16/12/08 00:52:11 INFO mapreduce.Job:  map 69% reduce 19%
16/12/08 00:52:12 INFO mapreduce.Job:  map 71% reduce 20%
16/12/08 00:52:14 INFO mapreduce.Job:  map 73% reduce 21%
16/12/08 00:52:15 INFO mapreduce.Job:  map 75% reduce 22%
16/12/08 00:52:17 INFO mapreduce.Job:  map 77% reduce 22%
16/12/08 00:52:18 INFO mapreduce.Job:  map 77% reduce 23%
16/12/08 00:52:19 INFO mapreduce.Job:  map 79% reduce 23%
16/12/08 00:52:20 INFO mapreduce.Job:  map 80% reduce 23%
16/12/08 00:52:22 INFO mapreduce.Job:  map 80% reduce 26%
16/12/08 00:52:23 INFO mapreduce.Job:  map 81% reduce 26%
16/12/08 00:52:25 INFO mapreduce.Job:  map 81% reduce 27%
16/12/08 00:52:28 INFO mapreduce.Job:  map 82% reduce 27%
16/12/08 00:52:32 INFO mapreduce.Job:  map 85% reduce 27%
16/12/08 00:52:33 INFO mapreduce.Job:  map 86% reduce 27%
16/12/08 00:52:35 INFO mapreduce.Job:  map 89% reduce 28%
16/12/08 00:52:36 INFO mapreduce.Job:  map 91% reduce 28%
16/12/08 00:52:38 INFO mapreduce.Job:  map 91% reduce 29%
16/12/08 00:52:39 INFO mapreduce.Job:  map 92% reduce 29%
16/12/08 00:52:41 INFO mapreduce.Job:  map 92% reduce 30%
16/12/08 00:52:42 INFO mapreduce.Job:  map 93% reduce 30%
16/12/08 00:52:43 INFO mapreduce.Job:  map 95% reduce 30%
16/12/08 00:52:44 INFO mapreduce.Job:  map 95% reduce 31%
16/12/08 00:52:45 INFO mapreduce.Job:  map 96% reduce 31%
16/12/08 00:52:46 INFO mapreduce.Job:  map 98% reduce 31%
16/12/08 00:52:47 INFO mapreduce.Job:  map 99% reduce 32%
16/12/08 00:52:48 INFO mapreduce.Job:  map 100% reduce 32%
16/12/08 00:52:50 INFO mapreduce.Job:  map 100% reduce 41%
16/12/08 00:52:51 INFO mapreduce.Job:  map 100% reduce 42%
16/12/08 00:52:53 INFO mapreduce.Job:  map 100% reduce 55%
16/12/08 00:52:54 INFO mapreduce.Job:  map 100% reduce 69%
16/12/08 00:52:55 INFO mapreduce.Job:  map 100% reduce 70%
16/12/08 00:52:56 INFO mapreduce.Job:  map 100% reduce 76%
16/12/08 00:52:57 INFO mapreduce.Job:  map 100% reduce 80%
16/12/08 00:52:58 INFO mapreduce.Job:  map 100% reduce 82%
16/12/08 00:52:59 INFO mapreduce.Job:  map 100% reduce 85%
16/12/08 00:53:00 INFO mapreduce.Job:  map 100% reduce 90%
16/12/08 00:53:01 INFO mapreduce.Job:  map 100% reduce 91%
16/12/08 00:53:03 INFO mapreduce.Job:  map 100% reduce 92%
16/12/08 00:53:04 INFO mapreduce.Job:  map 100% reduce 95%
16/12/08 00:53:06 INFO mapreduce.Job:  map 100% reduce 97%
16/12/08 00:53:07 INFO mapreduce.Job:  map 100% reduce 98%
16/12/08 00:53:08 INFO mapreduce.Job:  map 100% reduce 99%
16/12/08 00:53:13 INFO mapreduce.Job:  map 100% reduce 100%
16/12/08 00:53:17 INFO mapreduce.Job: Job job_1480588584072_5543 completed successfully
16/12/08 00:53:17 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=1109490986
		FILE: Number of bytes written=2251363937
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=932671027
		WASB: Number of bytes written=561435529
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13670064
		Total time spent by all reduces in occupied slots (ms)=3573064
		Total time spent by all map tasks (ms)=6835032
		Total time spent by all reduce tasks (ms)=1786532
		Total vcore-seconds taken by all map tasks=6835032
		Total vcore-seconds taken by all reduce tasks=1786532
		Total megabyte-seconds taken by all map tasks=6999072768
		Total megabyte-seconds taken by all reduce tasks=1829408768
	Map-Reduce Framework
		Map input records=3088146
		Map output records=2774183
		Map output bytes=1098979653
		Map output materialized bytes=1109514506
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2437525
		Reduce shuffle bytes=1109514506
		Reduce input records=2774183
		Reduce output records=1688137
		Spilled Records=5548366
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=76494
		CPU time spent (ms)=1028700
		Physical memory (bytes) snapshot=325734113280
		Virtual memory (bytes) snapshot=742709215232
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=929975023
	File Output Format Counters 
		Bytes Written=561435529
16/12/08 00:53:17 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/1900
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071600 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/2000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071600
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/2000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2759325901361941936.jar tmpDir=null
16/12/08 01:44:24 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 01:44:25 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 01:44:26 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 01:44:27 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 01:44:27 INFO mapreduce.JobSubmitter: number of splits:197
16/12/08 01:44:28 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5546
16/12/08 01:44:29 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5546
16/12/08 01:44:29 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5546/
16/12/08 01:44:29 INFO mapreduce.Job: Running job: job_1480588584072_5546
16/12/08 01:44:41 INFO mapreduce.Job: Job job_1480588584072_5546 running in uber mode : false
16/12/08 01:44:41 INFO mapreduce.Job:  map 0% reduce 0%
16/12/08 01:45:06 INFO mapreduce.Job:  map 4% reduce 0%
16/12/08 01:45:07 INFO mapreduce.Job:  map 6% reduce 0%
16/12/08 01:45:10 INFO mapreduce.Job:  map 10% reduce 0%
16/12/08 01:45:12 INFO mapreduce.Job:  map 12% reduce 0%
16/12/08 01:45:13 INFO mapreduce.Job:  map 14% reduce 0%
16/12/08 01:45:16 INFO mapreduce.Job:  map 15% reduce 0%
16/12/08 01:45:18 INFO mapreduce.Job:  map 17% reduce 0%
16/12/08 01:45:20 INFO mapreduce.Job:  map 18% reduce 0%
16/12/08 01:45:21 INFO mapreduce.Job:  map 20% reduce 0%
16/12/08 01:45:22 INFO mapreduce.Job:  map 22% reduce 0%
16/12/08 01:45:23 INFO mapreduce.Job:  map 23% reduce 0%
16/12/08 01:45:26 INFO mapreduce.Job:  map 25% reduce 0%
16/12/08 01:45:27 INFO mapreduce.Job:  map 26% reduce 0%
16/12/08 01:45:29 INFO mapreduce.Job:  map 28% reduce 0%
16/12/08 01:45:30 INFO mapreduce.Job:  map 29% reduce 2%
16/12/08 01:45:32 INFO mapreduce.Job:  map 30% reduce 2%
16/12/08 01:45:33 INFO mapreduce.Job:  map 31% reduce 3%
16/12/08 01:45:35 INFO mapreduce.Job:  map 31% reduce 4%
16/12/08 01:45:36 INFO mapreduce.Job:  map 32% reduce 7%
16/12/08 01:45:37 INFO mapreduce.Job:  map 33% reduce 8%
16/12/08 01:45:39 INFO mapreduce.Job:  map 35% reduce 8%
16/12/08 01:45:40 INFO mapreduce.Job:  map 36% reduce 10%
16/12/08 01:45:42 INFO mapreduce.Job:  map 37% reduce 10%
16/12/08 01:45:43 INFO mapreduce.Job:  map 40% reduce 11%
16/12/08 01:45:44 INFO mapreduce.Job:  map 42% reduce 11%
16/12/08 01:45:46 INFO mapreduce.Job:  map 43% reduce 11%
16/12/08 01:45:47 INFO mapreduce.Job:  map 43% reduce 12%
16/12/08 01:45:48 INFO mapreduce.Job:  map 45% reduce 13%
16/12/08 01:45:51 INFO mapreduce.Job:  map 47% reduce 13%
16/12/08 01:45:53 INFO mapreduce.Job:  map 51% reduce 13%
16/12/08 01:45:54 INFO mapreduce.Job:  map 53% reduce 13%
16/12/08 01:45:55 INFO mapreduce.Job:  map 55% reduce 13%
16/12/08 01:45:56 INFO mapreduce.Job:  map 58% reduce 14%
16/12/08 01:45:57 INFO mapreduce.Job:  map 59% reduce 15%
16/12/08 01:45:59 INFO mapreduce.Job:  map 61% reduce 17%
16/12/08 01:46:00 INFO mapreduce.Job:  map 62% reduce 17%
16/12/08 01:46:01 INFO mapreduce.Job:  map 64% reduce 18%
16/12/08 01:46:03 INFO mapreduce.Job:  map 65% reduce 18%
16/12/08 01:46:04 INFO mapreduce.Job:  map 69% reduce 19%
16/12/08 01:46:05 INFO mapreduce.Job:  map 71% reduce 19%
16/12/08 01:46:06 INFO mapreduce.Job:  map 72% reduce 21%
16/12/08 01:46:07 INFO mapreduce.Job:  map 73% reduce 23%
16/12/08 01:46:08 INFO mapreduce.Job:  map 74% reduce 23%
16/12/08 01:46:10 INFO mapreduce.Job:  map 77% reduce 24%
16/12/08 01:46:12 INFO mapreduce.Job:  map 79% reduce 25%
16/12/08 01:46:14 INFO mapreduce.Job:  map 80% reduce 25%
16/12/08 01:46:15 INFO mapreduce.Job:  map 80% reduce 26%
16/12/08 01:46:17 INFO mapreduce.Job:  map 81% reduce 26%
16/12/08 01:46:20 INFO mapreduce.Job:  map 81% reduce 27%
16/12/08 01:46:24 INFO mapreduce.Job:  map 82% reduce 27%
16/12/08 01:46:25 INFO mapreduce.Job:  map 84% reduce 27%
16/12/08 01:46:26 INFO mapreduce.Job:  map 87% reduce 27%
16/12/08 01:46:29 INFO mapreduce.Job:  map 88% reduce 28%
16/12/08 01:46:32 INFO mapreduce.Job:  map 88% reduce 29%
16/12/08 01:46:34 INFO mapreduce.Job:  map 89% reduce 29%
16/12/08 01:46:39 INFO mapreduce.Job:  map 90% reduce 30%
16/12/08 01:46:40 INFO mapreduce.Job:  map 91% reduce 30%
16/12/08 01:46:42 INFO mapreduce.Job:  map 93% reduce 30%
16/12/08 01:46:45 INFO mapreduce.Job:  map 94% reduce 30%
16/12/08 01:46:46 INFO mapreduce.Job:  map 95% reduce 31%
16/12/08 01:46:47 INFO mapreduce.Job:  map 96% reduce 31%
16/12/08 01:46:48 INFO mapreduce.Job:  map 98% reduce 31%
16/12/08 01:46:49 INFO mapreduce.Job:  map 100% reduce 32%
16/12/08 01:46:50 INFO mapreduce.Job:  map 100% reduce 33%
16/12/08 01:46:51 INFO mapreduce.Job:  map 100% reduce 35%
16/12/08 01:46:52 INFO mapreduce.Job:  map 100% reduce 48%
16/12/08 01:46:53 INFO mapreduce.Job:  map 100% reduce 55%
16/12/08 01:46:54 INFO mapreduce.Job:  map 100% reduce 57%
16/12/08 01:46:55 INFO mapreduce.Job:  map 100% reduce 69%
16/12/08 01:46:56 INFO mapreduce.Job:  map 100% reduce 71%
16/12/08 01:46:58 INFO mapreduce.Job:  map 100% reduce 76%
16/12/08 01:46:59 INFO mapreduce.Job:  map 100% reduce 80%
16/12/08 01:47:00 INFO mapreduce.Job:  map 100% reduce 81%
16/12/08 01:47:01 INFO mapreduce.Job:  map 100% reduce 87%
16/12/08 01:47:02 INFO mapreduce.Job:  map 100% reduce 90%
16/12/08 01:47:03 INFO mapreduce.Job:  map 100% reduce 91%
16/12/08 01:47:04 INFO mapreduce.Job:  map 100% reduce 95%
16/12/08 01:47:05 INFO mapreduce.Job:  map 100% reduce 99%
16/12/08 01:47:07 INFO mapreduce.Job:  map 100% reduce 100%
16/12/08 01:47:10 INFO mapreduce.Job: Job job_1480588584072_5546 completed successfully
16/12/08 01:47:10 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=1261086325
		FILE: Number of bytes written=2554554615
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=1047189092
		WASB: Number of bytes written=702389789
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=14313000
		Total time spent by all reduces in occupied slots (ms)=4134986
		Total time spent by all map tasks (ms)=7156500
		Total time spent by all reduce tasks (ms)=2067493
		Total vcore-seconds taken by all map tasks=7156500
		Total vcore-seconds taken by all reduce tasks=2067493
		Total megabyte-seconds taken by all map tasks=7328256000
		Total megabyte-seconds taken by all reduce tasks=2117112832
	Map-Reduce Framework
		Map input records=3419049
		Map output records=3131558
		Map output bytes=1249226646
		Map output materialized bytes=1261109845
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2791904
		Reduce shuffle bytes=1261109845
		Reduce input records=3131558
		Reduce output records=2107769
		Spilled Records=6263116
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=84037
		CPU time spent (ms)=1125770
		Physical memory (bytes) snapshot=326236901376
		Virtual memory (bytes) snapshot=742891438080
		Total committed heap usage (bytes)=574047649792
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=1044493088
	File Output Format Counters 
		Bytes Written=702389789
16/12/08 01:47:10 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/2000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071700 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/2100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071700
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/2100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4134239541915942541.jar tmpDir=null
16/12/08 02:43:18 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 02:43:19 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 02:43:22 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 02:43:24 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 02:43:24 INFO mapreduce.JobSubmitter: number of splits:197
16/12/08 02:43:24 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5549
16/12/08 02:43:25 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5549
16/12/08 02:43:25 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5549/
16/12/08 02:43:25 INFO mapreduce.Job: Running job: job_1480588584072_5549
16/12/08 02:43:37 INFO mapreduce.Job: Job job_1480588584072_5549 running in uber mode : false
16/12/08 02:43:37 INFO mapreduce.Job:  map 0% reduce 0%
16/12/08 02:43:51 INFO mapreduce.Job:  map 3% reduce 0%
16/12/08 02:43:59 INFO mapreduce.Job:  map 4% reduce 0%
16/12/08 02:44:00 INFO mapreduce.Job:  map 7% reduce 0%
16/12/08 02:44:01 INFO mapreduce.Job:  map 10% reduce 0%
16/12/08 02:44:02 INFO mapreduce.Job:  map 13% reduce 0%
16/12/08 02:44:07 INFO mapreduce.Job:  map 17% reduce 0%
16/12/08 02:44:08 INFO mapreduce.Job:  map 18% reduce 0%
16/12/08 02:44:10 INFO mapreduce.Job:  map 19% reduce 0%
16/12/08 02:44:11 INFO mapreduce.Job:  map 20% reduce 0%
16/12/08 02:44:12 INFO mapreduce.Job:  map 22% reduce 0%
16/12/08 02:44:13 INFO mapreduce.Job:  map 23% reduce 0%
16/12/08 02:44:14 INFO mapreduce.Job:  map 25% reduce 2%
16/12/08 02:44:18 INFO mapreduce.Job:  map 25% reduce 3%
16/12/08 02:44:22 INFO mapreduce.Job:  map 27% reduce 3%
16/12/08 02:44:23 INFO mapreduce.Job:  map 30% reduce 4%
16/12/08 02:44:24 INFO mapreduce.Job:  map 30% reduce 5%
16/12/08 02:44:25 INFO mapreduce.Job:  map 30% reduce 6%
16/12/08 02:44:26 INFO mapreduce.Job:  map 30% reduce 9%
16/12/08 02:44:27 INFO mapreduce.Job:  map 30% reduce 10%
16/12/08 02:44:28 INFO mapreduce.Job:  map 31% reduce 10%
16/12/08 02:44:29 INFO mapreduce.Job:  map 33% reduce 10%
16/12/08 02:44:30 INFO mapreduce.Job:  map 34% reduce 11%
16/12/08 02:44:32 INFO mapreduce.Job:  map 36% reduce 11%
16/12/08 02:44:34 INFO mapreduce.Job:  map 37% reduce 11%
16/12/08 02:44:35 INFO mapreduce.Job:  map 37% reduce 12%
16/12/08 02:44:36 INFO mapreduce.Job:  map 38% reduce 12%
16/12/08 02:44:37 INFO mapreduce.Job:  map 39% reduce 12%
16/12/08 02:44:38 INFO mapreduce.Job:  map 39% reduce 13%
16/12/08 02:44:40 INFO mapreduce.Job:  map 41% reduce 13%
16/12/08 02:44:41 INFO mapreduce.Job:  map 43% reduce 13%
16/12/08 02:44:42 INFO mapreduce.Job:  map 43% reduce 14%
16/12/08 02:44:43 INFO mapreduce.Job:  map 45% reduce 14%
16/12/08 02:44:45 INFO mapreduce.Job:  map 46% reduce 15%
16/12/08 02:44:47 INFO mapreduce.Job:  map 47% reduce 15%
16/12/08 02:44:48 INFO mapreduce.Job:  map 49% reduce 15%
16/12/08 02:44:49 INFO mapreduce.Job:  map 51% reduce 15%
16/12/08 02:44:50 INFO mapreduce.Job:  map 53% reduce 16%
16/12/08 02:44:51 INFO mapreduce.Job:  map 54% reduce 17%
16/12/08 02:44:52 INFO mapreduce.Job:  map 56% reduce 17%
16/12/08 02:44:53 INFO mapreduce.Job:  map 57% reduce 17%
16/12/08 02:44:54 INFO mapreduce.Job:  map 58% reduce 18%
16/12/08 02:44:55 INFO mapreduce.Job:  map 59% reduce 18%
16/12/08 02:44:56 INFO mapreduce.Job:  map 62% reduce 18%
16/12/08 02:44:57 INFO mapreduce.Job:  map 65% reduce 19%
16/12/08 02:44:58 INFO mapreduce.Job:  map 67% reduce 19%
16/12/08 02:44:59 INFO mapreduce.Job:  map 69% reduce 20%
16/12/08 02:45:00 INFO mapreduce.Job:  map 70% reduce 21%
16/12/08 02:45:02 INFO mapreduce.Job:  map 70% reduce 22%
16/12/08 02:45:03 INFO mapreduce.Job:  map 72% reduce 22%
16/12/08 02:45:04 INFO mapreduce.Job:  map 73% reduce 23%
16/12/08 02:45:05 INFO mapreduce.Job:  map 76% reduce 23%
16/12/08 02:45:06 INFO mapreduce.Job:  map 78% reduce 23%
16/12/08 02:45:07 INFO mapreduce.Job:  map 79% reduce 24%
16/12/08 02:45:08 INFO mapreduce.Job:  map 80% reduce 25%
16/12/08 02:45:11 INFO mapreduce.Job:  map 81% reduce 25%
16/12/08 02:45:12 INFO mapreduce.Job:  map 82% reduce 25%
16/12/08 02:45:13 INFO mapreduce.Job:  map 83% reduce 25%
16/12/08 02:45:14 INFO mapreduce.Job:  map 83% reduce 26%
16/12/08 02:45:15 INFO mapreduce.Job:  map 84% reduce 26%
16/12/08 02:45:17 INFO mapreduce.Job:  map 85% reduce 26%
16/12/08 02:45:19 INFO mapreduce.Job:  map 87% reduce 27%
16/12/08 02:45:21 INFO mapreduce.Job:  map 87% reduce 28%
16/12/08 02:45:22 INFO mapreduce.Job:  map 89% reduce 29%
16/12/08 02:45:25 INFO mapreduce.Job:  map 89% reduce 30%
16/12/08 02:45:29 INFO mapreduce.Job:  map 90% reduce 30%
16/12/08 02:45:30 INFO mapreduce.Job:  map 91% reduce 30%
16/12/08 02:45:32 INFO mapreduce.Job:  map 92% reduce 30%
16/12/08 02:45:33 INFO mapreduce.Job:  map 94% reduce 30%
16/12/08 02:45:34 INFO mapreduce.Job:  map 95% reduce 30%
16/12/08 02:45:35 INFO mapreduce.Job:  map 96% reduce 31%
16/12/08 02:45:36 INFO mapreduce.Job:  map 97% reduce 31%
16/12/08 02:45:37 INFO mapreduce.Job:  map 98% reduce 32%
16/12/08 02:45:38 INFO mapreduce.Job:  map 100% reduce 32%
16/12/08 02:45:39 INFO mapreduce.Job:  map 100% reduce 34%
16/12/08 02:45:40 INFO mapreduce.Job:  map 100% reduce 41%
16/12/08 02:45:41 INFO mapreduce.Job:  map 100% reduce 44%
16/12/08 02:45:42 INFO mapreduce.Job:  map 100% reduce 54%
16/12/08 02:45:43 INFO mapreduce.Job:  map 100% reduce 69%
16/12/08 02:45:44 INFO mapreduce.Job:  map 100% reduce 71%
16/12/08 02:45:45 INFO mapreduce.Job:  map 100% reduce 74%
16/12/08 02:45:46 INFO mapreduce.Job:  map 100% reduce 79%
16/12/08 02:45:47 INFO mapreduce.Job:  map 100% reduce 83%
16/12/08 02:45:48 INFO mapreduce.Job:  map 100% reduce 87%
16/12/08 02:45:49 INFO mapreduce.Job:  map 100% reduce 93%
16/12/08 02:45:50 INFO mapreduce.Job:  map 100% reduce 97%
16/12/08 02:45:51 INFO mapreduce.Job:  map 100% reduce 100%
16/12/08 02:45:54 INFO mapreduce.Job: Job job_1480588584072_5549 completed successfully
16/12/08 02:45:54 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=1086506983
		FILE: Number of bytes written=2205395931
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=902159466
		WASB: Number of bytes written=599373173
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=14103494
		Total time spent by all reduces in occupied slots (ms)=4074446
		Total time spent by all map tasks (ms)=7051747
		Total time spent by all reduce tasks (ms)=2037223
		Total vcore-seconds taken by all map tasks=7051747
		Total vcore-seconds taken by all reduce tasks=2037223
		Total megabyte-seconds taken by all map tasks=7220988928
		Total megabyte-seconds taken by all reduce tasks=2086116352
	Map-Reduce Framework
		Map input records=2957180
		Map output records=2706328
		Map output bytes=1076272494
		Map output materialized bytes=1086530503
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2410358
		Reduce shuffle bytes=1086530503
		Reduce input records=2706328
		Reduce output records=1797871
		Spilled Records=5412656
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=74342
		CPU time spent (ms)=1048700
		Physical memory (bytes) snapshot=326110789632
		Virtual memory (bytes) snapshot=742846922752
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=899463462
	File Output Format Counters 
		Bytes Written=599373173
16/12/08 02:45:54 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/2100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071800 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/2200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071800
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/2200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7774733308422337187.jar tmpDir=null
16/12/08 03:42:04 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 03:42:05 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 03:42:05 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 03:42:07 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 03:42:07 INFO mapreduce.JobSubmitter: number of splits:229
16/12/08 03:42:07 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5554
16/12/08 03:42:08 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5554
16/12/08 03:42:08 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5554/
16/12/08 03:42:08 INFO mapreduce.Job: Running job: job_1480588584072_5554
16/12/08 03:42:20 INFO mapreduce.Job: Job job_1480588584072_5554 running in uber mode : false
16/12/08 03:42:20 INFO mapreduce.Job:  map 0% reduce 0%
16/12/08 03:42:34 INFO mapreduce.Job:  map 2% reduce 0%
16/12/08 03:42:41 INFO mapreduce.Job:  map 3% reduce 0%
16/12/08 03:42:42 INFO mapreduce.Job:  map 5% reduce 0%
16/12/08 03:42:43 INFO mapreduce.Job:  map 7% reduce 0%
16/12/08 03:42:44 INFO mapreduce.Job:  map 8% reduce 0%
16/12/08 03:42:46 INFO mapreduce.Job:  map 10% reduce 0%
16/12/08 03:42:47 INFO mapreduce.Job:  map 11% reduce 0%
16/12/08 03:42:49 INFO mapreduce.Job:  map 12% reduce 0%
16/12/08 03:42:50 INFO mapreduce.Job:  map 15% reduce 0%
16/12/08 03:42:52 INFO mapreduce.Job:  map 17% reduce 0%
16/12/08 03:42:53 INFO mapreduce.Job:  map 18% reduce 0%
16/12/08 03:42:54 INFO mapreduce.Job:  map 20% reduce 0%
16/12/08 03:42:55 INFO mapreduce.Job:  map 21% reduce 0%
16/12/08 03:43:00 INFO mapreduce.Job:  map 22% reduce 0%
16/12/08 03:43:01 INFO mapreduce.Job:  map 23% reduce 0%
16/12/08 03:43:02 INFO mapreduce.Job:  map 23% reduce 2%
16/12/08 03:43:03 INFO mapreduce.Job:  map 23% reduce 3%
16/12/08 03:43:05 INFO mapreduce.Job:  map 25% reduce 3%
16/12/08 03:43:06 INFO mapreduce.Job:  map 27% reduce 4%
16/12/08 03:43:07 INFO mapreduce.Job:  map 27% reduce 5%
16/12/08 03:43:08 INFO mapreduce.Job:  map 28% reduce 6%
16/12/08 03:43:09 INFO mapreduce.Job:  map 28% reduce 7%
16/12/08 03:43:11 INFO mapreduce.Job:  map 28% reduce 8%
16/12/08 03:43:12 INFO mapreduce.Job:  map 29% reduce 8%
16/12/08 03:43:14 INFO mapreduce.Job:  map 30% reduce 9%
16/12/08 03:43:16 INFO mapreduce.Job:  map 31% reduce 9%
16/12/08 03:43:17 INFO mapreduce.Job:  map 32% reduce 10%
16/12/08 03:43:18 INFO mapreduce.Job:  map 33% reduce 10%
16/12/08 03:43:19 INFO mapreduce.Job:  map 34% reduce 10%
16/12/08 03:43:21 INFO mapreduce.Job:  map 34% reduce 11%
16/12/08 03:43:23 INFO mapreduce.Job:  map 35% reduce 11%
16/12/08 03:43:24 INFO mapreduce.Job:  map 35% reduce 12%
16/12/08 03:43:25 INFO mapreduce.Job:  map 36% reduce 12%
16/12/08 03:43:26 INFO mapreduce.Job:  map 38% reduce 12%
16/12/08 03:43:27 INFO mapreduce.Job:  map 39% reduce 12%
16/12/08 03:43:29 INFO mapreduce.Job:  map 40% reduce 13%
16/12/08 03:43:31 INFO mapreduce.Job:  map 41% reduce 13%
16/12/08 03:43:32 INFO mapreduce.Job:  map 42% reduce 13%
16/12/08 03:43:33 INFO mapreduce.Job:  map 44% reduce 13%
16/12/08 03:43:34 INFO mapreduce.Job:  map 46% reduce 14%
16/12/08 03:43:35 INFO mapreduce.Job:  map 48% reduce 14%
16/12/08 03:43:36 INFO mapreduce.Job:  map 49% reduce 14%
16/12/08 03:43:37 INFO mapreduce.Job:  map 51% reduce 15%
16/12/08 03:43:38 INFO mapreduce.Job:  map 52% reduce 15%
16/12/08 03:43:39 INFO mapreduce.Job:  map 53% reduce 16%
16/12/08 03:43:40 INFO mapreduce.Job:  map 55% reduce 16%
16/12/08 03:43:41 INFO mapreduce.Job:  map 57% reduce 17%
16/12/08 03:43:42 INFO mapreduce.Job:  map 59% reduce 17%
16/12/08 03:43:43 INFO mapreduce.Job:  map 61% reduce 17%
16/12/08 03:43:44 INFO mapreduce.Job:  map 63% reduce 18%
16/12/08 03:43:45 INFO mapreduce.Job:  map 66% reduce 18%
16/12/08 03:43:46 INFO mapreduce.Job:  map 68% reduce 19%
16/12/08 03:43:47 INFO mapreduce.Job:  map 69% reduce 20%
16/12/08 03:43:48 INFO mapreduce.Job:  map 69% reduce 21%
16/12/08 03:43:49 INFO mapreduce.Job:  map 70% reduce 21%
16/12/08 03:43:50 INFO mapreduce.Job:  map 72% reduce 22%
16/12/08 03:43:51 INFO mapreduce.Job:  map 73% reduce 22%
16/12/08 03:43:53 INFO mapreduce.Job:  map 75% reduce 23%
16/12/08 03:43:54 INFO mapreduce.Job:  map 76% reduce 23%
16/12/08 03:43:55 INFO mapreduce.Job:  map 77% reduce 24%
16/12/08 03:43:56 INFO mapreduce.Job:  map 78% reduce 24%
16/12/08 03:43:57 INFO mapreduce.Job:  map 79% reduce 25%
16/12/08 03:44:00 INFO mapreduce.Job:  map 80% reduce 26%
16/12/08 03:44:01 INFO mapreduce.Job:  map 81% reduce 26%
16/12/08 03:44:03 INFO mapreduce.Job:  map 82% reduce 27%
16/12/08 03:44:10 INFO mapreduce.Job:  map 83% reduce 27%
16/12/08 03:44:14 INFO mapreduce.Job:  map 84% reduce 28%
16/12/08 03:44:17 INFO mapreduce.Job:  map 85% reduce 28%
16/12/08 03:44:18 INFO mapreduce.Job:  map 86% reduce 28%
16/12/08 03:44:19 INFO mapreduce.Job:  map 87% reduce 28%
16/12/08 03:44:20 INFO mapreduce.Job:  map 89% reduce 29%
16/12/08 03:44:21 INFO mapreduce.Job:  map 90% reduce 29%
16/12/08 03:44:22 INFO mapreduce.Job:  map 90% reduce 30%
16/12/08 03:44:23 INFO mapreduce.Job:  map 91% reduce 30%
16/12/08 03:44:25 INFO mapreduce.Job:  map 92% reduce 30%
16/12/08 03:44:27 INFO mapreduce.Job:  map 93% reduce 30%
16/12/08 03:44:28 INFO mapreduce.Job:  map 94% reduce 31%
16/12/08 03:44:29 INFO mapreduce.Job:  map 95% reduce 31%
16/12/08 03:44:31 INFO mapreduce.Job:  map 96% reduce 31%
16/12/08 03:44:32 INFO mapreduce.Job:  map 97% reduce 32%
16/12/08 03:44:33 INFO mapreduce.Job:  map 100% reduce 32%
16/12/08 03:44:34 INFO mapreduce.Job:  map 100% reduce 33%
16/12/08 03:44:37 INFO mapreduce.Job:  map 100% reduce 37%
16/12/08 03:44:38 INFO mapreduce.Job:  map 100% reduce 46%
16/12/08 03:44:39 INFO mapreduce.Job:  map 100% reduce 51%
16/12/08 03:44:40 INFO mapreduce.Job:  map 100% reduce 65%
16/12/08 03:44:41 INFO mapreduce.Job:  map 100% reduce 70%
16/12/08 03:44:42 INFO mapreduce.Job:  map 100% reduce 73%
16/12/08 03:44:43 INFO mapreduce.Job:  map 100% reduce 78%
16/12/08 03:44:44 INFO mapreduce.Job:  map 100% reduce 82%
16/12/08 03:44:45 INFO mapreduce.Job:  map 100% reduce 86%
16/12/08 03:44:46 INFO mapreduce.Job:  map 100% reduce 91%
16/12/08 03:44:47 INFO mapreduce.Job:  map 100% reduce 95%
16/12/08 03:44:48 INFO mapreduce.Job:  map 100% reduce 96%
16/12/08 03:44:49 INFO mapreduce.Job:  map 100% reduce 99%
16/12/08 03:44:50 INFO mapreduce.Job:  map 100% reduce 100%
16/12/08 03:44:53 INFO mapreduce.Job: Job job_1480588584072_5554 completed successfully
16/12/08 03:44:53 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=1029521689
		FILE: Number of bytes written=2096202463
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=851647119
		WASB: Number of bytes written=610215195
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=229
		Launched reduce tasks=20
		Rack-local map tasks=229
		Total time spent by all maps in occupied slots (ms)=15780366
		Total time spent by all reduces in occupied slots (ms)=4587018
		Total time spent by all map tasks (ms)=7890183
		Total time spent by all reduce tasks (ms)=2293509
		Total vcore-seconds taken by all map tasks=7890183
		Total vcore-seconds taken by all reduce tasks=2293509
		Total megabyte-seconds taken by all map tasks=8079547392
		Total megabyte-seconds taken by all reduce tasks=2348553216
	Map-Reduce Framework
		Map input records=2729743
		Map output records=2553412
		Map output bytes=1019879482
		Map output materialized bytes=1029549049
		Input split bytes=31932
		Combine input records=0
		Combine output records=0
		Reduce input groups=2307166
		Reduce shuffle bytes=1029549049
		Reduce input records=2553412
		Reduce output records=1817258
		Spilled Records=5106824
		Shuffled Maps =4580
		Failed Shuffles=0
		Merged Map outputs=4580
		GC time elapsed (ms)=80386
		CPU time spent (ms)=1134180
		Physical memory (bytes) snapshot=377072914432
		Virtual memory (bytes) snapshot=852201582592
		Total committed heap usage (bytes)=659265945600
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=847989979
	File Output Format Counters 
		Bytes Written=610215195
16/12/08 03:44:53 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/2200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071900 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/2300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161207/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071900
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/2300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3775941331038986896.jar tmpDir=null
16/12/08 04:46:04 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 04:46:05 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 04:46:05 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 04:46:07 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 04:46:08 INFO mapreduce.JobSubmitter: number of splits:197
16/12/08 04:46:08 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5557
16/12/08 04:46:09 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5557
16/12/08 04:46:09 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5557/
16/12/08 04:46:09 INFO mapreduce.Job: Running job: job_1480588584072_5557
16/12/08 04:46:22 INFO mapreduce.Job: Job job_1480588584072_5557 running in uber mode : false
16/12/08 04:46:22 INFO mapreduce.Job:  map 0% reduce 0%
16/12/08 04:46:44 INFO mapreduce.Job:  map 1% reduce 0%
16/12/08 04:46:45 INFO mapreduce.Job:  map 2% reduce 0%
16/12/08 04:46:46 INFO mapreduce.Job:  map 9% reduce 0%
16/12/08 04:46:48 INFO mapreduce.Job:  map 12% reduce 0%
16/12/08 04:46:50 INFO mapreduce.Job:  map 13% reduce 0%
16/12/08 04:46:52 INFO mapreduce.Job:  map 15% reduce 0%
16/12/08 04:46:53 INFO mapreduce.Job:  map 17% reduce 0%
16/12/08 04:46:57 INFO mapreduce.Job:  map 18% reduce 0%
16/12/08 04:47:00 INFO mapreduce.Job:  map 19% reduce 0%
16/12/08 04:47:01 INFO mapreduce.Job:  map 22% reduce 0%
16/12/08 04:47:03 INFO mapreduce.Job:  map 24% reduce 0%
16/12/08 04:47:05 INFO mapreduce.Job:  map 27% reduce 0%
16/12/08 04:47:06 INFO mapreduce.Job:  map 30% reduce 0%
16/12/08 04:47:08 INFO mapreduce.Job:  map 31% reduce 1%
16/12/08 04:47:09 INFO mapreduce.Job:  map 32% reduce 2%
16/12/08 04:47:10 INFO mapreduce.Job:  map 33% reduce 2%
16/12/08 04:47:12 INFO mapreduce.Job:  map 34% reduce 2%
16/12/08 04:47:13 INFO mapreduce.Job:  map 35% reduce 3%
16/12/08 04:47:15 INFO mapreduce.Job:  map 35% reduce 4%
16/12/08 04:47:16 INFO mapreduce.Job:  map 37% reduce 8%
16/12/08 04:47:19 INFO mapreduce.Job:  map 40% reduce 8%
16/12/08 04:47:20 INFO mapreduce.Job:  map 43% reduce 9%
16/12/08 04:47:21 INFO mapreduce.Job:  map 45% reduce 9%
16/12/08 04:47:22 INFO mapreduce.Job:  map 45% reduce 11%
16/12/08 04:47:23 INFO mapreduce.Job:  map 46% reduce 14%
16/12/08 04:47:27 INFO mapreduce.Job:  map 48% reduce 14%
16/12/08 04:47:29 INFO mapreduce.Job:  map 50% reduce 14%
16/12/08 04:47:30 INFO mapreduce.Job:  map 50% reduce 16%
16/12/08 04:47:33 INFO mapreduce.Job:  map 51% reduce 16%
16/12/08 04:47:35 INFO mapreduce.Job:  map 52% reduce 16%
16/12/08 04:47:36 INFO mapreduce.Job:  map 58% reduce 17%
16/12/08 04:47:37 INFO mapreduce.Job:  map 61% reduce 17%
16/12/08 04:47:40 INFO mapreduce.Job:  map 64% reduce 19%
16/12/08 04:47:43 INFO mapreduce.Job:  map 65% reduce 19%
16/12/08 04:47:44 INFO mapreduce.Job:  map 67% reduce 21%
16/12/08 04:47:45 INFO mapreduce.Job:  map 69% reduce 21%
16/12/08 04:47:47 INFO mapreduce.Job:  map 70% reduce 21%
16/12/08 04:47:48 INFO mapreduce.Job:  map 71% reduce 22%
16/12/08 04:47:49 INFO mapreduce.Job:  map 73% reduce 22%
16/12/08 04:47:50 INFO mapreduce.Job:  map 77% reduce 23%
16/12/08 04:47:51 INFO mapreduce.Job:  map 78% reduce 23%
16/12/08 04:47:52 INFO mapreduce.Job:  map 80% reduce 23%
16/12/08 04:47:54 INFO mapreduce.Job:  map 82% reduce 25%
16/12/08 04:47:55 INFO mapreduce.Job:  map 83% reduce 26%
16/12/08 04:47:57 INFO mapreduce.Job:  map 85% reduce 27%
16/12/08 04:47:58 INFO mapreduce.Job:  map 86% reduce 27%
16/12/08 04:47:59 INFO mapreduce.Job:  map 86% reduce 28%
16/12/08 04:48:00 INFO mapreduce.Job:  map 87% reduce 28%
16/12/08 04:48:01 INFO mapreduce.Job:  map 87% reduce 29%
16/12/08 04:48:02 INFO mapreduce.Job:  map 88% reduce 29%
16/12/08 04:48:03 INFO mapreduce.Job:  map 89% reduce 29%
16/12/08 04:48:05 INFO mapreduce.Job:  map 90% reduce 29%
16/12/08 04:48:06 INFO mapreduce.Job:  map 91% reduce 30%
16/12/08 04:48:07 INFO mapreduce.Job:  map 94% reduce 30%
16/12/08 04:48:08 INFO mapreduce.Job:  map 96% reduce 30%
16/12/08 04:48:09 INFO mapreduce.Job:  map 98% reduce 31%
16/12/08 04:48:10 INFO mapreduce.Job:  map 99% reduce 32%
16/12/08 04:48:11 INFO mapreduce.Job:  map 100% reduce 32%
16/12/08 04:48:12 INFO mapreduce.Job:  map 100% reduce 36%
16/12/08 04:48:13 INFO mapreduce.Job:  map 100% reduce 45%
16/12/08 04:48:14 INFO mapreduce.Job:  map 100% reduce 49%
16/12/08 04:48:15 INFO mapreduce.Job:  map 100% reduce 55%
16/12/08 04:48:16 INFO mapreduce.Job:  map 100% reduce 71%
16/12/08 04:48:17 INFO mapreduce.Job:  map 100% reduce 75%
16/12/08 04:48:18 INFO mapreduce.Job:  map 100% reduce 76%
16/12/08 04:48:19 INFO mapreduce.Job:  map 100% reduce 83%
16/12/08 04:48:20 INFO mapreduce.Job:  map 100% reduce 85%
16/12/08 04:48:21 INFO mapreduce.Job:  map 100% reduce 87%
16/12/08 04:48:23 INFO mapreduce.Job:  map 100% reduce 93%
16/12/08 04:48:24 INFO mapreduce.Job:  map 100% reduce 96%
16/12/08 04:48:25 INFO mapreduce.Job:  map 100% reduce 97%
16/12/08 04:48:26 INFO mapreduce.Job:  map 100% reduce 100%
16/12/08 04:48:29 INFO mapreduce.Job: Job job_1480588584072_5557 completed successfully
16/12/08 04:48:29 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=650304019
		FILE: Number of bytes written=1332990003
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=534136796
		WASB: Number of bytes written=354816146
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13285124
		Total time spent by all reduces in occupied slots (ms)=3370142
		Total time spent by all map tasks (ms)=6642562
		Total time spent by all reduce tasks (ms)=1685071
		Total vcore-seconds taken by all map tasks=6642562
		Total vcore-seconds taken by all reduce tasks=1685071
		Total megabyte-seconds taken by all map tasks=6801983488
		Total megabyte-seconds taken by all reduce tasks=1725512704
	Map-Reduce Framework
		Map input records=1780355
		Map output records=1651228
		Map output bytes=644144971
		Map output materialized bytes=650327539
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1487051
		Reduce shuffle bytes=650327539
		Reduce input records=1651228
		Reduce output records=1072034
		Spilled Records=3302456
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=70061
		CPU time spent (ms)=893380
		Physical memory (bytes) snapshot=323823063040
		Virtual memory (bytes) snapshot=742694846464
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=531440792
	File Output Format Counters 
		Bytes Written=354816146
16/12/08 04:48:29 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161207/2300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161207/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8301803983564750289.jar tmpDir=null
16/12/08 05:44:38 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 05:44:39 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 05:44:40 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 05:44:41 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 05:44:42 INFO mapreduce.JobSubmitter: number of splits:197
16/12/08 05:44:42 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5562
16/12/08 05:44:43 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5562
16/12/08 05:44:43 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5562/
16/12/08 05:44:43 INFO mapreduce.Job: Running job: job_1480588584072_5562
16/12/08 05:44:55 INFO mapreduce.Job: Job job_1480588584072_5562 running in uber mode : false
16/12/08 05:44:55 INFO mapreduce.Job:  map 0% reduce 0%
16/12/08 05:45:18 INFO mapreduce.Job:  map 2% reduce 0%
16/12/08 05:45:20 INFO mapreduce.Job:  map 3% reduce 0%
16/12/08 05:45:21 INFO mapreduce.Job:  map 4% reduce 0%
16/12/08 05:45:22 INFO mapreduce.Job:  map 5% reduce 0%
16/12/08 05:45:23 INFO mapreduce.Job:  map 11% reduce 0%
16/12/08 05:45:24 INFO mapreduce.Job:  map 12% reduce 0%
16/12/08 05:45:27 INFO mapreduce.Job:  map 14% reduce 0%
16/12/08 05:45:28 INFO mapreduce.Job:  map 16% reduce 0%
16/12/08 05:45:29 INFO mapreduce.Job:  map 17% reduce 0%
16/12/08 05:45:32 INFO mapreduce.Job:  map 20% reduce 0%
16/12/08 05:45:35 INFO mapreduce.Job:  map 21% reduce 0%
16/12/08 05:45:37 INFO mapreduce.Job:  map 23% reduce 0%
16/12/08 05:45:40 INFO mapreduce.Job:  map 29% reduce 0%
16/12/08 05:45:41 INFO mapreduce.Job:  map 30% reduce 0%
16/12/08 05:45:42 INFO mapreduce.Job:  map 31% reduce 0%
16/12/08 05:45:44 INFO mapreduce.Job:  map 31% reduce 2%
16/12/08 05:45:47 INFO mapreduce.Job:  map 32% reduce 6%
16/12/08 05:45:49 INFO mapreduce.Job:  map 33% reduce 6%
16/12/08 05:45:50 INFO mapreduce.Job:  map 34% reduce 6%
16/12/08 05:45:51 INFO mapreduce.Job:  map 35% reduce 7%
16/12/08 05:45:54 INFO mapreduce.Job:  map 37% reduce 8%
16/12/08 05:45:55 INFO mapreduce.Job:  map 42% reduce 8%
16/12/08 05:45:57 INFO mapreduce.Job:  map 47% reduce 8%
16/12/08 05:45:58 INFO mapreduce.Job:  map 47% reduce 10%
16/12/08 05:45:59 INFO mapreduce.Job:  map 49% reduce 13%
16/12/08 05:46:01 INFO mapreduce.Job:  map 50% reduce 13%
16/12/08 05:46:02 INFO mapreduce.Job:  map 50% reduce 14%
16/12/08 05:46:05 INFO mapreduce.Job:  map 51% reduce 14%
16/12/08 05:46:06 INFO mapreduce.Job:  map 54% reduce 15%
16/12/08 05:46:10 INFO mapreduce.Job:  map 58% reduce 15%
16/12/08 05:46:11 INFO mapreduce.Job:  map 61% reduce 16%
16/12/08 05:46:13 INFO mapreduce.Job:  map 63% reduce 16%
16/12/08 05:46:14 INFO mapreduce.Job:  map 68% reduce 18%
16/12/08 05:46:16 INFO mapreduce.Job:  map 69% reduce 18%
16/12/08 05:46:18 INFO mapreduce.Job:  map 72% reduce 20%
16/12/08 05:46:22 INFO mapreduce.Job:  map 74% reduce 23%
16/12/08 05:46:24 INFO mapreduce.Job:  map 78% reduce 23%
16/12/08 05:46:25 INFO mapreduce.Job:  map 80% reduce 25%
16/12/08 05:46:26 INFO mapreduce.Job:  map 81% reduce 26%
16/12/08 05:46:29 INFO mapreduce.Job:  map 81% reduce 27%
16/12/08 05:46:30 INFO mapreduce.Job:  map 82% reduce 27%
16/12/08 05:46:35 INFO mapreduce.Job:  map 83% reduce 27%
16/12/08 05:46:36 INFO mapreduce.Job:  map 84% reduce 27%
16/12/08 05:46:38 INFO mapreduce.Job:  map 86% reduce 28%
16/12/08 05:46:39 INFO mapreduce.Job:  map 89% reduce 28%
16/12/08 05:46:40 INFO mapreduce.Job:  map 90% reduce 28%
16/12/08 05:46:41 INFO mapreduce.Job:  map 91% reduce 29%
16/12/08 05:46:42 INFO mapreduce.Job:  map 92% reduce 30%
16/12/08 05:46:43 INFO mapreduce.Job:  map 94% reduce 30%
16/12/08 05:46:45 INFO mapreduce.Job:  map 95% reduce 31%
16/12/08 05:46:46 INFO mapreduce.Job:  map 96% reduce 31%
16/12/08 05:46:47 INFO mapreduce.Job:  map 98% reduce 31%
16/12/08 05:46:48 INFO mapreduce.Job:  map 100% reduce 32%
16/12/08 05:46:50 INFO mapreduce.Job:  map 100% reduce 39%
16/12/08 05:46:51 INFO mapreduce.Job:  map 100% reduce 62%
16/12/08 05:46:52 INFO mapreduce.Job:  map 100% reduce 65%
16/12/08 05:46:53 INFO mapreduce.Job:  map 100% reduce 70%
16/12/08 05:46:54 INFO mapreduce.Job:  map 100% reduce 86%
16/12/08 05:46:55 INFO mapreduce.Job:  map 100% reduce 87%
16/12/08 05:46:57 INFO mapreduce.Job:  map 100% reduce 89%
16/12/08 05:46:58 INFO mapreduce.Job:  map 100% reduce 94%
16/12/08 05:47:00 INFO mapreduce.Job:  map 100% reduce 99%
16/12/08 05:47:01 INFO mapreduce.Job:  map 100% reduce 100%
16/12/08 05:47:03 INFO mapreduce.Job: Job job_1480588584072_5562 completed successfully
16/12/08 05:47:03 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=408277860
		FILE: Number of bytes written=848937685
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=330631869
		WASB: Number of bytes written=208992914
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13445682
		Total time spent by all reduces in occupied slots (ms)=3294754
		Total time spent by all map tasks (ms)=6722841
		Total time spent by all reduce tasks (ms)=1647377
		Total vcore-seconds taken by all map tasks=6722841
		Total vcore-seconds taken by all reduce tasks=1647377
		Total megabyte-seconds taken by all map tasks=6884189184
		Total megabyte-seconds taken by all reduce tasks=1686914048
	Map-Reduce Framework
		Map input records=1155378
		Map output records=1081883
		Map output bytes=404346381
		Map output materialized bytes=408301380
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=985202
		Reduce shuffle bytes=408301380
		Reduce input records=1081883
		Reduce output records=654318
		Spilled Records=2163766
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=77583
		CPU time spent (ms)=819040
		Physical memory (bytes) snapshot=323092865024
		Virtual memory (bytes) snapshot=742832971776
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=327935865
	File Output Format Counters 
		Bytes Written=208992914
16/12/08 05:47:03 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4601343093356326798.jar tmpDir=null
16/12/08 06:43:12 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 06:43:13 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 06:43:13 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 06:43:15 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 06:43:15 INFO mapreduce.JobSubmitter: number of splits:197
16/12/08 06:43:16 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5596
16/12/08 06:43:16 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5596
16/12/08 06:43:16 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5596/
16/12/08 06:43:16 INFO mapreduce.Job: Running job: job_1480588584072_5596
16/12/08 06:44:22 INFO mapreduce.Job: Job job_1480588584072_5596 running in uber mode : false
16/12/08 06:44:22 INFO mapreduce.Job:  map 0% reduce 0%
16/12/08 06:44:44 INFO mapreduce.Job:  map 2% reduce 0%
16/12/08 06:44:46 INFO mapreduce.Job:  map 3% reduce 0%
16/12/08 06:44:48 INFO mapreduce.Job:  map 4% reduce 0%
16/12/08 06:44:52 INFO mapreduce.Job:  map 13% reduce 0%
16/12/08 06:44:57 INFO mapreduce.Job:  map 17% reduce 0%
16/12/08 06:44:59 INFO mapreduce.Job:  map 19% reduce 0%
16/12/08 06:45:02 INFO mapreduce.Job:  map 20% reduce 0%
16/12/08 06:45:03 INFO mapreduce.Job:  map 21% reduce 0%
16/12/08 06:45:04 INFO mapreduce.Job:  map 23% reduce 0%
16/12/08 06:45:06 INFO mapreduce.Job:  map 24% reduce 0%
16/12/08 06:45:07 INFO mapreduce.Job:  map 25% reduce 0%
16/12/08 06:45:08 INFO mapreduce.Job:  map 28% reduce 0%
16/12/08 06:45:10 INFO mapreduce.Job:  map 34% reduce 0%
16/12/08 06:45:11 INFO mapreduce.Job:  map 38% reduce 0%
16/12/08 06:45:12 INFO mapreduce.Job:  map 40% reduce 1%
16/12/08 06:45:13 INFO mapreduce.Job:  map 40% reduce 2%
16/12/08 06:45:14 INFO mapreduce.Job:  map 40% reduce 3%
16/12/08 06:45:15 INFO mapreduce.Job:  map 40% reduce 5%
16/12/08 06:45:17 INFO mapreduce.Job:  map 40% reduce 9%
16/12/08 06:45:19 INFO mapreduce.Job:  map 42% reduce 9%
16/12/08 06:45:21 INFO mapreduce.Job:  map 43% reduce 10%
16/12/08 06:45:25 INFO mapreduce.Job:  map 47% reduce 10%
16/12/08 06:45:26 INFO mapreduce.Job:  map 50% reduce 10%
16/12/08 06:45:27 INFO mapreduce.Job:  map 51% reduce 11%
16/12/08 06:45:29 INFO mapreduce.Job:  map 51% reduce 13%
16/12/08 06:45:31 INFO mapreduce.Job:  map 53% reduce 13%
16/12/08 06:45:33 INFO mapreduce.Job:  map 55% reduce 13%
16/12/08 06:45:35 INFO mapreduce.Job:  map 58% reduce 13%
16/12/08 06:45:36 INFO mapreduce.Job:  map 59% reduce 13%
16/12/08 06:45:37 INFO mapreduce.Job:  map 60% reduce 14%
16/12/08 06:45:40 INFO mapreduce.Job:  map 65% reduce 16%
16/12/08 06:45:41 INFO mapreduce.Job:  map 68% reduce 16%
16/12/08 06:45:42 INFO mapreduce.Job:  map 68% reduce 17%
16/12/08 06:45:43 INFO mapreduce.Job:  map 70% reduce 20%
16/12/08 06:45:45 INFO mapreduce.Job:  map 73% reduce 20%
16/12/08 06:45:46 INFO mapreduce.Job:  map 76% reduce 23%
16/12/08 06:45:47 INFO mapreduce.Job:  map 78% reduce 24%
16/12/08 06:45:48 INFO mapreduce.Job:  map 80% reduce 24%
16/12/08 06:45:49 INFO mapreduce.Job:  map 82% reduce 26%
16/12/08 06:45:50 INFO mapreduce.Job:  map 84% reduce 26%
16/12/08 06:45:51 INFO mapreduce.Job:  map 87% reduce 26%
16/12/08 06:45:52 INFO mapreduce.Job:  map 89% reduce 28%
16/12/08 06:45:53 INFO mapreduce.Job:  map 91% reduce 29%
16/12/08 06:45:55 INFO mapreduce.Job:  map 92% reduce 30%
16/12/08 06:45:58 INFO mapreduce.Job:  map 92% reduce 31%
16/12/08 06:45:59 INFO mapreduce.Job:  map 93% reduce 31%
16/12/08 06:46:08 INFO mapreduce.Job:  map 94% reduce 31%
16/12/08 06:46:10 INFO mapreduce.Job:  map 96% reduce 32%
16/12/08 06:46:11 INFO mapreduce.Job:  map 97% reduce 32%
16/12/08 06:46:12 INFO mapreduce.Job:  map 98% reduce 32%
16/12/08 06:46:13 INFO mapreduce.Job:  map 99% reduce 33%
16/12/08 06:46:15 INFO mapreduce.Job:  map 100% reduce 33%
16/12/08 06:46:16 INFO mapreduce.Job:  map 100% reduce 34%
16/12/08 06:46:17 INFO mapreduce.Job:  map 100% reduce 41%
16/12/08 06:46:18 INFO mapreduce.Job:  map 100% reduce 43%
16/12/08 06:46:19 INFO mapreduce.Job:  map 100% reduce 51%
16/12/08 06:46:20 INFO mapreduce.Job:  map 100% reduce 79%
16/12/08 06:46:21 INFO mapreduce.Job:  map 100% reduce 85%
16/12/08 06:46:22 INFO mapreduce.Job:  map 100% reduce 97%
16/12/08 06:46:23 INFO mapreduce.Job:  map 100% reduce 99%
16/12/08 06:46:24 INFO mapreduce.Job:  map 100% reduce 100%
16/12/08 06:46:27 INFO mapreduce.Job: Job job_1480588584072_5596 completed successfully
16/12/08 06:46:27 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=287657724
		FILE: Number of bytes written=607697413
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=231230117
		WASB: Number of bytes written=135980043
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12009656
		Total time spent by all reduces in occupied slots (ms)=3143656
		Total time spent by all map tasks (ms)=6004828
		Total time spent by all reduce tasks (ms)=1571828
		Total vcore-seconds taken by all map tasks=6004828
		Total vcore-seconds taken by all reduce tasks=1571828
		Total megabyte-seconds taken by all map tasks=6148943872
		Total megabyte-seconds taken by all reduce tasks=1609551872
	Map-Reduce Framework
		Map input records=849610
		Map output records=796358
		Map output bytes=284838788
		Map output materialized bytes=287681244
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=736253
		Reduce shuffle bytes=287681244
		Reduce input records=796358
		Reduce output records=440854
		Spilled Records=1592716
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=69016
		CPU time spent (ms)=772870
		Physical memory (bytes) snapshot=322818859008
		Virtual memory (bytes) snapshot=742757142528
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=228534113
	File Output Format Counters 
		Bytes Written=135980043
16/12/08 06:46:27 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8188865859872883237.jar tmpDir=null
16/12/08 07:42:36 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 07:42:37 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 07:42:38 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 07:42:39 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 07:42:40 INFO mapreduce.JobSubmitter: number of splits:197
16/12/08 07:42:40 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5638
16/12/08 07:42:41 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5638
16/12/08 07:42:41 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5638/
16/12/08 07:42:41 INFO mapreduce.Job: Running job: job_1480588584072_5638
16/12/08 07:42:54 INFO mapreduce.Job: Job job_1480588584072_5638 running in uber mode : false
16/12/08 07:42:54 INFO mapreduce.Job:  map 0% reduce 0%
16/12/08 07:43:07 INFO mapreduce.Job:  map 1% reduce 0%
16/12/08 07:43:08 INFO mapreduce.Job:  map 2% reduce 0%
16/12/08 07:43:09 INFO mapreduce.Job:  map 3% reduce 0%
16/12/08 07:43:10 INFO mapreduce.Job:  map 4% reduce 0%
16/12/08 07:43:14 INFO mapreduce.Job:  map 6% reduce 0%
16/12/08 07:43:15 INFO mapreduce.Job:  map 8% reduce 0%
16/12/08 07:43:16 INFO mapreduce.Job:  map 12% reduce 0%
16/12/08 07:43:17 INFO mapreduce.Job:  map 14% reduce 0%
16/12/08 07:43:18 INFO mapreduce.Job:  map 15% reduce 0%
16/12/08 07:43:21 INFO mapreduce.Job:  map 16% reduce 0%
16/12/08 07:43:22 INFO mapreduce.Job:  map 17% reduce 0%
16/12/08 07:43:23 INFO mapreduce.Job:  map 18% reduce 0%
16/12/08 07:43:24 INFO mapreduce.Job:  map 19% reduce 0%
16/12/08 07:43:27 INFO mapreduce.Job:  map 21% reduce 0%
16/12/08 07:43:28 INFO mapreduce.Job:  map 23% reduce 0%
16/12/08 07:43:29 INFO mapreduce.Job:  map 24% reduce 0%
16/12/08 07:43:30 INFO mapreduce.Job:  map 26% reduce 0%
16/12/08 07:43:32 INFO mapreduce.Job:  map 27% reduce 0%
16/12/08 07:43:33 INFO mapreduce.Job:  map 27% reduce 2%
16/12/08 07:43:34 INFO mapreduce.Job:  map 27% reduce 4%
16/12/08 07:43:35 INFO mapreduce.Job:  map 28% reduce 4%
16/12/08 07:43:37 INFO mapreduce.Job:  map 28% reduce 5%
16/12/08 07:43:38 INFO mapreduce.Job:  map 30% reduce 6%
16/12/08 07:43:39 INFO mapreduce.Job:  map 31% reduce 7%
16/12/08 07:43:40 INFO mapreduce.Job:  map 31% reduce 8%
16/12/08 07:43:41 INFO mapreduce.Job:  map 32% reduce 9%
16/12/08 07:43:42 INFO mapreduce.Job:  map 33% reduce 10%
16/12/08 07:43:43 INFO mapreduce.Job:  map 34% reduce 11%
16/12/08 07:43:45 INFO mapreduce.Job:  map 35% reduce 11%
16/12/08 07:43:46 INFO mapreduce.Job:  map 37% reduce 11%
16/12/08 07:43:47 INFO mapreduce.Job:  map 37% reduce 12%
16/12/08 07:43:49 INFO mapreduce.Job:  map 38% reduce 12%
16/12/08 07:43:50 INFO mapreduce.Job:  map 39% reduce 12%
16/12/08 07:43:51 INFO mapreduce.Job:  map 39% reduce 13%
16/12/08 07:43:52 INFO mapreduce.Job:  map 40% reduce 13%
16/12/08 07:43:53 INFO mapreduce.Job:  map 41% reduce 13%
16/12/08 07:43:55 INFO mapreduce.Job:  map 43% reduce 13%
16/12/08 07:43:56 INFO mapreduce.Job:  map 44% reduce 14%
16/12/08 07:43:58 INFO mapreduce.Job:  map 45% reduce 14%
16/12/08 07:43:59 INFO mapreduce.Job:  map 46% reduce 15%
16/12/08 07:44:00 INFO mapreduce.Job:  map 47% reduce 15%
16/12/08 07:44:01 INFO mapreduce.Job:  map 48% reduce 15%
16/12/08 07:44:02 INFO mapreduce.Job:  map 49% reduce 15%
16/12/08 07:44:03 INFO mapreduce.Job:  map 51% reduce 16%
16/12/08 07:44:05 INFO mapreduce.Job:  map 53% reduce 17%
16/12/08 07:44:06 INFO mapreduce.Job:  map 55% reduce 17%
16/12/08 07:44:07 INFO mapreduce.Job:  map 57% reduce 17%
16/12/08 07:44:08 INFO mapreduce.Job:  map 57% reduce 18%
16/12/08 07:44:09 INFO mapreduce.Job:  map 60% reduce 18%
16/12/08 07:44:10 INFO mapreduce.Job:  map 63% reduce 19%
16/12/08 07:44:11 INFO mapreduce.Job:  map 65% reduce 19%
16/12/08 07:44:12 INFO mapreduce.Job:  map 67% reduce 19%
16/12/08 07:44:13 INFO mapreduce.Job:  map 70% reduce 20%
16/12/08 07:44:14 INFO mapreduce.Job:  map 73% reduce 21%
16/12/08 07:44:15 INFO mapreduce.Job:  map 74% reduce 22%
16/12/08 07:44:16 INFO mapreduce.Job:  map 78% reduce 23%
16/12/08 07:44:17 INFO mapreduce.Job:  map 80% reduce 24%
16/12/08 07:44:18 INFO mapreduce.Job:  map 82% reduce 24%
16/12/08 07:44:19 INFO mapreduce.Job:  map 84% reduce 26%
16/12/08 07:44:20 INFO mapreduce.Job:  map 85% reduce 27%
16/12/08 07:44:21 INFO mapreduce.Job:  map 86% reduce 27%
16/12/08 07:44:22 INFO mapreduce.Job:  map 87% reduce 28%
16/12/08 07:44:23 INFO mapreduce.Job:  map 88% reduce 28%
16/12/08 07:44:25 INFO mapreduce.Job:  map 89% reduce 29%
16/12/08 07:44:28 INFO mapreduce.Job:  map 89% reduce 30%
16/12/08 07:44:30 INFO mapreduce.Job:  map 90% reduce 30%
16/12/08 07:44:31 INFO mapreduce.Job:  map 92% reduce 30%
16/12/08 07:44:34 INFO mapreduce.Job:  map 93% reduce 31%
16/12/08 07:44:35 INFO mapreduce.Job:  map 94% reduce 31%
16/12/08 07:44:37 INFO mapreduce.Job:  map 96% reduce 31%
16/12/08 07:44:38 INFO mapreduce.Job:  map 96% reduce 32%
16/12/08 07:44:39 INFO mapreduce.Job:  map 97% reduce 32%
16/12/08 07:44:40 INFO mapreduce.Job:  map 99% reduce 32%
16/12/08 07:44:41 INFO mapreduce.Job:  map 100% reduce 33%
16/12/08 07:44:42 INFO mapreduce.Job:  map 100% reduce 37%
16/12/08 07:44:43 INFO mapreduce.Job:  map 100% reduce 61%
16/12/08 07:44:45 INFO mapreduce.Job:  map 100% reduce 75%
16/12/08 07:44:46 INFO mapreduce.Job:  map 100% reduce 88%
16/12/08 07:44:47 INFO mapreduce.Job:  map 100% reduce 94%
16/12/08 07:44:48 INFO mapreduce.Job:  map 100% reduce 98%
16/12/08 07:44:49 INFO mapreduce.Job:  map 100% reduce 100%
16/12/08 07:44:52 INFO mapreduce.Job: Job job_1480588584072_5638 completed successfully
16/12/08 07:44:52 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=240977567
		FILE: Number of bytes written=514337099
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=194737992
		WASB: Number of bytes written=97915051
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12479258
		Total time spent by all reduces in occupied slots (ms)=3324726
		Total time spent by all map tasks (ms)=6239629
		Total time spent by all reduce tasks (ms)=1662363
		Total vcore-seconds taken by all map tasks=6239629
		Total vcore-seconds taken by all reduce tasks=1662363
		Total megabyte-seconds taken by all map tasks=6389380096
		Total megabyte-seconds taken by all reduce tasks=1702259712
	Map-Reduce Framework
		Map input records=742443
		Map output records=687311
		Map output bytes=238578646
		Map output materialized bytes=241001087
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=635398
		Reduce shuffle bytes=241001087
		Reduce input records=687311
		Reduce output records=328501
		Spilled Records=1374622
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=59735
		CPU time spent (ms)=760200
		Physical memory (bytes) snapshot=322923692032
		Virtual memory (bytes) snapshot=743154802688
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=192041988
	File Output Format Counters 
		Bytes Written=97915051
16/12/08 07:44:52 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612071900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob463419475051441639.jar tmpDir=null
16/12/08 08:46:06 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 08:46:07 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 08:46:08 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 08:46:10 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 08:46:10 INFO mapreduce.JobSubmitter: number of splits:197
16/12/08 08:46:10 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5648
16/12/08 08:46:11 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5648
16/12/08 08:46:11 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5648/
16/12/08 08:46:11 INFO mapreduce.Job: Running job: job_1480588584072_5648
16/12/08 08:46:24 INFO mapreduce.Job: Job job_1480588584072_5648 running in uber mode : false
16/12/08 08:46:24 INFO mapreduce.Job:  map 0% reduce 0%
16/12/08 08:46:44 INFO mapreduce.Job:  map 1% reduce 0%
16/12/08 08:46:47 INFO mapreduce.Job:  map 3% reduce 0%
16/12/08 08:46:48 INFO mapreduce.Job:  map 5% reduce 0%
16/12/08 08:46:52 INFO mapreduce.Job:  map 12% reduce 0%
16/12/08 08:46:55 INFO mapreduce.Job:  map 16% reduce 0%
16/12/08 08:46:57 INFO mapreduce.Job:  map 17% reduce 0%
16/12/08 08:46:59 INFO mapreduce.Job:  map 18% reduce 0%
16/12/08 08:47:01 INFO mapreduce.Job:  map 21% reduce 0%
16/12/08 08:47:05 INFO mapreduce.Job:  map 22% reduce 0%
16/12/08 08:47:06 INFO mapreduce.Job:  map 23% reduce 0%
16/12/08 08:47:08 INFO mapreduce.Job:  map 24% reduce 0%
16/12/08 08:47:09 INFO mapreduce.Job:  map 25% reduce 0%
16/12/08 08:47:11 INFO mapreduce.Job:  map 26% reduce 0%
16/12/08 08:47:12 INFO mapreduce.Job:  map 33% reduce 0%
16/12/08 08:47:14 INFO mapreduce.Job:  map 36% reduce 0%
16/12/08 08:47:16 INFO mapreduce.Job:  map 40% reduce 1%
16/12/08 08:47:17 INFO mapreduce.Job:  map 43% reduce 2%
16/12/08 08:47:20 INFO mapreduce.Job:  map 45% reduce 5%
16/12/08 08:47:23 INFO mapreduce.Job:  map 45% reduce 6%
16/12/08 08:47:24 INFO mapreduce.Job:  map 45% reduce 8%
16/12/08 08:47:27 INFO mapreduce.Job:  map 47% reduce 8%
16/12/08 08:47:33 INFO mapreduce.Job:  map 54% reduce 9%
16/12/08 08:47:34 INFO mapreduce.Job:  map 56% reduce 9%
16/12/08 08:47:36 INFO mapreduce.Job:  map 57% reduce 11%
16/12/08 08:47:38 INFO mapreduce.Job:  map 59% reduce 12%
16/12/08 08:47:41 INFO mapreduce.Job:  map 61% reduce 13%
16/12/08 08:47:42 INFO mapreduce.Job:  map 62% reduce 13%
16/12/08 08:47:43 INFO mapreduce.Job:  map 63% reduce 13%
16/12/08 08:47:45 INFO mapreduce.Job:  map 65% reduce 14%
16/12/08 08:47:46 INFO mapreduce.Job:  map 71% reduce 14%
16/12/08 08:47:47 INFO mapreduce.Job:  map 73% reduce 17%
16/12/08 08:47:48 INFO mapreduce.Job:  map 75% reduce 17%
16/12/08 08:47:49 INFO mapreduce.Job:  map 78% reduce 17%
16/12/08 08:47:50 INFO mapreduce.Job:  map 79% reduce 19%
16/12/08 08:47:51 INFO mapreduce.Job:  map 80% reduce 24%
16/12/08 08:47:52 INFO mapreduce.Job:  map 82% reduce 24%
16/12/08 08:47:53 INFO mapreduce.Job:  map 86% reduce 25%
16/12/08 08:47:54 INFO mapreduce.Job:  map 87% reduce 26%
16/12/08 08:47:56 INFO mapreduce.Job:  map 89% reduce 29%
16/12/08 08:47:58 INFO mapreduce.Job:  map 92% reduce 29%
16/12/08 08:47:59 INFO mapreduce.Job:  map 93% reduce 30%
16/12/08 08:48:01 INFO mapreduce.Job:  map 93% reduce 31%
16/12/08 08:48:08 INFO mapreduce.Job:  map 94% reduce 31%
16/12/08 08:48:09 INFO mapreduce.Job:  map 95% reduce 31%
16/12/08 08:48:10 INFO mapreduce.Job:  map 96% reduce 31%
16/12/08 08:48:11 INFO mapreduce.Job:  map 97% reduce 32%
16/12/08 08:48:12 INFO mapreduce.Job:  map 99% reduce 32%
16/12/08 08:48:13 INFO mapreduce.Job:  map 100% reduce 32%
16/12/08 08:48:14 INFO mapreduce.Job:  map 100% reduce 36%
16/12/08 08:48:15 INFO mapreduce.Job:  map 100% reduce 39%
16/12/08 08:48:16 INFO mapreduce.Job:  map 100% reduce 45%
16/12/08 08:48:17 INFO mapreduce.Job:  map 100% reduce 63%
16/12/08 08:48:18 INFO mapreduce.Job:  map 100% reduce 77%
16/12/08 08:48:19 INFO mapreduce.Job:  map 100% reduce 89%
16/12/08 08:48:22 INFO mapreduce.Job:  map 100% reduce 93%
16/12/08 08:48:23 INFO mapreduce.Job:  map 100% reduce 97%
16/12/08 08:48:24 INFO mapreduce.Job:  map 100% reduce 98%
16/12/08 08:48:27 INFO mapreduce.Job:  map 100% reduce 100%
16/12/08 08:48:34 INFO mapreduce.Job: Job job_1480588584072_5648 completed successfully
16/12/08 08:48:34 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=250330709
		FILE: Number of bytes written=533043383
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=205326587
		WASB: Number of bytes written=92783973
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12875656
		Total time spent by all reduces in occupied slots (ms)=3007412
		Total time spent by all map tasks (ms)=6437828
		Total time spent by all reduce tasks (ms)=1503706
		Total vcore-seconds taken by all map tasks=6437828
		Total vcore-seconds taken by all reduce tasks=1503706
		Total megabyte-seconds taken by all map tasks=6592335872
		Total megabyte-seconds taken by all reduce tasks=1539794944
	Map-Reduce Framework
		Map input records=789832
		Map output records=714217
		Map output bytes=247833566
		Map output materialized bytes=250354229
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=655730
		Reduce shuffle bytes=250354229
		Reduce input records=714217
		Reduce output records=316703
		Spilled Records=1428434
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=67356
		CPU time spent (ms)=758600
		Physical memory (bytes) snapshot=322488139776
		Virtual memory (bytes) snapshot=742907514880
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=202630583
	File Output Format Counters 
		Bytes Written=92783973
16/12/08 08:48:34 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06.done
16/12/08 08:48:49 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0400 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0400': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob6029420257155230051.jar tmpDir=null
16/12/08 09:44:45 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 09:44:46 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 09:44:46 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 09:44:48 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 09:44:48 INFO mapreduce.JobSubmitter: number of splits:197
16/12/08 09:44:49 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5660
16/12/08 09:44:49 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5660
16/12/08 09:44:49 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5660/
16/12/08 09:44:49 INFO mapreduce.Job: Running job: job_1480588584072_5660
16/12/08 09:45:03 INFO mapreduce.Job: Job job_1480588584072_5660 running in uber mode : false
16/12/08 09:45:03 INFO mapreduce.Job:  map 0% reduce 0%
16/12/08 09:45:17 INFO mapreduce.Job:  map 1% reduce 0%
16/12/08 09:45:18 INFO mapreduce.Job:  map 3% reduce 0%
16/12/08 09:45:19 INFO mapreduce.Job:  map 4% reduce 0%
16/12/08 09:45:24 INFO mapreduce.Job:  map 6% reduce 0%
16/12/08 09:45:25 INFO mapreduce.Job:  map 8% reduce 0%
16/12/08 09:45:26 INFO mapreduce.Job:  map 15% reduce 0%
16/12/08 09:45:29 INFO mapreduce.Job:  map 16% reduce 0%
16/12/08 09:45:32 INFO mapreduce.Job:  map 19% reduce 0%
16/12/08 09:45:37 INFO mapreduce.Job:  map 20% reduce 0%
16/12/08 09:45:38 INFO mapreduce.Job:  map 23% reduce 0%
16/12/08 09:45:39 INFO mapreduce.Job:  map 24% reduce 0%
16/12/08 09:45:40 INFO mapreduce.Job:  map 25% reduce 0%
16/12/08 09:45:42 INFO mapreduce.Job:  map 25% reduce 3%
16/12/08 09:45:43 INFO mapreduce.Job:  map 25% reduce 4%
16/12/08 09:45:44 INFO mapreduce.Job:  map 27% reduce 5%
16/12/08 09:45:45 INFO mapreduce.Job:  map 28% reduce 5%
16/12/08 09:45:47 INFO mapreduce.Job:  map 28% reduce 6%
16/12/08 09:45:48 INFO mapreduce.Job:  map 29% reduce 7%
16/12/08 09:45:49 INFO mapreduce.Job:  map 30% reduce 7%
16/12/08 09:45:50 INFO mapreduce.Job:  map 30% reduce 8%
16/12/08 09:45:51 INFO mapreduce.Job:  map 32% reduce 9%
16/12/08 09:45:52 INFO mapreduce.Job:  map 33% reduce 10%
16/12/08 09:45:54 INFO mapreduce.Job:  map 34% reduce 11%
16/12/08 09:45:57 INFO mapreduce.Job:  map 36% reduce 11%
16/12/08 09:45:58 INFO mapreduce.Job:  map 37% reduce 11%
16/12/08 09:45:59 INFO mapreduce.Job:  map 38% reduce 12%
16/12/08 09:46:00 INFO mapreduce.Job:  map 39% reduce 12%
16/12/08 09:46:02 INFO mapreduce.Job:  map 39% reduce 13%
16/12/08 09:46:03 INFO mapreduce.Job:  map 40% reduce 13%
16/12/08 09:46:05 INFO mapreduce.Job:  map 42% reduce 13%
16/12/08 09:46:06 INFO mapreduce.Job:  map 44% reduce 14%
16/12/08 09:46:07 INFO mapreduce.Job:  map 45% reduce 14%
16/12/08 09:46:09 INFO mapreduce.Job:  map 46% reduce 15%
16/12/08 09:46:11 INFO mapreduce.Job:  map 47% reduce 15%
16/12/08 09:46:12 INFO mapreduce.Job:  map 48% reduce 15%
16/12/08 09:46:13 INFO mapreduce.Job:  map 51% reduce 15%
16/12/08 09:46:14 INFO mapreduce.Job:  map 53% reduce 16%
16/12/08 09:46:15 INFO mapreduce.Job:  map 55% reduce 17%
16/12/08 09:46:16 INFO mapreduce.Job:  map 56% reduce 17%
16/12/08 09:46:18 INFO mapreduce.Job:  map 58% reduce 18%
16/12/08 09:46:19 INFO mapreduce.Job:  map 61% reduce 18%
16/12/08 09:46:20 INFO mapreduce.Job:  map 63% reduce 19%
16/12/08 09:46:21 INFO mapreduce.Job:  map 65% reduce 20%
16/12/08 09:46:22 INFO mapreduce.Job:  map 68% reduce 20%
16/12/08 09:46:23 INFO mapreduce.Job:  map 70% reduce 21%
16/12/08 09:46:24 INFO mapreduce.Job:  map 73% reduce 21%
16/12/08 09:46:25 INFO mapreduce.Job:  map 73% reduce 22%
16/12/08 09:46:26 INFO mapreduce.Job:  map 77% reduce 23%
16/12/08 09:46:27 INFO mapreduce.Job:  map 80% reduce 23%
16/12/08 09:46:28 INFO mapreduce.Job:  map 81% reduce 24%
16/12/08 09:46:29 INFO mapreduce.Job:  map 83% reduce 25%
16/12/08 09:46:30 INFO mapreduce.Job:  map 84% reduce 26%
16/12/08 09:46:31 INFO mapreduce.Job:  map 85% reduce 26%
16/12/08 09:46:32 INFO mapreduce.Job:  map 86% reduce 27%
16/12/08 09:46:33 INFO mapreduce.Job:  map 87% reduce 27%
16/12/08 09:46:34 INFO mapreduce.Job:  map 87% reduce 28%
16/12/08 09:46:35 INFO mapreduce.Job:  map 88% reduce 28%
16/12/08 09:46:36 INFO mapreduce.Job:  map 88% reduce 29%
16/12/08 09:46:39 INFO mapreduce.Job:  map 89% reduce 29%
16/12/08 09:46:40 INFO mapreduce.Job:  map 91% reduce 30%
16/12/08 09:46:41 INFO mapreduce.Job:  map 92% reduce 30%
16/12/08 09:46:44 INFO mapreduce.Job:  map 92% reduce 31%
16/12/08 09:46:47 INFO mapreduce.Job:  map 93% reduce 31%
16/12/08 09:46:48 INFO mapreduce.Job:  map 94% reduce 31%
16/12/08 09:46:49 INFO mapreduce.Job:  map 95% reduce 31%
16/12/08 09:46:50 INFO mapreduce.Job:  map 96% reduce 31%
16/12/08 09:46:51 INFO mapreduce.Job:  map 97% reduce 32%
16/12/08 09:46:52 INFO mapreduce.Job:  map 99% reduce 32%
16/12/08 09:46:53 INFO mapreduce.Job:  map 100% reduce 33%
16/12/08 09:46:54 INFO mapreduce.Job:  map 100% reduce 36%
16/12/08 09:46:55 INFO mapreduce.Job:  map 100% reduce 48%
16/12/08 09:46:56 INFO mapreduce.Job:  map 100% reduce 58%
16/12/08 09:46:57 INFO mapreduce.Job:  map 100% reduce 74%
16/12/08 09:46:58 INFO mapreduce.Job:  map 100% reduce 85%
16/12/08 09:46:59 INFO mapreduce.Job:  map 100% reduce 96%
16/12/08 09:47:00 INFO mapreduce.Job:  map 100% reduce 100%
16/12/08 09:47:02 INFO mapreduce.Job: Job job_1480588584072_5660 completed successfully
16/12/08 09:47:02 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=317443330
		FILE: Number of bytes written=667268625
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=263744947
		WASB: Number of bytes written=125612184
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12747024
		Total time spent by all reduces in occupied slots (ms)=3462476
		Total time spent by all map tasks (ms)=6373512
		Total time spent by all reduce tasks (ms)=1731238
		Total vcore-seconds taken by all map tasks=6373512
		Total vcore-seconds taken by all reduce tasks=1731238
		Total megabyte-seconds taken by all map tasks=6526476288
		Total megabyte-seconds taken by all reduce tasks=1772787712
	Map-Reduce Framework
		Map input records=984472
		Map output records=876118
		Map output bytes=314314307
		Map output materialized bytes=317466850
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=793710
		Reduce shuffle bytes=317466850
		Reduce input records=876118
		Reduce output records=412403
		Spilled Records=1752236
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=59215
		CPU time spent (ms)=791060
		Physical memory (bytes) snapshot=323214929920
		Virtual memory (bytes) snapshot=743114997760
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=261048943
	File Output Format Counters 
		Bytes Written=125612184
16/12/08 09:47:02 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0400
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0500 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0500': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4553714126550702504.jar tmpDir=null
16/12/08 10:43:10 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 10:43:11 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 10:43:11 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 10:43:13 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 10:43:13 INFO mapreduce.JobSubmitter: number of splits:197
16/12/08 10:43:13 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5663
16/12/08 10:43:14 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5663
16/12/08 10:43:14 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5663/
16/12/08 10:43:14 INFO mapreduce.Job: Running job: job_1480588584072_5663
16/12/08 10:43:27 INFO mapreduce.Job: Job job_1480588584072_5663 running in uber mode : false
16/12/08 10:43:27 INFO mapreduce.Job:  map 0% reduce 0%
16/12/08 10:43:37 INFO mapreduce.Job:  map 2% reduce 0%
16/12/08 10:43:46 INFO mapreduce.Job:  map 4% reduce 0%
16/12/08 10:43:50 INFO mapreduce.Job:  map 5% reduce 0%
16/12/08 10:43:51 INFO mapreduce.Job:  map 8% reduce 0%
16/12/08 10:43:52 INFO mapreduce.Job:  map 12% reduce 0%
16/12/08 10:43:54 INFO mapreduce.Job:  map 14% reduce 0%
16/12/08 10:43:56 INFO mapreduce.Job:  map 15% reduce 0%
16/12/08 10:43:57 INFO mapreduce.Job:  map 17% reduce 0%
16/12/08 10:43:58 INFO mapreduce.Job:  map 18% reduce 0%
16/12/08 10:43:59 INFO mapreduce.Job:  map 19% reduce 0%
16/12/08 10:44:02 INFO mapreduce.Job:  map 20% reduce 0%
16/12/08 10:44:04 INFO mapreduce.Job:  map 23% reduce 0%
16/12/08 10:44:05 INFO mapreduce.Job:  map 25% reduce 1%
16/12/08 10:44:06 INFO mapreduce.Job:  map 25% reduce 2%
16/12/08 10:44:08 INFO mapreduce.Job:  map 25% reduce 3%
16/12/08 10:44:12 INFO mapreduce.Job:  map 26% reduce 3%
16/12/08 10:44:13 INFO mapreduce.Job:  map 27% reduce 3%
16/12/08 10:44:14 INFO mapreduce.Job:  map 27% reduce 4%
16/12/08 10:44:15 INFO mapreduce.Job:  map 28% reduce 5%
16/12/08 10:44:16 INFO mapreduce.Job:  map 30% reduce 5%
16/12/08 10:44:17 INFO mapreduce.Job:  map 30% reduce 8%
16/12/08 10:44:18 INFO mapreduce.Job:  map 31% reduce 9%
16/12/08 10:44:20 INFO mapreduce.Job:  map 32% reduce 10%
16/12/08 10:44:22 INFO mapreduce.Job:  map 32% reduce 11%
16/12/08 10:44:26 INFO mapreduce.Job:  map 34% reduce 11%
16/12/08 10:44:27 INFO mapreduce.Job:  map 37% reduce 11%
16/12/08 10:44:28 INFO mapreduce.Job:  map 38% reduce 11%
16/12/08 10:44:29 INFO mapreduce.Job:  map 38% reduce 12%
16/12/08 10:44:32 INFO mapreduce.Job:  map 39% reduce 13%
16/12/08 10:44:34 INFO mapreduce.Job:  map 40% reduce 13%
16/12/08 10:44:36 INFO mapreduce.Job:  map 41% reduce 13%
16/12/08 10:44:37 INFO mapreduce.Job:  map 42% reduce 13%
16/12/08 10:44:38 INFO mapreduce.Job:  map 43% reduce 13%
16/12/08 10:44:39 INFO mapreduce.Job:  map 45% reduce 14%
16/12/08 10:44:40 INFO mapreduce.Job:  map 48% reduce 14%
16/12/08 10:44:41 INFO mapreduce.Job:  map 50% reduce 14%
16/12/08 10:44:42 INFO mapreduce.Job:  map 51% reduce 15%
16/12/08 10:44:43 INFO mapreduce.Job:  map 53% reduce 15%
16/12/08 10:44:44 INFO mapreduce.Job:  map 54% reduce 16%
16/12/08 10:44:45 INFO mapreduce.Job:  map 58% reduce 17%
16/12/08 10:44:46 INFO mapreduce.Job:  map 60% reduce 17%
16/12/08 10:44:47 INFO mapreduce.Job:  map 61% reduce 18%
16/12/08 10:44:48 INFO mapreduce.Job:  map 64% reduce 19%
16/12/08 10:44:49 INFO mapreduce.Job:  map 66% reduce 19%
16/12/08 10:44:50 INFO mapreduce.Job:  map 68% reduce 20%
16/12/08 10:44:51 INFO mapreduce.Job:  map 70% reduce 21%
16/12/08 10:44:52 INFO mapreduce.Job:  map 73% reduce 21%
16/12/08 10:44:53 INFO mapreduce.Job:  map 74% reduce 22%
16/12/08 10:44:54 INFO mapreduce.Job:  map 75% reduce 23%
16/12/08 10:44:55 INFO mapreduce.Job:  map 76% reduce 24%
16/12/08 10:44:56 INFO mapreduce.Job:  map 77% reduce 24%
16/12/08 10:44:57 INFO mapreduce.Job:  map 78% reduce 25%
16/12/08 10:44:58 INFO mapreduce.Job:  map 79% reduce 25%
16/12/08 10:44:59 INFO mapreduce.Job:  map 80% reduce 26%
16/12/08 10:45:00 INFO mapreduce.Job:  map 81% reduce 26%
16/12/08 10:45:01 INFO mapreduce.Job:  map 82% reduce 26%
16/12/08 10:45:02 INFO mapreduce.Job:  map 82% reduce 27%
16/12/08 10:45:07 INFO mapreduce.Job:  map 83% reduce 27%
16/12/08 10:45:12 INFO mapreduce.Job:  map 83% reduce 28%
16/12/08 10:45:15 INFO mapreduce.Job:  map 85% reduce 28%
16/12/08 10:45:18 INFO mapreduce.Job:  map 88% reduce 28%
16/12/08 10:45:19 INFO mapreduce.Job:  map 90% reduce 29%
16/12/08 10:45:20 INFO mapreduce.Job:  map 92% reduce 29%
16/12/08 10:45:21 INFO mapreduce.Job:  map 92% reduce 30%
16/12/08 10:45:23 INFO mapreduce.Job:  map 92% reduce 31%
16/12/08 10:45:24 INFO mapreduce.Job:  map 93% reduce 31%
16/12/08 10:45:25 INFO mapreduce.Job:  map 95% reduce 31%
16/12/08 10:45:26 INFO mapreduce.Job:  map 97% reduce 31%
16/12/08 10:45:27 INFO mapreduce.Job:  map 99% reduce 32%
16/12/08 10:45:28 INFO mapreduce.Job:  map 100% reduce 33%
16/12/08 10:45:30 INFO mapreduce.Job:  map 100% reduce 41%
16/12/08 10:45:31 INFO mapreduce.Job:  map 100% reduce 57%
16/12/08 10:45:32 INFO mapreduce.Job:  map 100% reduce 59%
16/12/08 10:45:33 INFO mapreduce.Job:  map 100% reduce 70%
16/12/08 10:45:34 INFO mapreduce.Job:  map 100% reduce 81%
16/12/08 10:45:35 INFO mapreduce.Job:  map 100% reduce 83%
16/12/08 10:45:36 INFO mapreduce.Job:  map 100% reduce 89%
16/12/08 10:45:37 INFO mapreduce.Job:  map 100% reduce 96%
16/12/08 10:45:38 INFO mapreduce.Job:  map 100% reduce 99%
16/12/08 10:45:39 INFO mapreduce.Job:  map 100% reduce 100%
16/12/08 10:45:42 INFO mapreduce.Job: Job job_1480588584072_5663 completed successfully
16/12/08 10:45:42 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=466923356
		FILE: Number of bytes written=966228677
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=394279345
		WASB: Number of bytes written=211998873
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=14198146
		Total time spent by all reduces in occupied slots (ms)=3914652
		Total time spent by all map tasks (ms)=7099073
		Total time spent by all reduce tasks (ms)=1957326
		Total vcore-seconds taken by all map tasks=7099073
		Total vcore-seconds taken by all reduce tasks=1957326
		Total megabyte-seconds taken by all map tasks=7269450752
		Total megabyte-seconds taken by all reduce tasks=2004301824
	Map-Reduce Framework
		Map input records=1406246
		Map output records=1233316
		Map output bytes=462408114
		Map output materialized bytes=466946876
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1103847
		Reduce shuffle bytes=466946876
		Reduce input records=1233316
		Reduce output records=664723
		Spilled Records=2466632
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=69784
		CPU time spent (ms)=855780
		Physical memory (bytes) snapshot=323441180672
		Virtual memory (bytes) snapshot=742815870976
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=391583341
	File Output Format Counters 
		Bytes Written=211998873
16/12/08 10:45:42 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0500
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0600 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0600': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2524512144853842078.jar tmpDir=null
16/12/08 11:46:53 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 11:46:54 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 11:46:55 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 11:46:57 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 11:46:57 INFO mapreduce.JobSubmitter: number of splits:197
16/12/08 11:46:57 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5670
16/12/08 11:46:58 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5670
16/12/08 11:46:58 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5670/
16/12/08 11:46:58 INFO mapreduce.Job: Running job: job_1480588584072_5670
16/12/08 11:47:10 INFO mapreduce.Job: Job job_1480588584072_5670 running in uber mode : false
16/12/08 11:47:10 INFO mapreduce.Job:  map 0% reduce 0%
16/12/08 11:47:21 INFO mapreduce.Job:  map 1% reduce 0%
16/12/08 11:47:22 INFO mapreduce.Job:  map 2% reduce 0%
16/12/08 11:47:30 INFO mapreduce.Job:  map 4% reduce 0%
16/12/08 11:47:32 INFO mapreduce.Job:  map 5% reduce 0%
16/12/08 11:47:33 INFO mapreduce.Job:  map 9% reduce 0%
16/12/08 11:47:34 INFO mapreduce.Job:  map 10% reduce 0%
16/12/08 11:47:36 INFO mapreduce.Job:  map 12% reduce 0%
16/12/08 11:47:37 INFO mapreduce.Job:  map 13% reduce 0%
16/12/08 11:47:38 INFO mapreduce.Job:  map 14% reduce 0%
16/12/08 11:47:39 INFO mapreduce.Job:  map 18% reduce 0%
16/12/08 11:47:40 INFO mapreduce.Job:  map 19% reduce 0%
16/12/08 11:47:45 INFO mapreduce.Job:  map 21% reduce 0%
16/12/08 11:47:47 INFO mapreduce.Job:  map 25% reduce 0%
16/12/08 11:47:50 INFO mapreduce.Job:  map 25% reduce 2%
16/12/08 11:47:52 INFO mapreduce.Job:  map 25% reduce 4%
16/12/08 11:47:54 INFO mapreduce.Job:  map 27% reduce 4%
16/12/08 11:47:55 INFO mapreduce.Job:  map 28% reduce 4%
16/12/08 11:47:57 INFO mapreduce.Job:  map 28% reduce 5%
16/12/08 11:47:58 INFO mapreduce.Job:  map 30% reduce 7%
16/12/08 11:47:59 INFO mapreduce.Job:  map 30% reduce 8%
16/12/08 11:48:00 INFO mapreduce.Job:  map 31% reduce 8%
16/12/08 11:48:01 INFO mapreduce.Job:  map 31% reduce 9%
16/12/08 11:48:02 INFO mapreduce.Job:  map 31% reduce 10%
16/12/08 11:48:03 INFO mapreduce.Job:  map 32% reduce 10%
16/12/08 11:48:04 INFO mapreduce.Job:  map 33% reduce 11%
16/12/08 11:48:06 INFO mapreduce.Job:  map 34% reduce 11%
16/12/08 11:48:07 INFO mapreduce.Job:  map 36% reduce 11%
16/12/08 11:48:08 INFO mapreduce.Job:  map 37% reduce 11%
16/12/08 11:48:09 INFO mapreduce.Job:  map 37% reduce 12%
16/12/08 11:48:10 INFO mapreduce.Job:  map 38% reduce 12%
16/12/08 11:48:11 INFO mapreduce.Job:  map 39% reduce 12%
16/12/08 11:48:13 INFO mapreduce.Job:  map 40% reduce 13%
16/12/08 11:48:14 INFO mapreduce.Job:  map 41% reduce 13%
16/12/08 11:48:16 INFO mapreduce.Job:  map 43% reduce 14%
16/12/08 11:48:18 INFO mapreduce.Job:  map 44% reduce 14%
16/12/08 11:48:19 INFO mapreduce.Job:  map 45% reduce 14%
16/12/08 11:48:20 INFO mapreduce.Job:  map 46% reduce 15%
16/12/08 11:48:22 INFO mapreduce.Job:  map 47% reduce 15%
16/12/08 11:48:23 INFO mapreduce.Job:  map 48% reduce 15%
16/12/08 11:48:24 INFO mapreduce.Job:  map 49% reduce 15%
16/12/08 11:48:25 INFO mapreduce.Job:  map 51% reduce 16%
16/12/08 11:48:26 INFO mapreduce.Job:  map 53% reduce 16%
16/12/08 11:48:27 INFO mapreduce.Job:  map 55% reduce 16%
16/12/08 11:48:28 INFO mapreduce.Job:  map 56% reduce 16%
16/12/08 11:48:29 INFO mapreduce.Job:  map 57% reduce 17%
16/12/08 11:48:30 INFO mapreduce.Job:  map 58% reduce 17%
16/12/08 11:48:31 INFO mapreduce.Job:  map 61% reduce 18%
16/12/08 11:48:32 INFO mapreduce.Job:  map 65% reduce 18%
16/12/08 11:48:33 INFO mapreduce.Job:  map 67% reduce 18%
16/12/08 11:48:34 INFO mapreduce.Job:  map 70% reduce 19%
16/12/08 11:48:35 INFO mapreduce.Job:  map 72% reduce 21%
16/12/08 11:48:36 INFO mapreduce.Job:  map 75% reduce 21%
16/12/08 11:48:37 INFO mapreduce.Job:  map 76% reduce 22%
16/12/08 11:48:38 INFO mapreduce.Job:  map 77% reduce 23%
16/12/08 11:48:39 INFO mapreduce.Job:  map 78% reduce 23%
16/12/08 11:48:40 INFO mapreduce.Job:  map 79% reduce 24%
16/12/08 11:48:41 INFO mapreduce.Job:  map 83% reduce 25%
16/12/08 11:48:42 INFO mapreduce.Job:  map 84% reduce 25%
16/12/08 11:48:43 INFO mapreduce.Job:  map 85% reduce 26%
16/12/08 11:48:44 INFO mapreduce.Job:  map 86% reduce 28%
16/12/08 11:48:48 INFO mapreduce.Job:  map 86% reduce 29%
16/12/08 11:48:49 INFO mapreduce.Job:  map 87% reduce 29%
16/12/08 11:48:51 INFO mapreduce.Job:  map 88% reduce 29%
16/12/08 11:48:53 INFO mapreduce.Job:  map 91% reduce 29%
16/12/08 11:48:54 INFO mapreduce.Job:  map 91% reduce 30%
16/12/08 11:48:55 INFO mapreduce.Job:  map 92% reduce 30%
16/12/08 11:48:57 INFO mapreduce.Job:  map 92% reduce 31%
16/12/08 11:48:58 INFO mapreduce.Job:  map 93% reduce 31%
16/12/08 11:49:03 INFO mapreduce.Job:  map 95% reduce 31%
16/12/08 11:49:04 INFO mapreduce.Job:  map 96% reduce 31%
16/12/08 11:49:05 INFO mapreduce.Job:  map 99% reduce 32%
16/12/08 11:49:06 INFO mapreduce.Job:  map 100% reduce 32%
16/12/08 11:49:07 INFO mapreduce.Job:  map 100% reduce 36%
16/12/08 11:49:08 INFO mapreduce.Job:  map 100% reduce 42%
16/12/08 11:49:09 INFO mapreduce.Job:  map 100% reduce 62%
16/12/08 11:49:10 INFO mapreduce.Job:  map 100% reduce 69%
16/12/08 11:49:11 INFO mapreduce.Job:  map 100% reduce 74%
16/12/08 11:49:12 INFO mapreduce.Job:  map 100% reduce 86%
16/12/08 11:49:13 INFO mapreduce.Job:  map 100% reduce 88%
16/12/08 11:49:14 INFO mapreduce.Job:  map 100% reduce 91%
16/12/08 11:49:15 INFO mapreduce.Job:  map 100% reduce 100%
16/12/08 11:49:19 INFO mapreduce.Job: Job job_1480588584072_5670 completed successfully
16/12/08 11:49:19 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=573548203
		FILE: Number of bytes written=1179478371
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=486853362
		WASB: Number of bytes written=268606720
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13472236
		Total time spent by all reduces in occupied slots (ms)=3700068
		Total time spent by all map tasks (ms)=6736118
		Total time spent by all reduce tasks (ms)=1850034
		Total vcore-seconds taken by all map tasks=6736118
		Total vcore-seconds taken by all reduce tasks=1850034
		Total megabyte-seconds taken by all map tasks=6897784832
		Total megabyte-seconds taken by all reduce tasks=1894434816
	Map-Reduce Framework
		Map input records=1717630
		Map output records=1493645
		Map output bytes=568038705
		Map output materialized bytes=573571723
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1330216
		Reduce shuffle bytes=573571723
		Reduce input records=1493645
		Reduce output records=835691
		Spilled Records=2987290
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=73146
		CPU time spent (ms)=880450
		Physical memory (bytes) snapshot=323783528448
		Virtual memory (bytes) snapshot=742794297344
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=484157358
	File Output Format Counters 
		Bytes Written=268606720
16/12/08 11:49:19 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0600
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0700 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161207/201612072300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0700': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3178402379716838098.jar tmpDir=null
16/12/08 12:50:32 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 12:50:33 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 12:50:33 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 12:50:35 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 12:50:35 INFO mapreduce.JobSubmitter: number of splits:197
16/12/08 12:50:35 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5673
16/12/08 12:50:36 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5673
16/12/08 12:50:36 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5673/
16/12/08 12:50:36 INFO mapreduce.Job: Running job: job_1480588584072_5673
16/12/08 12:50:49 INFO mapreduce.Job: Job job_1480588584072_5673 running in uber mode : false
16/12/08 12:50:49 INFO mapreduce.Job:  map 0% reduce 0%
16/12/08 12:51:02 INFO mapreduce.Job:  map 1% reduce 0%
16/12/08 12:51:03 INFO mapreduce.Job:  map 3% reduce 0%
16/12/08 12:51:11 INFO mapreduce.Job:  map 7% reduce 0%
16/12/08 12:51:12 INFO mapreduce.Job:  map 11% reduce 0%
16/12/08 12:51:13 INFO mapreduce.Job:  map 13% reduce 0%
16/12/08 12:51:17 INFO mapreduce.Job:  map 14% reduce 0%
16/12/08 12:51:18 INFO mapreduce.Job:  map 15% reduce 0%
16/12/08 12:51:19 INFO mapreduce.Job:  map 17% reduce 0%
16/12/08 12:51:20 INFO mapreduce.Job:  map 19% reduce 0%
16/12/08 12:51:21 INFO mapreduce.Job:  map 21% reduce 0%
16/12/08 12:51:23 INFO mapreduce.Job:  map 23% reduce 0%
16/12/08 12:51:24 INFO mapreduce.Job:  map 24% reduce 0%
16/12/08 12:51:25 INFO mapreduce.Job:  map 26% reduce 0%
16/12/08 12:51:26 INFO mapreduce.Job:  map 27% reduce 0%
16/12/08 12:51:28 INFO mapreduce.Job:  map 28% reduce 0%
16/12/08 12:51:32 INFO mapreduce.Job:  map 28% reduce 1%
16/12/08 12:51:33 INFO mapreduce.Job:  map 28% reduce 2%
16/12/08 12:51:34 INFO mapreduce.Job:  map 29% reduce 2%
16/12/08 12:51:35 INFO mapreduce.Job:  map 29% reduce 4%
16/12/08 12:51:36 INFO mapreduce.Job:  map 29% reduce 5%
16/12/08 12:51:37 INFO mapreduce.Job:  map 30% reduce 6%
16/12/08 12:51:38 INFO mapreduce.Job:  map 30% reduce 9%
16/12/08 12:51:39 INFO mapreduce.Job:  map 32% reduce 9%
16/12/08 12:51:40 INFO mapreduce.Job:  map 34% reduce 10%
16/12/08 12:51:41 INFO mapreduce.Job:  map 35% reduce 11%
16/12/08 12:51:44 INFO mapreduce.Job:  map 35% reduce 12%
16/12/08 12:51:47 INFO mapreduce.Job:  map 36% reduce 12%
16/12/08 12:51:49 INFO mapreduce.Job:  map 37% reduce 12%
16/12/08 12:51:50 INFO mapreduce.Job:  map 38% reduce 12%
16/12/08 12:51:51 INFO mapreduce.Job:  map 40% reduce 12%
16/12/08 12:51:52 INFO mapreduce.Job:  map 40% reduce 13%
16/12/08 12:51:54 INFO mapreduce.Job:  map 41% reduce 13%
16/12/08 12:51:55 INFO mapreduce.Job:  map 42% reduce 13%
16/12/08 12:51:57 INFO mapreduce.Job:  map 42% reduce 14%
16/12/08 12:51:58 INFO mapreduce.Job:  map 43% reduce 14%
16/12/08 12:52:00 INFO mapreduce.Job:  map 44% reduce 14%
16/12/08 12:52:01 INFO mapreduce.Job:  map 47% reduce 14%
16/12/08 12:52:02 INFO mapreduce.Job:  map 48% reduce 15%
16/12/08 12:52:04 INFO mapreduce.Job:  map 50% reduce 16%
16/12/08 12:52:05 INFO mapreduce.Job:  map 53% reduce 16%
16/12/08 12:52:06 INFO mapreduce.Job:  map 54% reduce 16%
16/12/08 12:52:07 INFO mapreduce.Job:  map 55% reduce 16%
16/12/08 12:52:08 INFO mapreduce.Job:  map 58% reduce 17%
16/12/08 12:52:09 INFO mapreduce.Job:  map 60% reduce 17%
16/12/08 12:52:10 INFO mapreduce.Job:  map 62% reduce 17%
16/12/08 12:52:11 INFO mapreduce.Job:  map 65% reduce 18%
16/12/08 12:52:12 INFO mapreduce.Job:  map 67% reduce 19%
16/12/08 12:52:13 INFO mapreduce.Job:  map 68% reduce 19%
16/12/08 12:52:14 INFO mapreduce.Job:  map 70% reduce 20%
16/12/08 12:52:15 INFO mapreduce.Job:  map 71% reduce 21%
16/12/08 12:52:16 INFO mapreduce.Job:  map 74% reduce 21%
16/12/08 12:52:17 INFO mapreduce.Job:  map 75% reduce 22%
16/12/08 12:52:18 INFO mapreduce.Job:  map 76% reduce 23%
16/12/08 12:52:19 INFO mapreduce.Job:  map 77% reduce 23%
16/12/08 12:52:20 INFO mapreduce.Job:  map 78% reduce 24%
16/12/08 12:52:21 INFO mapreduce.Job:  map 81% reduce 24%
16/12/08 12:52:22 INFO mapreduce.Job:  map 82% reduce 24%
16/12/08 12:52:23 INFO mapreduce.Job:  map 84% reduce 26%
16/12/08 12:52:24 INFO mapreduce.Job:  map 85% reduce 27%
16/12/08 12:52:26 INFO mapreduce.Job:  map 85% reduce 28%
16/12/08 12:52:27 INFO mapreduce.Job:  map 86% reduce 28%
16/12/08 12:52:29 INFO mapreduce.Job:  map 87% reduce 28%
16/12/08 12:52:30 INFO mapreduce.Job:  map 88% reduce 29%
16/12/08 12:52:44 INFO mapreduce.Job:  map 89% reduce 29%
16/12/08 12:52:50 INFO mapreduce.Job:  map 91% reduce 29%
16/12/08 12:52:51 INFO mapreduce.Job:  map 93% reduce 30%
16/12/08 12:52:52 INFO mapreduce.Job:  map 94% reduce 30%
16/12/08 12:52:53 INFO mapreduce.Job:  map 95% reduce 30%
16/12/08 12:52:54 INFO mapreduce.Job:  map 97% reduce 31%
16/12/08 12:52:55 INFO mapreduce.Job:  map 98% reduce 31%
16/12/08 12:52:56 INFO mapreduce.Job:  map 99% reduce 32%
16/12/08 12:52:58 INFO mapreduce.Job:  map 99% reduce 33%
16/12/08 12:52:59 INFO mapreduce.Job:  map 100% reduce 33%
16/12/08 12:53:00 INFO mapreduce.Job:  map 100% reduce 34%
16/12/08 12:53:01 INFO mapreduce.Job:  map 100% reduce 44%
16/12/08 12:53:02 INFO mapreduce.Job:  map 100% reduce 49%
16/12/08 12:53:03 INFO mapreduce.Job:  map 100% reduce 57%
16/12/08 12:53:04 INFO mapreduce.Job:  map 100% reduce 71%
16/12/08 12:53:05 INFO mapreduce.Job:  map 100% reduce 74%
16/12/08 12:53:06 INFO mapreduce.Job:  map 100% reduce 78%
16/12/08 12:53:07 INFO mapreduce.Job:  map 100% reduce 87%
16/12/08 12:53:09 INFO mapreduce.Job:  map 100% reduce 88%
16/12/08 12:53:10 INFO mapreduce.Job:  map 100% reduce 92%
16/12/08 12:53:12 INFO mapreduce.Job:  map 100% reduce 94%
16/12/08 12:53:13 INFO mapreduce.Job:  map 100% reduce 97%
16/12/08 12:53:14 INFO mapreduce.Job:  map 100% reduce 99%
16/12/08 12:53:15 INFO mapreduce.Job:  map 100% reduce 100%
16/12/08 12:53:18 INFO mapreduce.Job: Job job_1480588584072_5673 completed successfully
16/12/08 12:53:18 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=696024908
		FILE: Number of bytes written=1424431781
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=590562420
		WASB: Number of bytes written=344646868
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=14423506
		Total time spent by all reduces in occupied slots (ms)=4381160
		Total time spent by all map tasks (ms)=7211753
		Total time spent by all reduce tasks (ms)=2190580
		Total vcore-seconds taken by all map tasks=7211753
		Total vcore-seconds taken by all reduce tasks=2190580
		Total megabyte-seconds taken by all map tasks=7384835072
		Total megabyte-seconds taken by all reduce tasks=2243153920
	Map-Reduce Framework
		Map input records=2068875
		Map output records=1798453
		Map output bytes=689373739
		Map output materialized bytes=696048428
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1607058
		Reduce shuffle bytes=696048428
		Reduce input records=1798453
		Reduce output records=1073019
		Spilled Records=3596906
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=68608
		CPU time spent (ms)=943460
		Physical memory (bytes) snapshot=324309000192
		Virtual memory (bytes) snapshot=742644420608
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=587866416
	File Output Format Counters 
		Bytes Written=344646868
16/12/08 12:53:18 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0700
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080400 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0800 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080400
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0800': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob6633739079637870694.jar tmpDir=null
16/12/08 13:44:26 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 13:44:27 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 13:44:27 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 13:44:29 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 13:44:29 INFO mapreduce.JobSubmitter: number of splits:197
16/12/08 13:44:30 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5702
16/12/08 13:44:30 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5702
16/12/08 13:44:30 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5702/
16/12/08 13:44:30 INFO mapreduce.Job: Running job: job_1480588584072_5702
16/12/08 13:44:43 INFO mapreduce.Job: Job job_1480588584072_5702 running in uber mode : false
16/12/08 13:44:43 INFO mapreduce.Job:  map 0% reduce 0%
16/12/08 13:45:05 INFO mapreduce.Job:  map 1% reduce 0%
16/12/08 13:45:07 INFO mapreduce.Job:  map 5% reduce 0%
16/12/08 13:45:08 INFO mapreduce.Job:  map 8% reduce 0%
16/12/08 13:45:10 INFO mapreduce.Job:  map 10% reduce 0%
16/12/08 13:45:12 INFO mapreduce.Job:  map 11% reduce 0%
16/12/08 13:45:13 INFO mapreduce.Job:  map 14% reduce 0%
16/12/08 13:45:14 INFO mapreduce.Job:  map 17% reduce 0%
16/12/08 13:45:22 INFO mapreduce.Job:  map 19% reduce 0%
16/12/08 13:45:24 INFO mapreduce.Job:  map 22% reduce 0%
16/12/08 13:45:25 INFO mapreduce.Job:  map 24% reduce 0%
16/12/08 13:45:27 INFO mapreduce.Job:  map 25% reduce 0%
16/12/08 13:45:29 INFO mapreduce.Job:  map 30% reduce 0%
16/12/08 13:45:30 INFO mapreduce.Job:  map 31% reduce 0%
16/12/08 13:45:31 INFO mapreduce.Job:  map 33% reduce 3%
16/12/08 13:45:32 INFO mapreduce.Job:  map 34% reduce 3%
16/12/08 13:45:34 INFO mapreduce.Job:  map 39% reduce 3%
16/12/08 13:45:35 INFO mapreduce.Job:  map 40% reduce 3%
16/12/08 13:45:36 INFO mapreduce.Job:  map 41% reduce 5%
16/12/08 13:45:37 INFO mapreduce.Job:  map 43% reduce 5%
16/12/08 13:45:38 INFO mapreduce.Job:  map 43% reduce 7%
16/12/08 13:45:39 INFO mapreduce.Job:  map 44% reduce 10%
16/12/08 13:45:41 INFO mapreduce.Job:  map 47% reduce 10%
16/12/08 13:45:45 INFO mapreduce.Job:  map 47% reduce 11%
16/12/08 13:45:46 INFO mapreduce.Job:  map 49% reduce 13%
16/12/08 13:45:47 INFO mapreduce.Job:  map 51% reduce 13%
16/12/08 13:45:48 INFO mapreduce.Job:  map 51% reduce 14%
16/12/08 13:45:49 INFO mapreduce.Job:  map 52% reduce 14%
16/12/08 13:45:50 INFO mapreduce.Job:  map 52% reduce 15%
16/12/08 13:45:52 INFO mapreduce.Job:  map 55% reduce 16%
16/12/08 13:45:55 INFO mapreduce.Job:  map 56% reduce 16%
16/12/08 13:45:57 INFO mapreduce.Job:  map 59% reduce 16%
16/12/08 13:45:59 INFO mapreduce.Job:  map 63% reduce 17%
16/12/08 13:46:00 INFO mapreduce.Job:  map 64% reduce 17%
16/12/08 13:46:01 INFO mapreduce.Job:  map 65% reduce 17%
16/12/08 13:46:02 INFO mapreduce.Job:  map 66% reduce 19%
16/12/08 13:46:05 INFO mapreduce.Job:  map 68% reduce 20%
16/12/08 13:46:06 INFO mapreduce.Job:  map 70% reduce 20%
16/12/08 13:46:09 INFO mapreduce.Job:  map 72% reduce 21%
16/12/08 13:46:11 INFO mapreduce.Job:  map 73% reduce 21%
16/12/08 13:46:14 INFO mapreduce.Job:  map 80% reduce 22%
16/12/08 13:46:15 INFO mapreduce.Job:  map 82% reduce 23%
16/12/08 13:46:16 INFO mapreduce.Job:  map 82% reduce 24%
16/12/08 13:46:17 INFO mapreduce.Job:  map 86% reduce 25%
16/12/08 13:46:18 INFO mapreduce.Job:  map 87% reduce 27%
16/12/08 13:46:19 INFO mapreduce.Job:  map 88% reduce 27%
16/12/08 13:46:20 INFO mapreduce.Job:  map 91% reduce 28%
16/12/08 13:46:21 INFO mapreduce.Job:  map 92% reduce 29%
16/12/08 13:46:22 INFO mapreduce.Job:  map 93% reduce 29%
16/12/08 13:46:23 INFO mapreduce.Job:  map 94% reduce 30%
16/12/08 13:46:24 INFO mapreduce.Job:  map 95% reduce 31%
16/12/08 13:46:25 INFO mapreduce.Job:  map 98% reduce 31%
16/12/08 13:46:26 INFO mapreduce.Job:  map 100% reduce 32%
16/12/08 13:46:27 INFO mapreduce.Job:  map 100% reduce 35%
16/12/08 13:46:29 INFO mapreduce.Job:  map 100% reduce 36%
16/12/08 13:46:30 INFO mapreduce.Job:  map 100% reduce 51%
16/12/08 13:46:31 INFO mapreduce.Job:  map 100% reduce 63%
16/12/08 13:46:32 INFO mapreduce.Job:  map 100% reduce 65%
16/12/08 13:46:33 INFO mapreduce.Job:  map 100% reduce 72%
16/12/08 13:46:34 INFO mapreduce.Job:  map 100% reduce 78%
16/12/08 13:46:35 INFO mapreduce.Job:  map 100% reduce 79%
16/12/08 13:46:36 INFO mapreduce.Job:  map 100% reduce 87%
16/12/08 13:46:37 INFO mapreduce.Job:  map 100% reduce 91%
16/12/08 13:46:38 INFO mapreduce.Job:  map 100% reduce 95%
16/12/08 13:46:39 INFO mapreduce.Job:  map 100% reduce 98%
16/12/08 13:46:40 INFO mapreduce.Job:  map 100% reduce 99%
16/12/08 13:46:42 INFO mapreduce.Job:  map 100% reduce 100%
16/12/08 13:46:44 INFO mapreduce.Job: Job job_1480588584072_5702 completed successfully
16/12/08 13:46:44 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=942300982
		FILE: Number of bytes written=1916983929
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=791761799
		WASB: Number of bytes written=523873141
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=12851604
		Total time spent by all reduces in occupied slots (ms)=2979224
		Total time spent by all map tasks (ms)=6425802
		Total time spent by all reduce tasks (ms)=1489612
		Total vcore-seconds taken by all map tasks=6425802
		Total vcore-seconds taken by all reduce tasks=1489612
		Total megabyte-seconds taken by all map tasks=6580021248
		Total megabyte-seconds taken by all reduce tasks=1525362688
	Map-Reduce Framework
		Map input records=2694653
		Map output records=2387071
		Map output bytes=933400403
		Map output materialized bytes=942324502
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2155253
		Reduce shuffle bytes=942324502
		Reduce input records=2387071
		Reduce output records=1606667
		Spilled Records=4774142
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=73137
		CPU time spent (ms)=1004070
		Physical memory (bytes) snapshot=325846810624
		Virtual memory (bytes) snapshot=742648147968
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=789065795
	File Output Format Counters 
		Bytes Written=523873141
16/12/08 13:46:44 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0800
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080500 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0900 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080500
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0900': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7011382387405407075.jar tmpDir=null
16/12/08 14:42:55 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 14:42:55 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 14:42:56 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 14:42:58 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 14:42:58 INFO mapreduce.JobSubmitter: number of splits:197
16/12/08 14:42:58 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5750
16/12/08 14:42:59 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5750
16/12/08 14:42:59 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5750/
16/12/08 14:42:59 INFO mapreduce.Job: Running job: job_1480588584072_5750
16/12/08 14:52:12 INFO mapreduce.Job: Job job_1480588584072_5750 running in uber mode : false
16/12/08 14:52:12 INFO mapreduce.Job:  map 0% reduce 0%
16/12/08 14:52:33 INFO mapreduce.Job:  map 3% reduce 0%
16/12/08 14:52:38 INFO mapreduce.Job:  map 8% reduce 0%
16/12/08 14:52:40 INFO mapreduce.Job:  map 11% reduce 0%
16/12/08 14:52:44 INFO mapreduce.Job:  map 12% reduce 0%
16/12/08 14:52:46 INFO mapreduce.Job:  map 13% reduce 0%
16/12/08 14:52:47 INFO mapreduce.Job:  map 16% reduce 0%
16/12/08 14:52:48 INFO mapreduce.Job:  map 18% reduce 0%
16/12/08 14:52:50 INFO mapreduce.Job:  map 20% reduce 0%
16/12/08 14:52:51 INFO mapreduce.Job:  map 21% reduce 0%
16/12/08 14:52:52 INFO mapreduce.Job:  map 23% reduce 0%
16/12/08 14:52:53 INFO mapreduce.Job:  map 26% reduce 0%
16/12/08 14:52:54 INFO mapreduce.Job:  map 28% reduce 0%
16/12/08 14:52:58 INFO mapreduce.Job:  map 29% reduce 1%
16/12/08 14:53:02 INFO mapreduce.Job:  map 30% reduce 2%
16/12/08 14:53:03 INFO mapreduce.Job:  map 32% reduce 5%
16/12/08 14:53:04 INFO mapreduce.Job:  map 34% reduce 6%
16/12/08 14:53:05 INFO mapreduce.Job:  map 35% reduce 8%
16/12/08 14:53:06 INFO mapreduce.Job:  map 36% reduce 8%
16/12/08 14:53:07 INFO mapreduce.Job:  map 37% reduce 10%
16/12/08 14:53:08 INFO mapreduce.Job:  map 37% reduce 11%
16/12/08 14:53:09 INFO mapreduce.Job:  map 40% reduce 11%
16/12/08 14:53:11 INFO mapreduce.Job:  map 41% reduce 11%
16/12/08 14:53:12 INFO mapreduce.Job:  map 45% reduce 12%
16/12/08 14:53:14 INFO mapreduce.Job:  map 47% reduce 12%
16/12/08 14:53:15 INFO mapreduce.Job:  map 47% reduce 13%
16/12/08 14:53:17 INFO mapreduce.Job:  map 49% reduce 14%
16/12/08 14:53:19 INFO mapreduce.Job:  map 51% reduce 14%
16/12/08 14:53:20 INFO mapreduce.Job:  map 52% reduce 15%
16/12/08 14:53:21 INFO mapreduce.Job:  map 56% reduce 15%
16/12/08 14:53:23 INFO mapreduce.Job:  map 57% reduce 16%
16/12/08 14:53:25 INFO mapreduce.Job:  map 61% reduce 17%
16/12/08 14:53:26 INFO mapreduce.Job:  map 63% reduce 17%
16/12/08 14:53:27 INFO mapreduce.Job:  map 64% reduce 18%
16/12/08 14:53:30 INFO mapreduce.Job:  map 65% reduce 18%
16/12/08 14:53:31 INFO mapreduce.Job:  map 67% reduce 21%
16/12/08 14:53:33 INFO mapreduce.Job:  map 72% reduce 21%
16/12/08 14:53:34 INFO mapreduce.Job:  map 75% reduce 21%
16/12/08 14:53:37 INFO mapreduce.Job:  map 76% reduce 21%
16/12/08 14:53:38 INFO mapreduce.Job:  map 77% reduce 24%
16/12/08 14:53:40 INFO mapreduce.Job:  map 79% reduce 24%
16/12/08 14:53:42 INFO mapreduce.Job:  map 82% reduce 25%
16/12/08 14:53:45 INFO mapreduce.Job:  map 83% reduce 25%
16/12/08 14:53:47 INFO mapreduce.Job:  map 83% reduce 27%
16/12/08 14:53:50 INFO mapreduce.Job:  map 84% reduce 27%
16/12/08 14:53:51 INFO mapreduce.Job:  map 85% reduce 27%
16/12/08 14:53:52 INFO mapreduce.Job:  map 86% reduce 28%
16/12/08 14:53:54 INFO mapreduce.Job:  map 87% reduce 28%
16/12/08 14:53:55 INFO mapreduce.Job:  map 88% reduce 28%
16/12/08 14:53:56 INFO mapreduce.Job:  map 90% reduce 29%
16/12/08 14:53:58 INFO mapreduce.Job:  map 91% reduce 29%
16/12/08 14:53:59 INFO mapreduce.Job:  map 91% reduce 30%
16/12/08 14:54:01 INFO mapreduce.Job:  map 92% reduce 30%
16/12/08 14:54:03 INFO mapreduce.Job:  map 94% reduce 30%
16/12/08 14:54:04 INFO mapreduce.Job:  map 95% reduce 30%
16/12/08 14:54:05 INFO mapreduce.Job:  map 96% reduce 31%
16/12/08 14:54:06 INFO mapreduce.Job:  map 98% reduce 32%
16/12/08 14:54:07 INFO mapreduce.Job:  map 99% reduce 32%
16/12/08 14:54:08 INFO mapreduce.Job:  map 100% reduce 32%
16/12/08 14:54:09 INFO mapreduce.Job:  map 100% reduce 38%
16/12/08 14:54:10 INFO mapreduce.Job:  map 100% reduce 41%
16/12/08 14:54:11 INFO mapreduce.Job:  map 100% reduce 49%
16/12/08 14:54:12 INFO mapreduce.Job:  map 100% reduce 60%
16/12/08 14:54:13 INFO mapreduce.Job:  map 100% reduce 69%
16/12/08 14:54:14 INFO mapreduce.Job:  map 100% reduce 73%
16/12/08 14:54:15 INFO mapreduce.Job:  map 100% reduce 78%
16/12/08 14:54:16 INFO mapreduce.Job:  map 100% reduce 81%
16/12/08 14:54:17 INFO mapreduce.Job:  map 100% reduce 86%
16/12/08 14:54:18 INFO mapreduce.Job:  map 100% reduce 87%
16/12/08 14:54:19 INFO mapreduce.Job:  map 100% reduce 91%
16/12/08 14:54:20 INFO mapreduce.Job:  map 100% reduce 92%
16/12/08 14:54:22 INFO mapreduce.Job:  map 100% reduce 96%
16/12/08 14:54:23 INFO mapreduce.Job:  map 100% reduce 97%
16/12/08 14:54:25 INFO mapreduce.Job:  map 100% reduce 100%
16/12/08 14:54:30 INFO mapreduce.Job: Job job_1480588584072_5750 completed successfully
16/12/08 14:54:30 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=891115700
		FILE: Number of bytes written=1814613365
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=756849381
		WASB: Number of bytes written=467466162
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13146316
		Total time spent by all reduces in occupied slots (ms)=3627174
		Total time spent by all map tasks (ms)=6573158
		Total time spent by all reduce tasks (ms)=1813587
		Total vcore-seconds taken by all map tasks=6573158
		Total vcore-seconds taken by all reduce tasks=1813587
		Total megabyte-seconds taken by all map tasks=6730913792
		Total megabyte-seconds taken by all reduce tasks=1857113088
	Map-Reduce Framework
		Map input records=2608463
		Map output records=2269525
		Map output bytes=882661754
		Map output materialized bytes=891139220
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2031442
		Reduce shuffle bytes=891139220
		Reduce input records=2269525
		Reduce output records=1445978
		Spilled Records=4539050
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=85462
		CPU time spent (ms)=990800
		Physical memory (bytes) snapshot=325446516736
		Virtual memory (bytes) snapshot=742682628096
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=754153377
	File Output Format Counters 
		Bytes Written=467466162
16/12/08 14:54:30 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/0900
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600 not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3389041335405860064.jar tmpDir=null
16/12/08 16:51:21 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 16:51:21 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 16:51:22 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 16:51:24 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 16:51:24 INFO mapreduce.JobSubmitter: number of splits:197
16/12/08 16:51:24 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5763
16/12/08 16:51:25 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5763
16/12/08 16:51:25 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5763/
16/12/08 16:51:25 INFO mapreduce.Job: Running job: job_1480588584072_5763
16/12/08 16:51:38 INFO mapreduce.Job: Job job_1480588584072_5763 running in uber mode : false
16/12/08 16:51:38 INFO mapreduce.Job:  map 0% reduce 0%
16/12/08 16:51:53 INFO mapreduce.Job:  map 2% reduce 0%
16/12/08 16:51:54 INFO mapreduce.Job:  map 4% reduce 0%
16/12/08 16:51:59 INFO mapreduce.Job:  map 5% reduce 0%
16/12/08 16:52:00 INFO mapreduce.Job:  map 7% reduce 0%
16/12/08 16:52:02 INFO mapreduce.Job:  map 8% reduce 0%
16/12/08 16:52:03 INFO mapreduce.Job:  map 11% reduce 0%
16/12/08 16:52:04 INFO mapreduce.Job:  map 13% reduce 0%
16/12/08 16:52:05 INFO mapreduce.Job:  map 16% reduce 0%
16/12/08 16:52:07 INFO mapreduce.Job:  map 19% reduce 0%
16/12/08 16:52:11 INFO mapreduce.Job:  map 20% reduce 0%
16/12/08 16:52:12 INFO mapreduce.Job:  map 21% reduce 0%
16/12/08 16:52:13 INFO mapreduce.Job:  map 22% reduce 0%
16/12/08 16:52:15 INFO mapreduce.Job:  map 23% reduce 0%
16/12/08 16:52:16 INFO mapreduce.Job:  map 24% reduce 0%
16/12/08 16:52:18 INFO mapreduce.Job:  map 25% reduce 0%
16/12/08 16:52:19 INFO mapreduce.Job:  map 27% reduce 2%
16/12/08 16:52:21 INFO mapreduce.Job:  map 27% reduce 4%
16/12/08 16:52:22 INFO mapreduce.Job:  map 28% reduce 5%
16/12/08 16:52:23 INFO mapreduce.Job:  map 29% reduce 6%
16/12/08 16:52:24 INFO mapreduce.Job:  map 29% reduce 7%
16/12/08 16:52:26 INFO mapreduce.Job:  map 29% reduce 8%
16/12/08 16:52:27 INFO mapreduce.Job:  map 29% reduce 9%
16/12/08 16:52:28 INFO mapreduce.Job:  map 30% reduce 9%
16/12/08 16:52:30 INFO mapreduce.Job:  map 32% reduce 9%
16/12/08 16:52:31 INFO mapreduce.Job:  map 35% reduce 10%
16/12/08 16:52:32 INFO mapreduce.Job:  map 35% reduce 11%
16/12/08 16:52:35 INFO mapreduce.Job:  map 35% reduce 12%
16/12/08 16:52:36 INFO mapreduce.Job:  map 36% reduce 12%
16/12/08 16:52:37 INFO mapreduce.Job:  map 37% reduce 12%
16/12/08 16:52:40 INFO mapreduce.Job:  map 38% reduce 12%
16/12/08 16:52:41 INFO mapreduce.Job:  map 39% reduce 12%
16/12/08 16:52:42 INFO mapreduce.Job:  map 42% reduce 12%
16/12/08 16:52:43 INFO mapreduce.Job:  map 42% reduce 13%
16/12/08 16:52:44 INFO mapreduce.Job:  map 43% reduce 14%
16/12/08 16:52:48 INFO mapreduce.Job:  map 44% reduce 14%
16/12/08 16:52:49 INFO mapreduce.Job:  map 46% reduce 14%
16/12/08 16:52:50 INFO mapreduce.Job:  map 47% reduce 14%
16/12/08 16:52:51 INFO mapreduce.Job:  map 49% reduce 15%
16/12/08 16:52:52 INFO mapreduce.Job:  map 52% reduce 15%
16/12/08 16:52:53 INFO mapreduce.Job:  map 57% reduce 16%
16/12/08 16:52:55 INFO mapreduce.Job:  map 60% reduce 17%
16/12/08 16:52:56 INFO mapreduce.Job:  map 60% reduce 18%
16/12/08 16:52:57 INFO mapreduce.Job:  map 62% reduce 19%
16/12/08 16:52:58 INFO mapreduce.Job:  map 64% reduce 19%
16/12/08 16:52:59 INFO mapreduce.Job:  map 64% reduce 20%
16/12/08 16:53:00 INFO mapreduce.Job:  map 66% reduce 20%
16/12/08 16:53:01 INFO mapreduce.Job:  map 67% reduce 21%
16/12/08 16:53:02 INFO mapreduce.Job:  map 69% reduce 21%
16/12/08 16:53:03 INFO mapreduce.Job:  map 71% reduce 22%
16/12/08 16:53:04 INFO mapreduce.Job:  map 73% reduce 22%
16/12/08 16:53:05 INFO mapreduce.Job:  map 74% reduce 23%
16/12/08 16:53:06 INFO mapreduce.Job:  map 76% reduce 24%
16/12/08 16:53:07 INFO mapreduce.Job:  map 77% reduce 24%
16/12/08 16:53:08 INFO mapreduce.Job:  map 78% reduce 25%
16/12/08 16:53:09 INFO mapreduce.Job:  map 79% reduce 25%
16/12/08 16:53:11 INFO mapreduce.Job:  map 79% reduce 26%
16/12/08 16:53:12 INFO mapreduce.Job:  map 80% reduce 26%
16/12/08 16:53:14 INFO mapreduce.Job:  map 81% reduce 26%
16/12/08 16:53:17 INFO mapreduce.Job:  map 82% reduce 26%
16/12/08 16:53:19 INFO mapreduce.Job:  map 83% reduce 26%
16/12/08 16:53:21 INFO mapreduce.Job:  map 83% reduce 27%
16/12/08 16:53:22 INFO mapreduce.Job:  map 84% reduce 27%
16/12/08 16:53:24 INFO mapreduce.Job:  map 84% reduce 28%
16/12/08 16:53:26 INFO mapreduce.Job:  map 85% reduce 28%
16/12/08 16:53:27 INFO mapreduce.Job:  map 86% reduce 28%
16/12/08 16:53:28 INFO mapreduce.Job:  map 87% reduce 28%
16/12/08 16:53:29 INFO mapreduce.Job:  map 90% reduce 28%
16/12/08 16:53:30 INFO mapreduce.Job:  map 92% reduce 29%
16/12/08 16:53:31 INFO mapreduce.Job:  map 92% reduce 30%
16/12/08 16:53:33 INFO mapreduce.Job:  map 93% reduce 31%
16/12/08 16:53:34 INFO mapreduce.Job:  map 95% reduce 31%
16/12/08 16:53:35 INFO mapreduce.Job:  map 96% reduce 31%
16/12/08 16:53:36 INFO mapreduce.Job:  map 97% reduce 31%
16/12/08 16:53:37 INFO mapreduce.Job:  map 98% reduce 32%
16/12/08 16:53:38 INFO mapreduce.Job:  map 99% reduce 32%
16/12/08 16:53:39 INFO mapreduce.Job:  map 100% reduce 33%
16/12/08 16:53:40 INFO mapreduce.Job:  map 100% reduce 38%
16/12/08 16:53:41 INFO mapreduce.Job:  map 100% reduce 47%
16/12/08 16:53:42 INFO mapreduce.Job:  map 100% reduce 60%
16/12/08 16:53:43 INFO mapreduce.Job:  map 100% reduce 69%
16/12/08 16:53:44 INFO mapreduce.Job:  map 100% reduce 72%
16/12/08 16:53:45 INFO mapreduce.Job:  map 100% reduce 76%
16/12/08 16:53:46 INFO mapreduce.Job:  map 100% reduce 80%
16/12/08 16:53:47 INFO mapreduce.Job:  map 100% reduce 82%
16/12/08 16:53:48 INFO mapreduce.Job:  map 100% reduce 89%
16/12/08 16:53:49 INFO mapreduce.Job:  map 100% reduce 93%
16/12/08 16:53:50 INFO mapreduce.Job:  map 100% reduce 95%
16/12/08 16:53:51 INFO mapreduce.Job:  map 100% reduce 99%
16/12/08 16:53:53 INFO mapreduce.Job:  map 100% reduce 100%
16/12/08 16:53:57 INFO mapreduce.Job: Job job_1480588584072_5763 completed successfully
16/12/08 16:53:58 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=942324300
		FILE: Number of bytes written=1917030565
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=796248734
		WASB: Number of bytes written=499335255
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=14174244
		Total time spent by all reduces in occupied slots (ms)=4035148
		Total time spent by all map tasks (ms)=7087122
		Total time spent by all reduce tasks (ms)=2017574
		Total vcore-seconds taken by all map tasks=7087122
		Total vcore-seconds taken by all reduce tasks=2017574
		Total megabyte-seconds taken by all map tasks=7257212928
		Total megabyte-seconds taken by all reduce tasks=2065995776
	Map-Reduce Framework
		Map input records=2732110
		Map output records=2394408
		Map output bytes=933395527
		Map output materialized bytes=942347820
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2142865
		Reduce shuffle bytes=942347820
		Reduce input records=2394408
		Reduce output records=1546105
		Spilled Records=4788816
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=81188
		CPU time spent (ms)=999270
		Physical memory (bytes) snapshot=325478854656
		Virtual memory (bytes) snapshot=743107952640
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=793552730
	File Output Format Counters 
		Bytes Written=499335255
16/12/08 16:53:58 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080700 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080700
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7231612725442192768.jar tmpDir=null
16/12/08 16:54:35 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 16:54:36 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 16:54:36 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 16:54:38 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 16:54:38 INFO mapreduce.JobSubmitter: number of splits:197
16/12/08 16:54:38 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5764
16/12/08 16:54:39 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5764
16/12/08 16:54:39 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5764/
16/12/08 16:54:39 INFO mapreduce.Job: Running job: job_1480588584072_5764
16/12/08 16:54:52 INFO mapreduce.Job: Job job_1480588584072_5764 running in uber mode : false
16/12/08 16:54:52 INFO mapreduce.Job:  map 0% reduce 0%
16/12/08 16:55:02 INFO mapreduce.Job:  map 2% reduce 0%
16/12/08 16:55:11 INFO mapreduce.Job:  map 3% reduce 0%
16/12/08 16:55:12 INFO mapreduce.Job:  map 4% reduce 0%
16/12/08 16:55:15 INFO mapreduce.Job:  map 9% reduce 0%
16/12/08 16:55:16 INFO mapreduce.Job:  map 11% reduce 0%
16/12/08 16:55:19 INFO mapreduce.Job:  map 13% reduce 0%
16/12/08 16:55:20 INFO mapreduce.Job:  map 14% reduce 0%
16/12/08 16:55:21 INFO mapreduce.Job:  map 15% reduce 0%
16/12/08 16:55:22 INFO mapreduce.Job:  map 17% reduce 0%
16/12/08 16:55:23 INFO mapreduce.Job:  map 19% reduce 0%
16/12/08 16:55:27 INFO mapreduce.Job:  map 20% reduce 0%
16/12/08 16:55:28 INFO mapreduce.Job:  map 23% reduce 0%
16/12/08 16:55:29 INFO mapreduce.Job:  map 25% reduce 0%
16/12/08 16:55:31 INFO mapreduce.Job:  map 25% reduce 1%
16/12/08 16:55:32 INFO mapreduce.Job:  map 25% reduce 2%
16/12/08 16:55:33 INFO mapreduce.Job:  map 26% reduce 2%
16/12/08 16:55:35 INFO mapreduce.Job:  map 26% reduce 3%
16/12/08 16:55:37 INFO mapreduce.Job:  map 27% reduce 3%
16/12/08 16:55:38 INFO mapreduce.Job:  map 28% reduce 4%
16/12/08 16:55:39 INFO mapreduce.Job:  map 31% reduce 5%
16/12/08 16:55:40 INFO mapreduce.Job:  map 31% reduce 6%
16/12/08 16:55:41 INFO mapreduce.Job:  map 31% reduce 9%
16/12/08 16:55:44 INFO mapreduce.Job:  map 31% reduce 10%
16/12/08 16:55:45 INFO mapreduce.Job:  map 32% reduce 10%
16/12/08 16:55:46 INFO mapreduce.Job:  map 35% reduce 10%
16/12/08 16:55:47 INFO mapreduce.Job:  map 35% reduce 11%
16/12/08 16:55:48 INFO mapreduce.Job:  map 36% reduce 11%
16/12/08 16:55:50 INFO mapreduce.Job:  map 36% reduce 12%
16/12/08 16:55:51 INFO mapreduce.Job:  map 37% reduce 12%
16/12/08 16:55:52 INFO mapreduce.Job:  map 38% reduce 12%
16/12/08 16:55:53 INFO mapreduce.Job:  map 39% reduce 12%
16/12/08 16:55:55 INFO mapreduce.Job:  map 40% reduce 13%
16/12/08 16:55:57 INFO mapreduce.Job:  map 42% reduce 13%
16/12/08 16:55:59 INFO mapreduce.Job:  map 43% reduce 14%
16/12/08 16:56:00 INFO mapreduce.Job:  map 45% reduce 14%
16/12/08 16:56:02 INFO mapreduce.Job:  map 45% reduce 15%
16/12/08 16:56:04 INFO mapreduce.Job:  map 47% reduce 15%
16/12/08 16:56:05 INFO mapreduce.Job:  map 48% reduce 15%
16/12/08 16:56:06 INFO mapreduce.Job:  map 50% reduce 15%
16/12/08 16:56:07 INFO mapreduce.Job:  map 52% reduce 16%
16/12/08 16:56:08 INFO mapreduce.Job:  map 54% reduce 17%
16/12/08 16:56:09 INFO mapreduce.Job:  map 55% reduce 17%
16/12/08 16:56:10 INFO mapreduce.Job:  map 56% reduce 17%
16/12/08 16:56:11 INFO mapreduce.Job:  map 57% reduce 17%
16/12/08 16:56:12 INFO mapreduce.Job:  map 59% reduce 18%
16/12/08 16:56:13 INFO mapreduce.Job:  map 61% reduce 18%
16/12/08 16:56:14 INFO mapreduce.Job:  map 64% reduce 19%
16/12/08 16:56:15 INFO mapreduce.Job:  map 65% reduce 20%
16/12/08 16:56:16 INFO mapreduce.Job:  map 67% reduce 20%
16/12/08 16:56:17 INFO mapreduce.Job:  map 69% reduce 21%
16/12/08 16:56:18 INFO mapreduce.Job:  map 70% reduce 21%
16/12/08 16:56:19 INFO mapreduce.Job:  map 71% reduce 22%
16/12/08 16:56:20 INFO mapreduce.Job:  map 73% reduce 22%
16/12/08 16:56:21 INFO mapreduce.Job:  map 74% reduce 23%
16/12/08 16:56:22 INFO mapreduce.Job:  map 77% reduce 23%
16/12/08 16:56:23 INFO mapreduce.Job:  map 78% reduce 23%
16/12/08 16:56:24 INFO mapreduce.Job:  map 79% reduce 24%
16/12/08 16:56:25 INFO mapreduce.Job:  map 80% reduce 24%
16/12/08 16:56:27 INFO mapreduce.Job:  map 81% reduce 24%
16/12/08 16:56:28 INFO mapreduce.Job:  map 82% reduce 24%
16/12/08 16:56:29 INFO mapreduce.Job:  map 82% reduce 25%
16/12/08 16:56:31 INFO mapreduce.Job:  map 83% reduce 25%
16/12/08 16:56:32 INFO mapreduce.Job:  map 84% reduce 25%
16/12/08 16:56:33 INFO mapreduce.Job:  map 85% reduce 26%
16/12/08 16:56:35 INFO mapreduce.Job:  map 86% reduce 27%
16/12/08 16:56:36 INFO mapreduce.Job:  map 88% reduce 27%
16/12/08 16:56:37 INFO mapreduce.Job:  map 88% reduce 28%
16/12/08 16:56:38 INFO mapreduce.Job:  map 88% reduce 29%
16/12/08 16:56:47 INFO mapreduce.Job:  map 89% reduce 29%
16/12/08 16:56:49 INFO mapreduce.Job:  map 90% reduce 29%
16/12/08 16:56:52 INFO mapreduce.Job:  map 91% reduce 30%
16/12/08 16:56:55 INFO mapreduce.Job:  map 92% reduce 30%
16/12/08 16:56:57 INFO mapreduce.Job:  map 93% reduce 30%
16/12/08 16:56:58 INFO mapreduce.Job:  map 95% reduce 30%
16/12/08 16:56:59 INFO mapreduce.Job:  map 97% reduce 31%
16/12/08 16:57:00 INFO mapreduce.Job:  map 99% reduce 31%
16/12/08 16:57:01 INFO mapreduce.Job:  map 100% reduce 33%
16/12/08 16:57:02 INFO mapreduce.Job:  map 100% reduce 37%
16/12/08 16:57:03 INFO mapreduce.Job:  map 100% reduce 42%
16/12/08 16:57:04 INFO mapreduce.Job:  map 100% reduce 55%
16/12/08 16:57:05 INFO mapreduce.Job:  map 100% reduce 66%
16/12/08 16:57:06 INFO mapreduce.Job:  map 100% reduce 70%
16/12/08 16:57:07 INFO mapreduce.Job:  map 100% reduce 74%
16/12/08 16:57:08 INFO mapreduce.Job:  map 100% reduce 80%
16/12/08 16:57:09 INFO mapreduce.Job:  map 100% reduce 83%
16/12/08 16:57:10 INFO mapreduce.Job:  map 100% reduce 89%
16/12/08 16:57:11 INFO mapreduce.Job:  map 100% reduce 92%
16/12/08 16:57:12 INFO mapreduce.Job:  map 100% reduce 93%
16/12/08 16:57:13 INFO mapreduce.Job:  map 100% reduce 95%
16/12/08 16:57:14 INFO mapreduce.Job:  map 100% reduce 97%
16/12/08 16:57:15 INFO mapreduce.Job:  map 100% reduce 98%
16/12/08 16:57:16 INFO mapreduce.Job:  map 100% reduce 99%
16/12/08 16:57:17 INFO mapreduce.Job:  map 100% reduce 100%
16/12/08 16:57:21 INFO mapreduce.Job: Job job_1480588584072_5764 completed successfully
16/12/08 16:57:21 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=955919814
		FILE: Number of bytes written=1944221593
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=806944267
		WASB: Number of bytes written=507268095
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=14789004
		Total time spent by all reduces in occupied slots (ms)=4358634
		Total time spent by all map tasks (ms)=7394502
		Total time spent by all reduce tasks (ms)=2179317
		Total vcore-seconds taken by all map tasks=7394502
		Total vcore-seconds taken by all reduce tasks=2179317
		Total megabyte-seconds taken by all map tasks=7571970048
		Total megabyte-seconds taken by all reduce tasks=2231620608
	Map-Reduce Framework
		Map input records=2747371
		Map output records=2414797
		Map output bytes=946869531
		Map output materialized bytes=955943334
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2153866
		Reduce shuffle bytes=955943334
		Reduce input records=2414797
		Reduce output records=1558851
		Spilled Records=4829594
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=79036
		CPU time spent (ms)=1031040
		Physical memory (bytes) snapshot=325839941632
		Virtual memory (bytes) snapshot=742870679552
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=804248263
	File Output Format Counters 
		Bytes Written=507268095
16/12/08 16:57:21 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15/* not ready, wait 300s
^[hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080800 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080800
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4648272344951684978.jar tmpDir=null
16/12/08 17:48:31 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 17:48:32 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 17:48:33 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 17:48:34 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 17:48:35 INFO mapreduce.JobSubmitter: number of splits:197
16/12/08 17:48:35 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5805
16/12/08 17:48:36 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5805
16/12/08 17:48:36 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5805/
16/12/08 17:48:36 INFO mapreduce.Job: Running job: job_1480588584072_5805
16/12/08 17:48:49 INFO mapreduce.Job: Job job_1480588584072_5805 running in uber mode : false
16/12/08 17:48:49 INFO mapreduce.Job:  map 0% reduce 0%
16/12/08 17:49:04 INFO mapreduce.Job:  map 1% reduce 0%
16/12/08 17:49:13 INFO mapreduce.Job:  map 2% reduce 0%
16/12/08 17:49:14 INFO mapreduce.Job:  map 3% reduce 0%
16/12/08 17:49:15 INFO mapreduce.Job:  map 4% reduce 0%
16/12/08 17:49:23 INFO mapreduce.Job:  map 6% reduce 0%
16/12/08 17:49:26 INFO mapreduce.Job:  map 7% reduce 0%
16/12/08 17:49:29 INFO mapreduce.Job:  map 8% reduce 0%
16/12/08 17:49:30 INFO mapreduce.Job:  map 9% reduce 0%
16/12/08 17:49:31 INFO mapreduce.Job:  map 10% reduce 0%
16/12/08 17:49:32 INFO mapreduce.Job:  map 11% reduce 0%
16/12/08 17:49:36 INFO mapreduce.Job:  map 12% reduce 0%
16/12/08 17:49:40 INFO mapreduce.Job:  map 13% reduce 0%
16/12/08 17:49:44 INFO mapreduce.Job:  map 14% reduce 0%
16/12/08 17:49:45 INFO mapreduce.Job:  map 16% reduce 0%
16/12/08 17:49:48 INFO mapreduce.Job:  map 19% reduce 0%
16/12/08 17:49:49 INFO mapreduce.Job:  map 23% reduce 0%
16/12/08 17:49:52 INFO mapreduce.Job:  map 25% reduce 1%
16/12/08 17:49:56 INFO mapreduce.Job:  map 28% reduce 2%
16/12/08 17:49:58 INFO mapreduce.Job:  map 28% reduce 4%
16/12/08 17:49:59 INFO mapreduce.Job:  map 29% reduce 4%
16/12/08 17:50:00 INFO mapreduce.Job:  map 31% reduce 4%
16/12/08 17:50:02 INFO mapreduce.Job:  map 34% reduce 4%
16/12/08 17:50:06 INFO mapreduce.Job:  map 37% reduce 6%
16/12/08 17:50:07 INFO mapreduce.Job:  map 37% reduce 7%
16/12/08 17:50:08 INFO mapreduce.Job:  map 38% reduce 10%
16/12/08 17:50:09 INFO mapreduce.Job:  map 41% reduce 10%
16/12/08 17:50:11 INFO mapreduce.Job:  map 43% reduce 10%
16/12/08 17:50:13 INFO mapreduce.Job:  map 45% reduce 11%
16/12/08 17:50:14 INFO mapreduce.Job:  map 46% reduce 12%
16/12/08 17:50:15 INFO mapreduce.Job:  map 48% reduce 13%
16/12/08 17:50:16 INFO mapreduce.Job:  map 49% reduce 13%
16/12/08 17:50:18 INFO mapreduce.Job:  map 52% reduce 15%
16/12/08 17:50:19 INFO mapreduce.Job:  map 54% reduce 15%
16/12/08 17:50:20 INFO mapreduce.Job:  map 56% reduce 15%
16/12/08 17:50:21 INFO mapreduce.Job:  map 58% reduce 17%
16/12/08 17:50:22 INFO mapreduce.Job:  map 62% reduce 17%
16/12/08 17:50:23 INFO mapreduce.Job:  map 63% reduce 17%
16/12/08 17:50:24 INFO mapreduce.Job:  map 65% reduce 19%
16/12/08 17:50:25 INFO mapreduce.Job:  map 67% reduce 20%
16/12/08 17:50:28 INFO mapreduce.Job:  map 70% reduce 21%
16/12/08 17:50:30 INFO mapreduce.Job:  map 72% reduce 22%
16/12/08 17:50:32 INFO mapreduce.Job:  map 74% reduce 22%
16/12/08 17:50:34 INFO mapreduce.Job:  map 76% reduce 23%
16/12/08 17:50:35 INFO mapreduce.Job:  map 77% reduce 23%
16/12/08 17:50:36 INFO mapreduce.Job:  map 78% reduce 24%
16/12/08 17:50:37 INFO mapreduce.Job:  map 80% reduce 25%
16/12/08 17:50:41 INFO mapreduce.Job:  map 82% reduce 26%
16/12/08 17:50:42 INFO mapreduce.Job:  map 82% reduce 27%
16/12/08 17:50:43 INFO mapreduce.Job:  map 84% reduce 27%
16/12/08 17:50:45 INFO mapreduce.Job:  map 84% reduce 28%
16/12/08 17:50:48 INFO mapreduce.Job:  map 85% reduce 28%
16/12/08 17:50:50 INFO mapreduce.Job:  map 86% reduce 28%
16/12/08 17:50:51 INFO mapreduce.Job:  map 87% reduce 28%
16/12/08 17:50:52 INFO mapreduce.Job:  map 88% reduce 28%
16/12/08 17:50:53 INFO mapreduce.Job:  map 89% reduce 29%
16/12/08 17:50:54 INFO mapreduce.Job:  map 90% reduce 29%
16/12/08 17:50:56 INFO mapreduce.Job:  map 91% reduce 30%
16/12/08 17:50:58 INFO mapreduce.Job:  map 92% reduce 30%
16/12/08 17:51:01 INFO mapreduce.Job:  map 93% reduce 30%
16/12/08 17:51:02 INFO mapreduce.Job:  map 94% reduce 31%
16/12/08 17:51:04 INFO mapreduce.Job:  map 95% reduce 31%
16/12/08 17:51:06 INFO mapreduce.Job:  map 96% reduce 31%
16/12/08 17:51:07 INFO mapreduce.Job:  map 96% reduce 32%
16/12/08 17:51:08 INFO mapreduce.Job:  map 97% reduce 32%
16/12/08 17:51:09 INFO mapreduce.Job:  map 99% reduce 32%
16/12/08 17:51:11 INFO mapreduce.Job:  map 99% reduce 33%
16/12/08 17:51:15 INFO mapreduce.Job:  map 100% reduce 33%
16/12/08 17:51:16 INFO mapreduce.Job:  map 100% reduce 34%
16/12/08 17:51:17 INFO mapreduce.Job:  map 100% reduce 36%
16/12/08 17:51:18 INFO mapreduce.Job:  map 100% reduce 48%
16/12/08 17:51:19 INFO mapreduce.Job:  map 100% reduce 65%
16/12/08 17:51:20 INFO mapreduce.Job:  map 100% reduce 69%
16/12/08 17:51:21 INFO mapreduce.Job:  map 100% reduce 74%
16/12/08 17:51:22 INFO mapreduce.Job:  map 100% reduce 81%
16/12/08 17:51:23 INFO mapreduce.Job:  map 100% reduce 82%
16/12/08 17:51:24 INFO mapreduce.Job:  map 100% reduce 89%
16/12/08 17:51:25 INFO mapreduce.Job:  map 100% reduce 95%
16/12/08 17:51:26 INFO mapreduce.Job:  map 100% reduce 98%
16/12/08 17:51:27 INFO mapreduce.Job:  map 100% reduce 99%
16/12/08 17:51:28 INFO mapreduce.Job:  map 100% reduce 100%
16/12/08 17:51:31 INFO mapreduce.Job: Job job_1480588584072_5805 completed successfully
16/12/08 17:51:31 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=1004765390
		FILE: Number of bytes written=2041912745
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=859494315
		WASB: Number of bytes written=540669192
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=10590922
		Total time spent by all reduces in occupied slots (ms)=4050468
		Total time spent by all map tasks (ms)=5295461
		Total time spent by all reduce tasks (ms)=2025234
		Total vcore-seconds taken by all map tasks=5295461
		Total vcore-seconds taken by all reduce tasks=2025234
		Total megabyte-seconds taken by all map tasks=5422552064
		Total megabyte-seconds taken by all reduce tasks=2073839616
	Map-Reduce Framework
		Map input records=2934684
		Map output records=2521103
		Map output bytes=995289982
		Map output materialized bytes=1004788910
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2249807
		Reduce shuffle bytes=1004788910
		Reduce input records=2521103
		Reduce output records=1649921
		Spilled Records=5042206
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=84815
		CPU time spent (ms)=1011560
		Physical memory (bytes) snapshot=325717872640
		Virtual memory (bytes) snapshot=742833438720
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=856798311
	File Output Format Counters 
		Bytes Written=540669192
16/12/08 17:51:31 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080900 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080900
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7690316858470659195.jar tmpDir=null
16/12/08 18:47:43 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 18:47:44 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 18:47:45 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 18:47:46 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 18:47:47 INFO mapreduce.JobSubmitter: number of splits:197
16/12/08 18:47:47 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5849
16/12/08 18:47:48 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5849
16/12/08 18:47:48 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5849/
16/12/08 18:47:48 INFO mapreduce.Job: Running job: job_1480588584072_5849
16/12/08 18:48:41 INFO mapreduce.Job: Job job_1480588584072_5849 running in uber mode : false
16/12/08 18:48:41 INFO mapreduce.Job:  map 0% reduce 0%
16/12/08 18:48:51 INFO mapreduce.Job:  map 1% reduce 0%
16/12/08 18:48:56 INFO mapreduce.Job:  map 3% reduce 0%
16/12/08 18:48:58 INFO mapreduce.Job:  map 4% reduce 0%
16/12/08 18:49:01 INFO mapreduce.Job:  map 5% reduce 0%
16/12/08 18:49:05 INFO mapreduce.Job:  map 6% reduce 0%
16/12/08 18:49:07 INFO mapreduce.Job:  map 7% reduce 0%
16/12/08 18:49:12 INFO mapreduce.Job:  map 8% reduce 0%
16/12/08 18:49:14 INFO mapreduce.Job:  map 10% reduce 0%
16/12/08 18:49:16 INFO mapreduce.Job:  map 11% reduce 0%
16/12/08 18:49:17 INFO mapreduce.Job:  map 12% reduce 0%
16/12/08 18:49:23 INFO mapreduce.Job:  map 13% reduce 0%
16/12/08 18:49:24 INFO mapreduce.Job:  map 14% reduce 0%
16/12/08 18:49:26 INFO mapreduce.Job:  map 15% reduce 0%
16/12/08 18:49:28 INFO mapreduce.Job:  map 16% reduce 0%
16/12/08 18:49:30 INFO mapreduce.Job:  map 18% reduce 0%
16/12/08 18:49:32 INFO mapreduce.Job:  map 19% reduce 0%
16/12/08 18:49:33 INFO mapreduce.Job:  map 20% reduce 0%
16/12/08 18:49:34 INFO mapreduce.Job:  map 25% reduce 0%
16/12/08 18:49:35 INFO mapreduce.Job:  map 27% reduce 1%
16/12/08 18:49:36 INFO mapreduce.Job:  map 29% reduce 1%
16/12/08 18:49:37 INFO mapreduce.Job:  map 30% reduce 1%
16/12/08 18:49:38 INFO mapreduce.Job:  map 31% reduce 1%
16/12/08 18:49:39 INFO mapreduce.Job:  map 31% reduce 2%
16/12/08 18:49:40 INFO mapreduce.Job:  map 32% reduce 2%
16/12/08 18:49:41 INFO mapreduce.Job:  map 32% reduce 3%
16/12/08 18:49:43 INFO mapreduce.Job:  map 33% reduce 3%
16/12/08 18:49:44 INFO mapreduce.Job:  map 36% reduce 3%
16/12/08 18:49:45 INFO mapreduce.Job:  map 39% reduce 3%
16/12/08 18:49:46 INFO mapreduce.Job:  map 42% reduce 3%
16/12/08 18:49:47 INFO mapreduce.Job:  map 43% reduce 4%
16/12/08 18:49:48 INFO mapreduce.Job:  map 44% reduce 4%
16/12/08 18:49:49 INFO mapreduce.Job:  map 45% reduce 5%
16/12/08 18:49:51 INFO mapreduce.Job:  map 46% reduce 7%
16/12/08 18:49:52 INFO mapreduce.Job:  map 47% reduce 7%
16/12/08 18:49:53 INFO mapreduce.Job:  map 48% reduce 8%
16/12/08 18:49:54 INFO mapreduce.Job:  map 49% reduce 8%
16/12/08 18:49:55 INFO mapreduce.Job:  map 50% reduce 9%
16/12/08 18:49:56 INFO mapreduce.Job:  map 51% reduce 9%
16/12/08 18:49:57 INFO mapreduce.Job:  map 54% reduce 9%
16/12/08 18:49:58 INFO mapreduce.Job:  map 55% reduce 10%
16/12/08 18:49:59 INFO mapreduce.Job:  map 56% reduce 11%
16/12/08 18:50:00 INFO mapreduce.Job:  map 57% reduce 14%
16/12/08 18:50:02 INFO mapreduce.Job:  map 58% reduce 14%
16/12/08 18:50:03 INFO mapreduce.Job:  map 60% reduce 15%
16/12/08 18:50:04 INFO mapreduce.Job:  map 60% reduce 16%
16/12/08 18:50:05 INFO mapreduce.Job:  map 61% reduce 16%
16/12/08 18:50:06 INFO mapreduce.Job:  map 62% reduce 16%
16/12/08 18:50:07 INFO mapreduce.Job:  map 63% reduce 17%
16/12/08 18:50:08 INFO mapreduce.Job:  map 65% reduce 17%
16/12/08 18:50:09 INFO mapreduce.Job:  map 66% reduce 18%
16/12/08 18:50:10 INFO mapreduce.Job:  map 69% reduce 18%
16/12/08 18:50:11 INFO mapreduce.Job:  map 69% reduce 19%
16/12/08 18:50:12 INFO mapreduce.Job:  map 70% reduce 19%
16/12/08 18:50:13 INFO mapreduce.Job:  map 71% reduce 20%
16/12/08 18:50:15 INFO mapreduce.Job:  map 72% reduce 20%
16/12/08 18:50:16 INFO mapreduce.Job:  map 73% reduce 20%
16/12/08 18:50:17 INFO mapreduce.Job:  map 75% reduce 20%
16/12/08 18:50:18 INFO mapreduce.Job:  map 77% reduce 21%
16/12/08 18:50:20 INFO mapreduce.Job:  map 79% reduce 21%
16/12/08 18:50:21 INFO mapreduce.Job:  map 80% reduce 22%
16/12/08 18:50:22 INFO mapreduce.Job:  map 81% reduce 22%
16/12/08 18:50:24 INFO mapreduce.Job:  map 82% reduce 23%
16/12/08 18:50:25 INFO mapreduce.Job:  map 84% reduce 23%
16/12/08 18:50:26 INFO mapreduce.Job:  map 85% reduce 23%
16/12/08 18:50:27 INFO mapreduce.Job:  map 85% reduce 24%
16/12/08 18:50:28 INFO mapreduce.Job:  map 86% reduce 24%
16/12/08 18:50:29 INFO mapreduce.Job:  map 88% reduce 24%
16/12/08 18:50:30 INFO mapreduce.Job:  map 88% reduce 25%
16/12/08 18:50:31 INFO mapreduce.Job:  map 90% reduce 25%
16/12/08 18:50:32 INFO mapreduce.Job:  map 93% reduce 25%
16/12/08 18:50:33 INFO mapreduce.Job:  map 94% reduce 26%
16/12/08 18:50:36 INFO mapreduce.Job:  map 95% reduce 26%
16/12/08 18:50:37 INFO mapreduce.Job:  map 96% reduce 27%
16/12/08 18:50:38 INFO mapreduce.Job:  map 98% reduce 27%
16/12/08 18:50:39 INFO mapreduce.Job:  map 99% reduce 27%
16/12/08 18:50:40 INFO mapreduce.Job:  map 100% reduce 28%
16/12/08 18:50:41 INFO mapreduce.Job:  map 100% reduce 30%
16/12/08 18:50:42 INFO mapreduce.Job:  map 100% reduce 34%
16/12/08 18:50:43 INFO mapreduce.Job:  map 100% reduce 45%
16/12/08 18:50:44 INFO mapreduce.Job:  map 100% reduce 55%
16/12/08 18:50:45 INFO mapreduce.Job:  map 100% reduce 60%
16/12/08 18:50:46 INFO mapreduce.Job:  map 100% reduce 68%
16/12/08 18:50:47 INFO mapreduce.Job:  map 100% reduce 80%
16/12/08 18:50:48 INFO mapreduce.Job:  map 100% reduce 83%
16/12/08 18:50:49 INFO mapreduce.Job:  map 100% reduce 89%
16/12/08 18:50:50 INFO mapreduce.Job:  map 100% reduce 96%
16/12/08 18:50:51 INFO mapreduce.Job:  map 100% reduce 97%
16/12/08 18:50:52 INFO mapreduce.Job:  map 100% reduce 99%
16/12/08 18:50:53 INFO mapreduce.Job:  map 100% reduce 100%
16/12/08 18:50:57 INFO mapreduce.Job: Job job_1480588584072_5849 completed successfully
16/12/08 18:50:57 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=1042290692
		FILE: Number of bytes written=2116963349
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=900445191
		WASB: Number of bytes written=572877988
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=3561406
		Total time spent by all reduces in occupied slots (ms)=2549212
		Total time spent by all map tasks (ms)=1780703
		Total time spent by all reduce tasks (ms)=1274606
		Total vcore-seconds taken by all map tasks=1780703
		Total vcore-seconds taken by all reduce tasks=1274606
		Total megabyte-seconds taken by all map tasks=1823439872
		Total megabyte-seconds taken by all reduce tasks=1305196544
	Map-Reduce Framework
		Map input records=3088679
		Map output records=2604871
		Map output bytes=1032479088
		Map output materialized bytes=1042314212
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2329508
		Reduce shuffle bytes=1042314212
		Reduce input records=2604871
		Reduce output records=1735789
		Spilled Records=5209742
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=23520
		CPU time spent (ms)=918970
		Physical memory (bytes) snapshot=325118697472
		Virtual memory (bytes) snapshot=743215001600
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=897749187
	File Output Format Counters 
		Bytes Written=572877988
16/12/08 18:50:57 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1400 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1400': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8945034980138799914.jar tmpDir=null
16/12/08 19:42:05 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 19:42:06 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 19:42:06 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 19:42:09 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 19:42:09 INFO mapreduce.JobSubmitter: number of splits:197
16/12/08 19:42:09 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5908
16/12/08 19:42:10 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5908
16/12/08 19:42:10 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5908/
16/12/08 19:42:10 INFO mapreduce.Job: Running job: job_1480588584072_5908
16/12/08 19:43:39 INFO mapreduce.Job: Job job_1480588584072_5908 running in uber mode : false
16/12/08 19:43:39 INFO mapreduce.Job:  map 0% reduce 0%
16/12/08 19:43:51 INFO mapreduce.Job:  map 2% reduce 0%
16/12/08 19:43:59 INFO mapreduce.Job:  map 3% reduce 0%
16/12/08 19:44:00 INFO mapreduce.Job:  map 4% reduce 0%
16/12/08 19:44:02 INFO mapreduce.Job:  map 7% reduce 0%
16/12/08 19:44:03 INFO mapreduce.Job:  map 10% reduce 0%
16/12/08 19:44:04 INFO mapreduce.Job:  map 14% reduce 0%
16/12/08 19:44:05 INFO mapreduce.Job:  map 16% reduce 0%
16/12/08 19:44:06 INFO mapreduce.Job:  map 18% reduce 0%
16/12/08 19:44:07 INFO mapreduce.Job:  map 21% reduce 0%
16/12/08 19:44:08 INFO mapreduce.Job:  map 22% reduce 0%
16/12/08 19:44:14 INFO mapreduce.Job:  map 23% reduce 0%
16/12/08 19:44:15 INFO mapreduce.Job:  map 25% reduce 0%
16/12/08 19:44:16 INFO mapreduce.Job:  map 26% reduce 0%
16/12/08 19:44:17 INFO mapreduce.Job:  map 27% reduce 0%
16/12/08 19:44:18 INFO mapreduce.Job:  map 28% reduce 0%
16/12/08 19:44:19 INFO mapreduce.Job:  map 31% reduce 1%
16/12/08 19:44:20 INFO mapreduce.Job:  map 33% reduce 3%
16/12/08 19:44:21 INFO mapreduce.Job:  map 36% reduce 3%
16/12/08 19:44:22 INFO mapreduce.Job:  map 37% reduce 3%
16/12/08 19:44:23 INFO mapreduce.Job:  map 37% reduce 4%
16/12/08 19:44:26 INFO mapreduce.Job:  map 39% reduce 4%
16/12/08 19:44:27 INFO mapreduce.Job:  map 40% reduce 4%
16/12/08 19:44:28 INFO mapreduce.Job:  map 41% reduce 4%
16/12/08 19:44:29 INFO mapreduce.Job:  map 41% reduce 5%
16/12/08 19:44:30 INFO mapreduce.Job:  map 43% reduce 6%
16/12/08 19:44:31 INFO mapreduce.Job:  map 46% reduce 6%
16/12/08 19:44:33 INFO mapreduce.Job:  map 47% reduce 7%
16/12/08 19:44:34 INFO mapreduce.Job:  map 48% reduce 7%
16/12/08 19:44:35 INFO mapreduce.Job:  map 49% reduce 8%
16/12/08 19:44:36 INFO mapreduce.Job:  map 50% reduce 9%
16/12/08 19:44:38 INFO mapreduce.Job:  map 51% reduce 10%
16/12/08 19:44:39 INFO mapreduce.Job:  map 52% reduce 10%
16/12/08 19:44:40 INFO mapreduce.Job:  map 53% reduce 10%
16/12/08 19:44:41 INFO mapreduce.Job:  map 54% reduce 12%
16/12/08 19:44:43 INFO mapreduce.Job:  map 57% reduce 13%
16/12/08 19:44:44 INFO mapreduce.Job:  map 59% reduce 13%
16/12/08 19:44:46 INFO mapreduce.Job:  map 59% reduce 14%
16/12/08 19:44:47 INFO mapreduce.Job:  map 59% reduce 16%
16/12/08 19:44:48 INFO mapreduce.Job:  map 59% reduce 17%
16/12/08 19:44:49 INFO mapreduce.Job:  map 62% reduce 17%
16/12/08 19:44:50 INFO mapreduce.Job:  map 65% reduce 17%
16/12/08 19:44:52 INFO mapreduce.Job:  map 66% reduce 18%
16/12/08 19:44:53 INFO mapreduce.Job:  map 66% reduce 19%
16/12/08 19:44:55 INFO mapreduce.Job:  map 69% reduce 19%
16/12/08 19:44:57 INFO mapreduce.Job:  map 70% reduce 19%
16/12/08 19:44:58 INFO mapreduce.Job:  map 72% reduce 20%
16/12/08 19:44:59 INFO mapreduce.Job:  map 74% reduce 20%
16/12/08 19:45:00 INFO mapreduce.Job:  map 75% reduce 20%
16/12/08 19:45:01 INFO mapreduce.Job:  map 75% reduce 21%
16/12/08 19:45:02 INFO mapreduce.Job:  map 76% reduce 21%
16/12/08 19:45:04 INFO mapreduce.Job:  map 77% reduce 21%
16/12/08 19:45:05 INFO mapreduce.Job:  map 77% reduce 22%
16/12/08 19:45:06 INFO mapreduce.Job:  map 79% reduce 22%
16/12/08 19:45:07 INFO mapreduce.Job:  map 82% reduce 22%
16/12/08 19:45:08 INFO mapreduce.Job:  map 84% reduce 22%
16/12/08 19:45:09 INFO mapreduce.Job:  map 84% reduce 23%
16/12/08 19:45:11 INFO mapreduce.Job:  map 85% reduce 24%
16/12/08 19:45:14 INFO mapreduce.Job:  map 87% reduce 24%
16/12/08 19:45:15 INFO mapreduce.Job:  map 88% reduce 24%
16/12/08 19:45:16 INFO mapreduce.Job:  map 89% reduce 25%
16/12/08 19:45:17 INFO mapreduce.Job:  map 91% reduce 25%
16/12/08 19:45:18 INFO mapreduce.Job:  map 94% reduce 26%
16/12/08 19:45:21 INFO mapreduce.Job:  map 96% reduce 27%
16/12/08 19:45:22 INFO mapreduce.Job:  map 97% reduce 27%
16/12/08 19:45:25 INFO mapreduce.Job:  map 98% reduce 27%
16/12/08 19:45:26 INFO mapreduce.Job:  map 100% reduce 28%
16/12/08 19:45:27 INFO mapreduce.Job:  map 100% reduce 29%
16/12/08 19:45:28 INFO mapreduce.Job:  map 100% reduce 36%
16/12/08 19:45:29 INFO mapreduce.Job:  map 100% reduce 50%
16/12/08 19:45:30 INFO mapreduce.Job:  map 100% reduce 63%
16/12/08 19:45:31 INFO mapreduce.Job:  map 100% reduce 71%
16/12/08 19:45:32 INFO mapreduce.Job:  map 100% reduce 76%
16/12/08 19:45:33 INFO mapreduce.Job:  map 100% reduce 80%
16/12/08 19:45:34 INFO mapreduce.Job:  map 100% reduce 86%
16/12/08 19:45:35 INFO mapreduce.Job:  map 100% reduce 90%
16/12/08 19:45:36 INFO mapreduce.Job:  map 100% reduce 94%
16/12/08 19:45:37 INFO mapreduce.Job:  map 100% reduce 96%
16/12/08 19:45:38 INFO mapreduce.Job:  map 100% reduce 98%
16/12/08 19:45:39 INFO mapreduce.Job:  map 100% reduce 99%
16/12/08 19:45:40 INFO mapreduce.Job:  map 100% reduce 100%
16/12/08 19:45:45 INFO mapreduce.Job: Job job_1480588584072_5908 completed successfully
16/12/08 19:45:45 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=962115937
		FILE: Number of bytes written=1956613839
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=858140399
		WASB: Number of bytes written=491530264
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=4542754
		Total time spent by all reduces in occupied slots (ms)=2753682
		Total time spent by all map tasks (ms)=2271377
		Total time spent by all reduce tasks (ms)=1376841
		Total vcore-seconds taken by all map tasks=2271377
		Total vcore-seconds taken by all reduce tasks=1376841
		Total megabyte-seconds taken by all map tasks=2325890048
		Total megabyte-seconds taken by all reduce tasks=1409885184
	Map-Reduce Framework
		Map input records=3030933
		Map output records=2418463
		Map output bytes=953010808
		Map output materialized bytes=962139457
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2145736
		Reduce shuffle bytes=962139457
		Reduce input records=2418463
		Reduce output records=1495238
		Spilled Records=4836926
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=26059
		CPU time spent (ms)=925610
		Physical memory (bytes) snapshot=324920524800
		Virtual memory (bytes) snapshot=743085543424
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=855444395
	File Output Format Counters 
		Bytes Written=491530264
16/12/08 19:45:45 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1400
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1500 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1500': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob6340777915158403456.jar tmpDir=null
16/12/08 20:52:03 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 20:52:04 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 20:52:04 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 20:52:06 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 20:52:06 INFO mapreduce.JobSubmitter: number of splits:197
16/12/08 20:52:07 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5915
16/12/08 20:52:07 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5915
16/12/08 20:52:08 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5915/
16/12/08 20:52:08 INFO mapreduce.Job: Running job: job_1480588584072_5915
16/12/08 21:10:41 INFO mapreduce.Job: Job job_1480588584072_5915 running in uber mode : false
16/12/08 21:10:41 INFO mapreduce.Job:  map 0% reduce 0%
16/12/08 21:10:57 INFO mapreduce.Job:  map 1% reduce 0%
16/12/08 21:11:06 INFO mapreduce.Job:  map 2% reduce 0%
16/12/08 21:11:16 INFO mapreduce.Job:  map 3% reduce 0%
16/12/08 21:11:25 INFO mapreduce.Job:  map 4% reduce 0%
16/12/08 21:11:33 INFO mapreduce.Job:  map 5% reduce 0%
16/12/08 21:11:42 INFO mapreduce.Job:  map 6% reduce 0%
16/12/08 21:11:51 INFO mapreduce.Job:  map 7% reduce 0%
16/12/08 21:12:00 INFO mapreduce.Job:  map 8% reduce 0%
16/12/08 21:12:09 INFO mapreduce.Job:  map 9% reduce 0%
16/12/08 21:12:18 INFO mapreduce.Job:  map 10% reduce 0%
16/12/08 21:12:27 INFO mapreduce.Job:  map 11% reduce 0%
16/12/08 21:12:36 INFO mapreduce.Job:  map 12% reduce 0%
16/12/08 21:12:45 INFO mapreduce.Job:  map 13% reduce 0%
16/12/08 21:12:54 INFO mapreduce.Job:  map 14% reduce 0%
16/12/08 21:13:03 INFO mapreduce.Job:  map 15% reduce 0%
16/12/08 21:13:12 INFO mapreduce.Job:  map 16% reduce 0%
16/12/08 21:13:19 INFO mapreduce.Job:  map 17% reduce 0%
16/12/08 21:13:26 INFO mapreduce.Job:  map 18% reduce 0%
16/12/08 21:13:33 INFO mapreduce.Job:  map 19% reduce 0%
16/12/08 21:13:39 INFO mapreduce.Job:  map 20% reduce 0%
16/12/08 21:13:46 INFO mapreduce.Job:  map 21% reduce 0%
16/12/08 21:13:53 INFO mapreduce.Job:  map 22% reduce 0%
16/12/08 21:14:00 INFO mapreduce.Job:  map 23% reduce 0%
16/12/08 21:14:07 INFO mapreduce.Job:  map 24% reduce 0%
16/12/08 21:14:13 INFO mapreduce.Job:  map 25% reduce 0%
16/12/08 21:14:20 INFO mapreduce.Job:  map 26% reduce 0%
16/12/08 21:14:27 INFO mapreduce.Job:  map 27% reduce 0%
16/12/08 21:14:34 INFO mapreduce.Job:  map 28% reduce 0%
16/12/08 21:14:40 INFO mapreduce.Job:  map 29% reduce 0%
16/12/08 21:14:47 INFO mapreduce.Job:  map 30% reduce 0%
16/12/08 21:14:54 INFO mapreduce.Job:  map 31% reduce 0%
16/12/08 21:15:00 INFO mapreduce.Job:  map 32% reduce 0%
16/12/08 21:15:07 INFO mapreduce.Job:  map 33% reduce 0%
16/12/08 21:15:09 INFO mapreduce.Job:  map 34% reduce 0%
16/12/08 21:15:16 INFO mapreduce.Job:  map 35% reduce 0%
16/12/08 21:15:23 INFO mapreduce.Job:  map 36% reduce 0%
16/12/08 21:15:30 INFO mapreduce.Job:  map 37% reduce 0%
16/12/08 21:15:38 INFO mapreduce.Job:  map 38% reduce 0%
16/12/08 21:15:44 INFO mapreduce.Job:  map 39% reduce 0%
16/12/08 21:15:51 INFO mapreduce.Job:  map 40% reduce 0%
16/12/08 21:15:58 INFO mapreduce.Job:  map 41% reduce 0%
16/12/08 21:16:05 INFO mapreduce.Job:  map 42% reduce 0%
16/12/08 21:16:12 INFO mapreduce.Job:  map 43% reduce 0%
16/12/08 21:16:19 INFO mapreduce.Job:  map 44% reduce 0%
16/12/08 21:16:26 INFO mapreduce.Job:  map 45% reduce 0%
16/12/08 21:16:33 INFO mapreduce.Job:  map 46% reduce 0%
16/12/08 21:16:39 INFO mapreduce.Job:  map 47% reduce 0%
16/12/08 21:16:46 INFO mapreduce.Job:  map 48% reduce 0%
16/12/08 21:16:52 INFO mapreduce.Job:  map 49% reduce 0%
16/12/08 21:16:59 INFO mapreduce.Job:  map 50% reduce 0%
16/12/08 21:17:05 INFO mapreduce.Job:  map 51% reduce 0%
16/12/08 21:17:14 INFO mapreduce.Job:  map 52% reduce 0%
16/12/08 21:17:15 INFO mapreduce.Job:  map 52% reduce 1%
16/12/08 21:17:27 INFO mapreduce.Job:  map 53% reduce 1%
16/12/08 21:17:40 INFO mapreduce.Job:  map 54% reduce 1%
16/12/08 21:17:53 INFO mapreduce.Job:  map 55% reduce 1%
16/12/08 21:18:07 INFO mapreduce.Job:  map 56% reduce 1%
16/12/08 21:18:20 INFO mapreduce.Job:  map 57% reduce 1%
16/12/08 21:18:32 INFO mapreduce.Job:  map 58% reduce 1%
16/12/08 21:18:45 INFO mapreduce.Job:  map 59% reduce 1%
16/12/08 21:18:57 INFO mapreduce.Job:  map 60% reduce 1%
16/12/08 21:19:09 INFO mapreduce.Job:  map 61% reduce 1%
16/12/08 21:19:22 INFO mapreduce.Job:  map 62% reduce 1%
16/12/08 21:19:35 INFO mapreduce.Job:  map 63% reduce 1%
16/12/08 21:19:48 INFO mapreduce.Job:  map 64% reduce 1%
16/12/08 21:20:01 INFO mapreduce.Job:  map 65% reduce 1%
16/12/08 21:20:14 INFO mapreduce.Job:  map 66% reduce 1%
16/12/08 21:20:27 INFO mapreduce.Job:  map 67% reduce 1%
16/12/08 21:20:34 INFO mapreduce.Job:  map 68% reduce 1%
16/12/08 21:20:46 INFO mapreduce.Job:  map 69% reduce 1%
16/12/08 21:20:59 INFO mapreduce.Job:  map 70% reduce 1%
16/12/08 21:21:11 INFO mapreduce.Job:  map 71% reduce 1%
16/12/08 21:21:23 INFO mapreduce.Job:  map 72% reduce 1%
16/12/08 21:21:35 INFO mapreduce.Job:  map 73% reduce 1%
16/12/08 21:21:48 INFO mapreduce.Job:  map 74% reduce 1%
16/12/08 21:22:00 INFO mapreduce.Job:  map 75% reduce 1%
16/12/08 21:22:12 INFO mapreduce.Job:  map 76% reduce 1%
16/12/08 21:22:24 INFO mapreduce.Job:  map 77% reduce 1%
16/12/08 21:22:36 INFO mapreduce.Job:  map 78% reduce 1%
16/12/08 21:22:48 INFO mapreduce.Job:  map 79% reduce 1%
16/12/08 21:23:00 INFO mapreduce.Job:  map 80% reduce 1%
16/12/08 21:23:13 INFO mapreduce.Job:  map 81% reduce 1%
16/12/08 21:23:26 INFO mapreduce.Job:  map 82% reduce 1%
16/12/08 21:23:39 INFO mapreduce.Job:  map 83% reduce 1%
16/12/08 21:23:52 INFO mapreduce.Job:  map 84% reduce 1%
16/12/08 21:24:05 INFO mapreduce.Job:  map 85% reduce 1%
16/12/08 21:24:17 INFO mapreduce.Job:  map 86% reduce 1%
16/12/08 21:24:30 INFO mapreduce.Job:  map 87% reduce 1%
16/12/08 21:24:42 INFO mapreduce.Job:  map 88% reduce 1%
16/12/08 21:24:55 INFO mapreduce.Job:  map 89% reduce 1%
16/12/08 21:25:08 INFO mapreduce.Job:  map 90% reduce 1%
16/12/08 21:25:17 INFO mapreduce.Job:  map 90% reduce 2%
16/12/08 21:25:20 INFO mapreduce.Job:  map 91% reduce 2%
16/12/08 21:25:33 INFO mapreduce.Job:  map 92% reduce 2%
16/12/08 21:25:46 INFO mapreduce.Job:  map 93% reduce 2%
16/12/08 21:25:58 INFO mapreduce.Job:  map 94% reduce 2%
16/12/08 21:26:10 INFO mapreduce.Job:  map 95% reduce 2%
16/12/08 21:26:23 INFO mapreduce.Job:  map 96% reduce 2%
16/12/08 21:26:35 INFO mapreduce.Job:  map 97% reduce 2%
16/12/08 21:26:47 INFO mapreduce.Job:  map 98% reduce 2%
16/12/08 21:26:59 INFO mapreduce.Job:  map 99% reduce 2%
16/12/08 21:27:11 INFO mapreduce.Job:  map 100% reduce 2%
16/12/08 21:27:15 INFO mapreduce.Job:  map 100% reduce 4%
16/12/08 21:27:21 INFO mapreduce.Job:  map 100% reduce 9%
16/12/08 21:27:24 INFO mapreduce.Job:  map 100% reduce 10%
16/12/08 21:27:31 INFO mapreduce.Job:  map 100% reduce 14%
16/12/08 21:27:34 INFO mapreduce.Job:  map 100% reduce 15%
16/12/08 21:27:36 INFO mapreduce.Job:  map 100% reduce 19%
16/12/08 21:27:39 INFO mapreduce.Job:  map 100% reduce 20%
16/12/08 21:27:46 INFO mapreduce.Job:  map 100% reduce 24%
16/12/08 21:27:49 INFO mapreduce.Job:  map 100% reduce 25%
16/12/08 21:27:50 INFO mapreduce.Job:  map 100% reduce 29%
16/12/08 21:27:53 INFO mapreduce.Job:  map 100% reduce 30%
16/12/08 21:28:02 INFO mapreduce.Job:  map 100% reduce 34%
16/12/08 21:28:05 INFO mapreduce.Job:  map 100% reduce 39%
16/12/08 21:28:08 INFO mapreduce.Job:  map 100% reduce 40%
16/12/08 21:28:18 INFO mapreduce.Job:  map 100% reduce 44%
16/12/08 21:28:20 INFO mapreduce.Job:  map 100% reduce 48%
16/12/08 21:28:21 INFO mapreduce.Job:  map 100% reduce 49%
16/12/08 21:28:23 INFO mapreduce.Job:  map 100% reduce 50%
16/12/08 21:28:33 INFO mapreduce.Job:  map 100% reduce 54%
16/12/08 21:28:35 INFO mapreduce.Job:  map 100% reduce 58%
16/12/08 21:28:36 INFO mapreduce.Job:  map 100% reduce 59%
16/12/08 21:28:38 INFO mapreduce.Job:  map 100% reduce 60%
16/12/08 21:28:49 INFO mapreduce.Job:  map 100% reduce 64%
16/12/08 21:28:50 INFO mapreduce.Job:  map 100% reduce 68%
16/12/08 21:28:52 INFO mapreduce.Job:  map 100% reduce 69%
16/12/08 21:28:53 INFO mapreduce.Job:  map 100% reduce 70%
16/12/08 21:29:03 INFO mapreduce.Job:  map 100% reduce 74%
16/12/08 21:29:05 INFO mapreduce.Job:  map 100% reduce 78%
16/12/08 21:29:06 INFO mapreduce.Job:  map 100% reduce 79%
16/12/08 21:29:08 INFO mapreduce.Job:  map 100% reduce 80%
16/12/08 21:29:18 INFO mapreduce.Job:  map 100% reduce 84%
16/12/08 21:29:19 INFO mapreduce.Job:  map 100% reduce 88%
16/12/08 21:29:21 INFO mapreduce.Job:  map 100% reduce 89%
16/12/08 21:29:22 INFO mapreduce.Job:  map 100% reduce 90%
16/12/08 21:29:33 INFO mapreduce.Job:  map 100% reduce 94%
16/12/08 21:29:34 INFO mapreduce.Job:  map 100% reduce 98%
16/12/08 21:29:36 INFO mapreduce.Job:  map 100% reduce 99%
16/12/08 21:29:37 INFO mapreduce.Job:  map 100% reduce 100%
16/12/08 21:29:42 INFO mapreduce.Job: Job job_1480588584072_5915 completed successfully
16/12/08 21:29:42 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=1136246809
		FILE: Number of bytes written=2304875583
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=1004751028
		WASB: Number of bytes written=617730996
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=2476038
		Total time spent by all reduces in occupied slots (ms)=1778698
		Total time spent by all map tasks (ms)=1238019
		Total time spent by all reduce tasks (ms)=889349
		Total vcore-seconds taken by all map tasks=1238019
		Total vcore-seconds taken by all reduce tasks=889349
		Total megabyte-seconds taken by all map tasks=1267731456
		Total megabyte-seconds taken by all reduce tasks=910693376
	Map-Reduce Framework
		Map input records=3594328
		Map output records=2886163
		Map output bytes=1125539480
		Map output materialized bytes=1136270329
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2603480
		Reduce shuffle bytes=1136270329
		Reduce input records=2886163
		Reduce output records=1933676
		Spilled Records=5772326
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=13975
		CPU time spent (ms)=897100
		Physical memory (bytes) snapshot=326097281024
		Virtual memory (bytes) snapshot=743525253120
		Total committed heap usage (bytes)=574512693248
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=1002055024
	File Output Format Counters 
		Bytes Written=617730996
16/12/08 21:29:42 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1500
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1600 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1600': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8253772149627969815.jar tmpDir=null
16/12/08 21:50:32 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 21:50:33 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/08 21:50:34 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/08 21:50:35 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/08 21:50:35 INFO mapreduce.JobSubmitter: number of splits:197
16/12/08 21:50:36 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5922
16/12/08 21:50:37 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5922
16/12/08 21:50:37 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5922/
16/12/08 21:50:37 INFO mapreduce.Job: Running job: job_1480588584072_5922
16/12/09 09:48:09 INFO mapreduce.Job: Job job_1480588584072_5922 running in uber mode : false
16/12/09 09:48:09 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 10:10:46 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 10:11:01 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 10:11:02 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 10:11:03 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 10:11:04 INFO mapreduce.Job:  map 9% reduce 0%
16/12/09 10:11:05 INFO mapreduce.Job:  map 11% reduce 0%
16/12/09 10:11:06 INFO mapreduce.Job:  map 12% reduce 0%
16/12/09 10:11:08 INFO mapreduce.Job:  map 16% reduce 0%
16/12/09 10:11:09 INFO mapreduce.Job:  map 18% reduce 0%
16/12/09 10:11:11 INFO mapreduce.Job:  map 19% reduce 0%
16/12/09 10:11:12 INFO mapreduce.Job:  map 21% reduce 0%
16/12/09 10:11:13 INFO mapreduce.Job:  map 22% reduce 0%
16/12/09 10:11:14 INFO mapreduce.Job:  map 23% reduce 0%
16/12/09 10:11:16 INFO mapreduce.Job:  map 24% reduce 0%
16/12/09 10:11:18 INFO mapreduce.Job:  map 26% reduce 0%
16/12/09 10:11:19 INFO mapreduce.Job:  map 28% reduce 0%
16/12/09 10:11:21 INFO mapreduce.Job:  map 30% reduce 0%
16/12/09 10:11:22 INFO mapreduce.Job:  map 32% reduce 0%
16/12/09 10:11:23 INFO mapreduce.Job:  map 34% reduce 0%
16/12/09 10:11:26 INFO mapreduce.Job:  map 35% reduce 1%
16/12/09 10:11:27 INFO mapreduce.Job:  map 37% reduce 2%
16/12/09 10:11:28 INFO mapreduce.Job:  map 38% reduce 3%
16/12/09 10:11:30 INFO mapreduce.Job:  map 40% reduce 3%
16/12/09 10:11:31 INFO mapreduce.Job:  map 42% reduce 5%
16/12/09 10:11:32 INFO mapreduce.Job:  map 45% reduce 5%
16/12/09 10:11:33 INFO mapreduce.Job:  map 46% reduce 6%
16/12/09 10:11:34 INFO mapreduce.Job:  map 48% reduce 7%
16/12/09 10:11:35 INFO mapreduce.Job:  map 49% reduce 8%
16/12/09 10:11:37 INFO mapreduce.Job:  map 50% reduce 9%
16/12/09 10:11:38 INFO mapreduce.Job:  map 51% reduce 9%
16/12/09 10:11:40 INFO mapreduce.Job:  map 52% reduce 10%
16/12/09 10:11:42 INFO mapreduce.Job:  map 54% reduce 10%
16/12/09 10:11:43 INFO mapreduce.Job:  map 55% reduce 10%
16/12/09 10:11:44 INFO mapreduce.Job:  map 57% reduce 11%
16/12/09 10:11:46 INFO mapreduce.Job:  map 59% reduce 11%
16/12/09 10:11:47 INFO mapreduce.Job:  map 60% reduce 11%
16/12/09 10:11:48 INFO mapreduce.Job:  map 62% reduce 12%
16/12/09 10:11:49 INFO mapreduce.Job:  map 65% reduce 13%
16/12/09 10:11:50 INFO mapreduce.Job:  map 67% reduce 13%
16/12/09 10:11:51 INFO mapreduce.Job:  map 68% reduce 15%
16/12/09 10:11:52 INFO mapreduce.Job:  map 69% reduce 15%
16/12/09 10:11:53 INFO mapreduce.Job:  map 70% reduce 17%
16/12/09 10:11:54 INFO mapreduce.Job:  map 72% reduce 17%
16/12/09 10:11:55 INFO mapreduce.Job:  map 73% reduce 17%
16/12/09 10:11:56 INFO mapreduce.Job:  map 75% reduce 17%
16/12/09 10:11:57 INFO mapreduce.Job:  map 77% reduce 19%
16/12/09 10:11:58 INFO mapreduce.Job:  map 78% reduce 19%
16/12/09 10:11:59 INFO mapreduce.Job:  map 78% reduce 21%
16/12/09 10:12:00 INFO mapreduce.Job:  map 79% reduce 21%
16/12/09 10:12:01 INFO mapreduce.Job:  map 80% reduce 23%
16/12/09 10:12:02 INFO mapreduce.Job:  map 81% reduce 23%
16/12/09 10:12:03 INFO mapreduce.Job:  map 83% reduce 23%
16/12/09 10:12:04 INFO mapreduce.Job:  map 85% reduce 23%
16/12/09 10:12:05 INFO mapreduce.Job:  map 87% reduce 24%
16/12/09 10:12:06 INFO mapreduce.Job:  map 89% reduce 26%
16/12/09 10:12:07 INFO mapreduce.Job:  map 89% reduce 27%
16/12/09 10:12:08 INFO mapreduce.Job:  map 90% reduce 28%
16/12/09 10:12:09 INFO mapreduce.Job:  map 92% reduce 28%
16/12/09 10:12:10 INFO mapreduce.Job:  map 93% reduce 28%
16/12/09 10:12:11 INFO mapreduce.Job:  map 93% reduce 30%
16/12/09 10:12:12 INFO mapreduce.Job:  map 94% reduce 31%
16/12/09 10:12:13 INFO mapreduce.Job:  map 95% reduce 31%
16/12/09 10:12:14 INFO mapreduce.Job:  map 96% reduce 31%
16/12/09 10:12:15 INFO mapreduce.Job:  map 97% reduce 31%
16/12/09 10:12:16 INFO mapreduce.Job:  map 99% reduce 32%
16/12/09 10:12:18 INFO mapreduce.Job:  map 99% reduce 33%
16/12/09 10:12:21 INFO mapreduce.Job:  map 100% reduce 33%
16/12/09 10:12:23 INFO mapreduce.Job:  map 100% reduce 34%
16/12/09 10:12:24 INFO mapreduce.Job:  map 100% reduce 41%
16/12/09 10:12:25 INFO mapreduce.Job:  map 100% reduce 45%
16/12/09 10:12:26 INFO mapreduce.Job:  map 100% reduce 47%
16/12/09 10:12:27 INFO mapreduce.Job:  map 100% reduce 55%
16/12/09 10:12:28 INFO mapreduce.Job:  map 100% reduce 62%
16/12/09 10:12:29 INFO mapreduce.Job:  map 100% reduce 65%
16/12/09 10:12:30 INFO mapreduce.Job:  map 100% reduce 68%
16/12/09 10:12:31 INFO mapreduce.Job:  map 100% reduce 70%
16/12/09 10:12:32 INFO mapreduce.Job:  map 100% reduce 71%
16/12/09 10:12:33 INFO mapreduce.Job:  map 100% reduce 74%
16/12/09 10:12:34 INFO mapreduce.Job:  map 100% reduce 75%
16/12/09 10:12:35 INFO mapreduce.Job:  map 100% reduce 77%
16/12/09 10:12:36 INFO mapreduce.Job:  map 100% reduce 80%
16/12/09 10:12:37 INFO mapreduce.Job:  map 100% reduce 81%
16/12/09 10:12:38 INFO mapreduce.Job:  map 100% reduce 83%
16/12/09 10:12:39 INFO mapreduce.Job:  map 100% reduce 85%
16/12/09 10:12:40 INFO mapreduce.Job:  map 100% reduce 86%
16/12/09 10:12:41 INFO mapreduce.Job:  map 100% reduce 88%
16/12/09 10:12:42 INFO mapreduce.Job:  map 100% reduce 90%
16/12/09 10:12:43 INFO mapreduce.Job:  map 100% reduce 91%
16/12/09 10:12:44 INFO mapreduce.Job:  map 100% reduce 94%
16/12/09 10:12:46 INFO mapreduce.Job:  map 100% reduce 95%
16/12/09 10:12:47 INFO mapreduce.Job:  map 100% reduce 96%
16/12/09 10:12:48 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 10:12:50 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 10:12:53 INFO mapreduce.Job: Job job_1480588584072_5922 completed successfully
16/12/09 10:12:53 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=1039266094
		FILE: Number of bytes written=2110914153
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=944444125
		WASB: Number of bytes written=525302323
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=14182686
		Total time spent by all reduces in occupied slots (ms)=3691230
		Total time spent by all map tasks (ms)=7091343
		Total time spent by all reduce tasks (ms)=1845615
		Total vcore-seconds taken by all map tasks=7091343
		Total vcore-seconds taken by all reduce tasks=1845615
		Total megabyte-seconds taken by all map tasks=7261535232
		Total megabyte-seconds taken by all reduce tasks=1889909760
	Map-Reduce Framework
		Map input records=3483824
		Map output records=2666272
		Map output bytes=1029414604
		Map output materialized bytes=1039289614
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2389767
		Reduce shuffle bytes=1039289614
		Reduce input records=2666272
		Reduce output records=1665206
		Spilled Records=5332544
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=107080
		CPU time spent (ms)=1091900
		Physical memory (bytes) snapshot=325810720768
		Virtual memory (bytes) snapshot=742387789824
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=941748121
	File Output Format Counters 
		Bytes Written=525302323
16/12/09 10:12:53 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1600
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1700 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612080900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1700': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5459439979453245410.jar tmpDir=null
16/12/09 10:13:33 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 10:13:34 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 10:13:35 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 10:13:36 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 10:13:36 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 10:13:37 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5973
16/12/09 10:13:38 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5973
16/12/09 10:13:38 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5973/
16/12/09 10:13:38 INFO mapreduce.Job: Running job: job_1480588584072_5973
16/12/09 10:15:03 INFO mapreduce.Job: Job job_1480588584072_5973 running in uber mode : false
16/12/09 10:15:03 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 10:15:24 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 10:15:38 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 10:16:54 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 10:16:56 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 10:17:00 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 10:17:05 INFO mapreduce.Job:  map 7% reduce 0%
16/12/09 10:17:08 INFO mapreduce.Job:  map 8% reduce 0%
16/12/09 10:17:22 INFO mapreduce.Job:  map 9% reduce 0%
16/12/09 10:17:28 INFO mapreduce.Job:  map 10% reduce 0%
16/12/09 10:17:30 INFO mapreduce.Job:  map 11% reduce 0%
16/12/09 10:17:33 INFO mapreduce.Job:  map 12% reduce 0%
16/12/09 10:17:35 INFO mapreduce.Job:  map 13% reduce 0%
16/12/09 10:17:37 INFO mapreduce.Job:  map 14% reduce 0%
16/12/09 10:17:41 INFO mapreduce.Job:  map 16% reduce 0%
16/12/09 10:17:42 INFO mapreduce.Job:  map 17% reduce 0%
16/12/09 10:17:43 INFO mapreduce.Job:  map 18% reduce 0%
16/12/09 10:17:45 INFO mapreduce.Job:  map 21% reduce 1%
16/12/09 10:17:46 INFO mapreduce.Job:  map 22% reduce 1%
16/12/09 10:17:47 INFO mapreduce.Job:  map 23% reduce 1%
16/12/09 10:17:48 INFO mapreduce.Job:  map 25% reduce 1%
16/12/09 10:17:49 INFO mapreduce.Job:  map 27% reduce 1%
16/12/09 10:17:50 INFO mapreduce.Job:  map 29% reduce 1%
16/12/09 10:17:51 INFO mapreduce.Job:  map 31% reduce 1%
16/12/09 10:17:52 INFO mapreduce.Job:  map 34% reduce 1%
16/12/09 10:17:53 INFO mapreduce.Job:  map 35% reduce 1%
16/12/09 10:17:55 INFO mapreduce.Job:  map 36% reduce 2%
16/12/09 10:17:56 INFO mapreduce.Job:  map 37% reduce 2%
16/12/09 10:17:58 INFO mapreduce.Job:  map 38% reduce 2%
16/12/09 10:18:00 INFO mapreduce.Job:  map 39% reduce 3%
16/12/09 10:18:01 INFO mapreduce.Job:  map 40% reduce 4%
16/12/09 10:18:02 INFO mapreduce.Job:  map 41% reduce 5%
16/12/09 10:18:03 INFO mapreduce.Job:  map 43% reduce 5%
16/12/09 10:18:04 INFO mapreduce.Job:  map 44% reduce 5%
16/12/09 10:18:05 INFO mapreduce.Job:  map 46% reduce 6%
16/12/09 10:18:06 INFO mapreduce.Job:  map 49% reduce 6%
16/12/09 10:18:07 INFO mapreduce.Job:  map 51% reduce 7%
16/12/09 10:18:08 INFO mapreduce.Job:  map 54% reduce 8%
16/12/09 10:18:09 INFO mapreduce.Job:  map 59% reduce 8%
16/12/09 10:18:10 INFO mapreduce.Job:  map 64% reduce 9%
16/12/09 10:18:11 INFO mapreduce.Job:  map 67% reduce 10%
16/12/09 10:18:12 INFO mapreduce.Job:  map 71% reduce 11%
16/12/09 10:18:13 INFO mapreduce.Job:  map 76% reduce 11%
16/12/09 10:18:14 INFO mapreduce.Job:  map 80% reduce 15%
16/12/09 10:18:15 INFO mapreduce.Job:  map 84% reduce 18%
16/12/09 10:18:16 INFO mapreduce.Job:  map 89% reduce 18%
16/12/09 10:18:17 INFO mapreduce.Job:  map 91% reduce 21%
16/12/09 10:18:18 INFO mapreduce.Job:  map 93% reduce 26%
16/12/09 10:18:19 INFO mapreduce.Job:  map 94% reduce 26%
16/12/09 10:18:20 INFO mapreduce.Job:  map 95% reduce 27%
16/12/09 10:18:21 INFO mapreduce.Job:  map 96% reduce 29%
16/12/09 10:18:22 INFO mapreduce.Job:  map 98% reduce 30%
16/12/09 10:18:23 INFO mapreduce.Job:  map 99% reduce 30%
16/12/09 10:18:24 INFO mapreduce.Job:  map 99% reduce 31%
16/12/09 10:18:26 INFO mapreduce.Job:  map 100% reduce 33%
16/12/09 10:18:27 INFO mapreduce.Job:  map 100% reduce 35%
16/12/09 10:18:28 INFO mapreduce.Job:  map 100% reduce 36%
16/12/09 10:18:29 INFO mapreduce.Job:  map 100% reduce 46%
16/12/09 10:18:30 INFO mapreduce.Job:  map 100% reduce 59%
16/12/09 10:18:31 INFO mapreduce.Job:  map 100% reduce 62%
16/12/09 10:18:32 INFO mapreduce.Job:  map 100% reduce 64%
16/12/09 10:18:33 INFO mapreduce.Job:  map 100% reduce 69%
16/12/09 10:18:34 INFO mapreduce.Job:  map 100% reduce 71%
16/12/09 10:18:35 INFO mapreduce.Job:  map 100% reduce 73%
16/12/09 10:18:36 INFO mapreduce.Job:  map 100% reduce 76%
16/12/09 10:18:37 INFO mapreduce.Job:  map 100% reduce 78%
16/12/09 10:18:38 INFO mapreduce.Job:  map 100% reduce 80%
16/12/09 10:18:39 INFO mapreduce.Job:  map 100% reduce 82%
16/12/09 10:18:40 INFO mapreduce.Job:  map 100% reduce 83%
16/12/09 10:18:41 INFO mapreduce.Job:  map 100% reduce 85%
16/12/09 10:18:42 INFO mapreduce.Job:  map 100% reduce 87%
16/12/09 10:18:44 INFO mapreduce.Job:  map 100% reduce 89%
16/12/09 10:18:48 INFO mapreduce.Job:  map 100% reduce 90%
16/12/09 10:18:50 INFO mapreduce.Job:  map 100% reduce 91%
16/12/09 10:18:54 INFO mapreduce.Job:  map 100% reduce 93%
16/12/09 10:18:56 INFO mapreduce.Job:  map 100% reduce 94%
16/12/09 10:19:00 INFO mapreduce.Job:  map 100% reduce 95%
16/12/09 10:19:04 INFO mapreduce.Job:  map 100% reduce 96%
16/12/09 10:19:07 INFO mapreduce.Job:  map 100% reduce 97%
16/12/09 10:19:11 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 10:19:16 INFO mapreduce.Job:  map 100% reduce 99%
16/12/09 10:19:24 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 10:19:31 INFO mapreduce.Job: Job job_1480588584072_5973 completed successfully
16/12/09 10:19:32 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=1297821496
		FILE: Number of bytes written=2628024957
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=1143204396
		WASB: Number of bytes written=746491249
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=18984722
		Total time spent by all reduces in occupied slots (ms)=3827142
		Total time spent by all map tasks (ms)=9492361
		Total time spent by all reduce tasks (ms)=1913571
		Total vcore-seconds taken by all map tasks=9492361
		Total vcore-seconds taken by all reduce tasks=1913571
		Total megabyte-seconds taken by all map tasks=9720177664
		Total megabyte-seconds taken by all reduce tasks=1959496704
	Map-Reduce Framework
		Map input records=4068109
		Map output records=3286090
		Map output bytes=1285632364
		Map output materialized bytes=1297845016
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2982656
		Reduce shuffle bytes=1297845016
		Reduce input records=3286090
		Reduce output records=2330153
		Spilled Records=6572180
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=165617
		CPU time spent (ms)=1191240
		Physical memory (bytes) snapshot=326293663744
		Virtual memory (bytes) snapshot=742020456448
		Total committed heap usage (bytes)=574439292928
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=1140508392
	File Output Format Counters 
		Bytes Written=746491249
16/12/09 10:19:32 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1700
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081400 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1800 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081400
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1800': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4088040390670262733.jar tmpDir=null
16/12/09 10:20:12 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 10:20:13 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 10:20:14 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 10:20:15 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 10:20:15 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 10:20:16 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5982
16/12/09 10:20:17 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5982
16/12/09 10:20:17 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5982/
16/12/09 10:20:17 INFO mapreduce.Job: Running job: job_1480588584072_5982
16/12/09 10:20:31 INFO mapreduce.Job: Job job_1480588584072_5982 running in uber mode : false
16/12/09 10:20:31 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 10:21:08 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 10:21:10 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 10:21:13 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 10:21:32 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 10:21:34 INFO mapreduce.Job:  map 5% reduce 0%
16/12/09 10:21:35 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 10:21:39 INFO mapreduce.Job:  map 10% reduce 0%
16/12/09 10:21:40 INFO mapreduce.Job:  map 11% reduce 0%
16/12/09 10:21:42 INFO mapreduce.Job:  map 12% reduce 0%
16/12/09 10:21:45 INFO mapreduce.Job:  map 13% reduce 0%
16/12/09 10:21:46 INFO mapreduce.Job:  map 14% reduce 0%
16/12/09 10:21:51 INFO mapreduce.Job:  map 17% reduce 0%
16/12/09 10:21:52 INFO mapreduce.Job:  map 18% reduce 0%
16/12/09 10:21:54 INFO mapreduce.Job:  map 19% reduce 0%
16/12/09 10:21:55 INFO mapreduce.Job:  map 20% reduce 0%
16/12/09 10:21:57 INFO mapreduce.Job:  map 21% reduce 0%
16/12/09 10:21:58 INFO mapreduce.Job:  map 23% reduce 0%
16/12/09 10:21:59 INFO mapreduce.Job:  map 24% reduce 0%
16/12/09 10:22:00 INFO mapreduce.Job:  map 25% reduce 0%
16/12/09 10:22:01 INFO mapreduce.Job:  map 26% reduce 1%
16/12/09 10:22:02 INFO mapreduce.Job:  map 27% reduce 1%
16/12/09 10:22:04 INFO mapreduce.Job:  map 29% reduce 1%
16/12/09 10:22:05 INFO mapreduce.Job:  map 29% reduce 2%
16/12/09 10:22:06 INFO mapreduce.Job:  map 30% reduce 3%
16/12/09 10:22:07 INFO mapreduce.Job:  map 31% reduce 4%
16/12/09 10:22:08 INFO mapreduce.Job:  map 32% reduce 5%
16/12/09 10:22:10 INFO mapreduce.Job:  map 33% reduce 5%
16/12/09 10:22:12 INFO mapreduce.Job:  map 34% reduce 5%
16/12/09 10:22:13 INFO mapreduce.Job:  map 35% reduce 5%
16/12/09 10:22:15 INFO mapreduce.Job:  map 36% reduce 5%
16/12/09 10:22:16 INFO mapreduce.Job:  map 36% reduce 6%
16/12/09 10:22:17 INFO mapreduce.Job:  map 37% reduce 6%
16/12/09 10:22:20 INFO mapreduce.Job:  map 38% reduce 6%
16/12/09 10:22:21 INFO mapreduce.Job:  map 39% reduce 6%
16/12/09 10:22:24 INFO mapreduce.Job:  map 40% reduce 6%
16/12/09 10:22:25 INFO mapreduce.Job:  map 43% reduce 6%
16/12/09 10:22:26 INFO mapreduce.Job:  map 44% reduce 6%
16/12/09 10:22:29 INFO mapreduce.Job:  map 48% reduce 7%
16/12/09 10:22:30 INFO mapreduce.Job:  map 49% reduce 7%
16/12/09 10:22:31 INFO mapreduce.Job:  map 51% reduce 7%
16/12/09 10:22:33 INFO mapreduce.Job:  map 52% reduce 9%
16/12/09 10:22:34 INFO mapreduce.Job:  map 56% reduce 10%
16/12/09 10:22:35 INFO mapreduce.Job:  map 58% reduce 11%
16/12/09 10:22:36 INFO mapreduce.Job:  map 60% reduce 13%
16/12/09 10:22:37 INFO mapreduce.Job:  map 63% reduce 14%
16/12/09 10:22:38 INFO mapreduce.Job:  map 67% reduce 15%
16/12/09 10:22:39 INFO mapreduce.Job:  map 69% reduce 16%
16/12/09 10:22:40 INFO mapreduce.Job:  map 72% reduce 16%
16/12/09 10:22:41 INFO mapreduce.Job:  map 74% reduce 18%
16/12/09 10:22:42 INFO mapreduce.Job:  map 75% reduce 19%
16/12/09 10:22:43 INFO mapreduce.Job:  map 77% reduce 21%
16/12/09 10:22:45 INFO mapreduce.Job:  map 78% reduce 23%
16/12/09 10:22:46 INFO mapreduce.Job:  map 79% reduce 24%
16/12/09 10:22:47 INFO mapreduce.Job:  map 80% reduce 24%
16/12/09 10:22:48 INFO mapreduce.Job:  map 80% reduce 25%
16/12/09 10:22:52 INFO mapreduce.Job:  map 80% reduce 26%
16/12/09 10:22:59 INFO mapreduce.Job:  map 81% reduce 26%
16/12/09 10:23:14 INFO mapreduce.Job:  map 82% reduce 26%
16/12/09 10:23:17 INFO mapreduce.Job:  map 83% reduce 26%
16/12/09 10:23:17 INFO mapreduce.Job: Task Id : attempt_1480588584072_5982_m_000006_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 10:23:17 INFO mapreduce.Job: Task Id : attempt_1480588584072_5982_m_000002_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 10:23:17 INFO mapreduce.Job: Task Id : attempt_1480588584072_5982_m_000004_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 10:23:18 INFO mapreduce.Job:  map 82% reduce 26%
16/12/09 10:23:18 INFO mapreduce.Job: Task Id : attempt_1480588584072_5982_m_000029_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 10:23:24 INFO mapreduce.Job:  map 83% reduce 26%
16/12/09 10:23:29 INFO mapreduce.Job:  map 84% reduce 26%
16/12/09 10:23:33 INFO mapreduce.Job:  map 85% reduce 26%
16/12/09 10:23:34 INFO mapreduce.Job:  map 86% reduce 26%
16/12/09 10:23:35 INFO mapreduce.Job:  map 87% reduce 26%
16/12/09 10:23:36 INFO mapreduce.Job:  map 88% reduce 26%
16/12/09 10:23:37 INFO mapreduce.Job:  map 88% reduce 27%
16/12/09 10:23:39 INFO mapreduce.Job:  map 89% reduce 27%
16/12/09 10:23:41 INFO mapreduce.Job:  map 90% reduce 27%
16/12/09 10:23:49 INFO mapreduce.Job:  map 91% reduce 27%
16/12/09 10:23:50 INFO mapreduce.Job:  map 92% reduce 27%
16/12/09 10:23:52 INFO mapreduce.Job:  map 93% reduce 27%
16/12/09 10:23:55 INFO mapreduce.Job:  map 94% reduce 27%
16/12/09 10:23:57 INFO mapreduce.Job:  map 94% reduce 28%
16/12/09 10:23:58 INFO mapreduce.Job:  map 95% reduce 28%
16/12/09 10:23:59 INFO mapreduce.Job:  map 95% reduce 29%
16/12/09 10:24:00 INFO mapreduce.Job:  map 96% reduce 29%
16/12/09 10:24:02 INFO mapreduce.Job:  map 97% reduce 30%
16/12/09 10:24:03 INFO mapreduce.Job:  map 98% reduce 30%
16/12/09 10:24:05 INFO mapreduce.Job:  map 98% reduce 31%
16/12/09 10:24:06 INFO mapreduce.Job:  map 99% reduce 32%
16/12/09 10:24:08 INFO mapreduce.Job:  map 99% reduce 33%
16/12/09 10:24:13 INFO mapreduce.Job:  map 100% reduce 33%
16/12/09 10:24:19 INFO mapreduce.Job:  map 100% reduce 35%
16/12/09 10:24:21 INFO mapreduce.Job:  map 100% reduce 46%
16/12/09 10:24:22 INFO mapreduce.Job:  map 100% reduce 54%
16/12/09 10:24:23 INFO mapreduce.Job:  map 100% reduce 59%
16/12/09 10:24:24 INFO mapreduce.Job:  map 100% reduce 65%
16/12/09 10:24:25 INFO mapreduce.Job:  map 100% reduce 69%
16/12/09 10:24:27 INFO mapreduce.Job:  map 100% reduce 71%
16/12/09 10:24:28 INFO mapreduce.Job:  map 100% reduce 75%
16/12/09 10:24:29 INFO mapreduce.Job:  map 100% reduce 76%
16/12/09 10:24:30 INFO mapreduce.Job:  map 100% reduce 77%
16/12/09 10:24:31 INFO mapreduce.Job:  map 100% reduce 80%
16/12/09 10:24:33 INFO mapreduce.Job:  map 100% reduce 81%
16/12/09 10:24:34 INFO mapreduce.Job:  map 100% reduce 83%
16/12/09 10:24:35 INFO mapreduce.Job:  map 100% reduce 84%
16/12/09 10:24:36 INFO mapreduce.Job:  map 100% reduce 85%
16/12/09 10:24:37 INFO mapreduce.Job:  map 100% reduce 87%
16/12/09 10:24:38 INFO mapreduce.Job:  map 100% reduce 88%
16/12/09 10:24:39 INFO mapreduce.Job:  map 100% reduce 89%
16/12/09 10:24:40 INFO mapreduce.Job:  map 100% reduce 90%
16/12/09 10:24:41 INFO mapreduce.Job:  map 100% reduce 92%
16/12/09 10:24:42 INFO mapreduce.Job:  map 100% reduce 93%
16/12/09 10:24:43 INFO mapreduce.Job:  map 100% reduce 94%
16/12/09 10:24:44 INFO mapreduce.Job:  map 100% reduce 95%
16/12/09 10:24:45 INFO mapreduce.Job:  map 100% reduce 96%
16/12/09 10:24:47 INFO mapreduce.Job:  map 100% reduce 97%
16/12/09 10:24:48 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 10:24:49 INFO mapreduce.Job:  map 100% reduce 99%
16/12/09 10:24:51 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 10:24:56 INFO mapreduce.Job: Job job_1480588584072_5982 completed successfully
16/12/09 10:24:56 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=1220377966
		FILE: Number of bytes written=2473137897
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=1076306364
		WASB: Number of bytes written=692209750
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=4
		Launched map tasks=201
		Launched reduce tasks=20
		Other local map tasks=4
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=48224870
		Total time spent by all reduces in occupied slots (ms)=6832126
		Total time spent by all map tasks (ms)=24112435
		Total time spent by all reduce tasks (ms)=3416063
		Total vcore-seconds taken by all map tasks=24112435
		Total vcore-seconds taken by all reduce tasks=3416063
		Total megabyte-seconds taken by all map tasks=24691133440
		Total megabyte-seconds taken by all reduce tasks=3498048512
	Map-Reduce Framework
		Map input records=3847833
		Map output records=3098684
		Map output bytes=1208898275
		Map output materialized bytes=1220401486
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2803584
		Reduce shuffle bytes=1220401486
		Reduce input records=3098684
		Reduce output records=2175248
		Spilled Records=6197368
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=327646
		CPU time spent (ms)=1473580
		Physical memory (bytes) snapshot=318618906624
		Virtual memory (bytes) snapshot=742073266176
		Total committed heap usage (bytes)=573991026688
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=1073610360
	File Output Format Counters 
		Bytes Written=692209750
16/12/09 10:24:56 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1800
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19.done
16/12/09 10:25:05 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081500 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1900 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081500
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1900': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7445241664488617219.jar tmpDir=null
16/12/09 10:25:36 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 10:25:37 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 10:25:37 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 10:25:39 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 10:25:39 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 10:25:39 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5986
16/12/09 10:25:40 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5986
16/12/09 10:25:40 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5986/
16/12/09 10:25:40 INFO mapreduce.Job: Running job: job_1480588584072_5986
16/12/09 10:25:52 INFO mapreduce.Job: Job job_1480588584072_5986 running in uber mode : false
16/12/09 10:25:52 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 10:26:57 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 10:27:07 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 10:27:09 INFO mapreduce.Job:  map 5% reduce 0%
16/12/09 10:27:24 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 10:27:56 INFO mapreduce.Job:  map 7% reduce 0%
16/12/09 10:27:57 INFO mapreduce.Job:  map 8% reduce 0%
16/12/09 10:28:04 INFO mapreduce.Job:  map 10% reduce 0%
16/12/09 10:28:05 INFO mapreduce.Job:  map 11% reduce 0%
16/12/09 10:28:06 INFO mapreduce.Job:  map 12% reduce 0%
16/12/09 10:28:07 INFO mapreduce.Job:  map 16% reduce 0%
16/12/09 10:28:08 INFO mapreduce.Job:  map 18% reduce 0%
16/12/09 10:28:09 INFO mapreduce.Job:  map 19% reduce 0%
16/12/09 10:28:13 INFO mapreduce.Job:  map 21% reduce 0%
16/12/09 10:28:41 INFO mapreduce.Job:  map 37% reduce 0%
16/12/09 10:28:43 INFO mapreduce.Job:  map 44% reduce 0%
16/12/09 10:28:44 INFO mapreduce.Job:  map 45% reduce 0%
16/12/09 10:28:45 INFO mapreduce.Job:  map 48% reduce 0%
16/12/09 10:28:47 INFO mapreduce.Job:  map 49% reduce 0%
16/12/09 10:28:47 INFO mapreduce.Job: Task Id : attempt_1480588584072_5986_m_000057_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 10:28:49 INFO mapreduce.Job:  map 51% reduce 0%
16/12/09 10:28:50 INFO mapreduce.Job:  map 53% reduce 0%
16/12/09 10:28:50 INFO mapreduce.Job: Task Id : attempt_1480588584072_5986_m_000085_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 10:28:51 INFO mapreduce.Job:  map 56% reduce 0%
16/12/09 10:28:51 INFO mapreduce.Job: Task Id : attempt_1480588584072_5986_m_000072_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 10:28:51 INFO mapreduce.Job: Task Id : attempt_1480588584072_5986_m_000071_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 10:28:51 INFO mapreduce.Job: Task Id : attempt_1480588584072_5986_m_000069_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 10:28:51 INFO mapreduce.Job: Task Id : attempt_1480588584072_5986_m_000061_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 10:28:52 INFO mapreduce.Job:  map 58% reduce 0%
16/12/09 10:28:53 INFO mapreduce.Job:  map 60% reduce 0%
16/12/09 10:28:54 INFO mapreduce.Job:  map 63% reduce 2%
16/12/09 10:28:55 INFO mapreduce.Job:  map 64% reduce 4%
16/12/09 10:28:56 INFO mapreduce.Job:  map 64% reduce 6%
16/12/09 10:28:57 INFO mapreduce.Job:  map 66% reduce 8%
16/12/09 10:28:58 INFO mapreduce.Job:  map 66% reduce 11%
16/12/09 10:28:59 INFO mapreduce.Job:  map 67% reduce 11%
16/12/09 10:29:00 INFO mapreduce.Job:  map 68% reduce 12%
16/12/09 10:29:01 INFO mapreduce.Job:  map 69% reduce 16%
16/12/09 10:29:02 INFO mapreduce.Job:  map 69% reduce 17%
16/12/09 10:29:04 INFO mapreduce.Job:  map 70% reduce 17%
16/12/09 10:29:12 INFO mapreduce.Job:  map 71% reduce 17%
16/12/09 10:29:17 INFO mapreduce.Job:  map 72% reduce 18%
16/12/09 10:29:21 INFO mapreduce.Job:  map 73% reduce 18%
16/12/09 10:29:23 INFO mapreduce.Job:  map 74% reduce 18%
16/12/09 10:29:25 INFO mapreduce.Job:  map 74% reduce 19%
16/12/09 10:29:27 INFO mapreduce.Job:  map 75% reduce 19%
16/12/09 10:29:28 INFO mapreduce.Job:  map 76% reduce 19%
16/12/09 10:29:29 INFO mapreduce.Job:  map 76% reduce 20%
16/12/09 10:29:30 INFO mapreduce.Job:  map 77% reduce 20%
16/12/09 10:29:32 INFO mapreduce.Job:  map 78% reduce 20%
16/12/09 10:29:35 INFO mapreduce.Job:  map 79% reduce 21%
16/12/09 10:29:36 INFO mapreduce.Job:  map 80% reduce 21%
16/12/09 10:29:37 INFO mapreduce.Job:  map 81% reduce 21%
16/12/09 10:29:38 INFO mapreduce.Job:  map 81% reduce 22%
16/12/09 10:29:40 INFO mapreduce.Job:  map 83% reduce 22%
16/12/09 10:29:42 INFO mapreduce.Job:  map 84% reduce 23%
16/12/09 10:29:44 INFO mapreduce.Job:  map 85% reduce 24%
16/12/09 10:29:47 INFO mapreduce.Job:  map 86% reduce 24%
16/12/09 10:29:48 INFO mapreduce.Job:  map 87% reduce 24%
16/12/09 10:29:50 INFO mapreduce.Job:  map 87% reduce 25%
16/12/09 10:29:51 INFO mapreduce.Job:  map 87% reduce 26%
16/12/09 10:29:52 INFO mapreduce.Job:  map 88% reduce 26%
16/12/09 10:29:53 INFO mapreduce.Job:  map 88% reduce 27%
16/12/09 10:30:17 INFO mapreduce.Job:  map 88% reduce 28%
16/12/09 10:30:22 INFO mapreduce.Job:  map 90% reduce 28%
16/12/09 10:30:23 INFO mapreduce.Job:  map 93% reduce 28%
16/12/09 10:30:24 INFO mapreduce.Job:  map 98% reduce 28%
16/12/09 10:30:26 INFO mapreduce.Job:  map 99% reduce 29%
16/12/09 10:30:27 INFO mapreduce.Job:  map 99% reduce 30%
16/12/09 10:30:29 INFO mapreduce.Job:  map 99% reduce 31%
16/12/09 10:30:30 INFO mapreduce.Job:  map 99% reduce 32%
16/12/09 10:30:31 INFO mapreduce.Job:  map 100% reduce 32%
16/12/09 10:30:33 INFO mapreduce.Job:  map 100% reduce 36%
16/12/09 10:30:34 INFO mapreduce.Job:  map 100% reduce 41%
16/12/09 10:30:35 INFO mapreduce.Job:  map 100% reduce 59%
16/12/09 10:30:36 INFO mapreduce.Job:  map 100% reduce 67%
16/12/09 10:30:37 INFO mapreduce.Job:  map 100% reduce 68%
16/12/09 10:30:38 INFO mapreduce.Job:  map 100% reduce 74%
16/12/09 10:30:39 INFO mapreduce.Job:  map 100% reduce 77%
16/12/09 10:30:40 INFO mapreduce.Job:  map 100% reduce 78%
16/12/09 10:30:41 INFO mapreduce.Job:  map 100% reduce 85%
16/12/09 10:30:42 INFO mapreduce.Job:  map 100% reduce 89%
16/12/09 10:30:43 INFO mapreduce.Job:  map 100% reduce 91%
16/12/09 10:30:44 INFO mapreduce.Job:  map 100% reduce 96%
16/12/09 10:30:45 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 10:30:46 INFO mapreduce.Job:  map 100% reduce 99%
16/12/09 10:30:47 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 10:30:50 INFO mapreduce.Job: Job job_1480588584072_5986 completed successfully
16/12/09 10:30:50 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=1173459994
		FILE: Number of bytes written=2379301953
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=1027471352
		WASB: Number of bytes written=665353381
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=6
		Launched map tasks=203
		Launched reduce tasks=20
		Other local map tasks=6
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=73660862
		Total time spent by all reduces in occupied slots (ms)=4846022
		Total time spent by all map tasks (ms)=36830431
		Total time spent by all reduce tasks (ms)=2423011
		Total vcore-seconds taken by all map tasks=36830431
		Total vcore-seconds taken by all reduce tasks=2423011
		Total megabyte-seconds taken by all map tasks=37714361344
		Total megabyte-seconds taken by all reduce tasks=2481163264
	Map-Reduce Framework
		Map input records=3671407
		Map output records=2983658
		Map output bytes=1162411056
		Map output materialized bytes=1173483514
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2697465
		Reduce shuffle bytes=1173483514
		Reduce input records=2983658
		Reduce output records=2093297
		Spilled Records=5967316
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=380881
		CPU time spent (ms)=1639690
		Physical memory (bytes) snapshot=312340467712
		Virtual memory (bytes) snapshot=741936128000
		Total committed heap usage (bytes)=574316085248
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=1024775348
	File Output Format Counters 
		Bytes Written=665353381
16/12/09 10:30:50 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/1900
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081600 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/2000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081600
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/2000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3443945230879183383.jar tmpDir=null
16/12/09 10:31:30 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 10:31:31 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 10:31:31 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 10:31:32 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 10:31:33 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 10:31:33 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5990
16/12/09 10:31:34 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5990
16/12/09 10:31:34 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5990/
16/12/09 10:31:34 INFO mapreduce.Job: Running job: job_1480588584072_5990
16/12/09 10:31:48 INFO mapreduce.Job: Job job_1480588584072_5990 running in uber mode : false
16/12/09 10:31:48 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 10:32:10 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 10:32:13 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 10:32:24 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 10:32:32 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 10:32:46 INFO mapreduce.Job:  map 5% reduce 0%
16/12/09 10:32:49 INFO mapreduce.Job:  map 7% reduce 0%
16/12/09 10:32:51 INFO mapreduce.Job:  map 8% reduce 0%
16/12/09 10:32:57 INFO mapreduce.Job:  map 10% reduce 0%
16/12/09 10:33:03 INFO mapreduce.Job:  map 11% reduce 0%
16/12/09 10:33:07 INFO mapreduce.Job:  map 12% reduce 0%
16/12/09 10:33:08 INFO mapreduce.Job:  map 15% reduce 0%
16/12/09 10:33:10 INFO mapreduce.Job:  map 19% reduce 0%
16/12/09 10:33:13 INFO mapreduce.Job:  map 21% reduce 0%
16/12/09 10:33:14 INFO mapreduce.Job:  map 30% reduce 0%
16/12/09 10:33:16 INFO mapreduce.Job:  map 33% reduce 0%
16/12/09 10:33:17 INFO mapreduce.Job:  map 42% reduce 0%
16/12/09 10:33:18 INFO mapreduce.Job:  map 43% reduce 0%
16/12/09 10:33:19 INFO mapreduce.Job:  map 44% reduce 0%
16/12/09 10:33:20 INFO mapreduce.Job:  map 49% reduce 0%
16/12/09 10:33:22 INFO mapreduce.Job:  map 57% reduce 0%
16/12/09 10:33:23 INFO mapreduce.Job:  map 59% reduce 0%
16/12/09 10:33:24 INFO mapreduce.Job:  map 62% reduce 0%
16/12/09 10:33:25 INFO mapreduce.Job:  map 63% reduce 0%
16/12/09 10:33:26 INFO mapreduce.Job:  map 66% reduce 0%
16/12/09 10:33:27 INFO mapreduce.Job:  map 70% reduce 0%
16/12/09 10:33:28 INFO mapreduce.Job:  map 73% reduce 1%
16/12/09 10:33:29 INFO mapreduce.Job:  map 75% reduce 3%
16/12/09 10:33:30 INFO mapreduce.Job:  map 77% reduce 3%
16/12/09 10:33:31 INFO mapreduce.Job:  map 78% reduce 4%
16/12/09 10:33:32 INFO mapreduce.Job:  map 79% reduce 4%
16/12/09 10:33:33 INFO mapreduce.Job:  map 81% reduce 4%
16/12/09 10:33:35 INFO mapreduce.Job:  map 82% reduce 4%
16/12/09 10:33:39 INFO mapreduce.Job:  map 83% reduce 8%
16/12/09 10:33:40 INFO mapreduce.Job:  map 83% reduce 10%
16/12/09 10:33:41 INFO mapreduce.Job:  map 84% reduce 11%
16/12/09 10:33:42 INFO mapreduce.Job:  map 86% reduce 12%
16/12/09 10:33:45 INFO mapreduce.Job:  map 89% reduce 14%
16/12/09 10:33:46 INFO mapreduce.Job:  map 90% reduce 16%
16/12/09 10:33:47 INFO mapreduce.Job:  map 91% reduce 16%
16/12/09 10:33:49 INFO mapreduce.Job:  map 92% reduce 17%
16/12/09 10:33:51 INFO mapreduce.Job:  map 92% reduce 20%
16/12/09 10:33:52 INFO mapreduce.Job:  map 93% reduce 21%
16/12/09 10:33:53 INFO mapreduce.Job:  map 94% reduce 23%
16/12/09 10:33:54 INFO mapreduce.Job:  map 94% reduce 25%
16/12/09 10:33:55 INFO mapreduce.Job:  map 95% reduce 25%
16/12/09 10:33:56 INFO mapreduce.Job:  map 96% reduce 25%
16/12/09 10:33:58 INFO mapreduce.Job:  map 97% reduce 27%
16/12/09 10:33:59 INFO mapreduce.Job:  map 98% reduce 29%
16/12/09 10:34:00 INFO mapreduce.Job:  map 99% reduce 29%
16/12/09 10:34:01 INFO mapreduce.Job:  map 99% reduce 30%
16/12/09 10:34:02 INFO mapreduce.Job:  map 100% reduce 30%
16/12/09 10:34:03 INFO mapreduce.Job:  map 100% reduce 38%
16/12/09 10:34:04 INFO mapreduce.Job:  map 100% reduce 42%
16/12/09 10:34:05 INFO mapreduce.Job:  map 100% reduce 47%
16/12/09 10:34:06 INFO mapreduce.Job:  map 100% reduce 58%
16/12/09 10:34:07 INFO mapreduce.Job:  map 100% reduce 68%
16/12/09 10:34:08 INFO mapreduce.Job:  map 100% reduce 71%
16/12/09 10:34:09 INFO mapreduce.Job:  map 100% reduce 72%
16/12/09 10:34:10 INFO mapreduce.Job:  map 100% reduce 78%
16/12/09 10:34:11 INFO mapreduce.Job:  map 100% reduce 79%
16/12/09 10:34:12 INFO mapreduce.Job:  map 100% reduce 82%
16/12/09 10:34:13 INFO mapreduce.Job:  map 100% reduce 84%
16/12/09 10:34:14 INFO mapreduce.Job:  map 100% reduce 86%
16/12/09 10:34:15 INFO mapreduce.Job:  map 100% reduce 87%
16/12/09 10:34:16 INFO mapreduce.Job:  map 100% reduce 89%
16/12/09 10:34:17 INFO mapreduce.Job:  map 100% reduce 90%
16/12/09 10:34:18 INFO mapreduce.Job:  map 100% reduce 92%
16/12/09 10:34:20 INFO mapreduce.Job:  map 100% reduce 93%
16/12/09 10:34:21 INFO mapreduce.Job:  map 100% reduce 94%
16/12/09 10:34:22 INFO mapreduce.Job:  map 100% reduce 95%
16/12/09 10:34:26 INFO mapreduce.Job:  map 100% reduce 96%
16/12/09 10:34:27 INFO mapreduce.Job:  map 100% reduce 97%
16/12/09 10:34:30 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 10:34:35 INFO mapreduce.Job:  map 100% reduce 99%
16/12/09 10:34:41 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 10:34:48 INFO mapreduce.Job: Job job_1480588584072_5990 completed successfully
16/12/09 10:34:48 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=853250746
		FILE: Number of bytes written=1738883457
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=763824237
		WASB: Number of bytes written=438287005
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=20973132
		Total time spent by all reduces in occupied slots (ms)=2544894
		Total time spent by all map tasks (ms)=10486566
		Total time spent by all reduce tasks (ms)=1272447
		Total vcore-seconds taken by all map tasks=10486566
		Total vcore-seconds taken by all reduce tasks=1272447
		Total megabyte-seconds taken by all map tasks=10738243584
		Total megabyte-seconds taken by all reduce tasks=1302985728
	Map-Reduce Framework
		Map input records=2785745
		Map output records=2179263
		Map output bytes=845158330
		Map output materialized bytes=853274266
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1965403
		Reduce shuffle bytes=853274266
		Reduce input records=2179263
		Reduce output records=1373241
		Spilled Records=4358526
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=154819
		CPU time spent (ms)=1023150
		Physical memory (bytes) snapshot=323780210688
		Virtual memory (bytes) snapshot=742499872768
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=761128233
	File Output Format Counters 
		Bytes Written=438287005
16/12/09 10:34:48 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/2000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081700 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/2100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081700
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/2100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3264215973561605447.jar tmpDir=null
16/12/09 10:35:27 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 10:35:28 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 10:35:28 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 10:35:29 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 10:35:30 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 10:35:30 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5994
16/12/09 10:35:31 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5994
16/12/09 10:35:31 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5994/
16/12/09 10:35:31 INFO mapreduce.Job: Running job: job_1480588584072_5994
16/12/09 10:36:02 INFO mapreduce.Job: Job job_1480588584072_5994 running in uber mode : false
16/12/09 10:36:02 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 10:36:17 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 10:36:22 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 10:36:27 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 10:36:34 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 10:36:37 INFO mapreduce.Job:  map 5% reduce 0%
16/12/09 10:36:40 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 10:36:44 INFO mapreduce.Job:  map 8% reduce 0%
16/12/09 10:36:47 INFO mapreduce.Job:  map 10% reduce 0%
16/12/09 10:36:48 INFO mapreduce.Job:  map 12% reduce 0%
16/12/09 10:36:53 INFO mapreduce.Job:  map 13% reduce 0%
16/12/09 10:36:54 INFO mapreduce.Job:  map 14% reduce 0%
16/12/09 10:36:59 INFO mapreduce.Job:  map 16% reduce 0%
16/12/09 10:37:00 INFO mapreduce.Job:  map 18% reduce 0%
16/12/09 10:37:01 INFO mapreduce.Job:  map 20% reduce 0%
16/12/09 10:37:02 INFO mapreduce.Job:  map 22% reduce 0%
16/12/09 10:37:04 INFO mapreduce.Job:  map 25% reduce 0%
16/12/09 10:37:05 INFO mapreduce.Job:  map 27% reduce 0%
16/12/09 10:37:06 INFO mapreduce.Job:  map 28% reduce 0%
16/12/09 10:37:07 INFO mapreduce.Job:  map 29% reduce 0%
16/12/09 10:37:08 INFO mapreduce.Job:  map 30% reduce 0%
16/12/09 10:37:09 INFO mapreduce.Job:  map 31% reduce 0%
16/12/09 10:37:10 INFO mapreduce.Job:  map 33% reduce 1%
16/12/09 10:37:12 INFO mapreduce.Job:  map 35% reduce 1%
16/12/09 10:37:13 INFO mapreduce.Job:  map 38% reduce 2%
16/12/09 10:37:15 INFO mapreduce.Job:  map 40% reduce 2%
16/12/09 10:37:17 INFO mapreduce.Job:  map 43% reduce 2%
16/12/09 10:37:18 INFO mapreduce.Job:  map 44% reduce 2%
16/12/09 10:37:19 INFO mapreduce.Job:  map 47% reduce 2%
16/12/09 10:37:20 INFO mapreduce.Job:  map 49% reduce 2%
16/12/09 10:37:21 INFO mapreduce.Job:  map 54% reduce 3%
16/12/09 10:37:23 INFO mapreduce.Job:  map 59% reduce 3%
16/12/09 10:37:24 INFO mapreduce.Job:  map 63% reduce 3%
16/12/09 10:37:25 INFO mapreduce.Job:  map 65% reduce 4%
16/12/09 10:37:26 INFO mapreduce.Job:  map 69% reduce 6%
16/12/09 10:37:27 INFO mapreduce.Job:  map 73% reduce 7%
16/12/09 10:37:28 INFO mapreduce.Job:  map 76% reduce 10%
16/12/09 10:37:29 INFO mapreduce.Job:  map 77% reduce 10%
16/12/09 10:37:30 INFO mapreduce.Job:  map 79% reduce 12%
16/12/09 10:37:31 INFO mapreduce.Job:  map 81% reduce 15%
16/12/09 10:37:32 INFO mapreduce.Job:  map 84% reduce 17%
16/12/09 10:37:33 INFO mapreduce.Job:  map 87% reduce 17%
16/12/09 10:37:34 INFO mapreduce.Job:  map 88% reduce 19%
16/12/09 10:37:35 INFO mapreduce.Job:  map 90% reduce 20%
16/12/09 10:37:36 INFO mapreduce.Job:  map 90% reduce 22%
16/12/09 10:37:37 INFO mapreduce.Job:  map 90% reduce 24%
16/12/09 10:37:39 INFO mapreduce.Job:  map 91% reduce 24%
16/12/09 10:37:40 INFO mapreduce.Job:  map 93% reduce 24%
16/12/09 10:37:41 INFO mapreduce.Job:  map 93% reduce 26%
16/12/09 10:37:42 INFO mapreduce.Job:  map 94% reduce 26%
16/12/09 10:37:44 INFO mapreduce.Job:  map 95% reduce 28%
16/12/09 10:37:45 INFO mapreduce.Job:  map 96% reduce 28%
16/12/09 10:37:47 INFO mapreduce.Job:  map 97% reduce 29%
16/12/09 10:37:48 INFO mapreduce.Job:  map 98% reduce 30%
16/12/09 10:37:49 INFO mapreduce.Job:  map 99% reduce 31%
16/12/09 10:37:54 INFO mapreduce.Job:  map 100% reduce 31%
16/12/09 10:37:55 INFO mapreduce.Job:  map 100% reduce 33%
16/12/09 10:38:09 INFO mapreduce.Job:  map 100% reduce 34%
16/12/09 10:38:11 INFO mapreduce.Job:  map 100% reduce 38%
16/12/09 10:38:12 INFO mapreduce.Job:  map 100% reduce 45%
16/12/09 10:38:13 INFO mapreduce.Job:  map 100% reduce 50%
16/12/09 10:38:14 INFO mapreduce.Job:  map 100% reduce 57%
16/12/09 10:38:16 INFO mapreduce.Job:  map 100% reduce 59%
16/12/09 10:38:17 INFO mapreduce.Job:  map 100% reduce 61%
16/12/09 10:38:18 INFO mapreduce.Job:  map 100% reduce 63%
16/12/09 10:38:19 INFO mapreduce.Job:  map 100% reduce 65%
16/12/09 10:38:20 INFO mapreduce.Job:  map 100% reduce 67%
16/12/09 10:38:21 INFO mapreduce.Job:  map 100% reduce 69%
16/12/09 10:38:22 INFO mapreduce.Job:  map 100% reduce 70%
16/12/09 10:38:23 INFO mapreduce.Job:  map 100% reduce 72%
16/12/09 10:38:24 INFO mapreduce.Job:  map 100% reduce 75%
16/12/09 10:38:25 INFO mapreduce.Job:  map 100% reduce 77%
16/12/09 10:38:26 INFO mapreduce.Job:  map 100% reduce 78%
16/12/09 10:38:27 INFO mapreduce.Job:  map 100% reduce 81%
16/12/09 10:38:28 INFO mapreduce.Job:  map 100% reduce 84%
16/12/09 10:38:29 INFO mapreduce.Job:  map 100% reduce 85%
16/12/09 10:38:30 INFO mapreduce.Job:  map 100% reduce 87%
16/12/09 10:38:31 INFO mapreduce.Job:  map 100% reduce 89%
16/12/09 10:38:32 INFO mapreduce.Job:  map 100% reduce 91%
16/12/09 10:38:33 INFO mapreduce.Job:  map 100% reduce 95%
16/12/09 10:38:34 INFO mapreduce.Job:  map 100% reduce 97%
16/12/09 10:38:36 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 10:38:37 INFO mapreduce.Job:  map 100% reduce 99%
16/12/09 10:38:39 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 10:38:42 INFO mapreduce.Job: Job job_1480588584072_5994 completed successfully
16/12/09 10:38:42 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=871501878
		FILE: Number of bytes written=1775385721
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=756879729
		WASB: Number of bytes written=490800609
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=17788212
		Total time spent by all reduces in occupied slots (ms)=3964506
		Total time spent by all map tasks (ms)=8894106
		Total time spent by all reduce tasks (ms)=1982253
		Total vcore-seconds taken by all map tasks=8894106
		Total vcore-seconds taken by all reduce tasks=1982253
		Total megabyte-seconds taken by all map tasks=9107564544
		Total megabyte-seconds taken by all reduce tasks=2029827072
	Map-Reduce Framework
		Map input records=2716865
		Map output records=2232949
		Map output bytes=863271854
		Map output materialized bytes=871525398
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2037134
		Reduce shuffle bytes=871525398
		Reduce input records=2232949
		Reduce output records=1550207
		Spilled Records=4465898
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=180674
		CPU time spent (ms)=1016020
		Physical memory (bytes) snapshot=325142380544
		Virtual memory (bytes) snapshot=742290575360
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=754183725
	File Output Format Counters 
		Bytes Written=490800609
16/12/09 10:38:42 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/2100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081800 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/2200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081800
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/2200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3408027306212875136.jar tmpDir=null
16/12/09 10:39:22 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 10:39:23 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 10:39:23 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 10:39:25 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 10:39:25 INFO mapreduce.JobSubmitter: number of splits:229
16/12/09 10:39:25 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_5998
16/12/09 10:39:26 INFO impl.YarnClientImpl: Submitted application application_1480588584072_5998
16/12/09 10:39:26 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_5998/
16/12/09 10:39:26 INFO mapreduce.Job: Running job: job_1480588584072_5998
16/12/09 10:40:18 INFO mapreduce.Job: Job job_1480588584072_5998 running in uber mode : false
16/12/09 10:40:18 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 10:41:15 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 10:41:17 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 10:41:19 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 10:41:23 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 10:41:24 INFO mapreduce.Job:  map 5% reduce 0%
16/12/09 10:41:26 INFO mapreduce.Job:  map 7% reduce 0%
16/12/09 10:41:27 INFO mapreduce.Job:  map 8% reduce 0%
16/12/09 10:41:28 INFO mapreduce.Job:  map 9% reduce 0%
16/12/09 10:41:32 INFO mapreduce.Job:  map 13% reduce 0%
16/12/09 10:41:34 INFO mapreduce.Job:  map 14% reduce 0%
16/12/09 10:41:41 INFO mapreduce.Job:  map 15% reduce 0%
16/12/09 10:42:04 INFO mapreduce.Job:  map 16% reduce 0%
16/12/09 10:42:07 INFO mapreduce.Job:  map 17% reduce 0%
16/12/09 10:42:08 INFO mapreduce.Job:  map 18% reduce 1%
16/12/09 10:42:10 INFO mapreduce.Job:  map 20% reduce 1%
16/12/09 10:42:11 INFO mapreduce.Job:  map 21% reduce 2%
16/12/09 10:42:12 INFO mapreduce.Job:  map 21% reduce 3%
16/12/09 10:42:13 INFO mapreduce.Job:  map 22% reduce 5%
16/12/09 10:42:14 INFO mapreduce.Job:  map 23% reduce 5%
16/12/09 10:42:15 INFO mapreduce.Job:  map 24% reduce 6%
16/12/09 10:42:16 INFO mapreduce.Job:  map 28% reduce 6%
16/12/09 10:42:17 INFO mapreduce.Job:  map 29% reduce 6%
16/12/09 10:42:18 INFO mapreduce.Job:  map 32% reduce 7%
16/12/09 10:42:19 INFO mapreduce.Job:  map 34% reduce 7%
16/12/09 10:42:20 INFO mapreduce.Job:  map 37% reduce 7%
16/12/09 10:42:21 INFO mapreduce.Job:  map 39% reduce 8%
16/12/09 10:42:22 INFO mapreduce.Job:  map 41% reduce 8%
16/12/09 10:42:23 INFO mapreduce.Job:  map 42% reduce 9%
16/12/09 10:42:24 INFO mapreduce.Job:  map 44% reduce 10%
16/12/09 10:42:25 INFO mapreduce.Job:  map 47% reduce 10%
16/12/09 10:42:26 INFO mapreduce.Job:  map 52% reduce 11%
16/12/09 10:42:27 INFO mapreduce.Job:  map 54% reduce 11%
16/12/09 10:42:28 INFO mapreduce.Job:  map 56% reduce 12%
16/12/09 10:42:29 INFO mapreduce.Job:  map 60% reduce 13%
16/12/09 10:42:30 INFO mapreduce.Job:  map 62% reduce 15%
16/12/09 10:42:31 INFO mapreduce.Job:  map 66% reduce 16%
16/12/09 10:42:32 INFO mapreduce.Job:  map 71% reduce 17%
16/12/09 10:42:33 INFO mapreduce.Job:  map 75% reduce 20%
16/12/09 10:42:34 INFO mapreduce.Job:  map 77% reduce 21%
16/12/09 10:42:35 INFO mapreduce.Job:  map 78% reduce 23%
16/12/09 10:42:36 INFO mapreduce.Job:  map 80% reduce 24%
16/12/09 10:42:37 INFO mapreduce.Job:  map 81% reduce 25%
16/12/09 10:42:40 INFO mapreduce.Job:  map 82% reduce 26%
16/12/09 10:42:54 INFO mapreduce.Job: Task Id : attempt_1480588584072_5998_m_000040_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 10:42:58 INFO mapreduce.Job:  map 83% reduce 27%
16/12/09 10:43:07 INFO mapreduce.Job:  map 84% reduce 27%
16/12/09 10:43:18 INFO mapreduce.Job:  map 85% reduce 27%
16/12/09 10:43:49 INFO mapreduce.Job: Task Id : attempt_1480588584072_5998_m_000014_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 10:43:49 INFO mapreduce.Job: Task Id : attempt_1480588584072_5998_m_000022_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 10:43:49 INFO mapreduce.Job: Task Id : attempt_1480588584072_5998_m_000004_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 10:43:50 INFO mapreduce.Job:  map 84% reduce 27%
16/12/09 10:43:52 INFO mapreduce.Job:  map 85% reduce 28%
16/12/09 10:43:54 INFO mapreduce.Job:  map 86% reduce 28%
16/12/09 10:43:57 INFO mapreduce.Job:  map 87% reduce 28%
16/12/09 10:43:59 INFO mapreduce.Job:  map 88% reduce 28%
16/12/09 10:44:00 INFO mapreduce.Job:  map 89% reduce 28%
16/12/09 10:44:01 INFO mapreduce.Job:  map 90% reduce 28%
16/12/09 10:44:02 INFO mapreduce.Job:  map 91% reduce 28%
16/12/09 10:44:04 INFO mapreduce.Job:  map 92% reduce 28%
16/12/09 10:44:07 INFO mapreduce.Job:  map 92% reduce 29%
16/12/09 10:44:08 INFO mapreduce.Job:  map 93% reduce 29%
16/12/09 10:44:12 INFO mapreduce.Job:  map 94% reduce 29%
16/12/09 10:44:13 INFO mapreduce.Job:  map 95% reduce 29%
16/12/09 10:44:15 INFO mapreduce.Job:  map 96% reduce 29%
16/12/09 10:44:16 INFO mapreduce.Job:  map 97% reduce 30%
16/12/09 10:44:18 INFO mapreduce.Job:  map 98% reduce 30%
16/12/09 10:44:20 INFO mapreduce.Job:  map 98% reduce 31%
16/12/09 10:44:22 INFO mapreduce.Job:  map 99% reduce 31%
16/12/09 10:44:23 INFO mapreduce.Job:  map 100% reduce 32%
16/12/09 10:44:25 INFO mapreduce.Job:  map 100% reduce 33%
16/12/09 10:44:26 INFO mapreduce.Job:  map 100% reduce 38%
16/12/09 10:44:27 INFO mapreduce.Job:  map 100% reduce 39%
16/12/09 10:44:28 INFO mapreduce.Job:  map 100% reduce 42%
16/12/09 10:44:29 INFO mapreduce.Job:  map 100% reduce 50%
16/12/09 10:44:30 INFO mapreduce.Job:  map 100% reduce 56%
16/12/09 10:44:31 INFO mapreduce.Job:  map 100% reduce 58%
16/12/09 10:44:32 INFO mapreduce.Job:  map 100% reduce 64%
16/12/09 10:44:33 INFO mapreduce.Job:  map 100% reduce 67%
16/12/09 10:44:34 INFO mapreduce.Job:  map 100% reduce 68%
16/12/09 10:44:35 INFO mapreduce.Job:  map 100% reduce 70%
16/12/09 10:44:36 INFO mapreduce.Job:  map 100% reduce 71%
16/12/09 10:44:37 INFO mapreduce.Job:  map 100% reduce 72%
16/12/09 10:44:39 INFO mapreduce.Job:  map 100% reduce 73%
16/12/09 10:44:40 INFO mapreduce.Job:  map 100% reduce 74%
16/12/09 10:44:42 INFO mapreduce.Job:  map 100% reduce 75%
16/12/09 10:44:44 INFO mapreduce.Job:  map 100% reduce 76%
16/12/09 10:44:45 INFO mapreduce.Job:  map 100% reduce 77%
16/12/09 10:44:47 INFO mapreduce.Job:  map 100% reduce 78%
16/12/09 10:44:48 INFO mapreduce.Job:  map 100% reduce 79%
16/12/09 10:44:49 INFO mapreduce.Job:  map 100% reduce 80%
16/12/09 10:44:51 INFO mapreduce.Job:  map 100% reduce 81%
16/12/09 10:44:52 INFO mapreduce.Job:  map 100% reduce 82%
16/12/09 10:44:53 INFO mapreduce.Job:  map 100% reduce 83%
16/12/09 10:44:54 INFO mapreduce.Job:  map 100% reduce 84%
16/12/09 10:44:55 INFO mapreduce.Job:  map 100% reduce 85%
16/12/09 10:44:56 INFO mapreduce.Job:  map 100% reduce 86%
16/12/09 10:44:57 INFO mapreduce.Job:  map 100% reduce 87%
16/12/09 10:44:58 INFO mapreduce.Job:  map 100% reduce 88%
16/12/09 10:44:59 INFO mapreduce.Job:  map 100% reduce 89%
16/12/09 10:45:01 INFO mapreduce.Job:  map 100% reduce 90%
16/12/09 10:45:02 INFO mapreduce.Job:  map 100% reduce 91%
16/12/09 10:45:04 INFO mapreduce.Job:  map 100% reduce 92%
16/12/09 10:45:06 INFO mapreduce.Job:  map 100% reduce 93%
16/12/09 10:45:07 INFO mapreduce.Job:  map 100% reduce 94%
16/12/09 10:45:09 INFO mapreduce.Job:  map 100% reduce 96%
16/12/09 10:45:13 INFO mapreduce.Job:  map 100% reduce 97%
16/12/09 10:45:15 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 10:45:18 INFO mapreduce.Job:  map 100% reduce 99%
16/12/09 10:45:26 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 10:45:31 INFO mapreduce.Job: Job job_1480588584072_5998 completed successfully
16/12/09 10:45:31 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=1030616140
		FILE: Number of bytes written=2098391365
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=872232619
		WASB: Number of bytes written=641057328
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=4
		Launched map tasks=233
		Launched reduce tasks=20
		Other local map tasks=4
		Rack-local map tasks=229
		Total time spent by all maps in occupied slots (ms)=61970094
		Total time spent by all reduces in occupied slots (ms)=8611194
		Total time spent by all map tasks (ms)=30985047
		Total time spent by all reduce tasks (ms)=4305597
		Total vcore-seconds taken by all map tasks=30985047
		Total vcore-seconds taken by all reduce tasks=4305597
		Total megabyte-seconds taken by all map tasks=31728688128
		Total megabyte-seconds taken by all reduce tasks=4408931328
	Map-Reduce Framework
		Map input records=3026868
		Map output records=2629888
		Map output bytes=1020968581
		Map output materialized bytes=1030643500
		Input split bytes=31932
		Combine input records=0
		Combine output records=0
		Reduce input groups=2425000
		Reduce shuffle bytes=1030643500
		Reduce input records=2629888
		Reduce output records=2019232
		Spilled Records=5259776
		Shuffled Maps =4580
		Failed Shuffles=0
		Merged Map outputs=4580
		GC time elapsed (ms)=389526
		CPU time spent (ms)=1606810
		Physical memory (bytes) snapshot=371287547904
		Virtual memory (bytes) snapshot=851382824960
		Total committed heap usage (bytes)=658591711232
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=868584464
	File Output Format Counters 
		Bytes Written=641057328
16/12/09 10:45:31 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/2200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081900 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/2300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161208/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081900
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/2300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7335692486280417762.jar tmpDir=null
16/12/09 10:46:11 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 10:46:11 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 10:46:12 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 10:46:14 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 10:46:14 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 10:46:15 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6006
16/12/09 10:46:16 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6006
16/12/09 10:46:16 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6006/
16/12/09 10:46:16 INFO mapreduce.Job: Running job: job_1480588584072_6006
16/12/09 10:46:48 INFO mapreduce.Job: Job job_1480588584072_6006 running in uber mode : false
16/12/09 10:46:48 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 10:47:09 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 10:47:16 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 10:47:17 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 10:47:24 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 10:47:26 INFO mapreduce.Job:  map 5% reduce 0%
16/12/09 10:47:27 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 10:47:28 INFO mapreduce.Job:  map 9% reduce 0%
16/12/09 10:47:41 INFO mapreduce.Job:  map 10% reduce 0%
16/12/09 10:47:43 INFO mapreduce.Job:  map 11% reduce 0%
16/12/09 10:47:45 INFO mapreduce.Job:  map 13% reduce 0%
16/12/09 10:47:46 INFO mapreduce.Job:  map 14% reduce 0%
16/12/09 10:47:48 INFO mapreduce.Job:  map 15% reduce 0%
16/12/09 10:47:49 INFO mapreduce.Job:  map 16% reduce 0%
16/12/09 10:47:52 INFO mapreduce.Job:  map 17% reduce 0%
16/12/09 10:47:55 INFO mapreduce.Job:  map 18% reduce 1%
16/12/09 10:47:56 INFO mapreduce.Job:  map 19% reduce 1%
16/12/09 10:47:57 INFO mapreduce.Job:  map 20% reduce 1%
16/12/09 10:48:00 INFO mapreduce.Job:  map 21% reduce 1%
16/12/09 10:48:01 INFO mapreduce.Job:  map 22% reduce 1%
16/12/09 10:48:02 INFO mapreduce.Job:  map 23% reduce 2%
16/12/09 10:48:04 INFO mapreduce.Job:  map 25% reduce 2%
16/12/09 10:48:06 INFO mapreduce.Job:  map 26% reduce 2%
16/12/09 10:48:07 INFO mapreduce.Job:  map 27% reduce 2%
16/12/09 10:48:08 INFO mapreduce.Job:  map 28% reduce 2%
16/12/09 10:48:09 INFO mapreduce.Job:  map 29% reduce 3%
16/12/09 10:48:10 INFO mapreduce.Job:  map 30% reduce 3%
16/12/09 10:48:13 INFO mapreduce.Job:  map 31% reduce 3%
16/12/09 10:48:14 INFO mapreduce.Job:  map 31% reduce 4%
16/12/09 10:48:15 INFO mapreduce.Job:  map 31% reduce 5%
16/12/09 10:48:16 INFO mapreduce.Job:  map 31% reduce 6%
16/12/09 10:48:17 INFO mapreduce.Job:  map 31% reduce 7%
16/12/09 10:48:18 INFO mapreduce.Job:  map 31% reduce 8%
16/12/09 10:48:19 INFO mapreduce.Job:  map 31% reduce 10%
16/12/09 10:48:29 INFO mapreduce.Job:  map 32% reduce 10%
16/12/09 10:48:34 INFO mapreduce.Job:  map 33% reduce 10%
16/12/09 10:48:36 INFO mapreduce.Job:  map 34% reduce 10%
16/12/09 10:48:37 INFO mapreduce.Job:  map 35% reduce 10%
16/12/09 10:48:38 INFO mapreduce.Job:  map 37% reduce 10%
16/12/09 10:48:39 INFO mapreduce.Job:  map 38% reduce 10%
16/12/09 10:48:40 INFO mapreduce.Job:  map 41% reduce 10%
16/12/09 10:48:42 INFO mapreduce.Job:  map 42% reduce 10%
16/12/09 10:48:44 INFO mapreduce.Job:  map 43% reduce 10%
16/12/09 10:48:45 INFO mapreduce.Job:  map 44% reduce 10%
16/12/09 10:48:46 INFO mapreduce.Job:  map 45% reduce 11%
16/12/09 10:48:47 INFO mapreduce.Job:  map 47% reduce 11%
16/12/09 10:48:48 INFO mapreduce.Job:  map 49% reduce 11%
16/12/09 10:48:50 INFO mapreduce.Job:  map 50% reduce 12%
16/12/09 10:48:51 INFO mapreduce.Job:  map 52% reduce 12%
16/12/09 10:48:52 INFO mapreduce.Job:  map 54% reduce 13%
16/12/09 10:48:54 INFO mapreduce.Job:  map 55% reduce 13%
16/12/09 10:48:55 INFO mapreduce.Job:  map 58% reduce 14%
16/12/09 10:48:56 INFO mapreduce.Job:  map 61% reduce 15%
16/12/09 10:48:58 INFO mapreduce.Job:  map 63% reduce 16%
16/12/09 10:48:59 INFO mapreduce.Job:  map 66% reduce 17%
16/12/09 10:49:00 INFO mapreduce.Job:  map 69% reduce 18%
16/12/09 10:49:01 INFO mapreduce.Job:  map 70% reduce 20%
16/12/09 10:49:02 INFO mapreduce.Job:  map 71% reduce 21%
16/12/09 10:49:03 INFO mapreduce.Job:  map 74% reduce 21%
16/12/09 10:49:04 INFO mapreduce.Job:  map 74% reduce 22%
16/12/09 10:49:05 INFO mapreduce.Job:  map 76% reduce 22%
16/12/09 10:49:06 INFO mapreduce.Job:  map 79% reduce 23%
16/12/09 10:49:07 INFO mapreduce.Job:  map 80% reduce 24%
16/12/09 10:49:08 INFO mapreduce.Job:  map 83% reduce 24%
16/12/09 10:49:09 INFO mapreduce.Job:  map 84% reduce 25%
16/12/09 10:49:10 INFO mapreduce.Job:  map 85% reduce 26%
16/12/09 10:49:12 INFO mapreduce.Job:  map 85% reduce 27%
16/12/09 10:49:13 INFO mapreduce.Job:  map 86% reduce 27%
16/12/09 10:49:14 INFO mapreduce.Job:  map 87% reduce 27%
16/12/09 10:49:16 INFO mapreduce.Job:  map 88% reduce 27%
16/12/09 10:49:19 INFO mapreduce.Job:  map 90% reduce 27%
16/12/09 10:49:21 INFO mapreduce.Job:  map 93% reduce 27%
16/12/09 10:49:22 INFO mapreduce.Job:  map 94% reduce 27%
16/12/09 10:49:23 INFO mapreduce.Job:  map 95% reduce 28%
16/12/09 10:49:25 INFO mapreduce.Job:  map 96% reduce 29%
16/12/09 10:49:26 INFO mapreduce.Job:  map 97% reduce 29%
16/12/09 10:49:27 INFO mapreduce.Job:  map 97% reduce 30%
16/12/09 10:49:28 INFO mapreduce.Job:  map 98% reduce 31%
16/12/09 10:49:29 INFO mapreduce.Job:  map 99% reduce 31%
16/12/09 10:49:30 INFO mapreduce.Job:  map 100% reduce 32%
16/12/09 10:49:31 INFO mapreduce.Job:  map 100% reduce 34%
16/12/09 10:49:32 INFO mapreduce.Job:  map 100% reduce 37%
16/12/09 10:49:33 INFO mapreduce.Job:  map 100% reduce 40%
16/12/09 10:49:34 INFO mapreduce.Job:  map 100% reduce 45%
16/12/09 10:49:35 INFO mapreduce.Job:  map 100% reduce 61%
16/12/09 10:49:36 INFO mapreduce.Job:  map 100% reduce 64%
16/12/09 10:49:37 INFO mapreduce.Job:  map 100% reduce 68%
16/12/09 10:49:38 INFO mapreduce.Job:  map 100% reduce 73%
16/12/09 10:49:39 INFO mapreduce.Job:  map 100% reduce 77%
16/12/09 10:49:40 INFO mapreduce.Job:  map 100% reduce 79%
16/12/09 10:49:41 INFO mapreduce.Job:  map 100% reduce 80%
16/12/09 10:49:42 INFO mapreduce.Job:  map 100% reduce 84%
16/12/09 10:49:44 INFO mapreduce.Job:  map 100% reduce 85%
16/12/09 10:49:45 INFO mapreduce.Job:  map 100% reduce 89%
16/12/09 10:49:46 INFO mapreduce.Job:  map 100% reduce 90%
16/12/09 10:49:47 INFO mapreduce.Job:  map 100% reduce 91%
16/12/09 10:49:48 INFO mapreduce.Job:  map 100% reduce 93%
16/12/09 10:49:49 INFO mapreduce.Job:  map 100% reduce 96%
16/12/09 10:49:50 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 10:49:51 INFO mapreduce.Job:  map 100% reduce 99%
16/12/09 10:49:54 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 10:49:57 INFO mapreduce.Job: Job job_1480588584072_6006 completed successfully
16/12/09 10:49:57 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=676396527
		FILE: Number of bytes written=1385175019
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=574345943
		WASB: Number of bytes written=389103450
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=42916718
		Total time spent by all reduces in occupied slots (ms)=4941274
		Total time spent by all map tasks (ms)=21458359
		Total time spent by all reduce tasks (ms)=2470637
		Total vcore-seconds taken by all map tasks=21458359
		Total vcore-seconds taken by all reduce tasks=2470637
		Total megabyte-seconds taken by all map tasks=21973359616
		Total megabyte-seconds taken by all reduce tasks=2529932288
	Map-Reduce Framework
		Map input records=2072238
		Map output records=1760360
		Map output bytes=670001816
		Map output materialized bytes=676420047
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1614766
		Reduce shuffle bytes=676420047
		Reduce input records=1760360
		Reduce output records=1247784
		Spilled Records=3520720
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=235632
		CPU time spent (ms)=1084950
		Physical memory (bytes) snapshot=319568351232
		Virtual memory (bytes) snapshot=741716025344
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=571649939
	File Output Format Counters 
		Bytes Written=389103450
16/12/09 10:49:57 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161208/2300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161208/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1825171539468143400.jar tmpDir=null
16/12/09 10:50:36 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 10:50:37 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 10:50:37 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 10:50:39 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 10:50:39 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 10:50:40 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6012
16/12/09 10:50:41 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6012
16/12/09 10:50:41 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6012/
16/12/09 10:50:41 INFO mapreduce.Job: Running job: job_1480588584072_6012
16/12/09 10:50:53 INFO mapreduce.Job: Job job_1480588584072_6012 running in uber mode : false
16/12/09 10:50:53 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 10:51:55 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 10:52:00 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 10:52:02 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 10:52:04 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 10:52:07 INFO mapreduce.Job:  map 5% reduce 0%
16/12/09 10:52:08 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 10:52:12 INFO mapreduce.Job:  map 7% reduce 0%
16/12/09 10:52:15 INFO mapreduce.Job:  map 9% reduce 0%
16/12/09 10:52:18 INFO mapreduce.Job:  map 10% reduce 0%
16/12/09 10:52:21 INFO mapreduce.Job:  map 12% reduce 0%
16/12/09 10:52:25 INFO mapreduce.Job:  map 13% reduce 0%
16/12/09 10:52:26 INFO mapreduce.Job:  map 15% reduce 0%
16/12/09 10:52:27 INFO mapreduce.Job:  map 16% reduce 0%
16/12/09 10:52:31 INFO mapreduce.Job:  map 18% reduce 0%
16/12/09 10:52:33 INFO mapreduce.Job:  map 19% reduce 0%
16/12/09 10:52:34 INFO mapreduce.Job:  map 20% reduce 0%
16/12/09 10:52:35 INFO mapreduce.Job:  map 21% reduce 0%
16/12/09 10:52:36 INFO mapreduce.Job:  map 21% reduce 1%
16/12/09 10:52:41 INFO mapreduce.Job:  map 23% reduce 1%
16/12/09 10:52:44 INFO mapreduce.Job:  map 24% reduce 1%
16/12/09 10:52:45 INFO mapreduce.Job:  map 25% reduce 2%
16/12/09 10:52:47 INFO mapreduce.Job:  map 28% reduce 2%
16/12/09 10:52:49 INFO mapreduce.Job:  map 30% reduce 2%
16/12/09 10:52:50 INFO mapreduce.Job:  map 33% reduce 3%
16/12/09 10:52:51 INFO mapreduce.Job:  map 34% reduce 3%
16/12/09 10:52:53 INFO mapreduce.Job:  map 40% reduce 3%
16/12/09 10:52:54 INFO mapreduce.Job:  map 42% reduce 3%
16/12/09 10:52:55 INFO mapreduce.Job:  map 45% reduce 3%
16/12/09 10:52:58 INFO mapreduce.Job:  map 55% reduce 4%
16/12/09 10:52:59 INFO mapreduce.Job:  map 60% reduce 4%
16/12/09 10:53:01 INFO mapreduce.Job:  map 61% reduce 7%
16/12/09 10:53:02 INFO mapreduce.Job:  map 66% reduce 9%
16/12/09 10:53:03 INFO mapreduce.Job:  map 71% reduce 10%
16/12/09 10:53:04 INFO mapreduce.Job:  map 73% reduce 11%
16/12/09 10:53:05 INFO mapreduce.Job:  map 76% reduce 12%
16/12/09 10:53:06 INFO mapreduce.Job:  map 79% reduce 14%
16/12/09 10:53:07 INFO mapreduce.Job:  map 82% reduce 16%
16/12/09 10:53:08 INFO mapreduce.Job:  map 85% reduce 17%
16/12/09 10:53:09 INFO mapreduce.Job:  map 87% reduce 20%
16/12/09 10:53:10 INFO mapreduce.Job:  map 88% reduce 23%
16/12/09 10:53:12 INFO mapreduce.Job:  map 88% reduce 24%
16/12/09 10:53:14 INFO mapreduce.Job:  map 88% reduce 25%
16/12/09 10:53:22 INFO mapreduce.Job:  map 89% reduce 25%
16/12/09 10:53:23 INFO mapreduce.Job:  map 90% reduce 26%
16/12/09 10:53:24 INFO mapreduce.Job:  map 90% reduce 27%
16/12/09 10:53:25 INFO mapreduce.Job:  map 90% reduce 28%
16/12/09 10:53:26 INFO mapreduce.Job:  map 91% reduce 29%
16/12/09 10:53:27 INFO mapreduce.Job:  map 92% reduce 30%
16/12/09 10:53:29 INFO mapreduce.Job:  map 94% reduce 30%
16/12/09 10:53:30 INFO mapreduce.Job:  map 96% reduce 30%
16/12/09 10:53:31 INFO mapreduce.Job:  map 98% reduce 31%
16/12/09 10:53:32 INFO mapreduce.Job:  map 99% reduce 32%
16/12/09 10:53:33 INFO mapreduce.Job:  map 100% reduce 32%
16/12/09 10:53:34 INFO mapreduce.Job:  map 100% reduce 33%
16/12/09 10:53:35 INFO mapreduce.Job:  map 100% reduce 40%
16/12/09 10:53:36 INFO mapreduce.Job:  map 100% reduce 46%
16/12/09 10:53:37 INFO mapreduce.Job:  map 100% reduce 54%
16/12/09 10:53:38 INFO mapreduce.Job:  map 100% reduce 66%
16/12/09 10:53:39 INFO mapreduce.Job:  map 100% reduce 69%
16/12/09 10:53:40 INFO mapreduce.Job:  map 100% reduce 75%
16/12/09 10:53:41 INFO mapreduce.Job:  map 100% reduce 79%
16/12/09 10:53:42 INFO mapreduce.Job:  map 100% reduce 80%
16/12/09 10:53:43 INFO mapreduce.Job:  map 100% reduce 82%
16/12/09 10:53:44 INFO mapreduce.Job:  map 100% reduce 86%
16/12/09 10:53:45 INFO mapreduce.Job:  map 100% reduce 88%
16/12/09 10:53:46 INFO mapreduce.Job:  map 100% reduce 90%
16/12/09 10:53:47 INFO mapreduce.Job:  map 100% reduce 94%
16/12/09 10:53:48 INFO mapreduce.Job:  map 100% reduce 97%
16/12/09 10:53:49 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 10:53:51 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 10:53:54 INFO mapreduce.Job: Job job_1480588584072_6012 completed successfully
16/12/09 10:53:54 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=425097369
		FILE: Number of bytes written=882576703
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=358735782
		WASB: Number of bytes written=237643302
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=42853260
		Total time spent by all reduces in occupied slots (ms)=3148580
		Total time spent by all map tasks (ms)=21426630
		Total time spent by all reduce tasks (ms)=1574290
		Total vcore-seconds taken by all map tasks=21426630
		Total vcore-seconds taken by all reduce tasks=1574290
		Total megabyte-seconds taken by all map tasks=21940869120
		Total megabyte-seconds taken by all reduce tasks=1612072960
	Map-Reduce Framework
		Map input records=1319052
		Map output records=1126790
		Map output bytes=421057074
		Map output materialized bytes=425120889
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1040062
		Reduce shuffle bytes=425120889
		Reduce input records=1126790
		Reduce output records=775346
		Spilled Records=2253580
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=214077
		CPU time spent (ms)=921640
		Physical memory (bytes) snapshot=317845864448
		Virtual memory (bytes) snapshot=741558837248
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=356039778
	File Output Format Counters 
		Bytes Written=237643302
16/12/09 10:53:54 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob6950739453006700125.jar tmpDir=null
16/12/09 10:54:34 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 10:54:35 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 10:54:35 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 10:54:37 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 10:54:37 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 10:54:38 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6017
16/12/09 10:54:39 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6017
16/12/09 10:54:39 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6017/
16/12/09 10:54:39 INFO mapreduce.Job: Running job: job_1480588584072_6017
16/12/09 10:54:51 INFO mapreduce.Job: Job job_1480588584072_6017 running in uber mode : false
16/12/09 10:54:51 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 10:55:25 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 10:55:35 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 10:55:37 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 10:55:41 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 10:55:44 INFO mapreduce.Job:  map 5% reduce 0%
16/12/09 10:55:46 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 10:55:47 INFO mapreduce.Job:  map 7% reduce 0%
16/12/09 10:55:50 INFO mapreduce.Job:  map 8% reduce 0%
16/12/09 10:55:53 INFO mapreduce.Job:  map 9% reduce 0%
16/12/09 10:55:54 INFO mapreduce.Job:  map 10% reduce 0%
16/12/09 10:55:58 INFO mapreduce.Job:  map 11% reduce 0%
16/12/09 10:56:04 INFO mapreduce.Job:  map 12% reduce 0%
16/12/09 10:56:06 INFO mapreduce.Job:  map 13% reduce 0%
16/12/09 10:56:10 INFO mapreduce.Job:  map 14% reduce 0%
16/12/09 10:56:12 INFO mapreduce.Job:  map 15% reduce 0%
16/12/09 10:56:13 INFO mapreduce.Job:  map 20% reduce 0%
16/12/09 10:56:14 INFO mapreduce.Job:  map 21% reduce 0%
16/12/09 10:56:17 INFO mapreduce.Job:  map 24% reduce 0%
16/12/09 10:56:23 INFO mapreduce.Job:  map 24% reduce 1%
16/12/09 10:56:27 INFO mapreduce.Job:  map 25% reduce 1%
16/12/09 10:56:30 INFO mapreduce.Job:  map 26% reduce 2%
16/12/09 10:56:32 INFO mapreduce.Job:  map 26% reduce 3%
16/12/09 10:56:34 INFO mapreduce.Job:  map 29% reduce 3%
16/12/09 10:56:35 INFO mapreduce.Job:  map 31% reduce 5%
16/12/09 10:56:37 INFO mapreduce.Job:  map 32% reduce 5%
16/12/09 10:56:38 INFO mapreduce.Job:  map 34% reduce 6%
16/12/09 10:56:39 INFO mapreduce.Job:  map 36% reduce 6%
16/12/09 10:56:41 INFO mapreduce.Job:  map 38% reduce 6%
16/12/09 10:56:42 INFO mapreduce.Job:  map 39% reduce 6%
16/12/09 10:56:43 INFO mapreduce.Job:  map 39% reduce 7%
16/12/09 10:56:45 INFO mapreduce.Job:  map 41% reduce 8%
16/12/09 10:56:46 INFO mapreduce.Job:  map 45% reduce 8%
16/12/09 10:56:47 INFO mapreduce.Job:  map 46% reduce 8%
16/12/09 10:56:49 INFO mapreduce.Job:  map 47% reduce 8%
16/12/09 10:56:51 INFO mapreduce.Job:  map 49% reduce 9%
16/12/09 10:56:52 INFO mapreduce.Job:  map 51% reduce 9%
16/12/09 10:56:53 INFO mapreduce.Job:  map 56% reduce 9%
16/12/09 10:56:54 INFO mapreduce.Job:  map 60% reduce 10%
16/12/09 10:56:56 INFO mapreduce.Job:  map 64% reduce 10%
16/12/09 10:56:57 INFO mapreduce.Job:  map 67% reduce 11%
16/12/09 10:56:58 INFO mapreduce.Job:  map 72% reduce 13%
16/12/09 10:56:59 INFO mapreduce.Job:  map 76% reduce 15%
16/12/09 10:57:00 INFO mapreduce.Job:  map 78% reduce 18%
16/12/09 10:57:01 INFO mapreduce.Job:  map 79% reduce 19%
16/12/09 10:57:02 INFO mapreduce.Job:  map 81% reduce 20%
16/12/09 10:57:03 INFO mapreduce.Job:  map 84% reduce 22%
16/12/09 10:57:04 INFO mapreduce.Job:  map 84% reduce 23%
16/12/09 10:57:05 INFO mapreduce.Job:  map 85% reduce 23%
16/12/09 10:57:06 INFO mapreduce.Job:  map 85% reduce 24%
16/12/09 10:57:08 INFO mapreduce.Job:  map 86% reduce 25%
16/12/09 10:57:09 INFO mapreduce.Job:  map 87% reduce 27%
16/12/09 10:57:11 INFO mapreduce.Job:  map 88% reduce 27%
16/12/09 10:57:12 INFO mapreduce.Job:  map 90% reduce 27%
16/12/09 10:57:13 INFO mapreduce.Job:  map 90% reduce 28%
16/12/09 10:57:14 INFO mapreduce.Job:  map 92% reduce 28%
16/12/09 10:57:16 INFO mapreduce.Job:  map 93% reduce 29%
16/12/09 10:57:18 INFO mapreduce.Job:  map 93% reduce 31%
16/12/09 10:57:19 INFO mapreduce.Job:  map 96% reduce 31%
16/12/09 10:57:20 INFO mapreduce.Job:  map 99% reduce 31%
16/12/09 10:57:21 INFO mapreduce.Job:  map 100% reduce 32%
16/12/09 10:57:22 INFO mapreduce.Job:  map 100% reduce 36%
16/12/09 10:57:23 INFO mapreduce.Job:  map 100% reduce 43%
16/12/09 10:57:24 INFO mapreduce.Job:  map 100% reduce 58%
16/12/09 10:57:26 INFO mapreduce.Job:  map 100% reduce 71%
16/12/09 10:57:27 INFO mapreduce.Job:  map 100% reduce 80%
16/12/09 10:57:28 INFO mapreduce.Job:  map 100% reduce 91%
16/12/09 10:57:29 INFO mapreduce.Job:  map 100% reduce 94%
16/12/09 10:57:30 INFO mapreduce.Job:  map 100% reduce 95%
16/12/09 10:57:31 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 10:57:33 INFO mapreduce.Job:  map 100% reduce 99%
16/12/09 10:57:34 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 10:57:39 INFO mapreduce.Job: Job job_1480588584072_6017 completed successfully
16/12/09 10:57:39 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=271169685
		FILE: Number of bytes written=574721335
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=231061491
		WASB: Number of bytes written=142229963
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=23701722
		Total time spent by all reduces in occupied slots (ms)=3462018
		Total time spent by all map tasks (ms)=11850861
		Total time spent by all reduce tasks (ms)=1731009
		Total vcore-seconds taken by all map tasks=11850861
		Total vcore-seconds taken by all reduce tasks=1731009
		Total megabyte-seconds taken by all map tasks=12135281664
		Total megabyte-seconds taken by all reduce tasks=1772553216
	Map-Reduce Framework
		Map input records=869985
		Map output records=732167
		Map output bytes=268569458
		Map output materialized bytes=271193205
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=675058
		Reduce shuffle bytes=271193205
		Reduce input records=732167
		Reduce output records=472703
		Spilled Records=1464334
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=141115
		CPU time spent (ms)=747460
		Physical memory (bytes) snapshot=322437656576
		Virtual memory (bytes) snapshot=742088171520
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=228365487
	File Output Format Counters 
		Bytes Written=142229963
16/12/09 10:57:39 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob370015960313671039.jar tmpDir=null
16/12/09 10:58:19 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 10:58:20 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 10:58:20 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 10:58:22 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 10:58:22 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 10:58:22 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6022
16/12/09 10:58:23 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6022
16/12/09 10:58:23 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6022/
16/12/09 10:58:23 INFO mapreduce.Job: Running job: job_1480588584072_6022
16/12/09 10:58:36 INFO mapreduce.Job: Job job_1480588584072_6022 running in uber mode : false
16/12/09 10:58:36 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 11:00:09 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 11:00:11 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 11:00:12 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 11:00:13 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 11:00:14 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 11:00:15 INFO mapreduce.Job:  map 7% reduce 0%
16/12/09 11:00:47 INFO mapreduce.Job:  map 8% reduce 0%
16/12/09 11:00:49 INFO mapreduce.Job:  map 9% reduce 0%
16/12/09 11:00:51 INFO mapreduce.Job:  map 10% reduce 0%
16/12/09 11:00:52 INFO mapreduce.Job:  map 11% reduce 0%
16/12/09 11:00:53 INFO mapreduce.Job:  map 12% reduce 0%
16/12/09 11:00:54 INFO mapreduce.Job:  map 15% reduce 0%
16/12/09 11:00:55 INFO mapreduce.Job:  map 17% reduce 1%
16/12/09 11:00:57 INFO mapreduce.Job:  map 21% reduce 1%
16/12/09 11:00:58 INFO mapreduce.Job:  map 23% reduce 1%
16/12/09 11:00:59 INFO mapreduce.Job:  map 25% reduce 1%
16/12/09 11:01:00 INFO mapreduce.Job:  map 27% reduce 1%
16/12/09 11:01:01 INFO mapreduce.Job:  map 31% reduce 1%
16/12/09 11:01:02 INFO mapreduce.Job:  map 34% reduce 2%
16/12/09 11:01:03 INFO mapreduce.Job:  map 38% reduce 4%
16/12/09 11:01:04 INFO mapreduce.Job:  map 39% reduce 4%
16/12/09 11:01:05 INFO mapreduce.Job:  map 40% reduce 4%
16/12/09 11:01:06 INFO mapreduce.Job:  map 40% reduce 5%
16/12/09 11:01:11 INFO mapreduce.Job:  map 40% reduce 7%
16/12/09 11:01:12 INFO mapreduce.Job:  map 41% reduce 7%
16/12/09 11:01:15 INFO mapreduce.Job:  map 42% reduce 7%
16/12/09 11:01:16 INFO mapreduce.Job:  map 43% reduce 7%
16/12/09 11:01:17 INFO mapreduce.Job:  map 45% reduce 7%
16/12/09 11:01:18 INFO mapreduce.Job:  map 46% reduce 8%
16/12/09 11:01:20 INFO mapreduce.Job:  map 49% reduce 8%
16/12/09 11:01:21 INFO mapreduce.Job:  map 51% reduce 8%
16/12/09 11:01:22 INFO mapreduce.Job:  map 54% reduce 8%
16/12/09 11:01:23 INFO mapreduce.Job:  map 56% reduce 8%
16/12/09 11:01:24 INFO mapreduce.Job:  map 59% reduce 9%
16/12/09 11:01:25 INFO mapreduce.Job:  map 63% reduce 10%
16/12/09 11:01:26 INFO mapreduce.Job:  map 66% reduce 12%
16/12/09 11:01:27 INFO mapreduce.Job:  map 67% reduce 12%
16/12/09 11:01:28 INFO mapreduce.Job:  map 71% reduce 13%
16/12/09 11:01:29 INFO mapreduce.Job:  map 74% reduce 14%
16/12/09 11:01:30 INFO mapreduce.Job:  map 75% reduce 17%
16/12/09 11:01:31 INFO mapreduce.Job:  map 78% reduce 18%
16/12/09 11:01:32 INFO mapreduce.Job:  map 81% reduce 20%
16/12/09 11:01:33 INFO mapreduce.Job:  map 85% reduce 20%
16/12/09 11:01:34 INFO mapreduce.Job:  map 89% reduce 22%
16/12/09 11:01:35 INFO mapreduce.Job:  map 89% reduce 23%
16/12/09 11:01:36 INFO mapreduce.Job:  map 90% reduce 24%
16/12/09 11:01:37 INFO mapreduce.Job:  map 90% reduce 26%
16/12/09 11:01:38 INFO mapreduce.Job:  map 91% reduce 26%
16/12/09 11:01:39 INFO mapreduce.Job:  map 92% reduce 27%
16/12/09 11:01:40 INFO mapreduce.Job:  map 93% reduce 28%
16/12/09 11:01:41 INFO mapreduce.Job:  map 93% reduce 29%
16/12/09 11:01:42 INFO mapreduce.Job:  map 95% reduce 29%
16/12/09 11:01:43 INFO mapreduce.Job:  map 96% reduce 31%
16/12/09 11:01:44 INFO mapreduce.Job:  map 98% reduce 31%
16/12/09 11:01:45 INFO mapreduce.Job:  map 100% reduce 32%
16/12/09 11:01:46 INFO mapreduce.Job:  map 100% reduce 45%
16/12/09 11:01:47 INFO mapreduce.Job:  map 100% reduce 57%
16/12/09 11:01:48 INFO mapreduce.Job:  map 100% reduce 73%
16/12/09 11:01:49 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 11:01:50 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 11:01:55 INFO mapreduce.Job: Job job_1480588584072_6022 completed successfully
16/12/09 11:01:55 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=202445391
		FILE: Number of bytes written=437272747
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=180714805
		WASB: Number of bytes written=93846414
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=33230746
		Total time spent by all reduces in occupied slots (ms)=3626180
		Total time spent by all map tasks (ms)=16615373
		Total time spent by all reduce tasks (ms)=1813090
		Total vcore-seconds taken by all map tasks=16615373
		Total vcore-seconds taken by all reduce tasks=1813090
		Total megabyte-seconds taken by all map tasks=17014141952
		Total megabyte-seconds taken by all reduce tasks=1856604160
	Map-Reduce Framework
		Map input records=686467
		Map output records=541027
		Map output bytes=200494189
		Map output materialized bytes=202468911
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=489317
		Reduce shuffle bytes=202468911
		Reduce input records=541027
		Reduce output records=306212
		Spilled Records=1082054
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=177751
		CPU time spent (ms)=714730
		Physical memory (bytes) snapshot=321881559040
		Virtual memory (bytes) snapshot=741385109504
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=178018801
	File Output Format Counters 
		Bytes Written=93846414
16/12/09 11:01:55 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612081900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob993971166343564635.jar tmpDir=null
16/12/09 11:02:35 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 11:02:35 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 11:02:36 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 11:02:37 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 11:02:38 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 11:02:38 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6027
16/12/09 11:02:39 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6027
16/12/09 11:02:39 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6027/
16/12/09 11:02:39 INFO mapreduce.Job: Running job: job_1480588584072_6027
16/12/09 11:05:16 INFO mapreduce.Job: Job job_1480588584072_6027 running in uber mode : false
16/12/09 11:05:16 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 11:06:11 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 11:06:16 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 11:06:19 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 11:06:21 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 11:06:22 INFO mapreduce.Job:  map 8% reduce 0%
16/12/09 11:06:24 INFO mapreduce.Job:  map 11% reduce 0%
16/12/09 11:06:26 INFO mapreduce.Job:  map 13% reduce 0%
16/12/09 11:06:27 INFO mapreduce.Job:  map 16% reduce 0%
16/12/09 11:06:28 INFO mapreduce.Job:  map 19% reduce 0%
16/12/09 11:06:29 INFO mapreduce.Job:  map 22% reduce 0%
16/12/09 11:06:30 INFO mapreduce.Job:  map 23% reduce 0%
16/12/09 11:06:31 INFO mapreduce.Job:  map 25% reduce 0%
16/12/09 11:06:32 INFO mapreduce.Job:  map 26% reduce 0%
16/12/09 11:06:35 INFO mapreduce.Job:  map 28% reduce 0%
16/12/09 11:06:40 INFO mapreduce.Job:  map 29% reduce 0%
16/12/09 11:06:52 INFO mapreduce.Job:  map 29% reduce 1%
16/12/09 11:06:53 INFO mapreduce.Job:  map 30% reduce 1%
16/12/09 11:06:57 INFO mapreduce.Job:  map 32% reduce 1%
16/12/09 11:06:58 INFO mapreduce.Job:  map 33% reduce 1%
16/12/09 11:06:59 INFO mapreduce.Job:  map 34% reduce 1%
16/12/09 11:07:00 INFO mapreduce.Job:  map 35% reduce 2%
16/12/09 11:07:01 INFO mapreduce.Job:  map 36% reduce 2%
16/12/09 11:07:02 INFO mapreduce.Job:  map 38% reduce 2%
16/12/09 11:07:03 INFO mapreduce.Job:  map 39% reduce 2%
16/12/09 11:07:04 INFO mapreduce.Job:  map 40% reduce 2%
16/12/09 11:07:05 INFO mapreduce.Job:  map 41% reduce 2%
16/12/09 11:07:06 INFO mapreduce.Job:  map 42% reduce 2%
16/12/09 11:07:07 INFO mapreduce.Job:  map 43% reduce 2%
16/12/09 11:07:08 INFO mapreduce.Job:  map 45% reduce 2%
16/12/09 11:07:09 INFO mapreduce.Job:  map 47% reduce 3%
16/12/09 11:07:10 INFO mapreduce.Job:  map 48% reduce 3%
16/12/09 11:07:11 INFO mapreduce.Job:  map 51% reduce 3%
16/12/09 11:07:12 INFO mapreduce.Job:  map 54% reduce 4%
16/12/09 11:07:13 INFO mapreduce.Job:  map 58% reduce 5%
16/12/09 11:07:14 INFO mapreduce.Job:  map 60% reduce 6%
16/12/09 11:07:15 INFO mapreduce.Job:  map 63% reduce 6%
16/12/09 11:07:16 INFO mapreduce.Job:  map 64% reduce 7%
16/12/09 11:07:17 INFO mapreduce.Job:  map 67% reduce 7%
16/12/09 11:07:18 INFO mapreduce.Job:  map 68% reduce 7%
16/12/09 11:07:21 INFO mapreduce.Job:  map 69% reduce 8%
16/12/09 11:07:22 INFO mapreduce.Job:  map 70% reduce 8%
16/12/09 11:07:23 INFO mapreduce.Job:  map 72% reduce 8%
16/12/09 11:07:25 INFO mapreduce.Job:  map 73% reduce 8%
16/12/09 11:07:27 INFO mapreduce.Job:  map 75% reduce 9%
16/12/09 11:07:28 INFO mapreduce.Job:  map 76% reduce 15%
16/12/09 11:07:29 INFO mapreduce.Job:  map 77% reduce 16%
16/12/09 11:07:30 INFO mapreduce.Job:  map 79% reduce 16%
16/12/09 11:07:31 INFO mapreduce.Job:  map 80% reduce 16%
16/12/09 11:07:32 INFO mapreduce.Job:  map 82% reduce 16%
16/12/09 11:07:33 INFO mapreduce.Job:  map 84% reduce 17%
16/12/09 11:07:34 INFO mapreduce.Job:  map 87% reduce 17%
16/12/09 11:07:35 INFO mapreduce.Job:  map 90% reduce 19%
16/12/09 11:07:37 INFO mapreduce.Job:  map 91% reduce 20%
16/12/09 11:07:38 INFO mapreduce.Job:  map 92% reduce 21%
16/12/09 11:07:39 INFO mapreduce.Job:  map 92% reduce 24%
16/12/09 11:07:40 INFO mapreduce.Job:  map 95% reduce 26%
16/12/09 11:07:41 INFO mapreduce.Job:  map 96% reduce 28%
16/12/09 11:07:42 INFO mapreduce.Job:  map 98% reduce 30%
16/12/09 11:07:43 INFO mapreduce.Job:  map 99% reduce 32%
16/12/09 11:07:44 INFO mapreduce.Job:  map 100% reduce 33%
16/12/09 11:07:45 INFO mapreduce.Job:  map 100% reduce 34%
16/12/09 11:07:46 INFO mapreduce.Job:  map 100% reduce 44%
16/12/09 11:07:47 INFO mapreduce.Job:  map 100% reduce 61%
16/12/09 11:07:48 INFO mapreduce.Job:  map 100% reduce 72%
16/12/09 11:07:49 INFO mapreduce.Job:  map 100% reduce 93%
16/12/09 11:07:50 INFO mapreduce.Job:  map 100% reduce 99%
16/12/09 11:07:51 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 11:07:53 INFO mapreduce.Job: Job job_1480588584072_6027 completed successfully
16/12/09 11:07:53 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=203273016
		FILE: Number of bytes written=438927997
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=187774465
		WASB: Number of bytes written=86506856
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=39965180
		Total time spent by all reduces in occupied slots (ms)=2075844
		Total time spent by all map tasks (ms)=19982590
		Total time spent by all reduce tasks (ms)=1037922
		Total vcore-seconds taken by all map tasks=19982590
		Total vcore-seconds taken by all reduce tasks=1037922
		Total megabyte-seconds taken by all map tasks=20462172160
		Total megabyte-seconds taken by all reduce tasks=1062832128
	Map-Reduce Framework
		Map input records=718506
		Map output records=537110
		Map output bytes=201312256
		Map output materialized bytes=203296536
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=476682
		Reduce shuffle bytes=203296536
		Reduce input records=537110
		Reduce output records=283368
		Spilled Records=1074220
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=201601
		CPU time spent (ms)=726830
		Physical memory (bytes) snapshot=322187468800
		Virtual memory (bytes) snapshot=741780860928
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=185078461
	File Output Format Counters 
		Bytes Written=86506856
16/12/09 11:07:53 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0400 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0400': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4079004046465056040.jar tmpDir=null
16/12/09 11:08:33 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 11:08:34 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 11:08:34 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 11:08:36 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 11:08:36 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 11:08:36 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6032
16/12/09 11:08:37 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6032
16/12/09 11:08:37 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6032/
16/12/09 11:08:37 INFO mapreduce.Job: Running job: job_1480588584072_6032
16/12/09 11:11:34 INFO mapreduce.Job: Job job_1480588584072_6032 running in uber mode : false
16/12/09 11:11:34 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 11:12:11 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 11:12:14 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 11:12:17 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 11:12:19 INFO mapreduce.Job:  map 7% reduce 0%
16/12/09 11:12:20 INFO mapreduce.Job:  map 8% reduce 0%
16/12/09 11:12:30 INFO mapreduce.Job:  map 14% reduce 0%
16/12/09 11:12:31 INFO mapreduce.Job:  map 16% reduce 0%
16/12/09 11:12:35 INFO mapreduce.Job:  map 18% reduce 0%
16/12/09 11:12:36 INFO mapreduce.Job:  map 22% reduce 0%
16/12/09 11:12:38 INFO mapreduce.Job:  map 26% reduce 0%
16/12/09 11:12:39 INFO mapreduce.Job:  map 28% reduce 0%
16/12/09 11:12:43 INFO mapreduce.Job:  map 30% reduce 0%
16/12/09 11:12:44 INFO mapreduce.Job:  map 35% reduce 1%
16/12/09 11:12:45 INFO mapreduce.Job:  map 36% reduce 1%
16/12/09 11:12:47 INFO mapreduce.Job:  map 38% reduce 1%
16/12/09 11:12:48 INFO mapreduce.Job:  map 39% reduce 2%
16/12/09 11:12:49 INFO mapreduce.Job:  map 42% reduce 2%
16/12/09 11:12:50 INFO mapreduce.Job:  map 44% reduce 2%
16/12/09 11:12:51 INFO mapreduce.Job:  map 45% reduce 4%
16/12/09 11:12:52 INFO mapreduce.Job:  map 45% reduce 5%
16/12/09 11:12:53 INFO mapreduce.Job:  map 47% reduce 6%
16/12/09 11:12:55 INFO mapreduce.Job:  map 49% reduce 10%
16/12/09 11:12:57 INFO mapreduce.Job:  map 49% reduce 11%
16/12/09 11:12:58 INFO mapreduce.Job:  map 50% reduce 11%
16/12/09 11:12:59 INFO mapreduce.Job:  map 51% reduce 12%
16/12/09 11:13:00 INFO mapreduce.Job:  map 52% reduce 13%
16/12/09 11:13:01 INFO mapreduce.Job:  map 54% reduce 14%
16/12/09 11:13:02 INFO mapreduce.Job:  map 55% reduce 14%
16/12/09 11:13:03 INFO mapreduce.Job:  map 58% reduce 16%
16/12/09 11:13:04 INFO mapreduce.Job:  map 61% reduce 17%
16/12/09 11:13:05 INFO mapreduce.Job:  map 61% reduce 18%
16/12/09 11:13:06 INFO mapreduce.Job:  map 61% reduce 19%
16/12/09 11:13:07 INFO mapreduce.Job:  map 62% reduce 20%
16/12/09 11:13:08 INFO mapreduce.Job:  map 63% reduce 20%
16/12/09 11:13:10 INFO mapreduce.Job:  map 64% reduce 21%
16/12/09 11:13:11 INFO mapreduce.Job:  map 65% reduce 21%
16/12/09 11:13:12 INFO mapreduce.Job:  map 68% reduce 21%
16/12/09 11:13:13 INFO mapreduce.Job:  map 71% reduce 21%
16/12/09 11:13:15 INFO mapreduce.Job:  map 75% reduce 22%
16/12/09 11:13:16 INFO mapreduce.Job:  map 77% reduce 23%
16/12/09 11:13:17 INFO mapreduce.Job:  map 78% reduce 23%
16/12/09 11:13:18 INFO mapreduce.Job:  map 79% reduce 24%
16/12/09 11:13:19 INFO mapreduce.Job:  map 79% reduce 25%
16/12/09 11:13:20 INFO mapreduce.Job:  map 79% reduce 26%
16/12/09 11:13:23 INFO mapreduce.Job:  map 80% reduce 26%
16/12/09 11:13:26 INFO mapreduce.Job:  map 81% reduce 26%
16/12/09 11:13:27 INFO mapreduce.Job:  map 82% reduce 26%
16/12/09 11:13:29 INFO mapreduce.Job:  map 83% reduce 27%
16/12/09 11:13:30 INFO mapreduce.Job:  map 84% reduce 27%
16/12/09 11:13:31 INFO mapreduce.Job:  map 85% reduce 27%
16/12/09 11:13:32 INFO mapreduce.Job:  map 86% reduce 27%
16/12/09 11:13:33 INFO mapreduce.Job:  map 88% reduce 27%
16/12/09 11:13:34 INFO mapreduce.Job:  map 89% reduce 28%
16/12/09 11:13:35 INFO mapreduce.Job:  map 92% reduce 28%
16/12/09 11:13:36 INFO mapreduce.Job:  map 94% reduce 29%
16/12/09 11:13:37 INFO mapreduce.Job:  map 94% reduce 30%
16/12/09 11:13:38 INFO mapreduce.Job:  map 97% reduce 30%
16/12/09 11:13:39 INFO mapreduce.Job:  map 99% reduce 31%
16/12/09 11:13:40 INFO mapreduce.Job:  map 100% reduce 32%
16/12/09 11:13:41 INFO mapreduce.Job:  map 100% reduce 33%
16/12/09 11:13:42 INFO mapreduce.Job:  map 100% reduce 40%
16/12/09 11:13:43 INFO mapreduce.Job:  map 100% reduce 52%
16/12/09 11:13:44 INFO mapreduce.Job:  map 100% reduce 68%
16/12/09 11:13:45 INFO mapreduce.Job:  map 100% reduce 72%
16/12/09 11:13:46 INFO mapreduce.Job:  map 100% reduce 80%
16/12/09 11:13:47 INFO mapreduce.Job:  map 100% reduce 87%
16/12/09 11:13:48 INFO mapreduce.Job:  map 100% reduce 90%
16/12/09 11:13:50 INFO mapreduce.Job:  map 100% reduce 93%
16/12/09 11:13:51 INFO mapreduce.Job:  map 100% reduce 95%
16/12/09 11:13:53 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 11:13:54 INFO mapreduce.Job:  map 100% reduce 99%
16/12/09 11:13:56 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 11:13:58 INFO mapreduce.Job: Job job_1480588584072_6032 completed successfully
16/12/09 11:13:59 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=300744361
		FILE: Number of bytes written=633870687
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=278584697
		WASB: Number of bytes written=139302160
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=27988946
		Total time spent by all reduces in occupied slots (ms)=3197976
		Total time spent by all map tasks (ms)=13994473
		Total time spent by all reduce tasks (ms)=1598988
		Total vcore-seconds taken by all map tasks=13994473
		Total vcore-seconds taken by all reduce tasks=1598988
		Total megabyte-seconds taken by all map tasks=14330340352
		Total megabyte-seconds taken by all reduce tasks=1637363712
	Map-Reduce Framework
		Map input records=1041485
		Map output records=777451
		Map output bytes=297873876
		Map output materialized bytes=300767881
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=689351
		Reduce shuffle bytes=300767881
		Reduce input records=777451
		Reduce output records=446838
		Spilled Records=1554902
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=171688
		CPU time spent (ms)=788920
		Physical memory (bytes) snapshot=322151849984
		Virtual memory (bytes) snapshot=741781078016
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=275888693
	File Output Format Counters 
		Bytes Written=139302160
16/12/09 11:13:59 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0400
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0500 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0500': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7424439227706548627.jar tmpDir=null
16/12/09 11:14:38 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 11:14:39 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 11:14:40 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 11:14:42 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 11:14:42 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 11:14:43 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6036
16/12/09 11:14:43 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6036
16/12/09 11:14:43 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6036/
16/12/09 11:14:43 INFO mapreduce.Job: Running job: job_1480588584072_6036
16/12/09 11:15:27 INFO mapreduce.Job: Job job_1480588584072_6036 running in uber mode : false
16/12/09 11:15:27 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 11:17:03 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 11:17:07 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 11:17:10 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 11:17:11 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 11:17:14 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 11:17:16 INFO mapreduce.Job:  map 8% reduce 0%
16/12/09 11:17:17 INFO mapreduce.Job:  map 9% reduce 0%
16/12/09 11:17:18 INFO mapreduce.Job:  map 10% reduce 0%
16/12/09 11:17:20 INFO mapreduce.Job:  map 11% reduce 0%
16/12/09 11:17:21 INFO mapreduce.Job:  map 12% reduce 0%
16/12/09 11:17:22 INFO mapreduce.Job:  map 14% reduce 0%
16/12/09 11:17:23 INFO mapreduce.Job:  map 16% reduce 0%
16/12/09 11:17:24 INFO mapreduce.Job:  map 18% reduce 0%
16/12/09 11:17:25 INFO mapreduce.Job:  map 20% reduce 0%
16/12/09 11:17:26 INFO mapreduce.Job:  map 23% reduce 0%
16/12/09 11:17:27 INFO mapreduce.Job:  map 25% reduce 0%
16/12/09 11:17:28 INFO mapreduce.Job:  map 27% reduce 0%
16/12/09 11:17:29 INFO mapreduce.Job:  map 29% reduce 0%
16/12/09 11:17:30 INFO mapreduce.Job:  map 32% reduce 0%
16/12/09 11:17:31 INFO mapreduce.Job:  map 36% reduce 0%
16/12/09 11:17:32 INFO mapreduce.Job:  map 38% reduce 0%
16/12/09 11:17:33 INFO mapreduce.Job:  map 41% reduce 0%
16/12/09 11:17:34 INFO mapreduce.Job:  map 44% reduce 0%
16/12/09 11:17:35 INFO mapreduce.Job:  map 48% reduce 0%
16/12/09 11:17:36 INFO mapreduce.Job:  map 51% reduce 1%
16/12/09 11:17:37 INFO mapreduce.Job:  map 55% reduce 1%
16/12/09 11:17:38 INFO mapreduce.Job:  map 58% reduce 1%
16/12/09 11:17:39 INFO mapreduce.Job:  map 60% reduce 1%
16/12/09 11:17:40 INFO mapreduce.Job:  map 61% reduce 1%
16/12/09 11:17:41 INFO mapreduce.Job:  map 65% reduce 1%
16/12/09 11:17:42 INFO mapreduce.Job:  map 67% reduce 1%
16/12/09 11:17:43 INFO mapreduce.Job:  map 69% reduce 1%
16/12/09 11:17:44 INFO mapreduce.Job:  map 70% reduce 1%
16/12/09 11:17:45 INFO mapreduce.Job:  map 71% reduce 1%
16/12/09 11:17:46 INFO mapreduce.Job:  map 72% reduce 1%
16/12/09 11:17:47 INFO mapreduce.Job:  map 74% reduce 1%
16/12/09 11:17:48 INFO mapreduce.Job:  map 75% reduce 2%
16/12/09 11:17:49 INFO mapreduce.Job:  map 76% reduce 2%
16/12/09 11:17:50 INFO mapreduce.Job:  map 77% reduce 2%
16/12/09 11:17:52 INFO mapreduce.Job:  map 79% reduce 2%
16/12/09 11:17:54 INFO mapreduce.Job:  map 80% reduce 2%
16/12/09 11:17:57 INFO mapreduce.Job:  map 81% reduce 2%
16/12/09 11:17:59 INFO mapreduce.Job:  map 81% reduce 4%
16/12/09 11:18:00 INFO mapreduce.Job:  map 81% reduce 5%
16/12/09 11:18:02 INFO mapreduce.Job:  map 81% reduce 6%
16/12/09 11:18:03 INFO mapreduce.Job:  map 81% reduce 10%
16/12/09 11:18:04 INFO mapreduce.Job:  map 81% reduce 11%
16/12/09 11:18:04 INFO mapreduce.Job: Task Id : attempt_1480588584072_6036_m_000009_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 11:18:04 INFO mapreduce.Job: Task Id : attempt_1480588584072_6036_m_000003_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 11:18:05 INFO mapreduce.Job:  map 81% reduce 12%
16/12/09 11:18:05 INFO mapreduce.Job: Task Id : attempt_1480588584072_6036_m_000044_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 11:18:05 INFO mapreduce.Job: Task Id : attempt_1480588584072_6036_r_000013_0, Status : FAILED
Exception from container-launch.
Container id: container_e14_1480588584072_6036_01_000246
Exit code: 1
Stack trace: ExitCodeException exitCode=1: 
	at org.apache.hadoop.util.Shell.runCommand(Shell.java:576)
	at org.apache.hadoop.util.Shell.run(Shell.java:487)
	at org.apache.hadoop.util.Shell$ShellCommandExecutor.execute(Shell.java:753)
	at org.apache.hadoop.yarn.server.nodemanager.LinuxContainerExecutor.launchContainer(LinuxContainerExecutor.java:371)
	at org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.ContainerLaunch.call(ContainerLaunch.java:303)
	at org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.ContainerLaunch.call(ContainerLaunch.java:82)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)

Shell output: main : command provided 1
main : run as user is nobody
main : requested yarn user is zhangrn


Container exited with a non-zero exit code 1

16/12/09 11:18:06 INFO mapreduce.Job:  map 81% reduce 16%
16/12/09 11:18:07 INFO mapreduce.Job:  map 81% reduce 19%
16/12/09 11:18:08 INFO mapreduce.Job:  map 81% reduce 23%
16/12/09 11:18:10 INFO mapreduce.Job:  map 81% reduce 24%
16/12/09 11:18:11 INFO mapreduce.Job:  map 82% reduce 24%
16/12/09 11:18:12 INFO mapreduce.Job: Task Id : attempt_1480588584072_6036_m_000016_0, Status : FAILED
Error: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 137
	at org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:322)
	at org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:535)
	at org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)
	at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)
	at org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)
	at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)
	at org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:168)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1709)
	at org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:162)

16/12/09 11:18:16 INFO mapreduce.Job:  map 83% reduce 24%
16/12/09 11:18:21 INFO mapreduce.Job:  map 85% reduce 25%
16/12/09 11:18:24 INFO mapreduce.Job:  map 85% reduce 26%
16/12/09 11:18:32 INFO mapreduce.Job: Task Id : attempt_1480588584072_6036_m_000021_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 11:18:38 INFO mapreduce.Job:  map 86% reduce 26%
16/12/09 11:18:40 INFO mapreduce.Job:  map 87% reduce 26%
16/12/09 11:18:42 INFO mapreduce.Job:  map 89% reduce 26%
16/12/09 11:18:43 INFO mapreduce.Job:  map 92% reduce 27%
16/12/09 11:18:44 INFO mapreduce.Job:  map 93% reduce 27%
16/12/09 11:18:45 INFO mapreduce.Job:  map 95% reduce 27%
16/12/09 11:18:46 INFO mapreduce.Job:  map 95% reduce 29%
16/12/09 11:18:47 INFO mapreduce.Job:  map 96% reduce 29%
16/12/09 11:18:48 INFO mapreduce.Job:  map 97% reduce 31%
16/12/09 11:18:49 INFO mapreduce.Job:  map 98% reduce 31%
16/12/09 11:18:50 INFO mapreduce.Job:  map 99% reduce 31%
16/12/09 11:18:51 INFO mapreduce.Job:  map 100% reduce 31%
16/12/09 11:18:52 INFO mapreduce.Job:  map 100% reduce 32%
16/12/09 11:18:53 INFO mapreduce.Job:  map 100% reduce 33%
16/12/09 11:18:55 INFO mapreduce.Job:  map 100% reduce 34%
16/12/09 11:18:56 INFO mapreduce.Job:  map 100% reduce 37%
16/12/09 11:18:57 INFO mapreduce.Job:  map 100% reduce 39%
16/12/09 11:18:58 INFO mapreduce.Job:  map 100% reduce 44%
16/12/09 11:18:59 INFO mapreduce.Job:  map 100% reduce 62%
16/12/09 11:19:00 INFO mapreduce.Job:  map 100% reduce 70%
16/12/09 11:19:01 INFO mapreduce.Job:  map 100% reduce 72%
16/12/09 11:19:02 INFO mapreduce.Job:  map 100% reduce 81%
16/12/09 11:19:03 INFO mapreduce.Job:  map 100% reduce 83%
16/12/09 11:19:04 INFO mapreduce.Job:  map 100% reduce 84%
16/12/09 11:19:05 INFO mapreduce.Job:  map 100% reduce 87%
16/12/09 11:19:06 INFO mapreduce.Job:  map 100% reduce 91%
16/12/09 11:19:07 INFO mapreduce.Job:  map 100% reduce 95%
16/12/09 11:19:08 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 11:19:09 INFO mapreduce.Job:  map 100% reduce 99%
16/12/09 11:19:10 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 11:19:13 INFO mapreduce.Job: Job job_1480588584072_6036 completed successfully
16/12/09 11:19:13 INFO mapreduce.Job: Counters: 52
	File System Counters
		FILE: Number of bytes read=457474499
		FILE: Number of bytes written=947330963
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=415687576
		WASB: Number of bytes written=235073333
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=5
		Failed reduce tasks=1
		Launched map tasks=202
		Launched reduce tasks=21
		Other local map tasks=5
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=54793772
		Total time spent by all reduces in occupied slots (ms)=3778526
		Total time spent by all map tasks (ms)=27396886
		Total time spent by all reduce tasks (ms)=1889263
		Total vcore-seconds taken by all map tasks=27396886
		Total vcore-seconds taken by all reduce tasks=1889263
		Total megabyte-seconds taken by all map tasks=28054411264
		Total megabyte-seconds taken by all reduce tasks=1934605312
	Map-Reduce Framework
		Map input records=1515362
		Map output records=1165316
		Map output bytes=453148056
		Map output materialized bytes=457498019
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1036744
		Reduce shuffle bytes=457498019
		Reduce input records=1165316
		Reduce output records=745210
		Spilled Records=2330632
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=299510
		CPU time spent (ms)=1019830
		Physical memory (bytes) snapshot=318746525696
		Virtual memory (bytes) snapshot=742307737600
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=412991572
	File Output Format Counters 
		Bytes Written=235073333
16/12/09 11:19:13 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0500
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0600 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0600': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob6781213149563445790.jar tmpDir=null
16/12/09 11:45:08 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 11:45:09 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 11:45:09 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 11:45:11 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 11:45:12 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 11:45:12 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6047
16/12/09 11:45:13 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6047
16/12/09 11:45:13 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6047/
16/12/09 11:45:13 INFO mapreduce.Job: Running job: job_1480588584072_6047
16/12/09 11:45:26 INFO mapreduce.Job: Job job_1480588584072_6047 running in uber mode : false
16/12/09 11:45:26 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 11:45:35 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 11:45:36 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 11:45:43 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 11:45:44 INFO mapreduce.Job:  map 5% reduce 0%
16/12/09 11:45:46 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 11:45:50 INFO mapreduce.Job:  map 8% reduce 0%
16/12/09 11:45:54 INFO mapreduce.Job:  map 9% reduce 0%
16/12/09 11:45:56 INFO mapreduce.Job:  map 10% reduce 0%
16/12/09 11:45:57 INFO mapreduce.Job:  map 11% reduce 0%
16/12/09 11:46:00 INFO mapreduce.Job:  map 11% reduce 1%
16/12/09 11:46:03 INFO mapreduce.Job:  map 12% reduce 1%
16/12/09 11:46:04 INFO mapreduce.Job:  map 14% reduce 1%
16/12/09 11:46:06 INFO mapreduce.Job:  map 15% reduce 1%
16/12/09 11:46:07 INFO mapreduce.Job:  map 17% reduce 1%
16/12/09 11:46:09 INFO mapreduce.Job:  map 18% reduce 2%
16/12/09 11:46:14 INFO mapreduce.Job:  map 19% reduce 3%
16/12/09 11:46:16 INFO mapreduce.Job:  map 20% reduce 3%
16/12/09 11:46:17 INFO mapreduce.Job:  map 21% reduce 3%
16/12/09 11:46:18 INFO mapreduce.Job:  map 22% reduce 3%
16/12/09 11:46:20 INFO mapreduce.Job:  map 23% reduce 3%
16/12/09 11:46:22 INFO mapreduce.Job:  map 25% reduce 4%
16/12/09 11:46:23 INFO mapreduce.Job:  map 26% reduce 4%
16/12/09 11:46:24 INFO mapreduce.Job:  map 28% reduce 4%
16/12/09 11:46:25 INFO mapreduce.Job:  map 28% reduce 5%
16/12/09 11:46:26 INFO mapreduce.Job:  map 28% reduce 6%
16/12/09 11:46:27 INFO mapreduce.Job:  map 30% reduce 6%
16/12/09 11:46:28 INFO mapreduce.Job:  map 30% reduce 7%
16/12/09 11:46:29 INFO mapreduce.Job:  map 31% reduce 7%
16/12/09 11:46:30 INFO mapreduce.Job:  map 31% reduce 8%
16/12/09 11:46:31 INFO mapreduce.Job:  map 31% reduce 9%
16/12/09 11:46:32 INFO mapreduce.Job:  map 31% reduce 10%
16/12/09 11:46:36 INFO mapreduce.Job:  map 33% reduce 10%
16/12/09 11:46:37 INFO mapreduce.Job:  map 34% reduce 10%
16/12/09 11:46:39 INFO mapreduce.Job:  map 35% reduce 11%
16/12/09 11:46:42 INFO mapreduce.Job:  map 36% reduce 11%
16/12/09 11:46:43 INFO mapreduce.Job:  map 37% reduce 11%
16/12/09 11:46:44 INFO mapreduce.Job:  map 39% reduce 11%
16/12/09 11:46:45 INFO mapreduce.Job:  map 40% reduce 11%
16/12/09 11:46:46 INFO mapreduce.Job:  map 42% reduce 12%
16/12/09 11:46:47 INFO mapreduce.Job:  map 43% reduce 12%
16/12/09 11:46:48 INFO mapreduce.Job:  map 44% reduce 12%
16/12/09 11:46:49 INFO mapreduce.Job:  map 45% reduce 13%
16/12/09 11:46:50 INFO mapreduce.Job:  map 48% reduce 13%
16/12/09 11:46:51 INFO mapreduce.Job:  map 51% reduce 13%
16/12/09 11:46:52 INFO mapreduce.Job:  map 54% reduce 15%
16/12/09 11:46:53 INFO mapreduce.Job:  map 56% reduce 15%
16/12/09 11:46:54 INFO mapreduce.Job:  map 57% reduce 16%
16/12/09 11:46:55 INFO mapreduce.Job:  map 59% reduce 16%
16/12/09 11:46:56 INFO mapreduce.Job:  map 63% reduce 17%
16/12/09 11:46:57 INFO mapreduce.Job:  map 64% reduce 17%
16/12/09 11:46:58 INFO mapreduce.Job:  map 65% reduce 18%
16/12/09 11:46:59 INFO mapreduce.Job:  map 69% reduce 19%
16/12/09 11:47:00 INFO mapreduce.Job:  map 71% reduce 20%
16/12/09 11:47:01 INFO mapreduce.Job:  map 72% reduce 21%
16/12/09 11:47:02 INFO mapreduce.Job:  map 73% reduce 22%
16/12/09 11:47:03 INFO mapreduce.Job:  map 74% reduce 22%
16/12/09 11:47:04 INFO mapreduce.Job:  map 77% reduce 23%
16/12/09 11:47:05 INFO mapreduce.Job:  map 78% reduce 23%
16/12/09 11:47:06 INFO mapreduce.Job:  map 80% reduce 24%
16/12/09 11:47:07 INFO mapreduce.Job:  map 81% reduce 25%
16/12/09 11:47:08 INFO mapreduce.Job:  map 82% reduce 26%
16/12/09 11:47:09 INFO mapreduce.Job:  map 83% reduce 27%
16/12/09 11:47:12 INFO mapreduce.Job:  map 85% reduce 28%
16/12/09 11:47:13 INFO mapreduce.Job:  map 86% reduce 28%
16/12/09 11:47:15 INFO mapreduce.Job:  map 87% reduce 29%
16/12/09 11:47:25 INFO mapreduce.Job:  map 88% reduce 29%
16/12/09 11:47:26 INFO mapreduce.Job:  map 89% reduce 29%
16/12/09 11:47:28 INFO mapreduce.Job:  map 90% reduce 29%
16/12/09 11:47:29 INFO mapreduce.Job:  map 92% reduce 29%
16/12/09 11:47:30 INFO mapreduce.Job:  map 93% reduce 30%
16/12/09 11:47:32 INFO mapreduce.Job:  map 94% reduce 31%
16/12/09 11:47:34 INFO mapreduce.Job:  map 97% reduce 31%
16/12/09 11:47:35 INFO mapreduce.Job:  map 97% reduce 32%
16/12/09 11:47:36 INFO mapreduce.Job:  map 99% reduce 32%
16/12/09 11:47:37 INFO mapreduce.Job:  map 100% reduce 33%
16/12/09 11:47:38 INFO mapreduce.Job:  map 100% reduce 36%
16/12/09 11:47:39 INFO mapreduce.Job:  map 100% reduce 46%
16/12/09 11:47:40 INFO mapreduce.Job:  map 100% reduce 53%
16/12/09 11:47:41 INFO mapreduce.Job:  map 100% reduce 63%
16/12/09 11:47:42 INFO mapreduce.Job:  map 100% reduce 75%
16/12/09 11:47:43 INFO mapreduce.Job:  map 100% reduce 79%
16/12/09 11:47:44 INFO mapreduce.Job:  map 100% reduce 85%
16/12/09 11:47:45 INFO mapreduce.Job:  map 100% reduce 89%
16/12/09 11:47:46 INFO mapreduce.Job:  map 100% reduce 91%
16/12/09 11:47:47 INFO mapreduce.Job:  map 100% reduce 94%
16/12/09 11:47:48 INFO mapreduce.Job:  map 100% reduce 95%
16/12/09 11:47:49 INFO mapreduce.Job:  map 100% reduce 97%
16/12/09 11:47:50 INFO mapreduce.Job:  map 100% reduce 99%
16/12/09 11:47:51 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 11:47:55 INFO mapreduce.Job: Job job_1480588584072_6047 completed successfully
16/12/09 11:47:55 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=554104273
		FILE: Number of bytes written=1140590511
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=505466842
		WASB: Number of bytes written=285533009
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=19464962
		Total time spent by all reduces in occupied slots (ms)=4159684
		Total time spent by all map tasks (ms)=9732481
		Total time spent by all reduce tasks (ms)=2079842
		Total vcore-seconds taken by all map tasks=9732481
		Total vcore-seconds taken by all reduce tasks=2079842
		Total megabyte-seconds taken by all map tasks=9966060544
		Total megabyte-seconds taken by all reduce tasks=2129758208
	Map-Reduce Framework
		Map input records=1835205
		Map output records=1403393
		Map output bytes=548874412
		Map output materialized bytes=554127793
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1245284
		Reduce shuffle bytes=554127793
		Reduce input records=1403393
		Reduce output records=900895
		Spilled Records=2806786
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=98301
		CPU time spent (ms)=892080
		Physical memory (bytes) snapshot=323416506368
		Virtual memory (bytes) snapshot=742830764032
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=502770838
	File Output Format Counters 
		Bytes Written=285533009
16/12/09 11:47:55 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0600
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0700 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161208/201612082300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0700': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8875577201456946464.jar tmpDir=null
16/12/09 12:44:12 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 12:44:13 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 12:44:13 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 12:44:15 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 12:44:15 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 12:44:16 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6082
16/12/09 12:44:16 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6082
16/12/09 12:44:16 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6082/
16/12/09 12:44:17 INFO mapreduce.Job: Running job: job_1480588584072_6082
16/12/09 12:46:39 INFO mapreduce.Job: Job job_1480588584072_6082 running in uber mode : false
16/12/09 12:46:39 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 12:47:33 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 12:47:34 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 12:47:36 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 12:47:37 INFO mapreduce.Job:  map 5% reduce 0%
16/12/09 12:47:39 INFO mapreduce.Job:  map 8% reduce 0%
16/12/09 12:47:40 INFO mapreduce.Job:  map 10% reduce 0%
16/12/09 12:47:41 INFO mapreduce.Job:  map 11% reduce 0%
16/12/09 12:47:43 INFO mapreduce.Job:  map 13% reduce 0%
16/12/09 12:47:44 INFO mapreduce.Job:  map 14% reduce 0%
16/12/09 12:47:46 INFO mapreduce.Job:  map 15% reduce 0%
16/12/09 12:48:00 INFO mapreduce.Job:  map 16% reduce 0%
16/12/09 12:48:06 INFO mapreduce.Job:  map 16% reduce 1%
16/12/09 12:48:08 INFO mapreduce.Job:  map 19% reduce 1%
16/12/09 12:48:09 INFO mapreduce.Job:  map 20% reduce 1%
16/12/09 12:48:13 INFO mapreduce.Job:  map 22% reduce 1%
16/12/09 12:48:14 INFO mapreduce.Job:  map 23% reduce 2%
16/12/09 12:48:15 INFO mapreduce.Job:  map 25% reduce 2%
16/12/09 12:48:16 INFO mapreduce.Job:  map 25% reduce 4%
16/12/09 12:48:17 INFO mapreduce.Job:  map 26% reduce 5%
16/12/09 12:48:18 INFO mapreduce.Job:  map 26% reduce 6%
16/12/09 12:48:19 INFO mapreduce.Job:  map 27% reduce 7%
16/12/09 12:48:21 INFO mapreduce.Job:  map 28% reduce 7%
16/12/09 12:48:22 INFO mapreduce.Job:  map 29% reduce 9%
16/12/09 12:48:28 INFO mapreduce.Job:  map 31% reduce 9%
16/12/09 12:48:31 INFO mapreduce.Job:  map 32% reduce 10%
16/12/09 12:48:34 INFO mapreduce.Job:  map 34% reduce 10%
16/12/09 12:48:35 INFO mapreduce.Job:  map 35% reduce 10%
16/12/09 12:48:36 INFO mapreduce.Job:  map 36% reduce 10%
16/12/09 12:48:37 INFO mapreduce.Job:  map 37% reduce 10%
16/12/09 12:48:39 INFO mapreduce.Job:  map 39% reduce 11%
16/12/09 12:48:41 INFO mapreduce.Job:  map 40% reduce 11%
16/12/09 12:48:42 INFO mapreduce.Job:  map 42% reduce 11%
16/12/09 12:48:43 INFO mapreduce.Job:  map 43% reduce 11%
16/12/09 12:48:44 INFO mapreduce.Job:  map 44% reduce 11%
16/12/09 12:48:45 INFO mapreduce.Job:  map 47% reduce 12%
16/12/09 12:48:46 INFO mapreduce.Job:  map 48% reduce 12%
16/12/09 12:48:47 INFO mapreduce.Job:  map 53% reduce 12%
16/12/09 12:48:48 INFO mapreduce.Job:  map 54% reduce 12%
16/12/09 12:48:50 INFO mapreduce.Job:  map 56% reduce 13%
16/12/09 12:48:51 INFO mapreduce.Job:  map 58% reduce 13%
16/12/09 12:48:52 INFO mapreduce.Job:  map 60% reduce 14%
16/12/09 12:48:53 INFO mapreduce.Job:  map 61% reduce 14%
16/12/09 12:48:54 INFO mapreduce.Job:  map 63% reduce 14%
16/12/09 12:48:55 INFO mapreduce.Job:  map 65% reduce 15%
16/12/09 12:48:56 INFO mapreduce.Job:  map 69% reduce 15%
16/12/09 12:48:57 INFO mapreduce.Job:  map 71% reduce 16%
16/12/09 12:48:58 INFO mapreduce.Job:  map 73% reduce 17%
16/12/09 12:48:59 INFO mapreduce.Job:  map 76% reduce 18%
16/12/09 12:49:00 INFO mapreduce.Job:  map 77% reduce 19%
16/12/09 12:49:01 INFO mapreduce.Job:  map 78% reduce 20%
16/12/09 12:49:02 INFO mapreduce.Job:  map 79% reduce 21%
16/12/09 12:49:03 INFO mapreduce.Job:  map 80% reduce 22%
16/12/09 12:49:04 INFO mapreduce.Job:  map 81% reduce 22%
16/12/09 12:49:05 INFO mapreduce.Job:  map 81% reduce 23%
16/12/09 12:49:06 INFO mapreduce.Job:  map 83% reduce 23%
16/12/09 12:49:07 INFO mapreduce.Job:  map 83% reduce 24%
16/12/09 12:49:08 INFO mapreduce.Job:  map 86% reduce 25%
16/12/09 12:49:09 INFO mapreduce.Job:  map 87% reduce 25%
16/12/09 12:49:10 INFO mapreduce.Job:  map 91% reduce 26%
16/12/09 12:49:11 INFO mapreduce.Job:  map 92% reduce 27%
16/12/09 12:49:12 INFO mapreduce.Job:  map 94% reduce 28%
16/12/09 12:49:14 INFO mapreduce.Job:  map 95% reduce 29%
16/12/09 12:49:15 INFO mapreduce.Job:  map 96% reduce 29%
16/12/09 12:49:16 INFO mapreduce.Job:  map 96% reduce 30%
16/12/09 12:49:17 INFO mapreduce.Job:  map 97% reduce 30%
16/12/09 12:49:18 INFO mapreduce.Job:  map 98% reduce 31%
16/12/09 12:49:20 INFO mapreduce.Job:  map 99% reduce 32%
16/12/09 12:49:24 INFO mapreduce.Job:  map 100% reduce 32%
16/12/09 12:49:25 INFO mapreduce.Job:  map 100% reduce 33%
16/12/09 12:49:28 INFO mapreduce.Job:  map 100% reduce 34%
16/12/09 12:49:29 INFO mapreduce.Job:  map 100% reduce 36%
16/12/09 12:49:30 INFO mapreduce.Job:  map 100% reduce 47%
16/12/09 12:49:31 INFO mapreduce.Job:  map 100% reduce 50%
16/12/09 12:49:32 INFO mapreduce.Job:  map 100% reduce 51%
16/12/09 12:49:33 INFO mapreduce.Job:  map 100% reduce 59%
16/12/09 12:49:34 INFO mapreduce.Job:  map 100% reduce 68%
16/12/09 12:49:35 INFO mapreduce.Job:  map 100% reduce 71%
16/12/09 12:49:36 INFO mapreduce.Job:  map 100% reduce 72%
16/12/09 12:49:37 INFO mapreduce.Job:  map 100% reduce 74%
16/12/09 12:49:38 INFO mapreduce.Job:  map 100% reduce 75%
16/12/09 12:49:40 INFO mapreduce.Job:  map 100% reduce 77%
16/12/09 12:49:41 INFO mapreduce.Job:  map 100% reduce 78%
16/12/09 12:49:42 INFO mapreduce.Job:  map 100% reduce 79%
16/12/09 12:49:44 INFO mapreduce.Job:  map 100% reduce 81%
16/12/09 12:49:45 INFO mapreduce.Job:  map 100% reduce 82%
16/12/09 12:49:46 INFO mapreduce.Job:  map 100% reduce 83%
16/12/09 12:49:47 INFO mapreduce.Job:  map 100% reduce 86%
16/12/09 12:49:48 INFO mapreduce.Job:  map 100% reduce 87%
16/12/09 12:49:49 INFO mapreduce.Job:  map 100% reduce 89%
16/12/09 12:49:50 INFO mapreduce.Job:  map 100% reduce 91%
16/12/09 12:49:51 INFO mapreduce.Job:  map 100% reduce 92%
16/12/09 12:49:52 INFO mapreduce.Job:  map 100% reduce 93%
16/12/09 12:49:53 INFO mapreduce.Job:  map 100% reduce 94%
16/12/09 12:49:54 INFO mapreduce.Job:  map 100% reduce 96%
16/12/09 12:49:55 INFO mapreduce.Job:  map 100% reduce 97%
16/12/09 12:49:56 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 12:49:57 INFO mapreduce.Job:  map 100% reduce 99%
16/12/09 12:50:02 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 12:50:07 INFO mapreduce.Job: Job job_1480588584072_6082 completed successfully
16/12/09 12:50:07 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=773505640
		FILE: Number of bytes written=1579393245
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=689033300
		WASB: Number of bytes written=436096487
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=45815196
		Total time spent by all reduces in occupied slots (ms)=5122490
		Total time spent by all map tasks (ms)=22907598
		Total time spent by all reduce tasks (ms)=2561245
		Total vcore-seconds taken by all map tasks=22907598
		Total vcore-seconds taken by all reduce tasks=2561245
		Total megabyte-seconds taken by all map tasks=23457380352
		Total megabyte-seconds taken by all reduce tasks=2622714880
	Map-Reduce Framework
		Map input records=2432491
		Map output records=1937615
		Map output bytes=766261165
		Map output materialized bytes=773529160
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1735283
		Reduce shuffle bytes=773529160
		Reduce input records=1937615
		Reduce output records=1358548
		Spilled Records=3875230
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=279866
		CPU time spent (ms)=1160220
		Physical memory (bytes) snapshot=320484597760
		Virtual memory (bytes) snapshot=742246461440
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=686337296
	File Output Format Counters 
		Bytes Written=436096487
16/12/09 12:50:07 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0700
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090400 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0800 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090400
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0800': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7873800710519896541.jar tmpDir=null
16/12/09 13:46:19 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 13:46:20 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 13:46:20 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 13:46:22 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 13:46:22 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 13:46:22 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6132
16/12/09 13:46:23 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6132
16/12/09 13:46:23 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6132/
16/12/09 13:46:23 INFO mapreduce.Job: Running job: job_1480588584072_6132
16/12/09 13:46:36 INFO mapreduce.Job: Job job_1480588584072_6132 running in uber mode : false
16/12/09 13:46:36 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 13:47:05 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 13:47:33 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 13:47:36 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 13:47:39 INFO mapreduce.Job:  map 5% reduce 0%
16/12/09 13:47:45 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 13:47:47 INFO mapreduce.Job:  map 7% reduce 0%
16/12/09 13:47:51 INFO mapreduce.Job:  map 8% reduce 0%
16/12/09 13:47:53 INFO mapreduce.Job:  map 9% reduce 0%
16/12/09 13:47:54 INFO mapreduce.Job:  map 10% reduce 0%
16/12/09 13:47:57 INFO mapreduce.Job:  map 12% reduce 0%
16/12/09 13:47:58 INFO mapreduce.Job:  map 15% reduce 0%
16/12/09 13:47:59 INFO mapreduce.Job:  map 16% reduce 0%
16/12/09 13:48:01 INFO mapreduce.Job:  map 17% reduce 0%
16/12/09 13:48:02 INFO mapreduce.Job:  map 18% reduce 0%
16/12/09 13:48:05 INFO mapreduce.Job:  map 20% reduce 0%
16/12/09 13:48:07 INFO mapreduce.Job:  map 22% reduce 0%
16/12/09 13:48:08 INFO mapreduce.Job:  map 24% reduce 2%
16/12/09 13:48:10 INFO mapreduce.Job:  map 25% reduce 2%
16/12/09 13:48:11 INFO mapreduce.Job:  map 26% reduce 2%
16/12/09 13:48:13 INFO mapreduce.Job:  map 26% reduce 5%
16/12/09 13:48:19 INFO mapreduce.Job:  map 26% reduce 6%
16/12/09 13:48:20 INFO mapreduce.Job:  map 26% reduce 7%
16/12/09 13:48:21 INFO mapreduce.Job:  map 26% reduce 8%
16/12/09 13:48:22 INFO mapreduce.Job:  map 26% reduce 9%
16/12/09 13:48:24 INFO mapreduce.Job:  map 27% reduce 9%
16/12/09 13:48:29 INFO mapreduce.Job:  map 28% reduce 9%
16/12/09 13:48:30 INFO mapreduce.Job:  map 29% reduce 9%
16/12/09 13:48:31 INFO mapreduce.Job:  map 30% reduce 9%
16/12/09 13:48:33 INFO mapreduce.Job:  map 31% reduce 9%
16/12/09 13:48:34 INFO mapreduce.Job:  map 32% reduce 9%
16/12/09 13:48:35 INFO mapreduce.Job:  map 34% reduce 9%
16/12/09 13:48:36 INFO mapreduce.Job:  map 35% reduce 9%
16/12/09 13:48:37 INFO mapreduce.Job:  map 36% reduce 9%
16/12/09 13:48:38 INFO mapreduce.Job:  map 37% reduce 10%
16/12/09 13:48:39 INFO mapreduce.Job:  map 40% reduce 10%
16/12/09 13:48:40 INFO mapreduce.Job:  map 42% reduce 10%
16/12/09 13:48:41 INFO mapreduce.Job:  map 43% reduce 10%
16/12/09 13:48:42 INFO mapreduce.Job:  map 45% reduce 11%
16/12/09 13:48:43 INFO mapreduce.Job:  map 48% reduce 11%
16/12/09 13:48:44 INFO mapreduce.Job:  map 50% reduce 12%
16/12/09 13:48:45 INFO mapreduce.Job:  map 54% reduce 12%
16/12/09 13:48:46 INFO mapreduce.Job:  map 56% reduce 13%
16/12/09 13:48:47 INFO mapreduce.Job:  map 58% reduce 14%
16/12/09 13:48:48 INFO mapreduce.Job:  map 61% reduce 15%
16/12/09 13:48:49 INFO mapreduce.Job:  map 64% reduce 16%
16/12/09 13:48:50 INFO mapreduce.Job:  map 65% reduce 17%
16/12/09 13:48:51 INFO mapreduce.Job:  map 67% reduce 18%
16/12/09 13:48:52 INFO mapreduce.Job:  map 71% reduce 18%
16/12/09 13:48:53 INFO mapreduce.Job:  map 77% reduce 20%
16/12/09 13:48:54 INFO mapreduce.Job:  map 78% reduce 21%
16/12/09 13:48:55 INFO mapreduce.Job:  map 80% reduce 22%
16/12/09 13:48:56 INFO mapreduce.Job:  map 80% reduce 24%
16/12/09 13:48:57 INFO mapreduce.Job:  map 80% reduce 25%
16/12/09 13:49:19 INFO mapreduce.Job:  map 81% reduce 25%
16/12/09 13:49:24 INFO mapreduce.Job:  map 82% reduce 25%
16/12/09 13:49:30 INFO mapreduce.Job:  map 83% reduce 25%
16/12/09 13:49:31 INFO mapreduce.Job:  map 83% reduce 26%
16/12/09 13:49:32 INFO mapreduce.Job: Task Id : attempt_1480588584072_6132_m_000022_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 13:49:33 INFO mapreduce.Job: Task Id : attempt_1480588584072_6132_m_000017_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 13:49:33 INFO mapreduce.Job: Task Id : attempt_1480588584072_6132_m_000009_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 13:49:33 INFO mapreduce.Job: Task Id : attempt_1480588584072_6132_m_000002_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 13:49:34 INFO mapreduce.Job:  map 82% reduce 26%
16/12/09 13:49:36 INFO mapreduce.Job:  map 83% reduce 26%
16/12/09 13:49:43 INFO mapreduce.Job:  map 84% reduce 26%
16/12/09 13:49:44 INFO mapreduce.Job:  map 85% reduce 26%
16/12/09 13:49:45 INFO mapreduce.Job:  map 86% reduce 27%
16/12/09 13:49:51 INFO mapreduce.Job:  map 87% reduce 27%
16/12/09 13:49:53 INFO mapreduce.Job:  map 88% reduce 27%
16/12/09 13:49:57 INFO mapreduce.Job:  map 89% reduce 27%
16/12/09 13:50:00 INFO mapreduce.Job:  map 90% reduce 28%
16/12/09 13:50:02 INFO mapreduce.Job:  map 91% reduce 28%
16/12/09 13:50:03 INFO mapreduce.Job:  map 92% reduce 28%
16/12/09 13:50:05 INFO mapreduce.Job:  map 93% reduce 29%
16/12/09 13:50:08 INFO mapreduce.Job:  map 94% reduce 29%
16/12/09 13:50:10 INFO mapreduce.Job:  map 95% reduce 29%
16/12/09 13:50:11 INFO mapreduce.Job:  map 95% reduce 30%
16/12/09 13:50:12 INFO mapreduce.Job:  map 96% reduce 30%
16/12/09 13:50:13 INFO mapreduce.Job:  map 97% reduce 31%
16/12/09 13:50:15 INFO mapreduce.Job:  map 98% reduce 31%
16/12/09 13:50:16 INFO mapreduce.Job:  map 98% reduce 32%
16/12/09 13:50:17 INFO mapreduce.Job:  map 99% reduce 32%
16/12/09 13:50:18 INFO mapreduce.Job:  map 99% reduce 33%
16/12/09 13:50:20 INFO mapreduce.Job:  map 100% reduce 33%
16/12/09 13:50:21 INFO mapreduce.Job:  map 100% reduce 36%
16/12/09 13:50:22 INFO mapreduce.Job:  map 100% reduce 46%
16/12/09 13:50:23 INFO mapreduce.Job:  map 100% reduce 48%
16/12/09 13:50:24 INFO mapreduce.Job:  map 100% reduce 60%
16/12/09 13:50:25 INFO mapreduce.Job:  map 100% reduce 70%
16/12/09 13:50:27 INFO mapreduce.Job:  map 100% reduce 77%
16/12/09 13:50:28 INFO mapreduce.Job:  map 100% reduce 86%
16/12/09 13:50:29 INFO mapreduce.Job:  map 100% reduce 90%
16/12/09 13:50:30 INFO mapreduce.Job:  map 100% reduce 95%
16/12/09 13:50:31 INFO mapreduce.Job:  map 100% reduce 97%
16/12/09 13:50:32 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 13:50:33 INFO mapreduce.Job:  map 100% reduce 99%
16/12/09 13:50:36 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 13:50:38 INFO mapreduce.Job: Job job_1480588584072_6132 completed successfully
16/12/09 13:50:39 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=814158237
		FILE: Number of bytes written=1660698439
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=721065241
		WASB: Number of bytes written=452072664
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=4
		Launched map tasks=201
		Launched reduce tasks=20
		Other local map tasks=4
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=50987150
		Total time spent by all reduces in occupied slots (ms)=6267056
		Total time spent by all map tasks (ms)=25493575
		Total time spent by all reduce tasks (ms)=3133528
		Total vcore-seconds taken by all map tasks=25493575
		Total vcore-seconds taken by all reduce tasks=3133528
		Total megabyte-seconds taken by all map tasks=26105420800
		Total megabyte-seconds taken by all reduce tasks=3208732672
	Map-Reduce Framework
		Map input records=2525697
		Map output records=2038875
		Map output bytes=806521678
		Map output materialized bytes=814181757
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1818560
		Reduce shuffle bytes=814181757
		Reduce input records=2038875
		Reduce output records=1408753
		Spilled Records=4077750
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=599388
		CPU time spent (ms)=1450100
		Physical memory (bytes) snapshot=316779261952
		Virtual memory (bytes) snapshot=742220201984
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=718369237
	File Output Format Counters 
		Bytes Written=452072664
16/12/09 13:50:39 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0800
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090500 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0900 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090500
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0900': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5257474108739115975.jar tmpDir=null
16/12/09 14:46:45 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 14:46:46 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 14:46:46 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 14:46:49 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 14:46:49 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 14:46:49 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6171
16/12/09 14:46:50 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6171
16/12/09 14:46:50 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6171/
16/12/09 14:46:50 INFO mapreduce.Job: Running job: job_1480588584072_6171
16/12/09 14:47:18 INFO mapreduce.Job: Job job_1480588584072_6171 running in uber mode : false
16/12/09 14:47:18 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 14:47:41 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 14:47:42 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 14:47:43 INFO mapreduce.Job:  map 7% reduce 0%
16/12/09 14:48:01 INFO mapreduce.Job:  map 7% reduce 1%
16/12/09 14:48:10 INFO mapreduce.Job:  map 7% reduce 2%
16/12/09 14:48:46 INFO mapreduce.Job:  map 8% reduce 2%
16/12/09 14:48:50 INFO mapreduce.Job:  map 9% reduce 2%
16/12/09 14:48:51 INFO mapreduce.Job:  map 9% reduce 3%
16/12/09 14:48:55 INFO mapreduce.Job:  map 10% reduce 3%
16/12/09 14:48:57 INFO mapreduce.Job:  map 11% reduce 3%
16/12/09 14:48:59 INFO mapreduce.Job:  map 12% reduce 3%
16/12/09 14:49:01 INFO mapreduce.Job:  map 13% reduce 3%
16/12/09 14:49:02 INFO mapreduce.Job:  map 14% reduce 3%
16/12/09 14:49:03 INFO mapreduce.Job:  map 15% reduce 3%
16/12/09 14:49:05 INFO mapreduce.Job:  map 16% reduce 3%
16/12/09 14:49:06 INFO mapreduce.Job:  map 17% reduce 3%
16/12/09 14:49:07 INFO mapreduce.Job:  map 18% reduce 3%
16/12/09 14:49:08 INFO mapreduce.Job:  map 19% reduce 3%
16/12/09 14:49:09 INFO mapreduce.Job:  map 20% reduce 4%
16/12/09 14:49:11 INFO mapreduce.Job:  map 22% reduce 4%
16/12/09 14:49:12 INFO mapreduce.Job:  map 23% reduce 4%
16/12/09 14:49:13 INFO mapreduce.Job:  map 25% reduce 4%
16/12/09 14:49:14 INFO mapreduce.Job:  map 27% reduce 4%
16/12/09 14:49:15 INFO mapreduce.Job:  map 29% reduce 4%
16/12/09 14:49:16 INFO mapreduce.Job:  map 30% reduce 5%
16/12/09 14:49:17 INFO mapreduce.Job:  map 31% reduce 5%
16/12/09 14:49:18 INFO mapreduce.Job:  map 33% reduce 6%
16/12/09 14:49:19 INFO mapreduce.Job:  map 34% reduce 7%
16/12/09 14:49:20 INFO mapreduce.Job:  map 38% reduce 8%
16/12/09 14:49:21 INFO mapreduce.Job:  map 39% reduce 9%
16/12/09 14:49:22 INFO mapreduce.Job:  map 41% reduce 10%
16/12/09 14:49:23 INFO mapreduce.Job:  map 45% reduce 11%
16/12/09 14:49:24 INFO mapreduce.Job:  map 47% reduce 11%
16/12/09 14:49:25 INFO mapreduce.Job:  map 51% reduce 12%
16/12/09 14:49:26 INFO mapreduce.Job:  map 54% reduce 12%
16/12/09 14:49:27 INFO mapreduce.Job:  map 57% reduce 12%
16/12/09 14:49:28 INFO mapreduce.Job:  map 61% reduce 13%
16/12/09 14:49:29 INFO mapreduce.Job:  map 63% reduce 13%
16/12/09 14:49:30 INFO mapreduce.Job:  map 64% reduce 13%
16/12/09 14:49:32 INFO mapreduce.Job:  map 65% reduce 14%
16/12/09 14:49:33 INFO mapreduce.Job:  map 68% reduce 14%
16/12/09 14:49:34 INFO mapreduce.Job:  map 71% reduce 15%
16/12/09 14:49:35 INFO mapreduce.Job:  map 75% reduce 16%
16/12/09 14:49:36 INFO mapreduce.Job:  map 77% reduce 17%
16/12/09 14:49:37 INFO mapreduce.Job:  map 84% reduce 21%
16/12/09 14:49:38 INFO mapreduce.Job:  map 87% reduce 23%
16/12/09 14:49:39 INFO mapreduce.Job:  map 91% reduce 25%
16/12/09 14:49:40 INFO mapreduce.Job:  map 93% reduce 28%
16/12/09 14:49:41 INFO mapreduce.Job:  map 95% reduce 29%
16/12/09 14:49:42 INFO mapreduce.Job:  map 98% reduce 30%
16/12/09 14:49:43 INFO mapreduce.Job:  map 99% reduce 32%
16/12/09 14:49:44 INFO mapreduce.Job:  map 100% reduce 32%
16/12/09 14:49:45 INFO mapreduce.Job:  map 100% reduce 33%
16/12/09 14:49:46 INFO mapreduce.Job:  map 100% reduce 35%
16/12/09 14:49:47 INFO mapreduce.Job:  map 100% reduce 39%
16/12/09 14:49:48 INFO mapreduce.Job:  map 100% reduce 44%
16/12/09 14:49:49 INFO mapreduce.Job:  map 100% reduce 57%
16/12/09 14:49:50 INFO mapreduce.Job:  map 100% reduce 63%
16/12/09 14:49:51 INFO mapreduce.Job:  map 100% reduce 68%
16/12/09 14:49:52 INFO mapreduce.Job:  map 100% reduce 70%
16/12/09 14:49:53 INFO mapreduce.Job:  map 100% reduce 71%
16/12/09 14:49:54 INFO mapreduce.Job:  map 100% reduce 74%
16/12/09 14:49:55 INFO mapreduce.Job:  map 100% reduce 76%
16/12/09 14:49:56 INFO mapreduce.Job:  map 100% reduce 80%
16/12/09 14:49:57 INFO mapreduce.Job:  map 100% reduce 83%
16/12/09 14:49:58 INFO mapreduce.Job:  map 100% reduce 86%
16/12/09 14:49:59 INFO mapreduce.Job:  map 100% reduce 90%
16/12/09 14:50:00 INFO mapreduce.Job:  map 100% reduce 93%
16/12/09 14:50:01 INFO mapreduce.Job:  map 100% reduce 95%
16/12/09 14:50:02 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 14:50:03 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 14:50:06 INFO mapreduce.Job: Job job_1480588584072_6171 completed successfully
16/12/09 14:50:06 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=887948517
		FILE: Number of bytes written=1808278999
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=775425611
		WASB: Number of bytes written=492567990
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=47309228
		Total time spent by all reduces in occupied slots (ms)=5266916
		Total time spent by all map tasks (ms)=23654614
		Total time spent by all reduce tasks (ms)=2633458
		Total vcore-seconds taken by all map tasks=23654614
		Total vcore-seconds taken by all reduce tasks=2633458
		Total megabyte-seconds taken by all map tasks=24222324736
		Total megabyte-seconds taken by all reduce tasks=2696660992
	Map-Reduce Framework
		Map input records=2676320
		Map output records=2220004
		Map output bytes=879621200
		Map output materialized bytes=887972037
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1980895
		Reduce shuffle bytes=887972037
		Reduce input records=2220004
		Reduce output records=1532612
		Spilled Records=4440008
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=193377
		CPU time spent (ms)=1127010
		Physical memory (bytes) snapshot=320663027712
		Virtual memory (bytes) snapshot=742103445504
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=772729607
	File Output Format Counters 
		Bytes Written=492567990
16/12/09 14:50:06 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/0900
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090600 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090600
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob54363808987900195.jar tmpDir=null
16/12/09 15:46:15 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 15:46:16 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 15:46:16 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 15:46:18 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 15:46:18 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 15:46:19 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6217
16/12/09 15:46:19 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6217
16/12/09 15:46:19 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6217/
16/12/09 15:46:19 INFO mapreduce.Job: Running job: job_1480588584072_6217
16/12/09 15:46:32 INFO mapreduce.Job: Job job_1480588584072_6217 running in uber mode : false
16/12/09 15:46:32 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 15:46:54 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 15:47:36 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 15:47:47 INFO mapreduce.Job:  map 5% reduce 0%
16/12/09 15:47:48 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 15:47:49 INFO mapreduce.Job:  map 7% reduce 0%
16/12/09 15:48:00 INFO mapreduce.Job:  map 8% reduce 0%
16/12/09 15:48:18 INFO mapreduce.Job:  map 9% reduce 0%
16/12/09 15:48:24 INFO mapreduce.Job:  map 10% reduce 0%
16/12/09 15:48:25 INFO mapreduce.Job:  map 11% reduce 0%
16/12/09 15:48:26 INFO mapreduce.Job:  map 13% reduce 0%
16/12/09 15:48:32 INFO mapreduce.Job:  map 14% reduce 0%
16/12/09 15:48:33 INFO mapreduce.Job:  map 16% reduce 0%
16/12/09 15:48:34 INFO mapreduce.Job:  map 18% reduce 0%
16/12/09 15:48:36 INFO mapreduce.Job:  map 22% reduce 0%
16/12/09 15:48:36 INFO mapreduce.Job: Task Id : attempt_1480588584072_6217_m_000166_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 15:48:36 INFO mapreduce.Job: Task Id : attempt_1480588584072_6217_m_000172_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 15:48:36 INFO mapreduce.Job: Task Id : attempt_1480588584072_6217_m_000190_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 15:48:37 INFO mapreduce.Job:  map 23% reduce 0%
16/12/09 15:48:38 INFO mapreduce.Job:  map 24% reduce 0%
16/12/09 15:48:39 INFO mapreduce.Job:  map 26% reduce 0%
16/12/09 15:48:42 INFO mapreduce.Job:  map 27% reduce 0%
16/12/09 15:48:43 INFO mapreduce.Job:  map 28% reduce 0%
16/12/09 15:48:59 INFO mapreduce.Job:  map 30% reduce 0%
16/12/09 15:49:04 INFO mapreduce.Job:  map 31% reduce 1%
16/12/09 15:49:06 INFO mapreduce.Job:  map 33% reduce 1%
16/12/09 15:49:07 INFO mapreduce.Job:  map 34% reduce 1%
16/12/09 15:49:09 INFO mapreduce.Job:  map 36% reduce 1%
16/12/09 15:49:10 INFO mapreduce.Job:  map 37% reduce 2%
16/12/09 15:49:11 INFO mapreduce.Job:  map 38% reduce 2%
16/12/09 15:49:11 INFO mapreduce.Job: Task Id : attempt_1480588584072_6217_m_000170_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 15:49:12 INFO mapreduce.Job:  map 40% reduce 2%
16/12/09 15:49:13 INFO mapreduce.Job:  map 42% reduce 2%
16/12/09 15:49:14 INFO mapreduce.Job:  map 43% reduce 2%
16/12/09 15:49:15 INFO mapreduce.Job:  map 45% reduce 2%
16/12/09 15:49:16 INFO mapreduce.Job:  map 48% reduce 2%
16/12/09 15:49:17 INFO mapreduce.Job:  map 52% reduce 2%
16/12/09 15:49:18 INFO mapreduce.Job:  map 58% reduce 2%
16/12/09 15:49:19 INFO mapreduce.Job:  map 61% reduce 3%
16/12/09 15:49:20 INFO mapreduce.Job:  map 65% reduce 3%
16/12/09 15:49:21 INFO mapreduce.Job:  map 67% reduce 3%
16/12/09 15:49:22 INFO mapreduce.Job:  map 68% reduce 3%
16/12/09 15:49:23 INFO mapreduce.Job:  map 70% reduce 3%
16/12/09 15:49:24 INFO mapreduce.Job:  map 72% reduce 4%
16/12/09 15:49:25 INFO mapreduce.Job:  map 73% reduce 4%
16/12/09 15:49:26 INFO mapreduce.Job:  map 74% reduce 4%
16/12/09 15:49:27 INFO mapreduce.Job:  map 75% reduce 4%
16/12/09 15:49:28 INFO mapreduce.Job:  map 76% reduce 5%
16/12/09 15:49:29 INFO mapreduce.Job:  map 77% reduce 5%
16/12/09 15:49:32 INFO mapreduce.Job:  map 77% reduce 6%
16/12/09 15:49:33 INFO mapreduce.Job:  map 77% reduce 7%
16/12/09 15:49:34 INFO mapreduce.Job:  map 78% reduce 8%
16/12/09 15:49:35 INFO mapreduce.Job:  map 78% reduce 10%
16/12/09 15:49:37 INFO mapreduce.Job:  map 78% reduce 11%
16/12/09 15:49:38 INFO mapreduce.Job:  map 79% reduce 11%
16/12/09 15:49:39 INFO mapreduce.Job:  map 79% reduce 12%
16/12/09 15:49:40 INFO mapreduce.Job:  map 79% reduce 14%
16/12/09 15:49:45 INFO mapreduce.Job:  map 79% reduce 16%
16/12/09 15:49:46 INFO mapreduce.Job:  map 79% reduce 17%
16/12/09 15:49:47 INFO mapreduce.Job:  map 79% reduce 19%
16/12/09 15:49:49 INFO mapreduce.Job:  map 80% reduce 21%
16/12/09 15:49:50 INFO mapreduce.Job:  map 80% reduce 22%
16/12/09 15:49:51 INFO mapreduce.Job:  map 80% reduce 23%
16/12/09 15:49:55 INFO mapreduce.Job:  map 81% reduce 23%
16/12/09 15:49:58 INFO mapreduce.Job:  map 82% reduce 23%
16/12/09 15:50:33 INFO mapreduce.Job: Task Id : attempt_1480588584072_6217_m_000026_0, Status : FAILED
Error: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 137
	at org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:322)
	at org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:535)
	at org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)
	at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)
	at org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)
	at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)
	at org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:168)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1709)
	at org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:162)

16/12/09 15:50:37 INFO mapreduce.Job: Task Id : attempt_1480588584072_6217_m_000047_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 15:50:37 INFO mapreduce.Job: Task Id : attempt_1480588584072_6217_m_000030_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 15:50:37 INFO mapreduce.Job: Task Id : attempt_1480588584072_6217_m_000002_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 15:50:37 INFO mapreduce.Job: Task Id : attempt_1480588584072_6217_m_000024_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 15:50:38 INFO mapreduce.Job:  map 82% reduce 24%
16/12/09 15:50:38 INFO mapreduce.Job: Task Id : attempt_1480588584072_6217_m_000046_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 15:50:38 INFO mapreduce.Job: Task Id : attempt_1480588584072_6217_m_000027_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 15:50:39 INFO mapreduce.Job:  map 81% reduce 24%
16/12/09 15:50:42 INFO mapreduce.Job:  map 82% reduce 24%
16/12/09 15:50:44 INFO mapreduce.Job:  map 83% reduce 24%
16/12/09 15:50:45 INFO mapreduce.Job:  map 84% reduce 24%
16/12/09 15:50:46 INFO mapreduce.Job:  map 86% reduce 24%
16/12/09 15:50:47 INFO mapreduce.Job:  map 87% reduce 24%
16/12/09 15:50:48 INFO mapreduce.Job:  map 89% reduce 24%
16/12/09 15:50:49 INFO mapreduce.Job:  map 90% reduce 25%
16/12/09 15:50:52 INFO mapreduce.Job:  map 90% reduce 26%
16/12/09 15:50:53 INFO mapreduce.Job:  map 91% reduce 26%
16/12/09 15:50:54 INFO mapreduce.Job:  map 92% reduce 26%
16/12/09 15:50:56 INFO mapreduce.Job:  map 93% reduce 26%
16/12/09 15:50:58 INFO mapreduce.Job:  map 94% reduce 26%
16/12/09 15:50:59 INFO mapreduce.Job:  map 95% reduce 26%
16/12/09 15:51:02 INFO mapreduce.Job:  map 96% reduce 26%
16/12/09 15:51:03 INFO mapreduce.Job:  map 96% reduce 27%
16/12/09 15:51:04 INFO mapreduce.Job:  map 97% reduce 27%
16/12/09 15:51:06 INFO mapreduce.Job:  map 98% reduce 27%
16/12/09 15:51:07 INFO mapreduce.Job:  map 98% reduce 29%
16/12/09 15:51:08 INFO mapreduce.Job:  map 99% reduce 31%
16/12/09 15:51:09 INFO mapreduce.Job:  map 100% reduce 32%
16/12/09 15:51:12 INFO mapreduce.Job:  map 100% reduce 33%
16/12/09 15:51:13 INFO mapreduce.Job:  map 100% reduce 37%
16/12/09 15:51:14 INFO mapreduce.Job:  map 100% reduce 39%
16/12/09 15:51:15 INFO mapreduce.Job:  map 100% reduce 42%
16/12/09 15:51:16 INFO mapreduce.Job:  map 100% reduce 52%
16/12/09 15:51:17 INFO mapreduce.Job:  map 100% reduce 54%
16/12/09 15:51:18 INFO mapreduce.Job:  map 100% reduce 55%
16/12/09 15:51:19 INFO mapreduce.Job:  map 100% reduce 62%
16/12/09 15:51:20 INFO mapreduce.Job:  map 100% reduce 65%
16/12/09 15:51:21 INFO mapreduce.Job:  map 100% reduce 66%
16/12/09 15:51:22 INFO mapreduce.Job:  map 100% reduce 67%
16/12/09 15:51:23 INFO mapreduce.Job:  map 100% reduce 69%
16/12/09 15:51:25 INFO mapreduce.Job:  map 100% reduce 70%
16/12/09 15:51:26 INFO mapreduce.Job:  map 100% reduce 72%
16/12/09 15:51:27 INFO mapreduce.Job:  map 100% reduce 73%
16/12/09 15:51:28 INFO mapreduce.Job:  map 100% reduce 74%
16/12/09 15:51:29 INFO mapreduce.Job:  map 100% reduce 77%
16/12/09 15:51:30 INFO mapreduce.Job:  map 100% reduce 78%
16/12/09 15:51:31 INFO mapreduce.Job:  map 100% reduce 79%
16/12/09 15:51:32 INFO mapreduce.Job:  map 100% reduce 80%
16/12/09 15:51:33 INFO mapreduce.Job:  map 100% reduce 82%
16/12/09 15:51:34 INFO mapreduce.Job:  map 100% reduce 84%
16/12/09 15:51:35 INFO mapreduce.Job:  map 100% reduce 85%
16/12/09 15:51:36 INFO mapreduce.Job:  map 100% reduce 87%
16/12/09 15:51:37 INFO mapreduce.Job:  map 100% reduce 88%
16/12/09 15:51:38 INFO mapreduce.Job:  map 100% reduce 89%
16/12/09 15:51:39 INFO mapreduce.Job:  map 100% reduce 91%
16/12/09 15:51:40 INFO mapreduce.Job:  map 100% reduce 93%
16/12/09 15:51:42 INFO mapreduce.Job:  map 100% reduce 94%
16/12/09 15:51:45 INFO mapreduce.Job:  map 100% reduce 96%
16/12/09 15:51:48 INFO mapreduce.Job:  map 100% reduce 97%
16/12/09 15:51:57 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 15:52:02 INFO mapreduce.Job:  map 100% reduce 99%
16/12/09 15:52:06 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 15:52:09 INFO mapreduce.Job: Job job_1480588584072_6217 completed successfully
16/12/09 15:52:10 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=962472610
		FILE: Number of bytes written=1957327185
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=826578998
		WASB: Number of bytes written=544912594
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=11
		Launched map tasks=208
		Launched reduce tasks=20
		Other local map tasks=11
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=67683810
		Total time spent by all reduces in occupied slots (ms)=6916736
		Total time spent by all map tasks (ms)=33841905
		Total time spent by all reduce tasks (ms)=3458368
		Total vcore-seconds taken by all map tasks=33841905
		Total vcore-seconds taken by all reduce tasks=3458368
		Total megabyte-seconds taken by all map tasks=34654110720
		Total megabyte-seconds taken by all reduce tasks=3541368832
	Map-Reduce Framework
		Map input records=2800794
		Map output records=2397264
		Map output bytes=953458849
		Map output materialized bytes=962496130
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2145238
		Reduce shuffle bytes=962496130
		Reduce input records=2397264
		Reduce output records=1686140
		Spilled Records=4794528
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=252771
		CPU time spent (ms)=1267020
		Physical memory (bytes) snapshot=318177259520
		Virtual memory (bytes) snapshot=742076395520
		Total committed heap usage (bytes)=574308745216
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=823882994
	File Output Format Counters 
		Bytes Written=544912594
16/12/09 15:52:10 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090700 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090700
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8195602389233593393.jar tmpDir=null
16/12/09 16:48:16 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 16:48:17 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 16:48:17 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 16:48:19 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 16:48:19 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 16:48:20 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6223
16/12/09 16:48:20 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6223
16/12/09 16:48:20 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6223/
16/12/09 16:48:20 INFO mapreduce.Job: Running job: job_1480588584072_6223
16/12/09 16:48:33 INFO mapreduce.Job: Job job_1480588584072_6223 running in uber mode : false
16/12/09 16:48:33 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 16:48:47 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 16:50:17 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 16:50:19 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 16:50:21 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 16:50:23 INFO mapreduce.Job:  map 5% reduce 0%
16/12/09 16:50:25 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 16:50:26 INFO mapreduce.Job:  map 7% reduce 0%
16/12/09 16:50:28 INFO mapreduce.Job:  map 8% reduce 0%
16/12/09 16:50:29 INFO mapreduce.Job:  map 9% reduce 0%
16/12/09 16:50:31 INFO mapreduce.Job:  map 10% reduce 0%
16/12/09 16:50:32 INFO mapreduce.Job:  map 13% reduce 0%
16/12/09 16:50:33 INFO mapreduce.Job:  map 14% reduce 0%
16/12/09 16:50:34 INFO mapreduce.Job:  map 15% reduce 0%
16/12/09 16:50:35 INFO mapreduce.Job:  map 17% reduce 0%
16/12/09 16:50:36 INFO mapreduce.Job:  map 19% reduce 0%
16/12/09 16:50:37 INFO mapreduce.Job:  map 21% reduce 0%
16/12/09 16:50:38 INFO mapreduce.Job:  map 25% reduce 0%
16/12/09 16:50:39 INFO mapreduce.Job:  map 27% reduce 0%
16/12/09 16:50:40 INFO mapreduce.Job:  map 28% reduce 0%
16/12/09 16:50:41 INFO mapreduce.Job:  map 30% reduce 0%
16/12/09 16:50:42 INFO mapreduce.Job:  map 34% reduce 0%
16/12/09 16:50:43 INFO mapreduce.Job:  map 36% reduce 1%
16/12/09 16:50:44 INFO mapreduce.Job:  map 38% reduce 1%
16/12/09 16:50:45 INFO mapreduce.Job:  map 40% reduce 2%
16/12/09 16:50:46 INFO mapreduce.Job:  map 43% reduce 3%
16/12/09 16:50:47 INFO mapreduce.Job:  map 45% reduce 3%
16/12/09 16:50:48 INFO mapreduce.Job:  map 47% reduce 3%
16/12/09 16:50:49 INFO mapreduce.Job:  map 50% reduce 4%
16/12/09 16:50:50 INFO mapreduce.Job:  map 54% reduce 4%
16/12/09 16:50:51 INFO mapreduce.Job:  map 56% reduce 5%
16/12/09 16:50:52 INFO mapreduce.Job:  map 59% reduce 5%
16/12/09 16:50:53 INFO mapreduce.Job:  map 64% reduce 6%
16/12/09 16:50:54 INFO mapreduce.Job:  map 69% reduce 6%
16/12/09 16:50:55 INFO mapreduce.Job:  map 72% reduce 7%
16/12/09 16:50:56 INFO mapreduce.Job:  map 76% reduce 7%
16/12/09 16:50:57 INFO mapreduce.Job:  map 77% reduce 8%
16/12/09 16:50:58 INFO mapreduce.Job:  map 77% reduce 9%
16/12/09 16:50:59 INFO mapreduce.Job:  map 80% reduce 9%
16/12/09 16:51:00 INFO mapreduce.Job:  map 80% reduce 10%
16/12/09 16:51:01 INFO mapreduce.Job:  map 82% reduce 10%
16/12/09 16:51:02 INFO mapreduce.Job:  map 83% reduce 10%
16/12/09 16:51:03 INFO mapreduce.Job:  map 83% reduce 11%
16/12/09 16:51:04 INFO mapreduce.Job:  map 83% reduce 13%
16/12/09 16:51:05 INFO mapreduce.Job:  map 83% reduce 18%
16/12/09 16:51:06 INFO mapreduce.Job:  map 83% reduce 19%
16/12/09 16:51:07 INFO mapreduce.Job:  map 83% reduce 22%
16/12/09 16:51:08 INFO mapreduce.Job:  map 83% reduce 23%
16/12/09 16:51:18 INFO mapreduce.Job:  map 84% reduce 24%
16/12/09 16:51:20 INFO mapreduce.Job:  map 85% reduce 24%
16/12/09 16:51:35 INFO mapreduce.Job:  map 86% reduce 24%
16/12/09 16:51:38 INFO mapreduce.Job:  map 87% reduce 24%
16/12/09 16:52:16 INFO mapreduce.Job: Task Id : attempt_1480588584072_6223_m_000015_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 16:52:18 INFO mapreduce.Job:  map 87% reduce 25%
16/12/09 16:52:20 INFO mapreduce.Job:  map 88% reduce 26%
16/12/09 16:52:23 INFO mapreduce.Job:  map 89% reduce 26%
16/12/09 16:52:25 INFO mapreduce.Job:  map 90% reduce 26%
16/12/09 16:52:26 INFO mapreduce.Job:  map 91% reduce 26%
16/12/09 16:52:27 INFO mapreduce.Job:  map 92% reduce 26%
16/12/09 16:52:29 INFO mapreduce.Job:  map 93% reduce 26%
16/12/09 16:52:31 INFO mapreduce.Job:  map 94% reduce 26%
16/12/09 16:52:33 INFO mapreduce.Job:  map 95% reduce 26%
16/12/09 16:52:35 INFO mapreduce.Job:  map 96% reduce 27%
16/12/09 16:52:36 INFO mapreduce.Job:  map 97% reduce 27%
16/12/09 16:52:38 INFO mapreduce.Job:  map 98% reduce 28%
16/12/09 16:52:39 INFO mapreduce.Job:  map 99% reduce 28%
16/12/09 16:52:41 INFO mapreduce.Job:  map 99% reduce 29%
16/12/09 16:52:43 INFO mapreduce.Job:  map 99% reduce 30%
16/12/09 16:52:45 INFO mapreduce.Job:  map 100% reduce 30%
16/12/09 16:52:46 INFO mapreduce.Job:  map 100% reduce 36%
16/12/09 16:52:47 INFO mapreduce.Job:  map 100% reduce 47%
16/12/09 16:52:48 INFO mapreduce.Job:  map 100% reduce 62%
16/12/09 16:52:49 INFO mapreduce.Job:  map 100% reduce 69%
16/12/09 16:52:50 INFO mapreduce.Job:  map 100% reduce 75%
16/12/09 16:52:51 INFO mapreduce.Job:  map 100% reduce 82%
16/12/09 16:52:52 INFO mapreduce.Job:  map 100% reduce 87%
16/12/09 16:52:53 INFO mapreduce.Job:  map 100% reduce 96%
16/12/09 16:52:54 INFO mapreduce.Job:  map 100% reduce 99%
16/12/09 16:52:56 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 16:53:00 INFO mapreduce.Job: Job job_1480588584072_6223 completed successfully
16/12/09 16:53:00 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=853893224
		FILE: Number of bytes written=1740168413
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=738554527
		WASB: Number of bytes written=451684929
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=1
		Launched map tasks=198
		Launched reduce tasks=20
		Other local map tasks=1
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=59977746
		Total time spent by all reduces in occupied slots (ms)=5575942
		Total time spent by all map tasks (ms)=29988873
		Total time spent by all reduce tasks (ms)=2787971
		Total vcore-seconds taken by all map tasks=29988873
		Total vcore-seconds taken by all reduce tasks=2787971
		Total megabyte-seconds taken by all map tasks=30708605952
		Total megabyte-seconds taken by all reduce tasks=2854882304
	Map-Reduce Framework
		Map input records=2449586
		Map output records=2094851
		Map output bytes=845880676
		Map output materialized bytes=853916744
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1842148
		Reduce shuffle bytes=853916744
		Reduce input records=2094851
		Reduce output records=1353195
		Spilled Records=4189702
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=364084
		CPU time spent (ms)=1340930
		Physical memory (bytes) snapshot=318477238272
		Virtual memory (bytes) snapshot=741929263104
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=735858523
	File Output Format Counters 
		Bytes Written=451684929
16/12/09 16:53:00 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090800 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090800
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob690200809727836510.jar tmpDir=null
16/12/09 17:44:09 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 17:44:10 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 17:44:10 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 17:44:12 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 17:44:12 INFO mapreduce.JobSubmitter: number of splits:221
16/12/09 17:44:12 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6258
16/12/09 17:44:13 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6258
16/12/09 17:44:13 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6258/
16/12/09 17:44:13 INFO mapreduce.Job: Running job: job_1480588584072_6258
16/12/09 17:44:25 INFO mapreduce.Job: Job job_1480588584072_6258 running in uber mode : false
16/12/09 17:44:25 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 17:44:47 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 17:44:51 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 17:45:01 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 17:45:02 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 17:45:34 INFO mapreduce.Job:  map 5% reduce 0%
16/12/09 17:45:39 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 17:46:16 INFO mapreduce.Job:  map 7% reduce 0%
16/12/09 17:46:17 INFO mapreduce.Job:  map 18% reduce 0%
16/12/09 17:46:18 INFO mapreduce.Job:  map 20% reduce 0%
16/12/09 17:46:20 INFO mapreduce.Job:  map 21% reduce 0%
16/12/09 17:46:21 INFO mapreduce.Job:  map 23% reduce 0%
16/12/09 17:46:22 INFO mapreduce.Job:  map 26% reduce 0%
16/12/09 17:46:58 INFO mapreduce.Job:  map 27% reduce 0%
16/12/09 17:47:00 INFO mapreduce.Job:  map 32% reduce 0%
16/12/09 17:47:10 INFO mapreduce.Job:  map 33% reduce 0%
16/12/09 17:47:11 INFO mapreduce.Job:  map 36% reduce 0%
16/12/09 17:47:12 INFO mapreduce.Job:  map 43% reduce 0%
16/12/09 17:47:13 INFO mapreduce.Job:  map 45% reduce 0%
16/12/09 17:47:14 INFO mapreduce.Job:  map 46% reduce 0%
16/12/09 17:47:15 INFO mapreduce.Job:  map 47% reduce 0%
16/12/09 17:47:16 INFO mapreduce.Job:  map 52% reduce 0%
16/12/09 17:47:17 INFO mapreduce.Job:  map 54% reduce 0%
16/12/09 17:47:18 INFO mapreduce.Job:  map 55% reduce 0%
16/12/09 17:47:20 INFO mapreduce.Job:  map 55% reduce 1%
16/12/09 17:47:20 INFO mapreduce.Job: Task Id : attempt_1480588584072_6258_m_000133_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 17:47:21 INFO mapreduce.Job:  map 57% reduce 3%
16/12/09 17:47:22 INFO mapreduce.Job: Task Id : attempt_1480588584072_6258_m_000108_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 17:47:22 INFO mapreduce.Job: Task Id : attempt_1480588584072_6258_m_000138_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 17:47:23 INFO mapreduce.Job:  map 58% reduce 3%
16/12/09 17:47:24 INFO mapreduce.Job:  map 59% reduce 5%
16/12/09 17:47:25 INFO mapreduce.Job:  map 60% reduce 5%
16/12/09 17:47:25 INFO mapreduce.Job: Task Id : attempt_1480588584072_6258_m_000170_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 17:47:26 INFO mapreduce.Job:  map 61% reduce 5%
16/12/09 17:47:26 INFO mapreduce.Job: Task Id : attempt_1480588584072_6258_m_000148_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 17:47:26 INFO mapreduce.Job: Task Id : attempt_1480588584072_6258_m_000182_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 17:47:26 INFO mapreduce.Job: Task Id : attempt_1480588584072_6258_m_000149_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 17:47:27 INFO mapreduce.Job:  map 61% reduce 7%
16/12/09 17:47:27 INFO mapreduce.Job: Task Id : attempt_1480588584072_6258_m_000151_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 17:47:28 INFO mapreduce.Job:  map 64% reduce 7%
16/12/09 17:47:29 INFO mapreduce.Job:  map 67% reduce 7%
16/12/09 17:47:30 INFO mapreduce.Job:  map 69% reduce 7%
16/12/09 17:47:31 INFO mapreduce.Job:  map 70% reduce 7%
16/12/09 17:47:33 INFO mapreduce.Job:  map 71% reduce 8%
16/12/09 17:47:34 INFO mapreduce.Job:  map 72% reduce 8%
16/12/09 17:47:35 INFO mapreduce.Job:  map 73% reduce 8%
16/12/09 17:47:36 INFO mapreduce.Job:  map 73% reduce 14%
16/12/09 17:47:38 INFO mapreduce.Job:  map 74% reduce 15%
16/12/09 17:47:40 INFO mapreduce.Job:  map 75% reduce 15%
16/12/09 17:47:43 INFO mapreduce.Job:  map 75% reduce 16%
16/12/09 17:47:44 INFO mapreduce.Job:  map 76% reduce 16%
16/12/09 17:47:46 INFO mapreduce.Job:  map 77% reduce 16%
16/12/09 17:47:47 INFO mapreduce.Job:  map 78% reduce 16%
16/12/09 17:47:48 INFO mapreduce.Job:  map 79% reduce 16%
16/12/09 17:47:49 INFO mapreduce.Job:  map 80% reduce 16%
16/12/09 17:47:50 INFO mapreduce.Job:  map 83% reduce 16%
16/12/09 17:47:51 INFO mapreduce.Job:  map 86% reduce 16%
16/12/09 17:47:52 INFO mapreduce.Job:  map 87% reduce 16%
16/12/09 17:47:53 INFO mapreduce.Job:  map 87% reduce 17%
16/12/09 17:47:56 INFO mapreduce.Job:  map 89% reduce 18%
16/12/09 17:47:57 INFO mapreduce.Job:  map 90% reduce 18%
16/12/09 17:47:58 INFO mapreduce.Job:  map 90% reduce 19%
16/12/09 17:47:59 INFO mapreduce.Job:  map 90% reduce 20%
16/12/09 17:48:00 INFO mapreduce.Job:  map 91% reduce 21%
16/12/09 17:48:11 INFO mapreduce.Job:  map 91% reduce 22%
16/12/09 17:48:11 INFO mapreduce.Job: Task Id : attempt_1480588584072_6258_m_000083_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 17:48:11 INFO mapreduce.Job: Task Id : attempt_1480588584072_6258_m_000059_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 17:48:11 INFO mapreduce.Job: Task Id : attempt_1480588584072_6258_m_000075_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 17:48:12 INFO mapreduce.Job:  map 91% reduce 23%
16/12/09 17:48:13 INFO mapreduce.Job:  map 92% reduce 23%
16/12/09 17:48:14 INFO mapreduce.Job:  map 92% reduce 24%
16/12/09 17:48:14 INFO mapreduce.Job: Task Id : attempt_1480588584072_6258_r_000007_0, Status : FAILED
Exception from container-launch.
Container id: container_e14_1480588584072_6258_01_000246
Exit code: 1
Stack trace: ExitCodeException exitCode=1: 
	at org.apache.hadoop.util.Shell.runCommand(Shell.java:576)
	at org.apache.hadoop.util.Shell.run(Shell.java:487)
	at org.apache.hadoop.util.Shell$ShellCommandExecutor.execute(Shell.java:753)
	at org.apache.hadoop.yarn.server.nodemanager.LinuxContainerExecutor.launchContainer(LinuxContainerExecutor.java:371)
	at org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.ContainerLaunch.call(ContainerLaunch.java:303)
	at org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.ContainerLaunch.call(ContainerLaunch.java:82)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)

Shell output: main : command provided 1
main : run as user is nobody
main : requested yarn user is zhangrn


Container exited with a non-zero exit code 1

16/12/09 17:48:14 INFO mapreduce.Job: Task Id : attempt_1480588584072_6258_m_000066_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 17:48:14 INFO mapreduce.Job: Task Id : attempt_1480588584072_6258_m_000072_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 17:48:15 INFO mapreduce.Job:  map 93% reduce 24%
16/12/09 17:48:16 INFO mapreduce.Job:  map 97% reduce 24%
16/12/09 17:48:17 INFO mapreduce.Job:  map 97% reduce 25%
16/12/09 17:48:19 INFO mapreduce.Job:  map 99% reduce 26%
16/12/09 17:48:27 INFO mapreduce.Job:  map 100% reduce 26%
16/12/09 17:48:28 INFO mapreduce.Job:  map 100% reduce 32%
16/12/09 17:48:29 INFO mapreduce.Job:  map 100% reduce 33%
16/12/09 17:48:30 INFO mapreduce.Job:  map 100% reduce 39%
16/12/09 17:48:31 INFO mapreduce.Job:  map 100% reduce 48%
16/12/09 17:48:32 INFO mapreduce.Job:  map 100% reduce 53%
16/12/09 17:48:33 INFO mapreduce.Job:  map 100% reduce 58%
16/12/09 17:48:34 INFO mapreduce.Job:  map 100% reduce 63%
16/12/09 17:48:35 INFO mapreduce.Job:  map 100% reduce 68%
16/12/09 17:48:36 INFO mapreduce.Job:  map 100% reduce 70%
16/12/09 17:48:37 INFO mapreduce.Job:  map 100% reduce 73%
16/12/09 17:48:38 INFO mapreduce.Job:  map 100% reduce 78%
16/12/09 17:48:39 INFO mapreduce.Job:  map 100% reduce 82%
16/12/09 17:48:40 INFO mapreduce.Job:  map 100% reduce 84%
16/12/09 17:48:41 INFO mapreduce.Job:  map 100% reduce 86%
16/12/09 17:48:42 INFO mapreduce.Job:  map 100% reduce 90%
16/12/09 17:48:43 INFO mapreduce.Job:  map 100% reduce 93%
16/12/09 17:48:44 INFO mapreduce.Job:  map 100% reduce 94%
16/12/09 17:48:45 INFO mapreduce.Job:  map 100% reduce 95%
16/12/09 17:48:46 INFO mapreduce.Job:  map 100% reduce 96%
16/12/09 17:48:47 INFO mapreduce.Job:  map 100% reduce 97%
16/12/09 17:48:50 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 17:48:52 INFO mapreduce.Job:  map 100% reduce 99%
16/12/09 17:48:54 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 17:48:58 INFO mapreduce.Job: Job job_1480588584072_6258 completed successfully
16/12/09 17:48:58 INFO mapreduce.Job: Counters: 52
	File System Counters
		FILE: Number of bytes read=858533242
		FILE: Number of bytes written=1753031289
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=738424161
		WASB: Number of bytes written=458016307
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=13
		Failed reduce tasks=1
		Launched map tasks=234
		Launched reduce tasks=21
		Other local map tasks=13
		Rack-local map tasks=221
		Total time spent by all maps in occupied slots (ms)=74799832
		Total time spent by all reduces in occupied slots (ms)=3606108
		Total time spent by all map tasks (ms)=37399916
		Total time spent by all reduce tasks (ms)=1803054
		Total vcore-seconds taken by all map tasks=37399916
		Total vcore-seconds taken by all reduce tasks=1803054
		Total megabyte-seconds taken by all map tasks=38297513984
		Total megabyte-seconds taken by all reduce tasks=1846327296
	Map-Reduce Framework
		Map input records=2385892
		Map output records=2098680
		Map output bytes=850489127
		Map output materialized bytes=858559642
		Input split bytes=30788
		Combine input records=0
		Combine output records=0
		Reduce input groups=1844574
		Reduce shuffle bytes=858559642
		Reduce input records=2098680
		Reduce output records=1363867
		Spilled Records=4197360
		Shuffled Maps =4420
		Failed Shuffles=0
		Merged Map outputs=4420
		GC time elapsed (ms)=410855
		CPU time spent (ms)=1687790
		Physical memory (bytes) snapshot=344539025408
		Virtual memory (bytes) snapshot=824009728000
		Total committed heap usage (bytes)=638084710400
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=735028713
	File Output Format Counters 
		Bytes Written=458016307
16/12/09 17:48:58 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090900 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090900
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob862216191209275004.jar tmpDir=null
16/12/09 18:45:05 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 18:45:06 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 18:45:06 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 18:45:08 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 18:45:08 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 18:45:08 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6304
16/12/09 18:45:09 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6304
16/12/09 18:45:09 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6304/
16/12/09 18:45:09 INFO mapreduce.Job: Running job: job_1480588584072_6304
16/12/09 18:45:21 INFO mapreduce.Job: Job job_1480588584072_6304 running in uber mode : false
16/12/09 18:45:21 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 18:45:49 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 18:46:29 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 18:46:34 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 18:46:35 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 18:46:36 INFO mapreduce.Job:  map 5% reduce 0%
16/12/09 18:46:50 INFO mapreduce.Job:  map 7% reduce 0%
16/12/09 18:47:10 INFO mapreduce.Job:  map 8% reduce 0%
16/12/09 18:47:14 INFO mapreduce.Job:  map 10% reduce 0%
16/12/09 18:47:20 INFO mapreduce.Job:  map 11% reduce 0%
16/12/09 18:47:21 INFO mapreduce.Job:  map 12% reduce 0%
16/12/09 18:47:22 INFO mapreduce.Job:  map 13% reduce 0%
16/12/09 18:47:23 INFO mapreduce.Job:  map 14% reduce 0%
16/12/09 18:47:24 INFO mapreduce.Job:  map 15% reduce 0%
16/12/09 18:47:25 INFO mapreduce.Job:  map 16% reduce 0%
16/12/09 18:47:40 INFO mapreduce.Job:  map 18% reduce 0%
16/12/09 18:47:40 INFO mapreduce.Job: Task Id : attempt_1480588584072_6304_m_000088_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 18:47:40 INFO mapreduce.Job: Task Id : attempt_1480588584072_6304_m_000050_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 18:47:41 INFO mapreduce.Job:  map 17% reduce 0%
16/12/09 18:47:42 INFO mapreduce.Job:  map 20% reduce 0%
16/12/09 18:47:43 INFO mapreduce.Job:  map 25% reduce 0%
16/12/09 18:47:43 INFO mapreduce.Job: Task Id : attempt_1480588584072_6304_m_000067_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 18:47:43 INFO mapreduce.Job: Task Id : attempt_1480588584072_6304_m_000052_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 18:47:43 INFO mapreduce.Job: Task Id : attempt_1480588584072_6304_m_000066_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 18:47:44 INFO mapreduce.Job:  map 24% reduce 0%
16/12/09 18:47:45 INFO mapreduce.Job:  map 25% reduce 0%
16/12/09 18:47:46 INFO mapreduce.Job:  map 26% reduce 0%
16/12/09 18:47:50 INFO mapreduce.Job:  map 27% reduce 0%
16/12/09 18:47:51 INFO mapreduce.Job:  map 28% reduce 0%
16/12/09 18:47:52 INFO mapreduce.Job:  map 28% reduce 2%
16/12/09 18:47:54 INFO mapreduce.Job:  map 30% reduce 2%
16/12/09 18:47:55 INFO mapreduce.Job:  map 31% reduce 3%
16/12/09 18:47:56 INFO mapreduce.Job:  map 33% reduce 5%
16/12/09 18:47:57 INFO mapreduce.Job:  map 34% reduce 5%
16/12/09 18:47:59 INFO mapreduce.Job:  map 35% reduce 6%
16/12/09 18:48:00 INFO mapreduce.Job:  map 35% reduce 8%
16/12/09 18:48:01 INFO mapreduce.Job:  map 36% reduce 8%
16/12/09 18:48:02 INFO mapreduce.Job:  map 37% reduce 8%
16/12/09 18:48:04 INFO mapreduce.Job:  map 39% reduce 8%
16/12/09 18:48:05 INFO mapreduce.Job:  map 40% reduce 8%
16/12/09 18:48:06 INFO mapreduce.Job:  map 41% reduce 8%
16/12/09 18:48:08 INFO mapreduce.Job:  map 42% reduce 8%
16/12/09 18:48:09 INFO mapreduce.Job:  map 44% reduce 8%
16/12/09 18:48:11 INFO mapreduce.Job:  map 45% reduce 8%
16/12/09 18:48:13 INFO mapreduce.Job:  map 46% reduce 8%
16/12/09 18:48:16 INFO mapreduce.Job:  map 47% reduce 8%
16/12/09 18:48:17 INFO mapreduce.Job:  map 48% reduce 9%
16/12/09 18:48:18 INFO mapreduce.Job:  map 49% reduce 9%
16/12/09 18:48:19 INFO mapreduce.Job:  map 50% reduce 9%
16/12/09 18:48:21 INFO mapreduce.Job:  map 50% reduce 10%
16/12/09 18:48:22 INFO mapreduce.Job:  map 52% reduce 10%
16/12/09 18:48:23 INFO mapreduce.Job:  map 53% reduce 10%
16/12/09 18:48:24 INFO mapreduce.Job:  map 54% reduce 11%
16/12/09 18:48:25 INFO mapreduce.Job:  map 55% reduce 12%
16/12/09 18:48:26 INFO mapreduce.Job:  map 58% reduce 12%
16/12/09 18:48:27 INFO mapreduce.Job:  map 60% reduce 13%
16/12/09 18:48:29 INFO mapreduce.Job:  map 60% reduce 14%
16/12/09 18:48:31 INFO mapreduce.Job:  map 61% reduce 14%
16/12/09 18:48:35 INFO mapreduce.Job:  map 61% reduce 15%
16/12/09 18:48:44 INFO mapreduce.Job:  map 62% reduce 15%
16/12/09 18:48:49 INFO mapreduce.Job: Task Id : attempt_1480588584072_6304_m_000145_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 18:48:49 INFO mapreduce.Job: Task Id : attempt_1480588584072_6304_m_000151_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 18:48:50 INFO mapreduce.Job:  map 61% reduce 15%
16/12/09 18:48:51 INFO mapreduce.Job:  map 62% reduce 16%
16/12/09 18:48:53 INFO mapreduce.Job:  map 63% reduce 16%
16/12/09 18:48:55 INFO mapreduce.Job:  map 64% reduce 16%
16/12/09 18:48:57 INFO mapreduce.Job:  map 65% reduce 16%
16/12/09 18:48:58 INFO mapreduce.Job:  map 66% reduce 17%
16/12/09 18:48:59 INFO mapreduce.Job:  map 67% reduce 17%
16/12/09 18:49:00 INFO mapreduce.Job:  map 68% reduce 17%
16/12/09 18:49:01 INFO mapreduce.Job:  map 68% reduce 18%
16/12/09 18:49:03 INFO mapreduce.Job:  map 70% reduce 18%
16/12/09 18:49:04 INFO mapreduce.Job:  map 71% reduce 18%
16/12/09 18:49:05 INFO mapreduce.Job:  map 73% reduce 19%
16/12/09 18:49:06 INFO mapreduce.Job:  map 74% reduce 19%
16/12/09 18:49:07 INFO mapreduce.Job:  map 76% reduce 19%
16/12/09 18:49:08 INFO mapreduce.Job:  map 77% reduce 20%
16/12/09 18:49:09 INFO mapreduce.Job:  map 78% reduce 22%
16/12/09 18:49:10 INFO mapreduce.Job:  map 78% reduce 24%
16/12/09 18:49:11 INFO mapreduce.Job:  map 78% reduce 25%
16/12/09 18:49:29 INFO mapreduce.Job:  map 79% reduce 25%
16/12/09 18:49:31 INFO mapreduce.Job: Task Id : attempt_1480588584072_6304_m_000028_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 18:49:31 INFO mapreduce.Job: Task Id : attempt_1480588584072_6304_m_000026_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 18:49:31 INFO mapreduce.Job: Task Id : attempt_1480588584072_6304_m_000004_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 18:49:31 INFO mapreduce.Job: Task Id : attempt_1480588584072_6304_m_000016_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 18:49:31 INFO mapreduce.Job: Task Id : attempt_1480588584072_6304_m_000038_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 18:49:31 INFO mapreduce.Job: Task Id : attempt_1480588584072_6304_m_000040_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 18:49:32 INFO mapreduce.Job:  map 79% reduce 26%
16/12/09 18:49:32 INFO mapreduce.Job: Task Id : attempt_1480588584072_6304_m_000003_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 18:49:35 INFO mapreduce.Job:  map 80% reduce 26%
16/12/09 18:49:38 INFO mapreduce.Job:  map 81% reduce 26%
16/12/09 18:49:41 INFO mapreduce.Job:  map 84% reduce 26%
16/12/09 18:49:42 INFO mapreduce.Job:  map 86% reduce 26%
16/12/09 18:49:43 INFO mapreduce.Job:  map 87% reduce 27%
16/12/09 18:49:44 INFO mapreduce.Job:  map 88% reduce 27%
16/12/09 18:49:45 INFO mapreduce.Job:  map 89% reduce 27%
16/12/09 18:49:46 INFO mapreduce.Job:  map 89% reduce 28%
16/12/09 18:49:47 INFO mapreduce.Job:  map 90% reduce 28%
16/12/09 18:49:49 INFO mapreduce.Job:  map 91% reduce 28%
16/12/09 18:49:50 INFO mapreduce.Job:  map 92% reduce 29%
16/12/09 18:49:52 INFO mapreduce.Job:  map 93% reduce 29%
16/12/09 18:49:53 INFO mapreduce.Job:  map 94% reduce 29%
16/12/09 18:49:54 INFO mapreduce.Job:  map 95% reduce 29%
16/12/09 18:49:57 INFO mapreduce.Job:  map 96% reduce 29%
16/12/09 18:49:59 INFO mapreduce.Job:  map 96% reduce 30%
16/12/09 18:50:00 INFO mapreduce.Job:  map 97% reduce 30%
16/12/09 18:50:01 INFO mapreduce.Job:  map 98% reduce 30%
16/12/09 18:50:02 INFO mapreduce.Job:  map 99% reduce 31%
16/12/09 18:50:03 INFO mapreduce.Job:  map 99% reduce 32%
16/12/09 18:50:04 INFO mapreduce.Job:  map 99% reduce 33%
16/12/09 18:50:06 INFO mapreduce.Job:  map 100% reduce 34%
16/12/09 18:50:07 INFO mapreduce.Job:  map 100% reduce 37%
16/12/09 18:50:08 INFO mapreduce.Job:  map 100% reduce 45%
16/12/09 18:50:10 INFO mapreduce.Job:  map 100% reduce 54%
16/12/09 18:50:11 INFO mapreduce.Job:  map 100% reduce 70%
16/12/09 18:50:12 INFO mapreduce.Job:  map 100% reduce 74%
16/12/09 18:50:13 INFO mapreduce.Job:  map 100% reduce 79%
16/12/09 18:50:14 INFO mapreduce.Job:  map 100% reduce 86%
16/12/09 18:50:15 INFO mapreduce.Job:  map 100% reduce 90%
16/12/09 18:50:16 INFO mapreduce.Job:  map 100% reduce 96%
16/12/09 18:50:17 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 18:50:19 INFO mapreduce.Job: Job job_1480588584072_6304 completed successfully
16/12/09 18:50:19 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=857257212
		FILE: Number of bytes written=1746896389
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=733980755
		WASB: Number of bytes written=455965090
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=14
		Launched map tasks=211
		Launched reduce tasks=20
		Other local map tasks=14
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=74664842
		Total time spent by all reduces in occupied slots (ms)=6187360
		Total time spent by all map tasks (ms)=37332421
		Total time spent by all reduce tasks (ms)=3093680
		Total vcore-seconds taken by all map tasks=37332421
		Total vcore-seconds taken by all reduce tasks=3093680
		Total megabyte-seconds taken by all map tasks=38228399104
		Total megabyte-seconds taken by all reduce tasks=3167928320
	Map-Reduce Framework
		Map input records=2387644
		Map output records=2094596
		Map output bytes=849228984
		Map output materialized bytes=857280732
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1836801
		Reduce shuffle bytes=857280732
		Reduce input records=2094596
		Reduce output records=1358173
		Spilled Records=4189192
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=443948
		CPU time spent (ms)=1433210
		Physical memory (bytes) snapshot=309972922368
		Virtual memory (bytes) snapshot=742182834176
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=731284751
	File Output Format Counters 
		Bytes Written=455965090
16/12/09 18:50:19 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1400 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1400': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7554422881128131457.jar tmpDir=null
16/12/09 19:51:29 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 19:51:30 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 19:51:30 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 19:51:32 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 19:51:32 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 19:51:32 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6314
16/12/09 19:51:33 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6314
16/12/09 19:51:33 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6314/
16/12/09 19:51:33 INFO mapreduce.Job: Running job: job_1480588584072_6314
16/12/09 19:51:45 INFO mapreduce.Job: Job job_1480588584072_6314 running in uber mode : false
16/12/09 19:51:45 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 19:52:19 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 19:52:54 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 19:52:59 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 19:53:00 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 19:53:34 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 19:53:37 INFO mapreduce.Job:  map 7% reduce 0%
16/12/09 19:53:38 INFO mapreduce.Job:  map 9% reduce 0%
16/12/09 19:53:39 INFO mapreduce.Job:  map 11% reduce 0%
16/12/09 19:53:44 INFO mapreduce.Job:  map 12% reduce 0%
16/12/09 19:53:51 INFO mapreduce.Job:  map 14% reduce 0%
16/12/09 19:53:51 INFO mapreduce.Job: Task Id : attempt_1480588584072_6314_m_000048_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 19:53:52 INFO mapreduce.Job: Task Id : attempt_1480588584072_6314_m_000093_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 19:53:52 INFO mapreduce.Job: Task Id : attempt_1480588584072_6314_m_000051_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 19:53:53 INFO mapreduce.Job:  map 22% reduce 0%
16/12/09 19:54:22 INFO mapreduce.Job:  map 25% reduce 0%
16/12/09 19:54:23 INFO mapreduce.Job:  map 59% reduce 0%
16/12/09 19:54:24 INFO mapreduce.Job:  map 61% reduce 0%
16/12/09 19:54:25 INFO mapreduce.Job:  map 64% reduce 0%
16/12/09 19:54:26 INFO mapreduce.Job:  map 66% reduce 0%
16/12/09 19:54:27 INFO mapreduce.Job:  map 68% reduce 0%
16/12/09 19:54:28 INFO mapreduce.Job:  map 69% reduce 0%
16/12/09 19:54:29 INFO mapreduce.Job:  map 71% reduce 0%
16/12/09 19:54:30 INFO mapreduce.Job:  map 74% reduce 0%
16/12/09 19:54:31 INFO mapreduce.Job:  map 76% reduce 0%
16/12/09 19:54:32 INFO mapreduce.Job:  map 77% reduce 0%
16/12/09 19:54:33 INFO mapreduce.Job:  map 79% reduce 0%
16/12/09 19:54:33 INFO mapreduce.Job: Task Id : attempt_1480588584072_6314_m_000049_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 19:54:33 INFO mapreduce.Job: Task Id : attempt_1480588584072_6314_m_000072_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 19:54:34 INFO mapreduce.Job:  map 82% reduce 0%
16/12/09 19:54:35 INFO mapreduce.Job:  map 84% reduce 1%
16/12/09 19:54:36 INFO mapreduce.Job:  map 87% reduce 3%
16/12/09 19:54:37 INFO mapreduce.Job:  map 89% reduce 4%
16/12/09 19:54:38 INFO mapreduce.Job:  map 92% reduce 7%
16/12/09 19:54:39 INFO mapreduce.Job:  map 93% reduce 11%
16/12/09 19:54:40 INFO mapreduce.Job:  map 94% reduce 16%
16/12/09 19:54:41 INFO mapreduce.Job:  map 94% reduce 18%
16/12/09 19:54:43 INFO mapreduce.Job:  map 95% reduce 18%
16/12/09 19:54:44 INFO mapreduce.Job:  map 96% reduce 18%
16/12/09 19:54:47 INFO mapreduce.Job:  map 97% reduce 23%
16/12/09 19:54:48 INFO mapreduce.Job:  map 98% reduce 23%
16/12/09 19:54:50 INFO mapreduce.Job:  map 99% reduce 23%
16/12/09 19:54:51 INFO mapreduce.Job:  map 99% reduce 24%
16/12/09 19:54:53 INFO mapreduce.Job:  map 99% reduce 25%
16/12/09 19:54:55 INFO mapreduce.Job:  map 100% reduce 25%
16/12/09 19:54:56 INFO mapreduce.Job:  map 100% reduce 26%
16/12/09 19:54:57 INFO mapreduce.Job:  map 100% reduce 30%
16/12/09 19:54:58 INFO mapreduce.Job:  map 100% reduce 46%
16/12/09 19:54:59 INFO mapreduce.Job:  map 100% reduce 59%
16/12/09 19:55:00 INFO mapreduce.Job:  map 100% reduce 66%
16/12/09 19:55:01 INFO mapreduce.Job:  map 100% reduce 75%
16/12/09 19:55:02 INFO mapreduce.Job:  map 100% reduce 81%
16/12/09 19:55:03 INFO mapreduce.Job:  map 100% reduce 85%
16/12/09 19:55:04 INFO mapreduce.Job:  map 100% reduce 96%
16/12/09 19:55:05 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 19:55:07 INFO mapreduce.Job:  map 100% reduce 99%
16/12/09 19:55:10 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 19:55:13 INFO mapreduce.Job: Job job_1480588584072_6314 completed successfully
16/12/09 19:55:14 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=924547014
		FILE: Number of bytes written=1881475993
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=789354848
		WASB: Number of bytes written=510105243
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=5
		Launched map tasks=202
		Launched reduce tasks=20
		Other local map tasks=5
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=59558830
		Total time spent by all reduces in occupied slots (ms)=1508398
		Total time spent by all map tasks (ms)=29779415
		Total time spent by all reduce tasks (ms)=754199
		Total vcore-seconds taken by all map tasks=29779415
		Total vcore-seconds taken by all reduce tasks=754199
		Total megabyte-seconds taken by all map tasks=30494120960
		Total megabyte-seconds taken by all reduce tasks=772299776
	Map-Reduce Framework
		Map input records=2544206
		Map output records=2248173
		Map output bytes=915918223
		Map output materialized bytes=924570534
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1977815
		Reduce shuffle bytes=924570534
		Reduce input records=2248173
		Reduce output records=1511461
		Spilled Records=4496346
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=183042
		CPU time spent (ms)=1116770
		Physical memory (bytes) snapshot=319248969728
		Virtual memory (bytes) snapshot=742064050176
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=786658844
	File Output Format Counters 
		Bytes Written=510105243
16/12/09 19:55:14 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1400
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1500 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1500': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2448206273689710296.jar tmpDir=null
16/12/09 20:46:17 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 20:46:18 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 20:46:18 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 20:46:20 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 20:46:20 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 20:46:20 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6318
16/12/09 20:46:21 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6318
16/12/09 20:46:21 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6318/
16/12/09 20:46:21 INFO mapreduce.Job: Running job: job_1480588584072_6318
16/12/09 20:46:34 INFO mapreduce.Job: Job job_1480588584072_6318 running in uber mode : false
16/12/09 20:46:34 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 20:47:10 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 20:47:54 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 20:47:58 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 20:48:34 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 20:48:44 INFO mapreduce.Job:  map 8% reduce 0%
16/12/09 20:48:45 INFO mapreduce.Job:  map 19% reduce 0%
16/12/09 20:48:46 INFO mapreduce.Job:  map 28% reduce 0%
16/12/09 20:48:47 INFO mapreduce.Job:  map 29% reduce 0%
16/12/09 20:49:12 INFO mapreduce.Job:  map 33% reduce 0%
16/12/09 20:49:14 INFO mapreduce.Job:  map 43% reduce 0%
16/12/09 20:49:16 INFO mapreduce.Job:  map 47% reduce 0%
16/12/09 20:49:17 INFO mapreduce.Job:  map 51% reduce 0%
16/12/09 20:49:18 INFO mapreduce.Job:  map 54% reduce 0%
16/12/09 20:49:20 INFO mapreduce.Job:  map 56% reduce 0%
16/12/09 20:49:21 INFO mapreduce.Job:  map 63% reduce 0%
16/12/09 20:49:22 INFO mapreduce.Job:  map 66% reduce 0%
16/12/09 20:49:23 INFO mapreduce.Job:  map 73% reduce 0%
16/12/09 20:49:24 INFO mapreduce.Job: Task Id : attempt_1480588584072_6318_m_000023_0, Status : FAILED
Error: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 137
	at org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:322)
	at org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:535)
	at org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)
	at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)
	at org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)
	at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:453)
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)
	at org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:168)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1709)
	at org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:162)

16/12/09 20:49:26 INFO mapreduce.Job:  map 76% reduce 0%
16/12/09 20:49:27 INFO mapreduce.Job:  map 81% reduce 0%
16/12/09 20:49:27 INFO mapreduce.Job: Task Id : attempt_1480588584072_6318_m_000013_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 20:49:27 INFO mapreduce.Job: Task Id : attempt_1480588584072_6318_m_000028_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 20:49:27 INFO mapreduce.Job: Task Id : attempt_1480588584072_6318_m_000026_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 20:49:27 INFO mapreduce.Job: Task Id : attempt_1480588584072_6318_m_000025_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 20:49:29 INFO mapreduce.Job:  map 83% reduce 0%
16/12/09 20:49:30 INFO mapreduce.Job:  map 84% reduce 1%
16/12/09 20:49:31 INFO mapreduce.Job:  map 85% reduce 12%
16/12/09 20:49:32 INFO mapreduce.Job:  map 87% reduce 13%
16/12/09 20:49:33 INFO mapreduce.Job:  map 87% reduce 14%
16/12/09 20:49:34 INFO mapreduce.Job:  map 88% reduce 15%
16/12/09 20:49:35 INFO mapreduce.Job:  map 90% reduce 16%
16/12/09 20:49:36 INFO mapreduce.Job:  map 90% reduce 22%
16/12/09 20:49:37 INFO mapreduce.Job:  map 92% reduce 23%
16/12/09 20:49:38 INFO mapreduce.Job:  map 94% reduce 23%
16/12/09 20:49:39 INFO mapreduce.Job:  map 94% reduce 24%
16/12/09 20:49:40 INFO mapreduce.Job:  map 97% reduce 25%
16/12/09 20:49:41 INFO mapreduce.Job:  map 98% reduce 25%
16/12/09 20:49:42 INFO mapreduce.Job:  map 100% reduce 25%
16/12/09 20:49:43 INFO mapreduce.Job:  map 100% reduce 30%
16/12/09 20:49:44 INFO mapreduce.Job:  map 100% reduce 32%
16/12/09 20:49:45 INFO mapreduce.Job:  map 100% reduce 35%
16/12/09 20:49:46 INFO mapreduce.Job:  map 100% reduce 57%
16/12/09 20:49:47 INFO mapreduce.Job:  map 100% reduce 59%
16/12/09 20:49:48 INFO mapreduce.Job:  map 100% reduce 61%
16/12/09 20:49:49 INFO mapreduce.Job:  map 100% reduce 73%
16/12/09 20:49:50 INFO mapreduce.Job:  map 100% reduce 80%
16/12/09 20:49:51 INFO mapreduce.Job:  map 100% reduce 95%
16/12/09 20:49:52 INFO mapreduce.Job:  map 100% reduce 97%
16/12/09 20:49:54 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 20:49:57 INFO mapreduce.Job: Job job_1480588584072_6318 completed successfully
16/12/09 20:49:57 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=825891149
		FILE: Number of bytes written=1684164263
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=712631282
		WASB: Number of bytes written=426321456
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=5
		Launched map tasks=202
		Launched reduce tasks=20
		Other local map tasks=5
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=58180588
		Total time spent by all reduces in occupied slots (ms)=1254224
		Total time spent by all map tasks (ms)=29090294
		Total time spent by all reduce tasks (ms)=627112
		Total vcore-seconds taken by all map tasks=29090294
		Total vcore-seconds taken by all reduce tasks=627112
		Total megabyte-seconds taken by all map tasks=29788461056
		Total megabyte-seconds taken by all reduce tasks=642162688
	Map-Reduce Framework
		Map input records=2317033
		Map output records=2015771
		Map output bytes=818148128
		Map output materialized bytes=825914669
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1756691
		Reduce shuffle bytes=825914669
		Reduce input records=2015771
		Reduce output records=1266018
		Spilled Records=4031542
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=205843
		CPU time spent (ms)=1104260
		Physical memory (bytes) snapshot=314294251520
		Virtual memory (bytes) snapshot=742144933888
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=709935278
	File Output Format Counters 
		Bytes Written=426321456
16/12/09 20:49:57 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1500
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1600 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1600': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3935947604424072022.jar tmpDir=null
16/12/09 21:51:08 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 21:51:09 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 21:51:09 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 21:51:10 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 21:51:11 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 21:51:11 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6322
16/12/09 21:51:12 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6322
16/12/09 21:51:12 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6322/
16/12/09 21:51:12 INFO mapreduce.Job: Running job: job_1480588584072_6322
16/12/09 21:51:25 INFO mapreduce.Job: Job job_1480588584072_6322 running in uber mode : false
16/12/09 21:51:25 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 21:53:03 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 21:53:11 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 21:53:14 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 21:53:16 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 21:53:18 INFO mapreduce.Job:  map 5% reduce 0%
16/12/09 21:53:19 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 21:53:21 INFO mapreduce.Job:  map 8% reduce 0%
16/12/09 21:53:22 INFO mapreduce.Job:  map 11% reduce 0%
16/12/09 21:53:23 INFO mapreduce.Job:  map 12% reduce 0%
16/12/09 21:53:24 INFO mapreduce.Job:  map 14% reduce 0%
16/12/09 21:53:25 INFO mapreduce.Job:  map 16% reduce 0%
16/12/09 21:53:26 INFO mapreduce.Job:  map 18% reduce 0%
16/12/09 21:53:27 INFO mapreduce.Job:  map 20% reduce 0%
16/12/09 21:53:28 INFO mapreduce.Job:  map 23% reduce 0%
16/12/09 21:53:29 INFO mapreduce.Job:  map 26% reduce 0%
16/12/09 21:53:30 INFO mapreduce.Job:  map 27% reduce 0%
16/12/09 21:53:31 INFO mapreduce.Job:  map 29% reduce 0%
16/12/09 21:53:32 INFO mapreduce.Job:  map 33% reduce 0%
16/12/09 21:53:33 INFO mapreduce.Job:  map 36% reduce 0%
16/12/09 21:53:34 INFO mapreduce.Job:  map 39% reduce 0%
16/12/09 21:53:35 INFO mapreduce.Job:  map 40% reduce 0%
16/12/09 21:53:36 INFO mapreduce.Job:  map 43% reduce 1%
16/12/09 21:53:37 INFO mapreduce.Job:  map 47% reduce 1%
16/12/09 21:53:38 INFO mapreduce.Job:  map 49% reduce 2%
16/12/09 21:53:39 INFO mapreduce.Job:  map 51% reduce 2%
16/12/09 21:53:40 INFO mapreduce.Job:  map 52% reduce 5%
16/12/09 21:53:41 INFO mapreduce.Job:  map 54% reduce 5%
16/12/09 21:53:42 INFO mapreduce.Job:  map 56% reduce 5%
16/12/09 21:53:43 INFO mapreduce.Job:  map 58% reduce 5%
16/12/09 21:53:45 INFO mapreduce.Job:  map 59% reduce 6%
16/12/09 21:53:46 INFO mapreduce.Job:  map 61% reduce 7%
16/12/09 21:53:47 INFO mapreduce.Job:  map 63% reduce 10%
16/12/09 21:53:48 INFO mapreduce.Job:  map 63% reduce 11%
16/12/09 21:53:49 INFO mapreduce.Job:  map 64% reduce 11%
16/12/09 21:53:52 INFO mapreduce.Job:  map 64% reduce 12%
16/12/09 21:53:54 INFO mapreduce.Job:  map 65% reduce 12%
16/12/09 21:53:55 INFO mapreduce.Job:  map 65% reduce 15%
16/12/09 21:53:56 INFO mapreduce.Job:  map 65% reduce 16%
16/12/09 21:54:10 INFO mapreduce.Job:  map 65% reduce 17%
16/12/09 21:54:15 INFO mapreduce.Job:  map 66% reduce 17%
16/12/09 21:54:19 INFO mapreduce.Job:  map 67% reduce 18%
16/12/09 21:54:21 INFO mapreduce.Job:  map 68% reduce 18%
16/12/09 21:54:21 INFO mapreduce.Job: Task Id : attempt_1480588584072_6322_m_000075_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 21:54:23 INFO mapreduce.Job:  map 68% reduce 19%
16/12/09 21:54:24 INFO mapreduce.Job:  map 69% reduce 19%
16/12/09 21:54:26 INFO mapreduce.Job:  map 69% reduce 20%
16/12/09 21:54:27 INFO mapreduce.Job:  map 70% reduce 20%
16/12/09 21:54:28 INFO mapreduce.Job:  map 73% reduce 20%
16/12/09 21:54:29 INFO mapreduce.Job:  map 74% reduce 20%
16/12/09 21:54:30 INFO mapreduce.Job:  map 76% reduce 20%
16/12/09 21:54:31 INFO mapreduce.Job:  map 78% reduce 21%
16/12/09 21:54:32 INFO mapreduce.Job:  map 79% reduce 22%
16/12/09 21:54:33 INFO mapreduce.Job:  map 79% reduce 23%
16/12/09 21:54:34 INFO mapreduce.Job:  map 79% reduce 25%
16/12/09 21:55:05 INFO mapreduce.Job:  map 80% reduce 25%
16/12/09 21:55:11 INFO mapreduce.Job:  map 81% reduce 25%
16/12/09 21:55:13 INFO mapreduce.Job:  map 82% reduce 25%
16/12/09 21:55:14 INFO mapreduce.Job:  map 82% reduce 26%
16/12/09 21:55:15 INFO mapreduce.Job: Task Id : attempt_1480588584072_6322_m_000031_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 21:55:16 INFO mapreduce.Job: Task Id : attempt_1480588584072_6322_m_000018_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 21:55:18 INFO mapreduce.Job: Task Id : attempt_1480588584072_6322_m_000000_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 21:55:18 INFO mapreduce.Job: Task Id : attempt_1480588584072_6322_m_000021_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 21:55:18 INFO mapreduce.Job: Task Id : attempt_1480588584072_6322_m_000025_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 21:55:18 INFO mapreduce.Job: Task Id : attempt_1480588584072_6322_m_000006_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 21:55:18 INFO mapreduce.Job: Task Id : attempt_1480588584072_6322_m_000028_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 21:55:19 INFO mapreduce.Job:  map 81% reduce 26%
16/12/09 21:55:20 INFO mapreduce.Job:  map 82% reduce 26%
16/12/09 21:55:22 INFO mapreduce.Job:  map 83% reduce 26%
16/12/09 21:55:24 INFO mapreduce.Job:  map 84% reduce 26%
16/12/09 21:55:25 INFO mapreduce.Job:  map 86% reduce 27%
16/12/09 21:55:26 INFO mapreduce.Job:  map 88% reduce 27%
16/12/09 21:55:27 INFO mapreduce.Job:  map 89% reduce 27%
16/12/09 21:55:28 INFO mapreduce.Job:  map 91% reduce 27%
16/12/09 21:55:29 INFO mapreduce.Job:  map 92% reduce 28%
16/12/09 21:55:30 INFO mapreduce.Job:  map 94% reduce 28%
16/12/09 21:55:31 INFO mapreduce.Job:  map 94% reduce 29%
16/12/09 21:55:32 INFO mapreduce.Job:  map 95% reduce 30%
16/12/09 21:55:33 INFO mapreduce.Job:  map 96% reduce 30%
16/12/09 21:55:34 INFO mapreduce.Job:  map 97% reduce 30%
16/12/09 21:55:36 INFO mapreduce.Job:  map 98% reduce 31%
16/12/09 21:55:37 INFO mapreduce.Job:  map 99% reduce 31%
16/12/09 21:55:38 INFO mapreduce.Job:  map 100% reduce 32%
16/12/09 21:55:40 INFO mapreduce.Job:  map 100% reduce 41%
16/12/09 21:55:41 INFO mapreduce.Job:  map 100% reduce 53%
16/12/09 21:55:42 INFO mapreduce.Job:  map 100% reduce 63%
16/12/09 21:55:43 INFO mapreduce.Job:  map 100% reduce 72%
16/12/09 21:55:44 INFO mapreduce.Job:  map 100% reduce 78%
16/12/09 21:55:45 INFO mapreduce.Job:  map 100% reduce 82%
16/12/09 21:55:46 INFO mapreduce.Job:  map 100% reduce 90%
16/12/09 21:55:47 INFO mapreduce.Job:  map 100% reduce 95%
16/12/09 21:55:48 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 21:55:49 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 21:55:52 INFO mapreduce.Job: Job job_1480588584072_6322 completed successfully
16/12/09 21:55:52 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=883559113
		FILE: Number of bytes written=1799500191
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=761536628
		WASB: Number of bytes written=461432832
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=8
		Launched map tasks=205
		Launched reduce tasks=20
		Other local map tasks=8
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=65306098
		Total time spent by all reduces in occupied slots (ms)=5676264
		Total time spent by all map tasks (ms)=32653049
		Total time spent by all reduce tasks (ms)=2838132
		Total vcore-seconds taken by all map tasks=32653049
		Total vcore-seconds taken by all reduce tasks=2838132
		Total megabyte-seconds taken by all map tasks=33436722176
		Total megabyte-seconds taken by all reduce tasks=2906247168
	Map-Reduce Framework
		Map input records=2467976
		Map output records=2152831
		Map output bytes=875286329
		Map output materialized bytes=883582633
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1884487
		Reduce shuffle bytes=883582633
		Reduce input records=2152831
		Reduce output records=1366765
		Spilled Records=4305662
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=477415
		CPU time spent (ms)=1438280
		Physical memory (bytes) snapshot=314950426624
		Virtual memory (bytes) snapshot=743009050624
		Total committed heap usage (bytes)=574524751872
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=758840624
	File Output Format Counters 
		Bytes Written=461432832
16/12/09 21:55:52 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1600
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1700 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612090900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1700': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8844175035587367104.jar tmpDir=null
16/12/09 22:46:56 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 22:46:56 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 22:46:57 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 22:46:59 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 22:46:59 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 22:46:59 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6351
16/12/09 22:47:00 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6351
16/12/09 22:47:00 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6351/
16/12/09 22:47:00 INFO mapreduce.Job: Running job: job_1480588584072_6351
16/12/09 22:47:13 INFO mapreduce.Job: Job job_1480588584072_6351 running in uber mode : false
16/12/09 22:47:13 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 22:47:48 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 22:48:29 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 22:48:32 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 22:48:33 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 22:48:37 INFO mapreduce.Job:  map 5% reduce 0%
16/12/09 22:49:01 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 22:49:05 INFO mapreduce.Job:  map 7% reduce 0%
16/12/09 22:49:08 INFO mapreduce.Job:  map 8% reduce 0%
16/12/09 22:49:13 INFO mapreduce.Job:  map 9% reduce 0%
16/12/09 22:49:18 INFO mapreduce.Job:  map 14% reduce 0%
16/12/09 22:49:20 INFO mapreduce.Job:  map 19% reduce 0%
16/12/09 22:49:22 INFO mapreduce.Job:  map 23% reduce 0%
16/12/09 22:49:23 INFO mapreduce.Job:  map 33% reduce 0%
16/12/09 22:49:25 INFO mapreduce.Job:  map 39% reduce 0%
16/12/09 22:49:26 INFO mapreduce.Job:  map 47% reduce 0%
16/12/09 22:49:28 INFO mapreduce.Job:  map 48% reduce 0%
16/12/09 22:49:44 INFO mapreduce.Job:  map 53% reduce 0%
16/12/09 22:49:46 INFO mapreduce.Job:  map 65% reduce 0%
16/12/09 22:49:47 INFO mapreduce.Job:  map 70% reduce 0%
16/12/09 22:49:48 INFO mapreduce.Job:  map 91% reduce 0%
16/12/09 22:49:52 INFO mapreduce.Job:  map 94% reduce 0%
16/12/09 22:49:54 INFO mapreduce.Job: Task Id : attempt_1480588584072_6351_m_000015_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 22:49:55 INFO mapreduce.Job: Task Id : attempt_1480588584072_6351_m_000031_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 22:49:56 INFO mapreduce.Job:  map 95% reduce 0%
16/12/09 22:49:57 INFO mapreduce.Job:  map 96% reduce 0%
16/12/09 22:49:59 INFO mapreduce.Job:  map 96% reduce 3%
16/12/09 22:50:00 INFO mapreduce.Job:  map 97% reduce 3%
16/12/09 22:50:01 INFO mapreduce.Job:  map 97% reduce 4%
16/12/09 22:50:04 INFO mapreduce.Job:  map 98% reduce 6%
16/12/09 22:50:06 INFO mapreduce.Job:  map 98% reduce 13%
16/12/09 22:50:07 INFO mapreduce.Job:  map 98% reduce 16%
16/12/09 22:50:07 INFO mapreduce.Job: Task Id : attempt_1480588584072_6351_m_000018_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 22:50:08 INFO mapreduce.Job:  map 98% reduce 20%
16/12/09 22:50:09 INFO mapreduce.Job:  map 98% reduce 23%
16/12/09 22:50:10 INFO mapreduce.Job:  map 99% reduce 26%
16/12/09 22:50:11 INFO mapreduce.Job:  map 100% reduce 26%
16/12/09 22:50:12 INFO mapreduce.Job:  map 100% reduce 27%
16/12/09 22:50:13 INFO mapreduce.Job:  map 100% reduce 43%
16/12/09 22:50:14 INFO mapreduce.Job:  map 100% reduce 49%
16/12/09 22:50:15 INFO mapreduce.Job:  map 100% reduce 53%
16/12/09 22:50:16 INFO mapreduce.Job:  map 100% reduce 63%
16/12/09 22:50:17 INFO mapreduce.Job:  map 100% reduce 67%
16/12/09 22:50:18 INFO mapreduce.Job:  map 100% reduce 70%
16/12/09 22:50:19 INFO mapreduce.Job:  map 100% reduce 77%
16/12/09 22:50:20 INFO mapreduce.Job:  map 100% reduce 79%
16/12/09 22:50:21 INFO mapreduce.Job:  map 100% reduce 81%
16/12/09 22:50:22 INFO mapreduce.Job:  map 100% reduce 87%
16/12/09 22:50:23 INFO mapreduce.Job:  map 100% reduce 88%
16/12/09 22:50:24 INFO mapreduce.Job:  map 100% reduce 89%
16/12/09 22:50:26 INFO mapreduce.Job:  map 100% reduce 92%
16/12/09 22:50:27 INFO mapreduce.Job:  map 100% reduce 93%
16/12/09 22:50:28 INFO mapreduce.Job:  map 100% reduce 94%
16/12/09 22:50:29 INFO mapreduce.Job:  map 100% reduce 96%
16/12/09 22:50:30 INFO mapreduce.Job:  map 100% reduce 97%
16/12/09 22:50:31 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 22:50:32 INFO mapreduce.Job:  map 100% reduce 99%
16/12/09 22:50:35 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 22:50:39 INFO mapreduce.Job: Job job_1480588584072_6351 completed successfully
16/12/09 22:50:39 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=1027500065
		FILE: Number of bytes written=2087382095
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=877500621
		WASB: Number of bytes written=562544084
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=3
		Launched map tasks=200
		Launched reduce tasks=20
		Other local map tasks=3
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=56206048
		Total time spent by all reduces in occupied slots (ms)=1358584
		Total time spent by all map tasks (ms)=28103024
		Total time spent by all reduce tasks (ms)=679292
		Total vcore-seconds taken by all map tasks=28103024
		Total vcore-seconds taken by all reduce tasks=679292
		Total megabyte-seconds taken by all map tasks=28777496576
		Total megabyte-seconds taken by all reduce tasks=695595008
	Map-Reduce Framework
		Map input records=2824565
		Map output records=2498997
		Map output bytes=1017896928
		Map output materialized bytes=1027523585
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2199676
		Reduce shuffle bytes=1027523585
		Reduce input records=2498997
		Reduce output records=1667839
		Spilled Records=4997994
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=368776
		CPU time spent (ms)=1243700
		Physical memory (bytes) snapshot=316012269568
		Virtual memory (bytes) snapshot=741548322816
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=874804617
	File Output Format Counters 
		Bytes Written=562544084
16/12/09 22:50:39 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1700
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091400 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1800 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091400
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1800': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7693723708341073947.jar tmpDir=null
16/12/09 23:46:47 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 23:46:48 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/09 23:46:48 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/09 23:46:50 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/09 23:46:50 INFO mapreduce.JobSubmitter: number of splits:197
16/12/09 23:46:50 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6397
16/12/09 23:46:51 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6397
16/12/09 23:46:51 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6397/
16/12/09 23:46:51 INFO mapreduce.Job: Running job: job_1480588584072_6397
16/12/09 23:47:05 INFO mapreduce.Job: Job job_1480588584072_6397 running in uber mode : false
16/12/09 23:47:05 INFO mapreduce.Job:  map 0% reduce 0%
16/12/09 23:47:24 INFO mapreduce.Job:  map 1% reduce 0%
16/12/09 23:48:17 INFO mapreduce.Job:  map 2% reduce 0%
16/12/09 23:48:22 INFO mapreduce.Job:  map 3% reduce 0%
16/12/09 23:48:25 INFO mapreduce.Job:  map 4% reduce 0%
16/12/09 23:48:57 INFO mapreduce.Job:  map 5% reduce 0%
16/12/09 23:49:01 INFO mapreduce.Job:  map 6% reduce 0%
16/12/09 23:49:02 INFO mapreduce.Job:  map 7% reduce 0%
16/12/09 23:49:04 INFO mapreduce.Job:  map 8% reduce 0%
16/12/09 23:49:07 INFO mapreduce.Job:  map 9% reduce 0%
16/12/09 23:49:09 INFO mapreduce.Job:  map 10% reduce 0%
16/12/09 23:49:10 INFO mapreduce.Job:  map 12% reduce 0%
16/12/09 23:49:11 INFO mapreduce.Job:  map 13% reduce 0%
16/12/09 23:49:13 INFO mapreduce.Job:  map 14% reduce 0%
16/12/09 23:49:15 INFO mapreduce.Job:  map 15% reduce 0%
16/12/09 23:49:16 INFO mapreduce.Job:  map 18% reduce 0%
16/12/09 23:49:17 INFO mapreduce.Job:  map 24% reduce 0%
16/12/09 23:49:19 INFO mapreduce.Job:  map 27% reduce 0%
16/12/09 23:49:20 INFO mapreduce.Job:  map 29% reduce 0%
16/12/09 23:49:20 INFO mapreduce.Job: Task Id : attempt_1480588584072_6397_m_000184_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 23:49:23 INFO mapreduce.Job: Task Id : attempt_1480588584072_6397_m_000193_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 23:49:23 INFO mapreduce.Job: Task Id : attempt_1480588584072_6397_m_000173_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 23:49:23 INFO mapreduce.Job: Task Id : attempt_1480588584072_6397_m_000169_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/09 23:49:24 INFO mapreduce.Job:  map 37% reduce 0%
16/12/09 23:49:26 INFO mapreduce.Job:  map 46% reduce 0%
16/12/09 23:49:28 INFO mapreduce.Job:  map 54% reduce 0%
16/12/09 23:49:29 INFO mapreduce.Job:  map 63% reduce 0%
16/12/09 23:49:30 INFO mapreduce.Job:  map 67% reduce 0%
16/12/09 23:49:31 INFO mapreduce.Job:  map 69% reduce 0%
16/12/09 23:49:33 INFO mapreduce.Job:  map 70% reduce 0%
16/12/09 23:49:34 INFO mapreduce.Job:  map 71% reduce 0%
16/12/09 23:49:37 INFO mapreduce.Job:  map 72% reduce 0%
16/12/09 23:49:38 INFO mapreduce.Job:  map 73% reduce 0%
16/12/09 23:49:39 INFO mapreduce.Job:  map 75% reduce 1%
16/12/09 23:49:40 INFO mapreduce.Job:  map 76% reduce 2%
16/12/09 23:49:41 INFO mapreduce.Job:  map 79% reduce 2%
16/12/09 23:49:42 INFO mapreduce.Job:  map 81% reduce 2%
16/12/09 23:49:43 INFO mapreduce.Job:  map 83% reduce 2%
16/12/09 23:49:44 INFO mapreduce.Job:  map 86% reduce 5%
16/12/09 23:49:45 INFO mapreduce.Job:  map 87% reduce 5%
16/12/09 23:49:46 INFO mapreduce.Job:  map 88% reduce 5%
16/12/09 23:49:47 INFO mapreduce.Job:  map 91% reduce 5%
16/12/09 23:49:48 INFO mapreduce.Job:  map 92% reduce 6%
16/12/09 23:49:49 INFO mapreduce.Job:  map 93% reduce 6%
16/12/09 23:49:50 INFO mapreduce.Job:  map 94% reduce 6%
16/12/09 23:49:51 INFO mapreduce.Job:  map 95% reduce 6%
16/12/09 23:49:52 INFO mapreduce.Job:  map 95% reduce 9%
16/12/09 23:49:53 INFO mapreduce.Job:  map 97% reduce 15%
16/12/09 23:49:54 INFO mapreduce.Job:  map 98% reduce 19%
16/12/09 23:49:55 INFO mapreduce.Job:  map 99% reduce 20%
16/12/09 23:49:56 INFO mapreduce.Job:  map 99% reduce 23%
16/12/09 23:49:57 INFO mapreduce.Job:  map 99% reduce 26%
16/12/09 23:49:58 INFO mapreduce.Job:  map 99% reduce 30%
16/12/09 23:49:59 INFO mapreduce.Job:  map 99% reduce 31%
16/12/09 23:50:00 INFO mapreduce.Job:  map 99% reduce 33%
16/12/09 23:50:19 INFO mapreduce.Job:  map 100% reduce 33%
16/12/09 23:50:20 INFO mapreduce.Job:  map 100% reduce 34%
16/12/09 23:50:21 INFO mapreduce.Job:  map 100% reduce 43%
16/12/09 23:50:22 INFO mapreduce.Job:  map 100% reduce 51%
16/12/09 23:50:23 INFO mapreduce.Job:  map 100% reduce 57%
16/12/09 23:50:24 INFO mapreduce.Job:  map 100% reduce 68%
16/12/09 23:50:25 INFO mapreduce.Job:  map 100% reduce 74%
16/12/09 23:50:26 INFO mapreduce.Job:  map 100% reduce 76%
16/12/09 23:50:27 INFO mapreduce.Job:  map 100% reduce 83%
16/12/09 23:50:28 INFO mapreduce.Job:  map 100% reduce 89%
16/12/09 23:50:29 INFO mapreduce.Job:  map 100% reduce 91%
16/12/09 23:50:30 INFO mapreduce.Job:  map 100% reduce 94%
16/12/09 23:50:31 INFO mapreduce.Job:  map 100% reduce 97%
16/12/09 23:50:32 INFO mapreduce.Job:  map 100% reduce 98%
16/12/09 23:50:33 INFO mapreduce.Job:  map 100% reduce 99%
16/12/09 23:50:34 INFO mapreduce.Job:  map 100% reduce 100%
16/12/09 23:50:38 INFO mapreduce.Job: Job job_1480588584072_6397 completed successfully
16/12/09 23:50:38 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=966285770
		FILE: Number of bytes written=1964953505
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=828662000
		WASB: Number of bytes written=500126161
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=4
		Launched map tasks=201
		Launched reduce tasks=20
		Other local map tasks=4
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=56277228
		Total time spent by all reduces in occupied slots (ms)=2403088
		Total time spent by all map tasks (ms)=28138614
		Total time spent by all reduce tasks (ms)=1201544
		Total vcore-seconds taken by all map tasks=28138614
		Total vcore-seconds taken by all reduce tasks=1201544
		Total megabyte-seconds taken by all map tasks=28813940736
		Total megabyte-seconds taken by all reduce tasks=1230381056
	Map-Reduce Framework
		Map input records=2687317
		Map output records=2357489
		Map output bytes=957218332
		Map output materialized bytes=966309290
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2057109
		Reduce shuffle bytes=966309290
		Reduce input records=2357489
		Reduce output records=1486158
		Spilled Records=4714978
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=165520
		CPU time spent (ms)=1125600
		Physical memory (bytes) snapshot=319006486528
		Virtual memory (bytes) snapshot=742413180928
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=825965996
	File Output Format Counters 
		Bytes Written=500126161
16/12/09 23:50:38 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1800
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091500 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1900 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091500
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1900': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7702934082005872952.jar tmpDir=null
16/12/10 00:46:45 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 00:46:46 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 00:46:46 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 00:46:47 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 00:46:48 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 00:46:48 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6401
16/12/10 00:46:49 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6401
16/12/10 00:46:49 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6401/
16/12/10 00:46:49 INFO mapreduce.Job: Running job: job_1480588584072_6401
16/12/10 00:47:02 INFO mapreduce.Job: Job job_1480588584072_6401 running in uber mode : false
16/12/10 00:47:02 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 00:47:14 INFO mapreduce.Job:  map 1% reduce 0%
16/12/10 00:48:40 INFO mapreduce.Job:  map 2% reduce 0%
16/12/10 00:48:48 INFO mapreduce.Job:  map 3% reduce 0%
16/12/10 00:48:53 INFO mapreduce.Job:  map 4% reduce 0%
16/12/10 00:48:54 INFO mapreduce.Job:  map 8% reduce 0%
16/12/10 00:48:56 INFO mapreduce.Job:  map 9% reduce 0%
16/12/10 00:48:57 INFO mapreduce.Job:  map 10% reduce 0%
16/12/10 00:48:58 INFO mapreduce.Job:  map 12% reduce 0%
16/12/10 00:48:59 INFO mapreduce.Job:  map 13% reduce 0%
16/12/10 00:49:01 INFO mapreduce.Job:  map 15% reduce 0%
16/12/10 00:49:02 INFO mapreduce.Job:  map 17% reduce 0%
16/12/10 00:49:03 INFO mapreduce.Job:  map 19% reduce 0%
16/12/10 00:49:04 INFO mapreduce.Job:  map 21% reduce 0%
16/12/10 00:49:05 INFO mapreduce.Job:  map 22% reduce 0%
16/12/10 00:49:06 INFO mapreduce.Job:  map 23% reduce 0%
16/12/10 00:49:07 INFO mapreduce.Job:  map 24% reduce 0%
16/12/10 00:49:08 INFO mapreduce.Job:  map 27% reduce 0%
16/12/10 00:49:09 INFO mapreduce.Job:  map 29% reduce 0%
16/12/10 00:49:10 INFO mapreduce.Job:  map 31% reduce 1%
16/12/10 00:49:11 INFO mapreduce.Job:  map 32% reduce 1%
16/12/10 00:49:12 INFO mapreduce.Job:  map 35% reduce 2%
16/12/10 00:49:13 INFO mapreduce.Job:  map 36% reduce 3%
16/12/10 00:49:14 INFO mapreduce.Job:  map 38% reduce 3%
16/12/10 00:49:15 INFO mapreduce.Job:  map 43% reduce 3%
16/12/10 00:49:16 INFO mapreduce.Job:  map 46% reduce 3%
16/12/10 00:49:17 INFO mapreduce.Job:  map 51% reduce 4%
16/12/10 00:49:18 INFO mapreduce.Job:  map 53% reduce 4%
16/12/10 00:49:19 INFO mapreduce.Job:  map 56% reduce 5%
16/12/10 00:49:20 INFO mapreduce.Job:  map 60% reduce 5%
16/12/10 00:49:21 INFO mapreduce.Job:  map 63% reduce 6%
16/12/10 00:49:22 INFO mapreduce.Job:  map 67% reduce 6%
16/12/10 00:49:23 INFO mapreduce.Job:  map 72% reduce 7%
16/12/10 00:49:24 INFO mapreduce.Job:  map 76% reduce 7%
16/12/10 00:49:25 INFO mapreduce.Job:  map 78% reduce 8%
16/12/10 00:49:26 INFO mapreduce.Job:  map 80% reduce 9%
16/12/10 00:49:28 INFO mapreduce.Job:  map 80% reduce 10%
16/12/10 00:49:32 INFO mapreduce.Job:  map 81% reduce 17%
16/12/10 00:49:32 INFO mapreduce.Job: Task Id : attempt_1480588584072_6401_m_000005_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 00:49:33 INFO mapreduce.Job:  map 81% reduce 22%
16/12/10 00:49:34 INFO mapreduce.Job:  map 81% reduce 25%
16/12/10 00:49:38 INFO mapreduce.Job:  map 82% reduce 25%
16/12/10 00:49:41 INFO mapreduce.Job:  map 83% reduce 25%
16/12/10 00:49:42 INFO mapreduce.Job:  map 83% reduce 26%
16/12/10 00:49:43 INFO mapreduce.Job:  map 84% reduce 26%
16/12/10 00:49:46 INFO mapreduce.Job:  map 85% reduce 26%
16/12/10 00:49:50 INFO mapreduce.Job:  map 85% reduce 27%
16/12/10 00:49:51 INFO mapreduce.Job:  map 86% reduce 27%
16/12/10 00:49:52 INFO mapreduce.Job:  map 87% reduce 27%
16/12/10 00:49:53 INFO mapreduce.Job:  map 88% reduce 27%
16/12/10 00:49:56 INFO mapreduce.Job:  map 89% reduce 27%
16/12/10 00:49:59 INFO mapreduce.Job:  map 90% reduce 27%
16/12/10 00:50:02 INFO mapreduce.Job:  map 90% reduce 28%
16/12/10 00:50:03 INFO mapreduce.Job:  map 91% reduce 28%
16/12/10 00:50:05 INFO mapreduce.Job:  map 92% reduce 28%
16/12/10 00:50:07 INFO mapreduce.Job:  map 93% reduce 29%
16/12/10 00:50:08 INFO mapreduce.Job:  map 94% reduce 29%
16/12/10 00:50:09 INFO mapreduce.Job:  map 95% reduce 29%
16/12/10 00:50:10 INFO mapreduce.Job:  map 95% reduce 30%
16/12/10 00:50:11 INFO mapreduce.Job:  map 96% reduce 30%
16/12/10 00:50:14 INFO mapreduce.Job:  map 97% reduce 31%
16/12/10 00:50:16 INFO mapreduce.Job:  map 98% reduce 31%
16/12/10 00:50:17 INFO mapreduce.Job:  map 99% reduce 31%
16/12/10 00:50:18 INFO mapreduce.Job:  map 100% reduce 31%
16/12/10 00:50:19 INFO mapreduce.Job:  map 100% reduce 32%
16/12/10 00:50:20 INFO mapreduce.Job:  map 100% reduce 36%
16/12/10 00:50:21 INFO mapreduce.Job:  map 100% reduce 47%
16/12/10 00:50:22 INFO mapreduce.Job:  map 100% reduce 57%
16/12/10 00:50:23 INFO mapreduce.Job:  map 100% reduce 67%
16/12/10 00:50:24 INFO mapreduce.Job:  map 100% reduce 71%
16/12/10 00:50:25 INFO mapreduce.Job:  map 100% reduce 74%
16/12/10 00:50:26 INFO mapreduce.Job:  map 100% reduce 79%
16/12/10 00:50:27 INFO mapreduce.Job:  map 100% reduce 84%
16/12/10 00:50:28 INFO mapreduce.Job:  map 100% reduce 87%
16/12/10 00:50:29 INFO mapreduce.Job:  map 100% reduce 92%
16/12/10 00:50:30 INFO mapreduce.Job:  map 100% reduce 95%
16/12/10 00:50:32 INFO mapreduce.Job:  map 100% reduce 98%
16/12/10 00:50:33 INFO mapreduce.Job:  map 100% reduce 99%
16/12/10 00:50:36 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 00:50:40 INFO mapreduce.Job: Job job_1480588584072_6401 completed successfully
16/12/10 00:50:40 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=1124425976
		FILE: Number of bytes written=2281233917
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=948368112
		WASB: Number of bytes written=632448032
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=1
		Launched map tasks=198
		Launched reduce tasks=20
		Other local map tasks=1
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=55741660
		Total time spent by all reduces in occupied slots (ms)=3553666
		Total time spent by all map tasks (ms)=27870830
		Total time spent by all reduce tasks (ms)=1776833
		Total vcore-seconds taken by all map tasks=27870830
		Total vcore-seconds taken by all reduce tasks=1776833
		Total megabyte-seconds taken by all map tasks=28539729920
		Total megabyte-seconds taken by all reduce tasks=1819476992
	Map-Reduce Framework
		Map input records=3037495
		Map output records=2731403
		Map output bytes=1113927405
		Map output materialized bytes=1124449496
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2413445
		Reduce shuffle bytes=1124449496
		Reduce input records=2731403
		Reduce output records=1876454
		Spilled Records=5462806
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=373931
		CPU time spent (ms)=1355780
		Physical memory (bytes) snapshot=321971777536
		Virtual memory (bytes) snapshot=742590308352
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=945672108
	File Output Format Counters 
		Bytes Written=632448032
16/12/10 00:50:40 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/1900
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091600 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/2000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091600
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/2000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1701960725360934304.jar tmpDir=null
16/12/10 01:41:42 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 01:41:43 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 01:41:43 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 01:41:45 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 01:41:45 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 01:41:46 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6405
16/12/10 01:41:47 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6405
16/12/10 01:41:47 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6405/
16/12/10 01:41:47 INFO mapreduce.Job: Running job: job_1480588584072_6405
16/12/10 01:42:00 INFO mapreduce.Job: Job job_1480588584072_6405 running in uber mode : false
16/12/10 01:42:00 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 01:42:28 INFO mapreduce.Job:  map 1% reduce 0%
16/12/10 01:43:03 INFO mapreduce.Job:  map 2% reduce 0%
16/12/10 01:43:13 INFO mapreduce.Job:  map 3% reduce 0%
16/12/10 01:43:21 INFO mapreduce.Job:  map 7% reduce 0%
16/12/10 01:43:30 INFO mapreduce.Job:  map 8% reduce 0%
16/12/10 01:43:38 INFO mapreduce.Job:  map 9% reduce 0%
16/12/10 01:43:58 INFO mapreduce.Job:  map 10% reduce 0%
16/12/10 01:44:00 INFO mapreduce.Job:  map 11% reduce 0%
16/12/10 01:44:03 INFO mapreduce.Job:  map 15% reduce 0%
16/12/10 01:44:04 INFO mapreduce.Job:  map 16% reduce 0%
16/12/10 01:44:05 INFO mapreduce.Job:  map 21% reduce 0%
16/12/10 01:44:06 INFO mapreduce.Job:  map 23% reduce 0%
16/12/10 01:44:07 INFO mapreduce.Job:  map 24% reduce 0%
16/12/10 01:44:23 INFO mapreduce.Job:  map 31% reduce 0%
16/12/10 01:44:26 INFO mapreduce.Job:  map 32% reduce 0%
16/12/10 01:44:26 INFO mapreduce.Job: Task Id : attempt_1480588584072_6405_m_000089_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 01:44:27 INFO mapreduce.Job:  map 31% reduce 0%
16/12/10 01:44:27 INFO mapreduce.Job: Task Id : attempt_1480588584072_6405_m_000078_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 01:44:27 INFO mapreduce.Job: Task Id : attempt_1480588584072_6405_m_000067_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 01:44:28 INFO mapreduce.Job:  map 32% reduce 0%
16/12/10 01:44:29 INFO mapreduce.Job:  map 38% reduce 0%
16/12/10 01:44:30 INFO mapreduce.Job:  map 39% reduce 0%
16/12/10 01:44:32 INFO mapreduce.Job:  map 40% reduce 0%
16/12/10 01:44:34 INFO mapreduce.Job:  map 41% reduce 1%
16/12/10 01:44:35 INFO mapreduce.Job:  map 42% reduce 3%
16/12/10 01:44:36 INFO mapreduce.Job:  map 43% reduce 3%
16/12/10 01:44:37 INFO mapreduce.Job:  map 44% reduce 3%
16/12/10 01:44:38 INFO mapreduce.Job:  map 46% reduce 3%
16/12/10 01:44:39 INFO mapreduce.Job:  map 48% reduce 3%
16/12/10 01:44:40 INFO mapreduce.Job:  map 50% reduce 5%
16/12/10 01:44:41 INFO mapreduce.Job:  map 52% reduce 7%
16/12/10 01:44:42 INFO mapreduce.Job:  map 53% reduce 7%
16/12/10 01:44:43 INFO mapreduce.Job:  map 55% reduce 7%
16/12/10 01:44:44 INFO mapreduce.Job:  map 57% reduce 7%
16/12/10 01:44:45 INFO mapreduce.Job:  map 58% reduce 7%
16/12/10 01:44:46 INFO mapreduce.Job:  map 59% reduce 7%
16/12/10 01:44:47 INFO mapreduce.Job:  map 62% reduce 7%
16/12/10 01:44:48 INFO mapreduce.Job:  map 66% reduce 7%
16/12/10 01:44:49 INFO mapreduce.Job:  map 68% reduce 8%
16/12/10 01:44:50 INFO mapreduce.Job:  map 71% reduce 8%
16/12/10 01:44:51 INFO mapreduce.Job:  map 73% reduce 8%
16/12/10 01:44:52 INFO mapreduce.Job:  map 75% reduce 9%
16/12/10 01:44:53 INFO mapreduce.Job:  map 76% reduce 9%
16/12/10 01:44:54 INFO mapreduce.Job:  map 78% reduce 9%
16/12/10 01:44:55 INFO mapreduce.Job:  map 79% reduce 11%
16/12/10 01:44:56 INFO mapreduce.Job:  map 81% reduce 11%
16/12/10 01:44:57 INFO mapreduce.Job:  map 82% reduce 12%
16/12/10 01:44:58 INFO mapreduce.Job:  map 83% reduce 13%
16/12/10 01:44:59 INFO mapreduce.Job:  map 84% reduce 13%
16/12/10 01:45:00 INFO mapreduce.Job:  map 84% reduce 15%
16/12/10 01:45:01 INFO mapreduce.Job:  map 84% reduce 17%
16/12/10 01:45:02 INFO mapreduce.Job:  map 84% reduce 19%
16/12/10 01:45:05 INFO mapreduce.Job:  map 84% reduce 22%
16/12/10 01:45:06 INFO mapreduce.Job:  map 84% reduce 25%
16/12/10 01:45:45 INFO mapreduce.Job:  map 85% reduce 26%
16/12/10 01:45:45 INFO mapreduce.Job: Task Id : attempt_1480588584072_6405_m_000096_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 01:45:45 INFO mapreduce.Job: Task Id : attempt_1480588584072_6405_m_000106_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 01:45:46 INFO mapreduce.Job:  map 84% reduce 28%
16/12/10 01:45:49 INFO mapreduce.Job:  map 85% reduce 28%
16/12/10 01:45:50 INFO mapreduce.Job:  map 88% reduce 28%
16/12/10 01:45:50 INFO mapreduce.Job: Task Id : attempt_1480588584072_6405_m_000101_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 01:45:50 INFO mapreduce.Job: Task Id : attempt_1480588584072_6405_m_000142_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 01:45:50 INFO mapreduce.Job: Task Id : attempt_1480588584072_6405_m_000129_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 01:45:50 INFO mapreduce.Job: Task Id : attempt_1480588584072_6405_m_000107_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 01:45:50 INFO mapreduce.Job: Task Id : attempt_1480588584072_6405_m_000098_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 01:45:50 INFO mapreduce.Job: Task Id : attempt_1480588584072_6405_m_000128_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 01:45:51 INFO mapreduce.Job:  map 91% reduce 28%
16/12/10 01:45:51 INFO mapreduce.Job: Task Id : attempt_1480588584072_6405_m_000131_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 01:45:52 INFO mapreduce.Job:  map 95% reduce 29%
16/12/10 01:45:53 INFO mapreduce.Job:  map 96% reduce 29%
16/12/10 01:45:54 INFO mapreduce.Job:  map 96% reduce 30%
16/12/10 01:45:55 INFO mapreduce.Job:  map 96% reduce 32%
16/12/10 01:45:59 INFO mapreduce.Job:  map 99% reduce 32%
16/12/10 01:46:00 INFO mapreduce.Job:  map 100% reduce 32%
16/12/10 01:46:01 INFO mapreduce.Job:  map 100% reduce 33%
16/12/10 01:46:02 INFO mapreduce.Job:  map 100% reduce 40%
16/12/10 01:46:03 INFO mapreduce.Job:  map 100% reduce 48%
16/12/10 01:46:04 INFO mapreduce.Job:  map 100% reduce 63%
16/12/10 01:46:05 INFO mapreduce.Job:  map 100% reduce 70%
16/12/10 01:46:06 INFO mapreduce.Job:  map 100% reduce 75%
16/12/10 01:46:07 INFO mapreduce.Job:  map 100% reduce 81%
16/12/10 01:46:08 INFO mapreduce.Job:  map 100% reduce 86%
16/12/10 01:46:09 INFO mapreduce.Job:  map 100% reduce 92%
16/12/10 01:46:10 INFO mapreduce.Job:  map 100% reduce 97%
16/12/10 01:46:12 INFO mapreduce.Job:  map 100% reduce 99%
16/12/10 01:46:15 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 01:46:17 INFO mapreduce.Job: Job job_1480588584072_6405 completed successfully
16/12/10 01:46:17 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=998065285
		FILE: Number of bytes written=2028512535
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=843146847
		WASB: Number of bytes written=551404892
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=12
		Launched map tasks=209
		Launched reduce tasks=20
		Other local map tasks=12
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=63851690
		Total time spent by all reduces in occupied slots (ms)=4267174
		Total time spent by all map tasks (ms)=31925845
		Total time spent by all reduce tasks (ms)=2133587
		Total vcore-seconds taken by all map tasks=31925845
		Total vcore-seconds taken by all reduce tasks=2133587
		Total megabyte-seconds taken by all map tasks=32692065280
		Total megabyte-seconds taken by all reduce tasks=2184793088
	Map-Reduce Framework
		Map input records=2700526
		Map output records=2422716
		Map output bytes=988735084
		Map output materialized bytes=998088805
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2128714
		Reduce shuffle bytes=998088805
		Reduce input records=2422716
		Reduce output records=1632095
		Spilled Records=4845432
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=251435
		CPU time spent (ms)=1245240
		Physical memory (bytes) snapshot=313252716544
		Virtual memory (bytes) snapshot=742603415552
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=840450843
	File Output Format Counters 
		Bytes Written=551404892
16/12/10 01:46:17 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/2000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091700 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/2100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091700
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/2100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5408558514800178965.jar tmpDir=null
16/12/10 02:42:23 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 02:42:24 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 02:42:24 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 02:42:26 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 02:42:26 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 02:42:27 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6409
16/12/10 02:42:27 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6409
16/12/10 02:42:27 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6409/
16/12/10 02:42:27 INFO mapreduce.Job: Running job: job_1480588584072_6409
16/12/10 02:42:40 INFO mapreduce.Job: Job job_1480588584072_6409 running in uber mode : false
16/12/10 02:42:40 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 02:43:02 INFO mapreduce.Job:  map 1% reduce 0%
16/12/10 02:43:52 INFO mapreduce.Job:  map 2% reduce 0%
16/12/10 02:43:54 INFO mapreduce.Job:  map 3% reduce 0%
16/12/10 02:43:56 INFO mapreduce.Job:  map 4% reduce 0%
16/12/10 02:44:31 INFO mapreduce.Job:  map 5% reduce 0%
16/12/10 02:44:32 INFO mapreduce.Job:  map 7% reduce 0%
16/12/10 02:44:33 INFO mapreduce.Job:  map 9% reduce 0%
16/12/10 02:44:34 INFO mapreduce.Job:  map 10% reduce 0%
16/12/10 02:44:36 INFO mapreduce.Job:  map 12% reduce 0%
16/12/10 02:44:37 INFO mapreduce.Job:  map 13% reduce 0%
16/12/10 02:44:51 INFO mapreduce.Job:  map 14% reduce 0%
16/12/10 02:44:52 INFO mapreduce.Job:  map 15% reduce 0%
16/12/10 02:44:55 INFO mapreduce.Job:  map 17% reduce 0%
16/12/10 02:44:56 INFO mapreduce.Job:  map 19% reduce 0%
16/12/10 02:44:57 INFO mapreduce.Job:  map 21% reduce 0%
16/12/10 02:44:59 INFO mapreduce.Job:  map 25% reduce 0%
16/12/10 02:45:02 INFO mapreduce.Job:  map 27% reduce 0%
16/12/10 02:45:03 INFO mapreduce.Job:  map 36% reduce 0%
16/12/10 02:45:04 INFO mapreduce.Job:  map 38% reduce 0%
16/12/10 02:45:04 INFO mapreduce.Job: Task Id : attempt_1480588584072_6409_m_000150_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 02:45:05 INFO mapreduce.Job:  map 39% reduce 0%
16/12/10 02:45:06 INFO mapreduce.Job:  map 41% reduce 0%
16/12/10 02:45:10 INFO mapreduce.Job:  map 42% reduce 0%
16/12/10 02:45:12 INFO mapreduce.Job:  map 42% reduce 1%
16/12/10 02:45:13 INFO mapreduce.Job:  map 43% reduce 2%
16/12/10 02:45:14 INFO mapreduce.Job:  map 43% reduce 3%
16/12/10 02:45:16 INFO mapreduce.Job:  map 44% reduce 3%
16/12/10 02:45:17 INFO mapreduce.Job:  map 45% reduce 5%
16/12/10 02:45:18 INFO mapreduce.Job:  map 45% reduce 6%
16/12/10 02:45:19 INFO mapreduce.Job:  map 47% reduce 6%
16/12/10 02:45:21 INFO mapreduce.Job:  map 48% reduce 6%
16/12/10 02:45:22 INFO mapreduce.Job:  map 49% reduce 6%
16/12/10 02:45:23 INFO mapreduce.Job:  map 50% reduce 6%
16/12/10 02:45:24 INFO mapreduce.Job:  map 53% reduce 6%
16/12/10 02:45:25 INFO mapreduce.Job:  map 54% reduce 6%
16/12/10 02:45:27 INFO mapreduce.Job:  map 56% reduce 6%
16/12/10 02:45:28 INFO mapreduce.Job:  map 57% reduce 7%
16/12/10 02:45:29 INFO mapreduce.Job:  map 58% reduce 7%
16/12/10 02:45:30 INFO mapreduce.Job:  map 60% reduce 7%
16/12/10 02:45:31 INFO mapreduce.Job:  map 61% reduce 7%
16/12/10 02:45:32 INFO mapreduce.Job:  map 65% reduce 7%
16/12/10 02:45:33 INFO mapreduce.Job:  map 66% reduce 7%
16/12/10 02:45:34 INFO mapreduce.Job:  map 72% reduce 7%
16/12/10 02:45:35 INFO mapreduce.Job:  map 74% reduce 8%
16/12/10 02:45:36 INFO mapreduce.Job:  map 78% reduce 8%
16/12/10 02:45:37 INFO mapreduce.Job:  map 80% reduce 10%
16/12/10 02:45:38 INFO mapreduce.Job:  map 82% reduce 11%
16/12/10 02:45:39 INFO mapreduce.Job:  map 84% reduce 11%
16/12/10 02:45:40 INFO mapreduce.Job:  map 84% reduce 12%
16/12/10 02:45:41 INFO mapreduce.Job:  map 84% reduce 14%
16/12/10 02:45:42 INFO mapreduce.Job:  map 84% reduce 19%
16/12/10 02:45:43 INFO mapreduce.Job:  map 85% reduce 19%
16/12/10 02:45:44 INFO mapreduce.Job:  map 85% reduce 22%
16/12/10 02:45:45 INFO mapreduce.Job:  map 85% reduce 23%
16/12/10 02:45:46 INFO mapreduce.Job:  map 86% reduce 24%
16/12/10 02:45:48 INFO mapreduce.Job:  map 87% reduce 25%
16/12/10 02:45:50 INFO mapreduce.Job:  map 88% reduce 25%
16/12/10 02:45:51 INFO mapreduce.Job:  map 89% reduce 25%
16/12/10 02:45:52 INFO mapreduce.Job:  map 90% reduce 25%
16/12/10 02:45:54 INFO mapreduce.Job:  map 91% reduce 25%
16/12/10 02:45:56 INFO mapreduce.Job:  map 92% reduce 25%
16/12/10 02:45:57 INFO mapreduce.Job:  map 93% reduce 25%
16/12/10 02:45:58 INFO mapreduce.Job:  map 94% reduce 28%
16/12/10 02:45:59 INFO mapreduce.Job:  map 94% reduce 29%
16/12/10 02:46:01 INFO mapreduce.Job:  map 95% reduce 29%
16/12/10 02:46:03 INFO mapreduce.Job:  map 96% reduce 30%
16/12/10 02:46:04 INFO mapreduce.Job:  map 97% reduce 30%
16/12/10 02:46:05 INFO mapreduce.Job:  map 98% reduce 30%
16/12/10 02:46:06 INFO mapreduce.Job:  map 99% reduce 31%
16/12/10 02:46:08 INFO mapreduce.Job:  map 100% reduce 32%
16/12/10 02:46:09 INFO mapreduce.Job:  map 100% reduce 34%
16/12/10 02:46:10 INFO mapreduce.Job:  map 100% reduce 38%
16/12/10 02:46:11 INFO mapreduce.Job:  map 100% reduce 46%
16/12/10 02:46:12 INFO mapreduce.Job:  map 100% reduce 60%
16/12/10 02:46:13 INFO mapreduce.Job:  map 100% reduce 72%
16/12/10 02:46:14 INFO mapreduce.Job:  map 100% reduce 76%
16/12/10 02:46:15 INFO mapreduce.Job:  map 100% reduce 82%
16/12/10 02:46:16 INFO mapreduce.Job:  map 100% reduce 89%
16/12/10 02:46:17 INFO mapreduce.Job:  map 100% reduce 94%
16/12/10 02:46:18 INFO mapreduce.Job:  map 100% reduce 97%
16/12/10 02:46:19 INFO mapreduce.Job:  map 100% reduce 99%
16/12/10 02:46:20 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 02:46:23 INFO mapreduce.Job: Job job_1480588584072_6409 completed successfully
16/12/10 02:46:23 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=929373995
		FILE: Number of bytes written=1891129955
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=776264887
		WASB: Number of bytes written=538445134
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=1
		Launched map tasks=198
		Launched reduce tasks=20
		Other local map tasks=1
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=61616176
		Total time spent by all reduces in occupied slots (ms)=2982356
		Total time spent by all map tasks (ms)=30808088
		Total time spent by all reduce tasks (ms)=1491178
		Total vcore-seconds taken by all map tasks=30808088
		Total vcore-seconds taken by all reduce tasks=1491178
		Total megabyte-seconds taken by all map tasks=31547482112
		Total megabyte-seconds taken by all reduce tasks=1526966272
	Map-Reduce Framework
		Map input records=2471998
		Map output records=2255709
		Map output bytes=920709701
		Map output materialized bytes=929397515
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1998051
		Reduce shuffle bytes=929397515
		Reduce input records=2255709
		Reduce output records=1599430
		Spilled Records=4511418
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=244615
		CPU time spent (ms)=1126300
		Physical memory (bytes) snapshot=319719464960
		Virtual memory (bytes) snapshot=742610157568
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=773568883
	File Output Format Counters 
		Bytes Written=538445134
16/12/10 02:46:23 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/2100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091800 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/2200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091800
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/2200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7979879004900176805.jar tmpDir=null
16/12/10 03:42:29 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 03:42:30 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 03:42:30 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 03:42:32 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 03:42:32 INFO mapreduce.JobSubmitter: number of splits:200
16/12/10 03:42:33 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6415
16/12/10 03:42:34 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6415
16/12/10 03:42:34 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6415/
16/12/10 03:42:34 INFO mapreduce.Job: Running job: job_1480588584072_6415
16/12/10 03:42:47 INFO mapreduce.Job: Job job_1480588584072_6415 running in uber mode : false
16/12/10 03:42:47 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 03:43:27 INFO mapreduce.Job:  map 3% reduce 0%
16/12/10 03:44:42 INFO mapreduce.Job:  map 4% reduce 0%
16/12/10 03:44:43 INFO mapreduce.Job:  map 5% reduce 0%
16/12/10 03:44:45 INFO mapreduce.Job:  map 6% reduce 0%
16/12/10 03:45:03 INFO mapreduce.Job:  map 7% reduce 0%
16/12/10 03:45:04 INFO mapreduce.Job:  map 12% reduce 0%
16/12/10 03:45:05 INFO mapreduce.Job:  map 17% reduce 0%
16/12/10 03:45:06 INFO mapreduce.Job:  map 20% reduce 0%
16/12/10 03:45:07 INFO mapreduce.Job:  map 22% reduce 0%
16/12/10 03:45:36 INFO mapreduce.Job: Task Id : attempt_1480588584072_6415_m_000011_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 03:45:36 INFO mapreduce.Job: Task Id : attempt_1480588584072_6415_m_000028_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 03:45:37 INFO mapreduce.Job:  map 30% reduce 0%
16/12/10 03:45:38 INFO mapreduce.Job:  map 31% reduce 0%
16/12/10 03:45:39 INFO mapreduce.Job:  map 36% reduce 0%
16/12/10 03:45:41 INFO mapreduce.Job:  map 46% reduce 0%
16/12/10 03:45:41 INFO mapreduce.Job: Task Id : attempt_1480588584072_6415_m_000023_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 03:45:41 INFO mapreduce.Job: Task Id : attempt_1480588584072_6415_m_000020_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 03:45:41 INFO mapreduce.Job: Task Id : attempt_1480588584072_6415_m_000004_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 03:45:42 INFO mapreduce.Job:  map 52% reduce 0%
16/12/10 03:45:43 INFO mapreduce.Job:  map 57% reduce 0%
16/12/10 03:45:44 INFO mapreduce.Job:  map 60% reduce 0%
16/12/10 03:45:45 INFO mapreduce.Job:  map 64% reduce 0%
16/12/10 03:45:46 INFO mapreduce.Job:  map 67% reduce 0%
16/12/10 03:45:47 INFO mapreduce.Job:  map 69% reduce 1%
16/12/10 03:45:48 INFO mapreduce.Job:  map 72% reduce 2%
16/12/10 03:45:49 INFO mapreduce.Job:  map 74% reduce 4%
16/12/10 03:45:50 INFO mapreduce.Job:  map 78% reduce 4%
16/12/10 03:45:51 INFO mapreduce.Job:  map 80% reduce 5%
16/12/10 03:45:52 INFO mapreduce.Job:  map 82% reduce 5%
16/12/10 03:45:53 INFO mapreduce.Job:  map 83% reduce 10%
16/12/10 03:45:54 INFO mapreduce.Job:  map 83% reduce 11%
16/12/10 03:45:55 INFO mapreduce.Job:  map 84% reduce 14%
16/12/10 03:45:57 INFO mapreduce.Job:  map 86% reduce 18%
16/12/10 03:45:58 INFO mapreduce.Job:  map 87% reduce 18%
16/12/10 03:45:59 INFO mapreduce.Job:  map 87% reduce 19%
16/12/10 03:46:00 INFO mapreduce.Job:  map 88% reduce 20%
16/12/10 03:46:01 INFO mapreduce.Job:  map 88% reduce 24%
16/12/10 03:46:02 INFO mapreduce.Job:  map 89% reduce 25%
16/12/10 03:46:03 INFO mapreduce.Job:  map 89% reduce 26%
16/12/10 03:46:04 INFO mapreduce.Job:  map 90% reduce 26%
16/12/10 03:46:05 INFO mapreduce.Job:  map 91% reduce 28%
16/12/10 03:46:06 INFO mapreduce.Job:  map 92% reduce 28%
16/12/10 03:46:07 INFO mapreduce.Job:  map 93% reduce 28%
16/12/10 03:46:08 INFO mapreduce.Job:  map 97% reduce 29%
16/12/10 03:46:09 INFO mapreduce.Job:  map 99% reduce 29%
16/12/10 03:46:10 INFO mapreduce.Job:  map 100% reduce 30%
16/12/10 03:46:11 INFO mapreduce.Job:  map 100% reduce 32%
16/12/10 03:46:12 INFO mapreduce.Job:  map 100% reduce 40%
16/12/10 03:46:13 INFO mapreduce.Job:  map 100% reduce 52%
16/12/10 03:46:14 INFO mapreduce.Job:  map 100% reduce 58%
16/12/10 03:46:15 INFO mapreduce.Job:  map 100% reduce 67%
16/12/10 03:46:16 INFO mapreduce.Job:  map 100% reduce 72%
16/12/10 03:46:17 INFO mapreduce.Job:  map 100% reduce 79%
16/12/10 03:46:18 INFO mapreduce.Job:  map 100% reduce 92%
16/12/10 03:46:19 INFO mapreduce.Job:  map 100% reduce 94%
16/12/10 03:46:20 INFO mapreduce.Job:  map 100% reduce 98%
16/12/10 03:46:21 INFO mapreduce.Job:  map 100% reduce 99%
16/12/10 03:46:23 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 03:46:26 INFO mapreduce.Job: Job job_1480588584072_6415 completed successfully
16/12/10 03:46:27 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=758027358
		FILE: Number of bytes written=1548884536
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=633061548
		WASB: Number of bytes written=447577268
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=5
		Launched map tasks=205
		Launched reduce tasks=20
		Other local map tasks=5
		Rack-local map tasks=200
		Total time spent by all maps in occupied slots (ms)=64094186
		Total time spent by all reduces in occupied slots (ms)=1673220
		Total time spent by all map tasks (ms)=32047093
		Total time spent by all reduce tasks (ms)=836610
		Total vcore-seconds taken by all map tasks=32047093
		Total vcore-seconds taken by all reduce tasks=836610
		Total megabyte-seconds taken by all map tasks=32816223232
		Total megabyte-seconds taken by all reduce tasks=856688640
	Map-Reduce Framework
		Map input records=2001684
		Map output records=1834272
		Map output bytes=750976552
		Map output materialized bytes=758051238
		Input split bytes=27785
		Combine input records=0
		Combine output records=0
		Reduce input groups=1627504
		Reduce shuffle bytes=758051238
		Reduce input records=1834272
		Reduce output records=1323973
		Spilled Records=3668544
		Shuffled Maps =4000
		Failed Shuffles=0
		Merged Map outputs=4000
		GC time elapsed (ms)=304505
		CPU time spent (ms)=1145050
		Physical memory (bytes) snapshot=317272977408
		Virtual memory (bytes) snapshot=752376315904
		Total committed heap usage (bytes)=582483968000
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=630281658
	File Output Format Counters 
		Bytes Written=447577268
16/12/10 03:46:27 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/2200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091900 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/2300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161209/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091900
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/2300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1222716764564758044.jar tmpDir=null
16/12/10 04:42:33 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 04:42:34 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 04:42:35 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 04:42:36 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 04:42:37 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 04:42:37 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6419
16/12/10 04:42:38 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6419
16/12/10 04:42:38 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6419/
16/12/10 04:42:38 INFO mapreduce.Job: Running job: job_1480588584072_6419
16/12/10 04:42:54 INFO mapreduce.Job: Job job_1480588584072_6419 running in uber mode : false
16/12/10 04:42:54 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 04:43:13 INFO mapreduce.Job:  map 1% reduce 0%
16/12/10 04:44:06 INFO mapreduce.Job:  map 3% reduce 0%
16/12/10 04:44:08 INFO mapreduce.Job:  map 4% reduce 0%
16/12/10 04:44:10 INFO mapreduce.Job:  map 5% reduce 0%
16/12/10 04:44:12 INFO mapreduce.Job:  map 6% reduce 0%
16/12/10 04:44:13 INFO mapreduce.Job:  map 9% reduce 0%
16/12/10 04:44:15 INFO mapreduce.Job:  map 12% reduce 0%
16/12/10 04:44:17 INFO mapreduce.Job:  map 14% reduce 0%
16/12/10 04:44:18 INFO mapreduce.Job:  map 17% reduce 0%
16/12/10 04:44:19 INFO mapreduce.Job:  map 19% reduce 0%
16/12/10 04:44:20 INFO mapreduce.Job:  map 20% reduce 0%
16/12/10 04:44:21 INFO mapreduce.Job:  map 23% reduce 0%
16/12/10 04:44:25 INFO mapreduce.Job:  map 24% reduce 0%
16/12/10 04:44:29 INFO mapreduce.Job:  map 24% reduce 2%
16/12/10 04:44:33 INFO mapreduce.Job:  map 25% reduce 2%
16/12/10 04:44:34 INFO mapreduce.Job:  map 25% reduce 3%
16/12/10 04:44:39 INFO mapreduce.Job:  map 26% reduce 3%
16/12/10 04:44:40 INFO mapreduce.Job:  map 27% reduce 3%
16/12/10 04:44:41 INFO mapreduce.Job:  map 28% reduce 5%
16/12/10 04:44:42 INFO mapreduce.Job:  map 28% reduce 7%
16/12/10 04:44:43 INFO mapreduce.Job:  map 29% reduce 9%
16/12/10 04:44:45 INFO mapreduce.Job:  map 30% reduce 9%
16/12/10 04:44:46 INFO mapreduce.Job:  map 31% reduce 9%
16/12/10 04:44:48 INFO mapreduce.Job:  map 32% reduce 9%
16/12/10 04:44:49 INFO mapreduce.Job:  map 34% reduce 10%
16/12/10 04:44:50 INFO mapreduce.Job:  map 36% reduce 10%
16/12/10 04:44:51 INFO mapreduce.Job:  map 37% reduce 10%
16/12/10 04:44:52 INFO mapreduce.Job:  map 39% reduce 11%
16/12/10 04:44:53 INFO mapreduce.Job:  map 41% reduce 11%
16/12/10 04:44:54 INFO mapreduce.Job:  map 44% reduce 11%
16/12/10 04:44:55 INFO mapreduce.Job:  map 47% reduce 11%
16/12/10 04:44:56 INFO mapreduce.Job:  map 50% reduce 12%
16/12/10 04:44:57 INFO mapreduce.Job:  map 53% reduce 13%
16/12/10 04:44:58 INFO mapreduce.Job:  map 57% reduce 14%
16/12/10 04:44:59 INFO mapreduce.Job:  map 60% reduce 16%
16/12/10 04:45:00 INFO mapreduce.Job:  map 63% reduce 17%
16/12/10 04:45:01 INFO mapreduce.Job:  map 68% reduce 18%
16/12/10 04:45:02 INFO mapreduce.Job:  map 71% reduce 19%
16/12/10 04:45:03 INFO mapreduce.Job:  map 74% reduce 20%
16/12/10 04:45:04 INFO mapreduce.Job:  map 77% reduce 22%
16/12/10 04:45:05 INFO mapreduce.Job:  map 79% reduce 23%
16/12/10 04:45:06 INFO mapreduce.Job:  map 82% reduce 24%
16/12/10 04:45:07 INFO mapreduce.Job:  map 82% reduce 25%
16/12/10 04:45:08 INFO mapreduce.Job:  map 82% reduce 26%
16/12/10 04:45:09 INFO mapreduce.Job:  map 83% reduce 26%
16/12/10 04:45:10 INFO mapreduce.Job:  map 85% reduce 26%
16/12/10 04:45:12 INFO mapreduce.Job:  map 86% reduce 27%
16/12/10 04:45:15 INFO mapreduce.Job:  map 89% reduce 27%
16/12/10 04:45:16 INFO mapreduce.Job:  map 90% reduce 27%
16/12/10 04:45:17 INFO mapreduce.Job:  map 90% reduce 28%
16/12/10 04:45:18 INFO mapreduce.Job:  map 91% reduce 28%
16/12/10 04:45:19 INFO mapreduce.Job:  map 92% reduce 29%
16/12/10 04:45:21 INFO mapreduce.Job:  map 93% reduce 29%
16/12/10 04:45:22 INFO mapreduce.Job:  map 94% reduce 30%
16/12/10 04:45:23 INFO mapreduce.Job:  map 95% reduce 30%
16/12/10 04:45:24 INFO mapreduce.Job:  map 96% reduce 30%
16/12/10 04:45:25 INFO mapreduce.Job:  map 97% reduce 31%
16/12/10 04:45:26 INFO mapreduce.Job:  map 99% reduce 31%
16/12/10 04:45:27 INFO mapreduce.Job:  map 99% reduce 32%
16/12/10 04:45:28 INFO mapreduce.Job:  map 100% reduce 33%
16/12/10 04:45:30 INFO mapreduce.Job:  map 100% reduce 34%
16/12/10 04:45:31 INFO mapreduce.Job:  map 100% reduce 41%
16/12/10 04:45:32 INFO mapreduce.Job:  map 100% reduce 51%
16/12/10 04:45:33 INFO mapreduce.Job:  map 100% reduce 54%
16/12/10 04:45:34 INFO mapreduce.Job:  map 100% reduce 64%
16/12/10 04:45:35 INFO mapreduce.Job:  map 100% reduce 72%
16/12/10 04:45:36 INFO mapreduce.Job:  map 100% reduce 77%
16/12/10 04:45:37 INFO mapreduce.Job:  map 100% reduce 80%
16/12/10 04:45:38 INFO mapreduce.Job:  map 100% reduce 82%
16/12/10 04:45:40 INFO mapreduce.Job:  map 100% reduce 84%
16/12/10 04:45:41 INFO mapreduce.Job:  map 100% reduce 87%
16/12/10 04:45:42 INFO mapreduce.Job:  map 100% reduce 89%
16/12/10 04:45:43 INFO mapreduce.Job:  map 100% reduce 92%
16/12/10 04:45:44 INFO mapreduce.Job:  map 100% reduce 95%
16/12/10 04:45:45 INFO mapreduce.Job:  map 100% reduce 96%
16/12/10 04:45:46 INFO mapreduce.Job:  map 100% reduce 98%
16/12/10 04:45:47 INFO mapreduce.Job:  map 100% reduce 99%
16/12/10 04:45:48 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 04:45:54 INFO mapreduce.Job: Job job_1480588584072_6419 completed successfully
16/12/10 04:45:54 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=491077574
		FILE: Number of bytes written=1014537113
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=410156586
		WASB: Number of bytes written=280355384
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=44356772
		Total time spent by all reduces in occupied slots (ms)=3366932
		Total time spent by all map tasks (ms)=22178386
		Total time spent by all reduce tasks (ms)=1683466
		Total vcore-seconds taken by all map tasks=22178386
		Total vcore-seconds taken by all reduce tasks=1683466
		Total megabyte-seconds taken by all map tasks=22710667264
		Total megabyte-seconds taken by all reduce tasks=1723869184
	Map-Reduce Framework
		Map input records=1298286
		Map output records=1188985
		Map output bytes=486503304
		Map output materialized bytes=491101094
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1052319
		Reduce shuffle bytes=491101094
		Reduce input records=1188985
		Reduce output records=827596
		Spilled Records=2377970
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=185626
		CPU time spent (ms)=859610
		Physical memory (bytes) snapshot=323378749440
		Virtual memory (bytes) snapshot=742797905920
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=407460582
	File Output Format Counters 
		Bytes Written=280355384
16/12/10 04:45:54 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161209/2300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161209/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob478431141563386677.jar tmpDir=null
16/12/10 05:42:04 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 05:42:05 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 05:42:05 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 05:42:09 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 05:42:09 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 05:42:10 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6425
16/12/10 05:42:11 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6425
16/12/10 05:42:11 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6425/
16/12/10 05:42:11 INFO mapreduce.Job: Running job: job_1480588584072_6425
16/12/10 05:42:25 INFO mapreduce.Job: Job job_1480588584072_6425 running in uber mode : false
16/12/10 05:42:25 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 05:42:50 INFO mapreduce.Job:  map 2% reduce 0%
16/12/10 05:43:23 INFO mapreduce.Job:  map 3% reduce 0%
16/12/10 05:43:30 INFO mapreduce.Job:  map 4% reduce 0%
16/12/10 05:43:32 INFO mapreduce.Job:  map 5% reduce 0%
16/12/10 05:43:36 INFO mapreduce.Job:  map 6% reduce 0%
16/12/10 05:43:38 INFO mapreduce.Job:  map 9% reduce 0%
16/12/10 05:43:39 INFO mapreduce.Job:  map 10% reduce 0%
16/12/10 05:43:41 INFO mapreduce.Job:  map 11% reduce 0%
16/12/10 05:43:42 INFO mapreduce.Job:  map 14% reduce 0%
16/12/10 05:43:43 INFO mapreduce.Job:  map 17% reduce 0%
16/12/10 05:43:44 INFO mapreduce.Job:  map 21% reduce 0%
16/12/10 05:43:45 INFO mapreduce.Job:  map 23% reduce 0%
16/12/10 05:43:46 INFO mapreduce.Job:  map 24% reduce 0%
16/12/10 05:43:47 INFO mapreduce.Job:  map 25% reduce 0%
16/12/10 05:43:49 INFO mapreduce.Job:  map 26% reduce 0%
16/12/10 05:43:53 INFO mapreduce.Job:  map 26% reduce 1%
16/12/10 05:43:54 INFO mapreduce.Job:  map 26% reduce 2%
16/12/10 05:43:55 INFO mapreduce.Job:  map 27% reduce 2%
16/12/10 05:43:57 INFO mapreduce.Job:  map 28% reduce 2%
16/12/10 05:43:58 INFO mapreduce.Job:  map 28% reduce 3%
16/12/10 05:43:59 INFO mapreduce.Job:  map 28% reduce 5%
16/12/10 05:44:00 INFO mapreduce.Job:  map 28% reduce 6%
16/12/10 05:44:01 INFO mapreduce.Job:  map 28% reduce 8%
16/12/10 05:44:02 INFO mapreduce.Job:  map 28% reduce 9%
16/12/10 05:44:08 INFO mapreduce.Job:  map 29% reduce 9%
16/12/10 05:44:09 INFO mapreduce.Job:  map 30% reduce 9%
16/12/10 05:44:10 INFO mapreduce.Job:  map 30% reduce 10%
16/12/10 05:44:11 INFO mapreduce.Job:  map 32% reduce 10%
16/12/10 05:44:16 INFO mapreduce.Job:  map 33% reduce 10%
16/12/10 05:44:18 INFO mapreduce.Job:  map 34% reduce 10%
16/12/10 05:44:19 INFO mapreduce.Job:  map 35% reduce 10%
16/12/10 05:44:20 INFO mapreduce.Job:  map 36% reduce 11%
16/12/10 05:44:21 INFO mapreduce.Job:  map 38% reduce 11%
16/12/10 05:44:22 INFO mapreduce.Job:  map 39% reduce 11%
16/12/10 05:44:23 INFO mapreduce.Job:  map 40% reduce 11%
16/12/10 05:44:24 INFO mapreduce.Job:  map 42% reduce 12%
16/12/10 05:44:25 INFO mapreduce.Job:  map 43% reduce 12%
16/12/10 05:44:26 INFO mapreduce.Job:  map 45% reduce 13%
16/12/10 05:44:27 INFO mapreduce.Job:  map 48% reduce 13%
16/12/10 05:44:28 INFO mapreduce.Job:  map 49% reduce 14%
16/12/10 05:44:29 INFO mapreduce.Job:  map 50% reduce 14%
16/12/10 05:44:30 INFO mapreduce.Job:  map 55% reduce 15%
16/12/10 05:44:31 INFO mapreduce.Job:  map 60% reduce 15%
16/12/10 05:44:32 INFO mapreduce.Job:  map 62% reduce 16%
16/12/10 05:44:33 INFO mapreduce.Job:  map 67% reduce 16%
16/12/10 05:44:34 INFO mapreduce.Job:  map 73% reduce 17%
16/12/10 05:44:35 INFO mapreduce.Job:  map 76% reduce 18%
16/12/10 05:44:36 INFO mapreduce.Job:  map 80% reduce 20%
16/12/10 05:44:37 INFO mapreduce.Job:  map 82% reduce 22%
16/12/10 05:44:38 INFO mapreduce.Job:  map 84% reduce 23%
16/12/10 05:44:39 INFO mapreduce.Job:  map 86% reduce 24%
16/12/10 05:44:40 INFO mapreduce.Job:  map 89% reduce 26%
16/12/10 05:44:41 INFO mapreduce.Job:  map 90% reduce 27%
16/12/10 05:44:42 INFO mapreduce.Job:  map 92% reduce 28%
16/12/10 05:44:43 INFO mapreduce.Job:  map 93% reduce 29%
16/12/10 05:44:44 INFO mapreduce.Job:  map 94% reduce 29%
16/12/10 05:44:45 INFO mapreduce.Job:  map 96% reduce 30%
16/12/10 05:44:47 INFO mapreduce.Job:  map 97% reduce 31%
16/12/10 05:44:48 INFO mapreduce.Job:  map 99% reduce 32%
16/12/10 05:44:49 INFO mapreduce.Job:  map 100% reduce 32%
16/12/10 05:44:50 INFO mapreduce.Job:  map 100% reduce 33%
16/12/10 05:44:51 INFO mapreduce.Job:  map 100% reduce 39%
16/12/10 05:44:52 INFO mapreduce.Job:  map 100% reduce 48%
16/12/10 05:44:53 INFO mapreduce.Job:  map 100% reduce 70%
16/12/10 05:44:54 INFO mapreduce.Job:  map 100% reduce 75%
16/12/10 05:44:55 INFO mapreduce.Job:  map 100% reduce 84%
16/12/10 05:44:56 INFO mapreduce.Job:  map 100% reduce 92%
16/12/10 05:44:57 INFO mapreduce.Job:  map 100% reduce 94%
16/12/10 05:44:58 INFO mapreduce.Job:  map 100% reduce 99%
16/12/10 05:44:59 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 05:45:04 INFO mapreduce.Job: Job job_1480588584072_6425 completed successfully
16/12/10 05:45:04 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=306655655
		FILE: Number of bytes written=645693275
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=256272864
		WASB: Number of bytes written=174206030
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=42948550
		Total time spent by all reduces in occupied slots (ms)=3014330
		Total time spent by all map tasks (ms)=21474275
		Total time spent by all reduce tasks (ms)=1507165
		Total vcore-seconds taken by all map tasks=21474275
		Total vcore-seconds taken by all reduce tasks=1507165
		Total megabyte-seconds taken by all map tasks=21989657600
		Total megabyte-seconds taken by all reduce tasks=1543336960
	Map-Reduce Framework
		Map input records=810089
		Map output records=744304
		Map output bytes=303797568
		Map output materialized bytes=306679175
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=658415
		Reduce shuffle bytes=306679175
		Reduce input records=744304
		Reduce output records=515339
		Spilled Records=1488608
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=158594
		CPU time spent (ms)=758550
		Physical memory (bytes) snapshot=321123913728
		Virtual memory (bytes) snapshot=742209400832
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=253576860
	File Output Format Counters 
		Bytes Written=174206030
16/12/10 05:45:04 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7320788749013204019.jar tmpDir=null
16/12/10 06:41:12 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 06:41:12 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 06:41:13 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 06:41:15 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 06:41:15 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 06:41:16 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6453
16/12/10 06:41:16 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6453
16/12/10 06:41:16 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6453/
16/12/10 06:41:16 INFO mapreduce.Job: Running job: job_1480588584072_6453
16/12/10 06:41:33 INFO mapreduce.Job: Job job_1480588584072_6453 running in uber mode : false
16/12/10 06:41:33 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 06:42:16 INFO mapreduce.Job:  map 1% reduce 0%
16/12/10 06:42:18 INFO mapreduce.Job:  map 2% reduce 0%
16/12/10 06:42:27 INFO mapreduce.Job:  map 3% reduce 0%
16/12/10 06:42:38 INFO mapreduce.Job:  map 4% reduce 0%
16/12/10 06:42:42 INFO mapreduce.Job:  map 5% reduce 0%
16/12/10 06:42:43 INFO mapreduce.Job:  map 7% reduce 0%
16/12/10 06:42:46 INFO mapreduce.Job:  map 8% reduce 0%
16/12/10 06:42:47 INFO mapreduce.Job:  map 9% reduce 0%
16/12/10 06:42:48 INFO mapreduce.Job:  map 10% reduce 0%
16/12/10 06:42:50 INFO mapreduce.Job:  map 11% reduce 0%
16/12/10 06:42:51 INFO mapreduce.Job:  map 12% reduce 0%
16/12/10 06:42:53 INFO mapreduce.Job:  map 13% reduce 0%
16/12/10 06:42:55 INFO mapreduce.Job:  map 15% reduce 0%
16/12/10 06:42:56 INFO mapreduce.Job:  map 17% reduce 0%
16/12/10 06:43:00 INFO mapreduce.Job:  map 21% reduce 0%
16/12/10 06:43:01 INFO mapreduce.Job:  map 22% reduce 0%
16/12/10 06:43:02 INFO mapreduce.Job:  map 24% reduce 0%
16/12/10 06:43:05 INFO mapreduce.Job:  map 24% reduce 1%
16/12/10 06:43:10 INFO mapreduce.Job:  map 25% reduce 1%
16/12/10 06:43:13 INFO mapreduce.Job:  map 26% reduce 2%
16/12/10 06:43:14 INFO mapreduce.Job:  map 27% reduce 2%
16/12/10 06:43:16 INFO mapreduce.Job:  map 29% reduce 2%
16/12/10 06:43:18 INFO mapreduce.Job:  map 30% reduce 2%
16/12/10 06:43:19 INFO mapreduce.Job:  map 32% reduce 2%
16/12/10 06:43:20 INFO mapreduce.Job:  map 33% reduce 2%
16/12/10 06:43:22 INFO mapreduce.Job:  map 34% reduce 2%
16/12/10 06:43:23 INFO mapreduce.Job:  map 38% reduce 2%
16/12/10 06:43:24 INFO mapreduce.Job:  map 40% reduce 3%
16/12/10 06:43:25 INFO mapreduce.Job:  map 43% reduce 4%
16/12/10 06:43:26 INFO mapreduce.Job:  map 49% reduce 6%
16/12/10 06:43:27 INFO mapreduce.Job:  map 54% reduce 8%
16/12/10 06:43:28 INFO mapreduce.Job:  map 55% reduce 10%
16/12/10 06:43:29 INFO mapreduce.Job:  map 55% reduce 14%
16/12/10 06:43:30 INFO mapreduce.Job:  map 56% reduce 16%
16/12/10 06:43:31 INFO mapreduce.Job:  map 56% reduce 18%
16/12/10 06:43:32 INFO mapreduce.Job:  map 57% reduce 18%
16/12/10 06:43:34 INFO mapreduce.Job:  map 58% reduce 18%
16/12/10 06:43:35 INFO mapreduce.Job:  map 58% reduce 19%
16/12/10 06:43:36 INFO mapreduce.Job:  map 60% reduce 19%
16/12/10 06:43:37 INFO mapreduce.Job:  map 61% reduce 19%
16/12/10 06:43:38 INFO mapreduce.Job:  map 62% reduce 19%
16/12/10 06:43:39 INFO mapreduce.Job:  map 64% reduce 19%
16/12/10 06:43:40 INFO mapreduce.Job:  map 64% reduce 20%
16/12/10 06:43:41 INFO mapreduce.Job:  map 66% reduce 20%
16/12/10 06:43:42 INFO mapreduce.Job:  map 68% reduce 20%
16/12/10 06:43:43 INFO mapreduce.Job:  map 69% reduce 21%
16/12/10 06:43:44 INFO mapreduce.Job:  map 70% reduce 21%
16/12/10 06:43:45 INFO mapreduce.Job:  map 71% reduce 22%
16/12/10 06:43:46 INFO mapreduce.Job:  map 74% reduce 22%
16/12/10 06:43:47 INFO mapreduce.Job:  map 75% reduce 23%
16/12/10 06:43:48 INFO mapreduce.Job:  map 81% reduce 23%
16/12/10 06:43:49 INFO mapreduce.Job:  map 85% reduce 24%
16/12/10 06:43:50 INFO mapreduce.Job:  map 87% reduce 25%
16/12/10 06:43:51 INFO mapreduce.Job:  map 92% reduce 26%
16/12/10 06:43:52 INFO mapreduce.Job:  map 97% reduce 27%
16/12/10 06:43:53 INFO mapreduce.Job:  map 99% reduce 30%
16/12/10 06:43:54 INFO mapreduce.Job:  map 99% reduce 31%
16/12/10 06:43:55 INFO mapreduce.Job:  map 99% reduce 32%
16/12/10 06:43:56 INFO mapreduce.Job:  map 100% reduce 33%
16/12/10 06:43:58 INFO mapreduce.Job:  map 100% reduce 38%
16/12/10 06:43:59 INFO mapreduce.Job:  map 100% reduce 59%
16/12/10 06:44:00 INFO mapreduce.Job:  map 100% reduce 65%
16/12/10 06:44:01 INFO mapreduce.Job:  map 100% reduce 71%
16/12/10 06:44:02 INFO mapreduce.Job:  map 100% reduce 75%
16/12/10 06:44:03 INFO mapreduce.Job:  map 100% reduce 78%
16/12/10 06:44:04 INFO mapreduce.Job:  map 100% reduce 81%
16/12/10 06:44:05 INFO mapreduce.Job:  map 100% reduce 83%
16/12/10 06:44:06 INFO mapreduce.Job:  map 100% reduce 87%
16/12/10 06:44:07 INFO mapreduce.Job:  map 100% reduce 94%
16/12/10 06:44:08 INFO mapreduce.Job:  map 100% reduce 97%
16/12/10 06:44:09 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 06:44:14 INFO mapreduce.Job: Job job_1480588584072_6453 completed successfully
16/12/10 06:44:14 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=206504273
		FILE: Number of bytes written=445390511
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=174003481
		WASB: Number of bytes written=113100878
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=41354616
		Total time spent by all reduces in occupied slots (ms)=2868280
		Total time spent by all map tasks (ms)=20677308
		Total time spent by all reduce tasks (ms)=1434140
		Total vcore-seconds taken by all map tasks=20677308
		Total vcore-seconds taken by all reduce tasks=1434140
		Total megabyte-seconds taken by all map tasks=21173563392
		Total megabyte-seconds taken by all reduce tasks=1468559360
	Map-Reduce Framework
		Map input records=550981
		Map output records=502866
		Map output bytes=204575643
		Map output materialized bytes=206527793
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=443530
		Reduce shuffle bytes=206527793
		Reduce input records=502866
		Reduce output records=334703
		Spilled Records=1005732
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=164128
		CPU time spent (ms)=710150
		Physical memory (bytes) snapshot=319889887232
		Virtual memory (bytes) snapshot=741964951552
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=171307477
	File Output Format Counters 
		Bytes Written=113100878
16/12/10 06:44:14 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4838274658267110141.jar tmpDir=null
16/12/10 07:45:24 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 07:45:26 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 07:45:27 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 07:45:29 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 07:45:30 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 07:45:30 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6501
16/12/10 07:45:31 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6501
16/12/10 07:45:31 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6501/
16/12/10 07:45:31 INFO mapreduce.Job: Running job: job_1480588584072_6501
16/12/10 07:45:50 INFO mapreduce.Job: Job job_1480588584072_6501 running in uber mode : false
16/12/10 07:45:50 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 07:46:33 INFO mapreduce.Job:  map 1% reduce 0%
16/12/10 07:46:34 INFO mapreduce.Job:  map 2% reduce 0%
16/12/10 07:46:55 INFO mapreduce.Job:  map 3% reduce 0%
16/12/10 07:46:59 INFO mapreduce.Job:  map 4% reduce 0%
16/12/10 07:47:04 INFO mapreduce.Job:  map 5% reduce 0%
16/12/10 07:47:06 INFO mapreduce.Job:  map 6% reduce 0%
16/12/10 07:47:07 INFO mapreduce.Job:  map 8% reduce 0%
16/12/10 07:47:10 INFO mapreduce.Job:  map 11% reduce 0%
16/12/10 07:47:13 INFO mapreduce.Job:  map 14% reduce 0%
16/12/10 07:47:14 INFO mapreduce.Job:  map 15% reduce 0%
16/12/10 07:47:15 INFO mapreduce.Job:  map 17% reduce 0%
16/12/10 07:47:18 INFO mapreduce.Job:  map 20% reduce 0%
16/12/10 07:47:19 INFO mapreduce.Job:  map 22% reduce 0%
16/12/10 07:47:21 INFO mapreduce.Job:  map 23% reduce 0%
16/12/10 07:47:22 INFO mapreduce.Job:  map 24% reduce 0%
16/12/10 07:47:24 INFO mapreduce.Job:  map 25% reduce 0%
16/12/10 07:47:30 INFO mapreduce.Job:  map 25% reduce 2%
16/12/10 07:47:33 INFO mapreduce.Job:  map 26% reduce 2%
16/12/10 07:47:35 INFO mapreduce.Job:  map 26% reduce 4%
16/12/10 07:47:37 INFO mapreduce.Job:  map 27% reduce 4%
16/12/10 07:47:38 INFO mapreduce.Job:  map 27% reduce 5%
16/12/10 07:47:40 INFO mapreduce.Job:  map 28% reduce 8%
16/12/10 07:47:41 INFO mapreduce.Job:  map 29% reduce 9%
16/12/10 07:47:42 INFO mapreduce.Job:  map 30% reduce 9%
16/12/10 07:47:44 INFO mapreduce.Job:  map 32% reduce 9%
16/12/10 07:47:45 INFO mapreduce.Job:  map 34% reduce 10%
16/12/10 07:47:46 INFO mapreduce.Job:  map 37% reduce 10%
16/12/10 07:47:47 INFO mapreduce.Job:  map 39% reduce 11%
16/12/10 07:47:48 INFO mapreduce.Job:  map 42% reduce 11%
16/12/10 07:47:49 INFO mapreduce.Job:  map 44% reduce 11%
16/12/10 07:47:50 INFO mapreduce.Job:  map 48% reduce 12%
16/12/10 07:47:51 INFO mapreduce.Job:  map 49% reduce 13%
16/12/10 07:47:52 INFO mapreduce.Job:  map 53% reduce 14%
16/12/10 07:47:53 INFO mapreduce.Job:  map 59% reduce 16%
16/12/10 07:47:54 INFO mapreduce.Job:  map 64% reduce 16%
16/12/10 07:47:55 INFO mapreduce.Job:  map 68% reduce 18%
16/12/10 07:47:56 INFO mapreduce.Job:  map 74% reduce 20%
16/12/10 07:47:57 INFO mapreduce.Job:  map 77% reduce 20%
16/12/10 07:47:59 INFO mapreduce.Job:  map 81% reduce 22%
16/12/10 07:48:00 INFO mapreduce.Job:  map 85% reduce 25%
16/12/10 07:48:01 INFO mapreduce.Job:  map 88% reduce 26%
16/12/10 07:48:02 INFO mapreduce.Job:  map 90% reduce 27%
16/12/10 07:48:03 INFO mapreduce.Job:  map 91% reduce 29%
16/12/10 07:48:04 INFO mapreduce.Job:  map 96% reduce 30%
16/12/10 07:48:05 INFO mapreduce.Job:  map 99% reduce 30%
16/12/10 07:48:06 INFO mapreduce.Job:  map 100% reduce 32%
16/12/10 07:48:07 INFO mapreduce.Job:  map 100% reduce 34%
16/12/10 07:48:08 INFO mapreduce.Job:  map 100% reduce 41%
16/12/10 07:48:09 INFO mapreduce.Job:  map 100% reduce 64%
16/12/10 07:48:10 INFO mapreduce.Job:  map 100% reduce 76%
16/12/10 07:48:11 INFO mapreduce.Job:  map 100% reduce 82%
16/12/10 07:48:12 INFO mapreduce.Job:  map 100% reduce 93%
16/12/10 07:48:13 INFO mapreduce.Job:  map 100% reduce 94%
16/12/10 07:48:14 INFO mapreduce.Job:  map 100% reduce 98%
16/12/10 07:48:15 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 07:48:18 INFO mapreduce.Job: Job job_1480588584072_6501 completed successfully
16/12/10 07:48:18 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=164188891
		FILE: Number of bytes written=360759747
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=140799943
		WASB: Number of bytes written=79833204
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=37686988
		Total time spent by all reduces in occupied slots (ms)=2136400
		Total time spent by all map tasks (ms)=18843494
		Total time spent by all reduce tasks (ms)=1068200
		Total vcore-seconds taken by all map tasks=18843494
		Total vcore-seconds taken by all reduce tasks=1068200
		Total megabyte-seconds taken by all map tasks=19295737856
		Total megabyte-seconds taken by all reduce tasks=1093836800
	Map-Reduce Framework
		Map input records=451993
		Map output records=402823
		Map output bytes=162643643
		Map output materialized bytes=164212411
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=350457
		Reduce shuffle bytes=164212411
		Reduce input records=402823
		Reduce output records=237366
		Spilled Records=805646
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=182794
		CPU time spent (ms)=675250
		Physical memory (bytes) snapshot=320555683840
		Virtual memory (bytes) snapshot=741912031232
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=138103939
	File Output Format Counters 
		Bytes Written=79833204
16/12/10 07:48:18 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612091900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4667348780473753832.jar tmpDir=null
16/12/10 08:44:30 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 08:44:30 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 08:44:31 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 08:44:33 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 08:44:33 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 08:44:34 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6512
16/12/10 08:44:34 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6512
16/12/10 08:44:34 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6512/
16/12/10 08:44:34 INFO mapreduce.Job: Running job: job_1480588584072_6512
16/12/10 08:44:51 INFO mapreduce.Job: Job job_1480588584072_6512 running in uber mode : false
16/12/10 08:44:51 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 08:45:18 INFO mapreduce.Job:  map 2% reduce 0%
16/12/10 08:45:19 INFO mapreduce.Job:  map 4% reduce 0%
16/12/10 08:45:51 INFO mapreduce.Job:  map 5% reduce 0%
16/12/10 08:45:55 INFO mapreduce.Job:  map 7% reduce 0%
16/12/10 08:45:57 INFO mapreduce.Job:  map 8% reduce 0%
16/12/10 08:45:58 INFO mapreduce.Job:  map 9% reduce 0%
16/12/10 08:46:00 INFO mapreduce.Job:  map 11% reduce 0%
16/12/10 08:46:01 INFO mapreduce.Job:  map 12% reduce 0%
16/12/10 08:46:02 INFO mapreduce.Job:  map 14% reduce 0%
16/12/10 08:46:03 INFO mapreduce.Job:  map 15% reduce 0%
16/12/10 08:46:04 INFO mapreduce.Job:  map 17% reduce 0%
16/12/10 08:46:05 INFO mapreduce.Job:  map 20% reduce 0%
16/12/10 08:46:07 INFO mapreduce.Job:  map 21% reduce 0%
16/12/10 08:46:08 INFO mapreduce.Job:  map 24% reduce 0%
16/12/10 08:46:09 INFO mapreduce.Job:  map 25% reduce 0%
16/12/10 08:46:12 INFO mapreduce.Job:  map 25% reduce 2%
16/12/10 08:46:15 INFO mapreduce.Job:  map 25% reduce 4%
16/12/10 08:46:16 INFO mapreduce.Job:  map 26% reduce 5%
16/12/10 08:46:21 INFO mapreduce.Job:  map 26% reduce 6%
16/12/10 08:46:22 INFO mapreduce.Job:  map 26% reduce 7%
16/12/10 08:46:23 INFO mapreduce.Job:  map 26% reduce 9%
16/12/10 08:46:31 INFO mapreduce.Job:  map 27% reduce 9%
16/12/10 08:46:36 INFO mapreduce.Job:  map 28% reduce 9%
16/12/10 08:46:38 INFO mapreduce.Job:  map 29% reduce 9%
16/12/10 08:46:40 INFO mapreduce.Job:  map 30% reduce 9%
16/12/10 08:46:41 INFO mapreduce.Job:  map 31% reduce 9%
16/12/10 08:46:42 INFO mapreduce.Job:  map 32% reduce 9%
16/12/10 08:46:44 INFO mapreduce.Job:  map 33% reduce 10%
16/12/10 08:46:45 INFO mapreduce.Job:  map 34% reduce 10%
16/12/10 08:46:46 INFO mapreduce.Job:  map 36% reduce 10%
16/12/10 08:46:47 INFO mapreduce.Job:  map 38% reduce 10%
16/12/10 08:46:48 INFO mapreduce.Job:  map 40% reduce 11%
16/12/10 08:46:49 INFO mapreduce.Job:  map 41% reduce 11%
16/12/10 08:46:50 INFO mapreduce.Job:  map 44% reduce 12%
16/12/10 08:46:51 INFO mapreduce.Job:  map 46% reduce 12%
16/12/10 08:46:52 INFO mapreduce.Job:  map 49% reduce 13%
16/12/10 08:46:53 INFO mapreduce.Job:  map 53% reduce 14%
16/12/10 08:46:54 INFO mapreduce.Job:  map 58% reduce 15%
16/12/10 08:46:55 INFO mapreduce.Job:  map 61% reduce 16%
16/12/10 08:46:56 INFO mapreduce.Job:  map 66% reduce 17%
16/12/10 08:46:57 INFO mapreduce.Job:  map 70% reduce 19%
16/12/10 08:46:58 INFO mapreduce.Job:  map 72% reduce 21%
16/12/10 08:46:59 INFO mapreduce.Job:  map 75% reduce 21%
16/12/10 08:47:00 INFO mapreduce.Job:  map 76% reduce 22%
16/12/10 08:47:01 INFO mapreduce.Job:  map 80% reduce 23%
16/12/10 08:47:02 INFO mapreduce.Job:  map 83% reduce 24%
16/12/10 08:47:03 INFO mapreduce.Job:  map 85% reduce 25%
16/12/10 08:47:04 INFO mapreduce.Job:  map 88% reduce 26%
16/12/10 08:47:05 INFO mapreduce.Job:  map 91% reduce 27%
16/12/10 08:47:06 INFO mapreduce.Job:  map 97% reduce 29%
16/12/10 08:47:07 INFO mapreduce.Job:  map 99% reduce 30%
16/12/10 08:47:08 INFO mapreduce.Job:  map 99% reduce 31%
16/12/10 08:47:09 INFO mapreduce.Job:  map 99% reduce 33%
16/12/10 08:47:10 INFO mapreduce.Job:  map 100% reduce 33%
16/12/10 08:47:12 INFO mapreduce.Job:  map 100% reduce 51%
16/12/10 08:47:13 INFO mapreduce.Job:  map 100% reduce 73%
16/12/10 08:47:15 INFO mapreduce.Job:  map 100% reduce 82%
16/12/10 08:47:16 INFO mapreduce.Job:  map 100% reduce 93%
16/12/10 08:47:17 INFO mapreduce.Job:  map 100% reduce 99%
16/12/10 08:47:18 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 08:47:21 INFO mapreduce.Job: Job job_1480588584072_6512 completed successfully
16/12/10 08:47:21 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=161728608
		FILE: Number of bytes written=355839181
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=140770062
		WASB: Number of bytes written=67555941
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=41304554
		Total time spent by all reduces in occupied slots (ms)=2998604
		Total time spent by all map tasks (ms)=20652277
		Total time spent by all reduce tasks (ms)=1499302
		Total vcore-seconds taken by all map tasks=20652277
		Total vcore-seconds taken by all reduce tasks=1499302
		Total megabyte-seconds taken by all map tasks=21147931648
		Total megabyte-seconds taken by all reduce tasks=1535285248
	Map-Reduce Framework
		Map input records=458950
		Map output records=398854
		Map output bytes=160195465
		Map output materialized bytes=161752128
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=340845
		Reduce shuffle bytes=161752128
		Reduce input records=398854
		Reduce output records=201568
		Spilled Records=797708
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=154872
		CPU time spent (ms)=687480
		Physical memory (bytes) snapshot=321645637632
		Virtual memory (bytes) snapshot=742137274368
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=138074058
	File Output Format Counters 
		Bytes Written=67555941
16/12/10 08:47:21 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0400 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0400': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4749136786034750071.jar tmpDir=null
16/12/10 09:43:32 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 09:43:33 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 09:43:33 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 09:43:38 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 09:43:38 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 09:43:38 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6524
16/12/10 09:43:39 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6524
16/12/10 09:43:39 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6524/
16/12/10 09:43:39 INFO mapreduce.Job: Running job: job_1480588584072_6524
16/12/10 09:43:51 INFO mapreduce.Job: Job job_1480588584072_6524 running in uber mode : false
16/12/10 09:43:51 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 09:44:33 INFO mapreduce.Job:  map 1% reduce 0%
16/12/10 09:45:00 INFO mapreduce.Job:  map 2% reduce 0%
16/12/10 09:45:02 INFO mapreduce.Job:  map 3% reduce 0%
16/12/10 09:45:06 INFO mapreduce.Job:  map 5% reduce 0%
16/12/10 09:45:07 INFO mapreduce.Job:  map 6% reduce 0%
16/12/10 09:45:09 INFO mapreduce.Job:  map 7% reduce 0%
16/12/10 09:45:17 INFO mapreduce.Job:  map 8% reduce 0%
16/12/10 09:45:20 INFO mapreduce.Job:  map 9% reduce 0%
16/12/10 09:45:28 INFO mapreduce.Job:  map 10% reduce 0%
16/12/10 09:45:30 INFO mapreduce.Job:  map 11% reduce 0%
16/12/10 09:45:31 INFO mapreduce.Job:  map 12% reduce 0%
16/12/10 09:45:34 INFO mapreduce.Job:  map 13% reduce 0%
16/12/10 09:45:36 INFO mapreduce.Job:  map 22% reduce 0%
16/12/10 09:45:37 INFO mapreduce.Job:  map 23% reduce 0%
16/12/10 09:45:38 INFO mapreduce.Job:  map 27% reduce 0%
16/12/10 09:45:39 INFO mapreduce.Job:  map 28% reduce 0%
16/12/10 09:45:40 INFO mapreduce.Job:  map 29% reduce 0%
16/12/10 09:45:41 INFO mapreduce.Job:  map 30% reduce 0%
16/12/10 09:45:43 INFO mapreduce.Job:  map 31% reduce 0%
16/12/10 09:45:46 INFO mapreduce.Job:  map 32% reduce 1%
16/12/10 09:45:47 INFO mapreduce.Job:  map 32% reduce 2%
16/12/10 09:45:55 INFO mapreduce.Job:  map 33% reduce 2%
16/12/10 09:45:56 INFO mapreduce.Job:  map 33% reduce 6%
16/12/10 09:45:57 INFO mapreduce.Job:  map 33% reduce 7%
16/12/10 09:45:58 INFO mapreduce.Job:  map 33% reduce 9%
16/12/10 09:45:59 INFO mapreduce.Job:  map 34% reduce 9%
16/12/10 09:46:00 INFO mapreduce.Job:  map 35% reduce 9%
16/12/10 09:46:03 INFO mapreduce.Job:  map 38% reduce 9%
16/12/10 09:46:04 INFO mapreduce.Job:  map 40% reduce 10%
16/12/10 09:46:05 INFO mapreduce.Job:  map 42% reduce 10%
16/12/10 09:46:06 INFO mapreduce.Job:  map 46% reduce 10%
16/12/10 09:46:07 INFO mapreduce.Job:  map 48% reduce 10%
16/12/10 09:46:08 INFO mapreduce.Job:  map 53% reduce 11%
16/12/10 09:46:09 INFO mapreduce.Job:  map 55% reduce 12%
16/12/10 09:46:10 INFO mapreduce.Job:  map 59% reduce 13%
16/12/10 09:46:11 INFO mapreduce.Job:  map 63% reduce 14%
16/12/10 09:46:12 INFO mapreduce.Job:  map 67% reduce 14%
16/12/10 09:46:13 INFO mapreduce.Job:  map 73% reduce 15%
16/12/10 09:46:14 INFO mapreduce.Job:  map 78% reduce 18%
16/12/10 09:46:15 INFO mapreduce.Job:  map 81% reduce 18%
16/12/10 09:46:16 INFO mapreduce.Job:  map 83% reduce 20%
16/12/10 09:46:17 INFO mapreduce.Job:  map 86% reduce 23%
16/12/10 09:46:18 INFO mapreduce.Job:  map 88% reduce 24%
16/12/10 09:46:19 INFO mapreduce.Job:  map 91% reduce 25%
16/12/10 09:46:20 INFO mapreduce.Job:  map 94% reduce 26%
16/12/10 09:46:21 INFO mapreduce.Job:  map 98% reduce 26%
16/12/10 09:46:22 INFO mapreduce.Job:  map 99% reduce 29%
16/12/10 09:46:23 INFO mapreduce.Job:  map 100% reduce 31%
16/12/10 09:46:25 INFO mapreduce.Job:  map 100% reduce 35%
16/12/10 09:46:26 INFO mapreduce.Job:  map 100% reduce 51%
16/12/10 09:46:27 INFO mapreduce.Job:  map 100% reduce 69%
16/12/10 09:46:28 INFO mapreduce.Job:  map 100% reduce 83%
16/12/10 09:46:29 INFO mapreduce.Job:  map 100% reduce 88%
16/12/10 09:46:30 INFO mapreduce.Job:  map 100% reduce 96%
16/12/10 09:46:31 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 09:46:37 INFO mapreduce.Job: Job job_1480588584072_6524 completed successfully
16/12/10 09:46:37 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=236703677
		FILE: Number of bytes written=505789319
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=206478727
		WASB: Number of bytes written=105614974
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=46067092
		Total time spent by all reduces in occupied slots (ms)=2084054
		Total time spent by all map tasks (ms)=23033546
		Total time spent by all reduce tasks (ms)=1042027
		Total vcore-seconds taken by all map tasks=23033546
		Total vcore-seconds taken by all reduce tasks=1042027
		Total megabyte-seconds taken by all map tasks=23586351104
		Total megabyte-seconds taken by all reduce tasks=1067035648
	Map-Reduce Framework
		Map input records=671318
		Map output records=581037
		Map output bytes=234465492
		Map output materialized bytes=236727197
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=497953
		Reduce shuffle bytes=236727197
		Reduce input records=581037
		Reduce output records=314503
		Spilled Records=1162074
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=207326
		CPU time spent (ms)=781030
		Physical memory (bytes) snapshot=316735238144
		Virtual memory (bytes) snapshot=742200455168
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=203782723
	File Output Format Counters 
		Bytes Written=105614974
16/12/10 09:46:37 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0400
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0500 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0500': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob9173750431057067688.jar tmpDir=null
16/12/10 10:42:47 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 10:42:47 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 10:42:48 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 10:42:50 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 10:42:50 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 10:42:50 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6528
16/12/10 10:42:51 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6528
16/12/10 10:42:51 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6528/
16/12/10 10:42:51 INFO mapreduce.Job: Running job: job_1480588584072_6528
16/12/10 10:43:05 INFO mapreduce.Job: Job job_1480588584072_6528 running in uber mode : false
16/12/10 10:43:05 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 10:43:56 INFO mapreduce.Job:  map 1% reduce 0%
16/12/10 10:44:20 INFO mapreduce.Job:  map 2% reduce 0%
16/12/10 10:44:21 INFO mapreduce.Job:  map 3% reduce 0%
16/12/10 10:44:24 INFO mapreduce.Job:  map 4% reduce 0%
16/12/10 10:44:29 INFO mapreduce.Job:  map 5% reduce 0%
16/12/10 10:44:32 INFO mapreduce.Job:  map 7% reduce 0%
16/12/10 10:45:05 INFO mapreduce.Job:  map 8% reduce 0%
16/12/10 10:45:07 INFO mapreduce.Job:  map 9% reduce 0%
16/12/10 10:45:10 INFO mapreduce.Job:  map 10% reduce 0%
16/12/10 10:45:13 INFO mapreduce.Job:  map 14% reduce 0%
16/12/10 10:45:14 INFO mapreduce.Job:  map 17% reduce 0%
16/12/10 10:45:20 INFO mapreduce.Job:  map 18% reduce 0%
16/12/10 10:45:24 INFO mapreduce.Job:  map 21% reduce 0%
16/12/10 10:45:25 INFO mapreduce.Job:  map 36% reduce 0%
16/12/10 10:45:26 INFO mapreduce.Job:  map 38% reduce 0%
16/12/10 10:45:55 INFO mapreduce.Job:  map 39% reduce 0%
16/12/10 10:45:56 INFO mapreduce.Job:  map 50% reduce 0%
16/12/10 10:45:57 INFO mapreduce.Job:  map 51% reduce 0%
16/12/10 10:45:57 INFO mapreduce.Job: Task Id : attempt_1480588584072_6528_m_000014_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 10:45:58 INFO mapreduce.Job: Task Id : attempt_1480588584072_6528_m_000023_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 10:45:59 INFO mapreduce.Job:  map 53% reduce 0%
16/12/10 10:46:00 INFO mapreduce.Job:  map 58% reduce 0%
16/12/10 10:46:01 INFO mapreduce.Job:  map 63% reduce 0%
16/12/10 10:46:02 INFO mapreduce.Job:  map 66% reduce 0%
16/12/10 10:46:02 INFO mapreduce.Job: Task Id : attempt_1480588584072_6528_m_000045_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 10:46:03 INFO mapreduce.Job:  map 68% reduce 0%
16/12/10 10:46:04 INFO mapreduce.Job:  map 71% reduce 0%
16/12/10 10:46:05 INFO mapreduce.Job: Task Id : attempt_1480588584072_6528_m_000006_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 10:46:05 INFO mapreduce.Job: Task Id : attempt_1480588584072_6528_m_000000_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 10:46:06 INFO mapreduce.Job:  map 71% reduce 1%
16/12/10 10:46:09 INFO mapreduce.Job:  map 72% reduce 2%
16/12/10 10:46:10 INFO mapreduce.Job:  map 72% reduce 5%
16/12/10 10:46:13 INFO mapreduce.Job:  map 72% reduce 11%
16/12/10 10:46:17 INFO mapreduce.Job:  map 72% reduce 12%
16/12/10 10:46:18 INFO mapreduce.Job:  map 73% reduce 13%
16/12/10 10:46:18 INFO mapreduce.Job: Task Id : attempt_1480588584072_6528_m_000153_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 10:46:19 INFO mapreduce.Job:  map 73% reduce 16%
16/12/10 10:46:20 INFO mapreduce.Job:  map 74% reduce 22%
16/12/10 10:46:23 INFO mapreduce.Job:  map 76% reduce 23%
16/12/10 10:46:25 INFO mapreduce.Job:  map 77% reduce 23%
16/12/10 10:46:28 INFO mapreduce.Job:  map 78% reduce 23%
16/12/10 10:46:29 INFO mapreduce.Job:  map 78% reduce 24%
16/12/10 10:46:32 INFO mapreduce.Job:  map 79% reduce 24%
16/12/10 10:46:47 INFO mapreduce.Job:  map 80% reduce 24%
16/12/10 10:46:49 INFO mapreduce.Job:  map 81% reduce 24%
16/12/10 10:46:50 INFO mapreduce.Job:  map 82% reduce 24%
16/12/10 10:46:53 INFO mapreduce.Job:  map 87% reduce 24%
16/12/10 10:46:54 INFO mapreduce.Job:  map 91% reduce 24%
16/12/10 10:47:34 INFO mapreduce.Job: Task Id : attempt_1480588584072_6528_m_000135_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 10:47:35 INFO mapreduce.Job:  map 91% reduce 25%
16/12/10 10:47:36 INFO mapreduce.Job: Task Id : attempt_1480588584072_6528_m_000130_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 10:47:37 INFO mapreduce.Job:  map 91% reduce 26%
16/12/10 10:47:37 INFO mapreduce.Job: Task Id : attempt_1480588584072_6528_m_000112_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 10:47:37 INFO mapreduce.Job: Task Id : attempt_1480588584072_6528_m_000144_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 10:47:37 INFO mapreduce.Job: Task Id : attempt_1480588584072_6528_m_000117_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 10:47:37 INFO mapreduce.Job: Task Id : attempt_1480588584072_6528_m_000097_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 10:47:38 INFO mapreduce.Job:  map 90% reduce 27%
16/12/10 10:47:38 INFO mapreduce.Job: Task Id : attempt_1480588584072_6528_m_000131_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 10:47:38 INFO mapreduce.Job: Task Id : attempt_1480588584072_6528_r_000012_0, Status : FAILED
Exception from container-launch.
Container id: container_e14_1480588584072_6528_01_000204
Exit code: 1
Stack trace: ExitCodeException exitCode=1: 
	at org.apache.hadoop.util.Shell.runCommand(Shell.java:576)
	at org.apache.hadoop.util.Shell.run(Shell.java:487)
	at org.apache.hadoop.util.Shell$ShellCommandExecutor.execute(Shell.java:753)
	at org.apache.hadoop.yarn.server.nodemanager.LinuxContainerExecutor.launchContainer(LinuxContainerExecutor.java:371)
	at org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.ContainerLaunch.call(ContainerLaunch.java:303)
	at org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.ContainerLaunch.call(ContainerLaunch.java:82)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)

Shell output: main : command provided 1
main : run as user is nobody
main : requested yarn user is zhangrn


Container exited with a non-zero exit code 1

16/12/10 10:47:39 INFO mapreduce.Job:  map 91% reduce 28%
16/12/10 10:47:40 INFO mapreduce.Job:  map 94% reduce 28%
16/12/10 10:47:41 INFO mapreduce.Job:  map 96% reduce 29%
16/12/10 10:47:42 INFO mapreduce.Job:  map 96% reduce 30%
16/12/10 10:47:43 INFO mapreduce.Job:  map 97% reduce 30%
16/12/10 10:47:44 INFO mapreduce.Job:  map 97% reduce 31%
16/12/10 10:47:46 INFO mapreduce.Job:  map 98% reduce 31%
16/12/10 10:47:47 INFO mapreduce.Job:  map 100% reduce 31%
16/12/10 10:47:49 INFO mapreduce.Job:  map 100% reduce 35%
16/12/10 10:47:50 INFO mapreduce.Job:  map 100% reduce 48%
16/12/10 10:47:51 INFO mapreduce.Job:  map 100% reduce 58%
16/12/10 10:47:52 INFO mapreduce.Job:  map 100% reduce 72%
16/12/10 10:47:53 INFO mapreduce.Job:  map 100% reduce 87%
16/12/10 10:47:54 INFO mapreduce.Job:  map 100% reduce 90%
16/12/10 10:47:55 INFO mapreduce.Job:  map 100% reduce 95%
16/12/10 10:47:56 INFO mapreduce.Job:  map 100% reduce 98%
16/12/10 10:47:57 INFO mapreduce.Job:  map 100% reduce 99%
16/12/10 10:47:58 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 10:48:03 INFO mapreduce.Job: Job job_1480588584072_6528 completed successfully
16/12/10 10:48:03 INFO mapreduce.Job: Counters: 52
	File System Counters
		FILE: Number of bytes read=362755484
		FILE: Number of bytes written=757892933
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=312414141
		WASB: Number of bytes written=179706140
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=13
		Failed reduce tasks=1
		Launched map tasks=210
		Launched reduce tasks=21
		Other local map tasks=13
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=66993104
		Total time spent by all reduces in occupied slots (ms)=4625020
		Total time spent by all map tasks (ms)=33496552
		Total time spent by all reduce tasks (ms)=2312510
		Total vcore-seconds taken by all map tasks=33496552
		Total vcore-seconds taken by all reduce tasks=2312510
		Total megabyte-seconds taken by all map tasks=34300469248
		Total megabyte-seconds taken by all reduce tasks=2368010240
	Map-Reduce Framework
		Map input records=1004968
		Map output records=884018
		Map output bytes=359348432
		Map output materialized bytes=362779004
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=763348
		Reduce shuffle bytes=362779004
		Reduce input records=884018
		Reduce output records=532592
		Spilled Records=1768036
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=265402
		CPU time spent (ms)=1157770
		Physical memory (bytes) snapshot=306258300928
		Virtual memory (bytes) snapshot=742775619584
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=309718137
	File Output Format Counters 
		Bytes Written=179706140
16/12/10 10:48:03 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0500
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0600 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0600': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8919293946613919980.jar tmpDir=null
16/12/10 11:44:11 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 11:44:12 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 11:44:12 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 11:44:19 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 11:44:19 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 11:44:19 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6533
16/12/10 11:44:20 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6533
16/12/10 11:44:20 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6533/
16/12/10 11:44:20 INFO mapreduce.Job: Running job: job_1480588584072_6533
16/12/10 11:44:38 INFO mapreduce.Job: Job job_1480588584072_6533 running in uber mode : false
16/12/10 11:44:38 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 11:45:15 INFO mapreduce.Job:  map 1% reduce 0%
16/12/10 11:45:44 INFO mapreduce.Job:  map 2% reduce 0%
16/12/10 11:45:49 INFO mapreduce.Job:  map 3% reduce 0%
16/12/10 11:45:55 INFO mapreduce.Job:  map 4% reduce 0%
16/12/10 11:45:59 INFO mapreduce.Job:  map 5% reduce 0%
16/12/10 11:46:01 INFO mapreduce.Job:  map 7% reduce 0%
16/12/10 11:46:35 INFO mapreduce.Job:  map 8% reduce 0%
16/12/10 11:46:38 INFO mapreduce.Job:  map 9% reduce 0%
16/12/10 11:46:39 INFO mapreduce.Job:  map 10% reduce 0%
16/12/10 11:46:45 INFO mapreduce.Job:  map 17% reduce 0%
16/12/10 11:46:46 INFO mapreduce.Job:  map 22% reduce 0%
16/12/10 11:46:48 INFO mapreduce.Job:  map 24% reduce 0%
16/12/10 11:46:50 INFO mapreduce.Job:  map 26% reduce 0%
16/12/10 11:47:14 INFO mapreduce.Job:  map 27% reduce 0%
16/12/10 11:47:15 INFO mapreduce.Job:  map 46% reduce 0%
16/12/10 11:47:16 INFO mapreduce.Job:  map 48% reduce 0%
16/12/10 11:47:17 INFO mapreduce.Job:  map 49% reduce 0%
16/12/10 11:47:18 INFO mapreduce.Job:  map 51% reduce 0%
16/12/10 11:47:19 INFO mapreduce.Job:  map 53% reduce 0%
16/12/10 11:47:20 INFO mapreduce.Job:  map 56% reduce 0%
16/12/10 11:47:21 INFO mapreduce.Job:  map 57% reduce 0%
16/12/10 11:47:21 INFO mapreduce.Job: Task Id : attempt_1480588584072_6533_m_000000_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 11:47:21 INFO mapreduce.Job: Task Id : attempt_1480588584072_6533_m_000007_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 11:47:23 INFO mapreduce.Job:  map 60% reduce 0%
16/12/10 11:47:23 INFO mapreduce.Job: Task Id : attempt_1480588584072_6533_m_000032_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 11:47:23 INFO mapreduce.Job: Task Id : attempt_1480588584072_6533_m_000024_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 11:47:24 INFO mapreduce.Job:  map 61% reduce 0%
16/12/10 11:47:25 INFO mapreduce.Job:  map 62% reduce 1%
16/12/10 11:47:26 INFO mapreduce.Job:  map 65% reduce 2%
16/12/10 11:47:27 INFO mapreduce.Job:  map 66% reduce 3%
16/12/10 11:47:28 INFO mapreduce.Job:  map 68% reduce 5%
16/12/10 11:47:29 INFO mapreduce.Job:  map 69% reduce 5%
16/12/10 11:47:30 INFO mapreduce.Job:  map 71% reduce 8%
16/12/10 11:47:31 INFO mapreduce.Job:  map 72% reduce 9%
16/12/10 11:47:32 INFO mapreduce.Job:  map 74% reduce 9%
16/12/10 11:47:33 INFO mapreduce.Job:  map 74% reduce 10%
16/12/10 11:47:34 INFO mapreduce.Job:  map 74% reduce 15%
16/12/10 11:47:35 INFO mapreduce.Job:  map 75% reduce 15%
16/12/10 11:47:36 INFO mapreduce.Job:  map 76% reduce 16%
16/12/10 11:47:40 INFO mapreduce.Job:  map 77% reduce 16%
16/12/10 11:47:43 INFO mapreduce.Job:  map 77% reduce 17%
16/12/10 11:48:02 INFO mapreduce.Job:  map 79% reduce 17%
16/12/10 11:48:04 INFO mapreduce.Job:  map 79% reduce 18%
16/12/10 11:48:06 INFO mapreduce.Job:  map 80% reduce 18%
16/12/10 11:48:07 INFO mapreduce.Job:  map 81% reduce 19%
16/12/10 11:48:08 INFO mapreduce.Job:  map 82% reduce 19%
16/12/10 11:48:09 INFO mapreduce.Job: Task Id : attempt_1480588584072_6533_r_000015_0, Status : FAILED
Exception from container-launch.
Container id: container_e14_1480588584072_6533_01_000215
Exit code: 1
Stack trace: ExitCodeException exitCode=1: 
	at org.apache.hadoop.util.Shell.runCommand(Shell.java:576)
	at org.apache.hadoop.util.Shell.run(Shell.java:487)
	at org.apache.hadoop.util.Shell$ShellCommandExecutor.execute(Shell.java:753)
	at org.apache.hadoop.yarn.server.nodemanager.LinuxContainerExecutor.launchContainer(LinuxContainerExecutor.java:371)
	at org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.ContainerLaunch.call(ContainerLaunch.java:303)
	at org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.ContainerLaunch.call(ContainerLaunch.java:82)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)

Shell output: main : command provided 1
main : run as user is nobody
main : requested yarn user is zhangrn


Container exited with a non-zero exit code 1

16/12/10 11:48:09 INFO mapreduce.Job: Task Id : attempt_1480588584072_6533_r_000010_0, Status : FAILED
Exception from container-launch.
Container id: container_e14_1480588584072_6533_01_000210
Exit code: 1
Stack trace: ExitCodeException exitCode=1: 
	at org.apache.hadoop.util.Shell.runCommand(Shell.java:576)
	at org.apache.hadoop.util.Shell.run(Shell.java:487)
	at org.apache.hadoop.util.Shell$ShellCommandExecutor.execute(Shell.java:753)
	at org.apache.hadoop.yarn.server.nodemanager.LinuxContainerExecutor.launchContainer(LinuxContainerExecutor.java:371)
	at org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.ContainerLaunch.call(ContainerLaunch.java:303)
	at org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.ContainerLaunch.call(ContainerLaunch.java:82)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)

Shell output: main : command provided 1
main : run as user is nobody
main : requested yarn user is zhangrn


Container exited with a non-zero exit code 1

16/12/10 11:48:10 INFO mapreduce.Job:  map 84% reduce 19%
16/12/10 11:48:10 INFO mapreduce.Job: Task Id : attempt_1480588584072_6533_m_000158_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 11:48:11 INFO mapreduce.Job:  map 86% reduce 20%
16/12/10 11:48:11 INFO mapreduce.Job: Task Id : attempt_1480588584072_6533_m_000161_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 11:48:12 INFO mapreduce.Job:  map 89% reduce 20%
16/12/10 11:48:13 INFO mapreduce.Job:  map 89% reduce 22%
16/12/10 11:48:14 INFO mapreduce.Job:  map 90% reduce 23%
16/12/10 11:48:15 INFO mapreduce.Job:  map 90% reduce 24%
16/12/10 11:48:16 INFO mapreduce.Job:  map 90% reduce 25%
16/12/10 11:48:18 INFO mapreduce.Job:  map 90% reduce 26%
16/12/10 11:48:19 INFO mapreduce.Job:  map 91% reduce 26%
16/12/10 11:48:25 INFO mapreduce.Job:  map 91% reduce 27%
16/12/10 11:48:52 INFO mapreduce.Job:  map 92% reduce 27%
16/12/10 11:48:53 INFO mapreduce.Job:  map 96% reduce 28%
16/12/10 11:48:54 INFO mapreduce.Job:  map 97% reduce 28%
16/12/10 11:48:55 INFO mapreduce.Job:  map 99% reduce 28%
16/12/10 11:48:56 INFO mapreduce.Job:  map 99% reduce 29%
16/12/10 11:48:57 INFO mapreduce.Job:  map 99% reduce 30%
16/12/10 11:48:59 INFO mapreduce.Job:  map 100% reduce 30%
16/12/10 11:49:00 INFO mapreduce.Job:  map 100% reduce 33%
16/12/10 11:49:01 INFO mapreduce.Job:  map 100% reduce 42%
16/12/10 11:49:02 INFO mapreduce.Job:  map 100% reduce 69%
16/12/10 11:49:03 INFO mapreduce.Job:  map 100% reduce 77%
16/12/10 11:49:04 INFO mapreduce.Job:  map 100% reduce 88%
16/12/10 11:49:05 INFO mapreduce.Job:  map 100% reduce 94%
16/12/10 11:49:06 INFO mapreduce.Job:  map 100% reduce 95%
16/12/10 11:49:07 INFO mapreduce.Job:  map 100% reduce 99%
16/12/10 11:49:08 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 11:49:12 INFO mapreduce.Job: Job job_1480588584072_6533 completed successfully
16/12/10 11:49:12 INFO mapreduce.Job: Counters: 52
	File System Counters
		FILE: Number of bytes read=447136470
		FILE: Number of bytes written=926654905
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=384597735
		WASB: Number of bytes written=223252794
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=6
		Failed reduce tasks=2
		Launched map tasks=203
		Launched reduce tasks=22
		Other local map tasks=6
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=63162860
		Total time spent by all reduces in occupied slots (ms)=4316340
		Total time spent by all map tasks (ms)=31581430
		Total time spent by all reduce tasks (ms)=2158170
		Total vcore-seconds taken by all map tasks=31581430
		Total vcore-seconds taken by all reduce tasks=2158170
		Total megabyte-seconds taken by all map tasks=32339384320
		Total megabyte-seconds taken by all reduce tasks=2209966080
	Map-Reduce Framework
		Map input records=1236643
		Map output records=1088869
		Map output bytes=442941171
		Map output materialized bytes=447159990
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=941031
		Reduce shuffle bytes=447159990
		Reduce input records=1088869
		Reduce output records=661753
		Spilled Records=2177738
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=308631
		CPU time spent (ms)=1286040
		Physical memory (bytes) snapshot=307201486848
		Virtual memory (bytes) snapshot=741852364800
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=381901731
	File Output Format Counters 
		Bytes Written=223252794
16/12/10 11:49:12 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0600
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0700 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161209/201612092300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0700': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2208743254460930987.jar tmpDir=null
16/12/10 12:45:22 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 12:45:23 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 12:45:24 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 12:45:26 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 12:45:26 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 12:45:27 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6537
16/12/10 12:45:28 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6537
16/12/10 12:45:28 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6537/
16/12/10 12:45:28 INFO mapreduce.Job: Running job: job_1480588584072_6537
16/12/10 12:45:42 INFO mapreduce.Job: Job job_1480588584072_6537 running in uber mode : false
16/12/10 12:45:42 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 12:46:20 INFO mapreduce.Job:  map 1% reduce 0%
16/12/10 12:46:22 INFO mapreduce.Job:  map 2% reduce 0%
16/12/10 12:46:46 INFO mapreduce.Job:  map 3% reduce 0%
16/12/10 12:47:01 INFO mapreduce.Job:  map 4% reduce 0%
16/12/10 12:47:05 INFO mapreduce.Job:  map 5% reduce 0%
16/12/10 12:47:06 INFO mapreduce.Job:  map 7% reduce 0%
16/12/10 12:47:43 INFO mapreduce.Job:  map 9% reduce 0%
16/12/10 12:47:45 INFO mapreduce.Job:  map 10% reduce 0%
16/12/10 12:47:47 INFO mapreduce.Job:  map 11% reduce 0%
16/12/10 12:47:48 INFO mapreduce.Job:  map 14% reduce 0%
16/12/10 12:47:49 INFO mapreduce.Job:  map 23% reduce 0%
16/12/10 12:47:50 INFO mapreduce.Job:  map 27% reduce 0%
16/12/10 12:48:01 INFO mapreduce.Job:  map 32% reduce 0%
16/12/10 12:48:02 INFO mapreduce.Job:  map 40% reduce 0%
16/12/10 12:48:05 INFO mapreduce.Job:  map 42% reduce 0%
16/12/10 12:48:06 INFO mapreduce.Job:  map 41% reduce 0%
16/12/10 12:48:06 INFO mapreduce.Job: Task Id : attempt_1480588584072_6537_m_000001_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 12:48:06 INFO mapreduce.Job: Task Id : attempt_1480588584072_6537_m_000028_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 12:48:07 INFO mapreduce.Job:  map 44% reduce 0%
16/12/10 12:48:10 INFO mapreduce.Job:  map 45% reduce 0%
16/12/10 12:48:11 INFO mapreduce.Job:  map 46% reduce 0%
16/12/10 12:48:12 INFO mapreduce.Job:  map 49% reduce 1%
16/12/10 12:48:13 INFO mapreduce.Job:  map 51% reduce 1%
16/12/10 12:48:15 INFO mapreduce.Job:  map 54% reduce 2%
16/12/10 12:48:16 INFO mapreduce.Job:  map 55% reduce 2%
16/12/10 12:48:17 INFO mapreduce.Job:  map 57% reduce 2%
16/12/10 12:48:18 INFO mapreduce.Job:  map 59% reduce 3%
16/12/10 12:48:19 INFO mapreduce.Job:  map 60% reduce 5%
16/12/10 12:48:20 INFO mapreduce.Job:  map 62% reduce 5%
16/12/10 12:48:21 INFO mapreduce.Job:  map 67% reduce 6%
16/12/10 12:48:22 INFO mapreduce.Job:  map 70% reduce 6%
16/12/10 12:48:23 INFO mapreduce.Job:  map 72% reduce 6%
16/12/10 12:48:24 INFO mapreduce.Job:  map 77% reduce 6%
16/12/10 12:48:25 INFO mapreduce.Job:  map 81% reduce 7%
16/12/10 12:48:26 INFO mapreduce.Job:  map 84% reduce 7%
16/12/10 12:48:27 INFO mapreduce.Job:  map 85% reduce 7%
16/12/10 12:48:28 INFO mapreduce.Job:  map 87% reduce 8%
16/12/10 12:48:29 INFO mapreduce.Job:  map 88% reduce 8%
16/12/10 12:48:30 INFO mapreduce.Job:  map 89% reduce 8%
16/12/10 12:48:31 INFO mapreduce.Job:  map 90% reduce 11%
16/12/10 12:48:32 INFO mapreduce.Job:  map 90% reduce 15%
16/12/10 12:48:33 INFO mapreduce.Job:  map 92% reduce 15%
16/12/10 12:48:34 INFO mapreduce.Job:  map 93% reduce 18%
16/12/10 12:48:35 INFO mapreduce.Job:  map 94% reduce 23%
16/12/10 12:48:36 INFO mapreduce.Job:  map 96% reduce 25%
16/12/10 12:48:37 INFO mapreduce.Job:  map 97% reduce 26%
16/12/10 12:48:38 INFO mapreduce.Job:  map 99% reduce 27%
16/12/10 12:48:39 INFO mapreduce.Job:  map 100% reduce 27%
16/12/10 12:48:40 INFO mapreduce.Job:  map 100% reduce 29%
16/12/10 12:48:41 INFO mapreduce.Job:  map 100% reduce 39%
16/12/10 12:48:42 INFO mapreduce.Job:  map 100% reduce 45%
16/12/10 12:48:43 INFO mapreduce.Job:  map 100% reduce 56%
16/12/10 12:48:44 INFO mapreduce.Job:  map 100% reduce 66%
16/12/10 12:48:45 INFO mapreduce.Job:  map 100% reduce 70%
16/12/10 12:48:46 INFO mapreduce.Job:  map 100% reduce 87%
16/12/10 12:48:47 INFO mapreduce.Job:  map 100% reduce 97%
16/12/10 12:48:48 INFO mapreduce.Job:  map 100% reduce 98%
16/12/10 12:48:49 INFO mapreduce.Job:  map 100% reduce 99%
16/12/10 12:48:50 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 12:49:00 INFO mapreduce.Job: Job job_1480588584072_6537 completed successfully
16/12/10 12:49:00 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=616592643
		FILE: Number of bytes written=1265567251
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=525546599
		WASB: Number of bytes written=335912514
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=2
		Launched map tasks=199
		Launched reduce tasks=20
		Other local map tasks=2
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=52832326
		Total time spent by all reduces in occupied slots (ms)=1811916
		Total time spent by all map tasks (ms)=26416163
		Total time spent by all reduce tasks (ms)=905958
		Total vcore-seconds taken by all map tasks=26416163
		Total vcore-seconds taken by all reduce tasks=905958
		Total megabyte-seconds taken by all map tasks=27050150912
		Total megabyte-seconds taken by all reduce tasks=927700992
	Map-Reduce Framework
		Map input records=1668845
		Map output records=1490652
		Map output bytes=610842691
		Map output materialized bytes=616616163
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1306134
		Reduce shuffle bytes=616616163
		Reduce input records=1490652
		Reduce output records=988162
		Spilled Records=2981304
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=155407
		CPU time spent (ms)=966440
		Physical memory (bytes) snapshot=316930068480
		Virtual memory (bytes) snapshot=742440247296
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=522850595
	File Output Format Counters 
		Bytes Written=335912514
16/12/10 12:49:00 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0700
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100400 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0800 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100400
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0800': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4545640880465430822.jar tmpDir=null
16/12/10 13:45:13 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 13:45:14 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 13:45:14 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 13:45:16 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 13:45:17 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 13:45:17 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6541
16/12/10 13:45:21 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6541
16/12/10 13:45:21 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6541/
16/12/10 13:45:21 INFO mapreduce.Job: Running job: job_1480588584072_6541
16/12/10 13:45:35 INFO mapreduce.Job: Job job_1480588584072_6541 running in uber mode : false
16/12/10 13:45:35 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 13:45:45 INFO mapreduce.Job:  map 1% reduce 0%
16/12/10 13:47:20 INFO mapreduce.Job:  map 2% reduce 0%
16/12/10 13:47:24 INFO mapreduce.Job:  map 3% reduce 0%
16/12/10 13:47:26 INFO mapreduce.Job:  map 4% reduce 0%
16/12/10 13:47:29 INFO mapreduce.Job:  map 5% reduce 0%
16/12/10 13:47:30 INFO mapreduce.Job:  map 6% reduce 0%
16/12/10 13:47:31 INFO mapreduce.Job:  map 8% reduce 0%
16/12/10 13:47:32 INFO mapreduce.Job:  map 9% reduce 0%
16/12/10 13:47:33 INFO mapreduce.Job:  map 10% reduce 0%
16/12/10 13:47:35 INFO mapreduce.Job:  map 11% reduce 0%
16/12/10 13:47:36 INFO mapreduce.Job:  map 14% reduce 0%
16/12/10 13:47:37 INFO mapreduce.Job:  map 18% reduce 0%
16/12/10 13:47:38 INFO mapreduce.Job:  map 20% reduce 0%
16/12/10 13:47:39 INFO mapreduce.Job:  map 22% reduce 0%
16/12/10 13:47:40 INFO mapreduce.Job:  map 24% reduce 0%
16/12/10 13:47:41 INFO mapreduce.Job:  map 27% reduce 0%
16/12/10 13:47:42 INFO mapreduce.Job:  map 29% reduce 0%
16/12/10 13:47:43 INFO mapreduce.Job:  map 33% reduce 0%
16/12/10 13:47:44 INFO mapreduce.Job:  map 35% reduce 0%
16/12/10 13:47:45 INFO mapreduce.Job:  map 38% reduce 1%
16/12/10 13:47:46 INFO mapreduce.Job:  map 40% reduce 1%
16/12/10 13:47:47 INFO mapreduce.Job:  map 41% reduce 2%
16/12/10 13:47:48 INFO mapreduce.Job:  map 44% reduce 2%
16/12/10 13:47:49 INFO mapreduce.Job:  map 48% reduce 2%
16/12/10 13:47:50 INFO mapreduce.Job:  map 50% reduce 3%
16/12/10 13:47:51 INFO mapreduce.Job:  map 54% reduce 5%
16/12/10 13:47:52 INFO mapreduce.Job:  map 59% reduce 5%
16/12/10 13:47:53 INFO mapreduce.Job:  map 64% reduce 6%
16/12/10 13:47:54 INFO mapreduce.Job:  map 69% reduce 7%
16/12/10 13:47:55 INFO mapreduce.Job:  map 71% reduce 7%
16/12/10 13:47:56 INFO mapreduce.Job:  map 76% reduce 8%
16/12/10 13:47:57 INFO mapreduce.Job:  map 78% reduce 9%
16/12/10 13:47:58 INFO mapreduce.Job:  map 83% reduce 9%
16/12/10 13:47:59 INFO mapreduce.Job:  map 84% reduce 10%
16/12/10 13:48:00 INFO mapreduce.Job:  map 86% reduce 11%
16/12/10 13:48:01 INFO mapreduce.Job:  map 89% reduce 11%
16/12/10 13:48:02 INFO mapreduce.Job:  map 90% reduce 13%
16/12/10 13:48:03 INFO mapreduce.Job:  map 91% reduce 14%
16/12/10 13:48:04 INFO mapreduce.Job:  map 92% reduce 18%
16/12/10 13:48:05 INFO mapreduce.Job:  map 93% reduce 24%
16/12/10 13:48:06 INFO mapreduce.Job:  map 93% reduce 25%
16/12/10 13:48:07 INFO mapreduce.Job:  map 94% reduce 25%
16/12/10 13:48:08 INFO mapreduce.Job:  map 94% reduce 26%
16/12/10 13:48:09 INFO mapreduce.Job:  map 95% reduce 28%
16/12/10 13:48:10 INFO mapreduce.Job:  map 96% reduce 28%
16/12/10 13:48:11 INFO mapreduce.Job:  map 97% reduce 29%
16/12/10 13:48:12 INFO mapreduce.Job:  map 98% reduce 29%
16/12/10 13:48:13 INFO mapreduce.Job:  map 99% reduce 29%
16/12/10 13:48:14 INFO mapreduce.Job:  map 100% reduce 30%
16/12/10 13:48:15 INFO mapreduce.Job:  map 100% reduce 31%
16/12/10 13:48:16 INFO mapreduce.Job:  map 100% reduce 34%
16/12/10 13:48:17 INFO mapreduce.Job:  map 100% reduce 44%
16/12/10 13:48:18 INFO mapreduce.Job:  map 100% reduce 61%
16/12/10 13:48:19 INFO mapreduce.Job:  map 100% reduce 68%
16/12/10 13:48:20 INFO mapreduce.Job:  map 100% reduce 74%
16/12/10 13:48:21 INFO mapreduce.Job:  map 100% reduce 89%
16/12/10 13:48:22 INFO mapreduce.Job:  map 100% reduce 95%
16/12/10 13:48:23 INFO mapreduce.Job:  map 100% reduce 98%
16/12/10 13:48:24 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 13:48:33 INFO mapreduce.Job: Job job_1480588584072_6541 completed successfully
16/12/10 13:48:34 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=666988292
		FILE: Number of bytes written=1366358549
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=568592480
		WASB: Number of bytes written=360043643
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=52386794
		Total time spent by all reduces in occupied slots (ms)=1898384
		Total time spent by all map tasks (ms)=26193397
		Total time spent by all reduce tasks (ms)=949192
		Total vcore-seconds taken by all map tasks=26193397
		Total vcore-seconds taken by all reduce tasks=949192
		Total megabyte-seconds taken by all map tasks=26822038528
		Total megabyte-seconds taken by all reduce tasks=971972608
	Map-Reduce Framework
		Map input records=1805162
		Map output records=1610745
		Map output bytes=660768812
		Map output materialized bytes=667011812
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1408372
		Reduce shuffle bytes=667011812
		Reduce input records=1610745
		Reduce output records=1055975
		Spilled Records=3221490
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=211896
		CPU time spent (ms)=996270
		Physical memory (bytes) snapshot=321319931904
		Virtual memory (bytes) snapshot=743079768064
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=565896476
	File Output Format Counters 
		Bytes Written=360043643
16/12/10 13:48:34 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0800
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100500 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0900 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100500
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0900': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3122492120459532131.jar tmpDir=null
16/12/10 14:44:42 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 14:44:43 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 14:44:47 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 14:44:49 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 14:44:49 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 14:44:49 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6545
16/12/10 14:44:50 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6545
16/12/10 14:44:50 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6545/
16/12/10 14:44:50 INFO mapreduce.Job: Running job: job_1480588584072_6545
16/12/10 14:45:07 INFO mapreduce.Job: Job job_1480588584072_6545 running in uber mode : false
16/12/10 14:45:07 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 14:46:54 INFO mapreduce.Job:  map 1% reduce 0%
16/12/10 14:46:56 INFO mapreduce.Job:  map 2% reduce 0%
16/12/10 14:47:01 INFO mapreduce.Job:  map 3% reduce 0%
16/12/10 14:47:02 INFO mapreduce.Job:  map 4% reduce 0%
16/12/10 14:47:03 INFO mapreduce.Job:  map 6% reduce 0%
16/12/10 14:47:04 INFO mapreduce.Job:  map 7% reduce 0%
16/12/10 14:47:05 INFO mapreduce.Job:  map 8% reduce 0%
16/12/10 14:47:06 INFO mapreduce.Job:  map 11% reduce 0%
16/12/10 14:47:07 INFO mapreduce.Job:  map 12% reduce 0%
16/12/10 14:47:08 INFO mapreduce.Job:  map 14% reduce 0%
16/12/10 14:47:09 INFO mapreduce.Job:  map 16% reduce 0%
16/12/10 14:47:10 INFO mapreduce.Job:  map 18% reduce 0%
16/12/10 14:47:11 INFO mapreduce.Job:  map 21% reduce 0%
16/12/10 14:47:12 INFO mapreduce.Job:  map 23% reduce 0%
16/12/10 14:47:14 INFO mapreduce.Job:  map 25% reduce 0%
16/12/10 14:47:15 INFO mapreduce.Job:  map 28% reduce 0%
16/12/10 14:47:16 INFO mapreduce.Job:  map 30% reduce 0%
16/12/10 14:47:17 INFO mapreduce.Job:  map 33% reduce 0%
16/12/10 14:47:18 INFO mapreduce.Job:  map 36% reduce 0%
16/12/10 14:47:19 INFO mapreduce.Job:  map 40% reduce 0%
16/12/10 14:47:20 INFO mapreduce.Job:  map 42% reduce 0%
16/12/10 14:47:21 INFO mapreduce.Job:  map 46% reduce 1%
16/12/10 14:47:22 INFO mapreduce.Job:  map 48% reduce 1%
16/12/10 14:47:23 INFO mapreduce.Job:  map 50% reduce 2%
16/12/10 14:47:24 INFO mapreduce.Job:  map 55% reduce 2%
16/12/10 14:47:25 INFO mapreduce.Job:  map 58% reduce 4%
16/12/10 14:47:26 INFO mapreduce.Job:  map 61% reduce 5%
16/12/10 14:47:27 INFO mapreduce.Job:  map 67% reduce 5%
16/12/10 14:47:28 INFO mapreduce.Job:  map 69% reduce 6%
16/12/10 14:47:29 INFO mapreduce.Job:  map 70% reduce 6%
16/12/10 14:47:30 INFO mapreduce.Job:  map 72% reduce 6%
16/12/10 14:47:31 INFO mapreduce.Job:  map 73% reduce 7%
16/12/10 14:47:32 INFO mapreduce.Job:  map 74% reduce 7%
16/12/10 14:47:33 INFO mapreduce.Job:  map 75% reduce 7%
16/12/10 14:47:34 INFO mapreduce.Job:  map 77% reduce 9%
16/12/10 14:47:35 INFO mapreduce.Job:  map 80% reduce 12%
16/12/10 14:47:36 INFO mapreduce.Job:  map 81% reduce 13%
16/12/10 14:47:37 INFO mapreduce.Job:  map 81% reduce 18%
16/12/10 14:47:38 INFO mapreduce.Job:  map 81% reduce 21%
16/12/10 14:47:39 INFO mapreduce.Job:  map 82% reduce 23%
16/12/10 14:47:40 INFO mapreduce.Job:  map 82% reduce 24%
16/12/10 14:47:44 INFO mapreduce.Job:  map 82% reduce 25%
16/12/10 14:47:48 INFO mapreduce.Job:  map 83% reduce 25%
16/12/10 14:47:54 INFO mapreduce.Job: Task Id : attempt_1480588584072_6545_m_000006_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 14:47:54 INFO mapreduce.Job: Task Id : attempt_1480588584072_6545_m_000024_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 14:47:57 INFO mapreduce.Job:  map 84% reduce 25%
16/12/10 14:47:58 INFO mapreduce.Job:  map 84% reduce 26%
16/12/10 14:48:05 INFO mapreduce.Job:  map 85% reduce 26%
16/12/10 14:48:15 INFO mapreduce.Job:  map 86% reduce 26%
16/12/10 14:48:18 INFO mapreduce.Job:  map 87% reduce 26%
16/12/10 14:48:23 INFO mapreduce.Job:  map 88% reduce 26%
16/12/10 14:48:27 INFO mapreduce.Job:  map 89% reduce 26%
16/12/10 14:48:31 INFO mapreduce.Job:  map 90% reduce 26%
16/12/10 14:48:32 INFO mapreduce.Job:  map 91% reduce 26%
16/12/10 14:48:34 INFO mapreduce.Job:  map 92% reduce 26%
16/12/10 14:48:35 INFO mapreduce.Job:  map 93% reduce 26%
16/12/10 14:48:54 INFO mapreduce.Job: Task Id : attempt_1480588584072_6545_m_000001_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 14:48:54 INFO mapreduce.Job: Task Id : attempt_1480588584072_6545_m_000005_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 14:48:54 INFO mapreduce.Job: Task Id : attempt_1480588584072_6545_m_000026_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 14:48:54 INFO mapreduce.Job: Task Id : attempt_1480588584072_6545_m_000003_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 14:48:55 INFO mapreduce.Job:  map 92% reduce 27%
16/12/10 14:48:56 INFO mapreduce.Job:  map 92% reduce 28%
16/12/10 14:48:57 INFO mapreduce.Job: Task Id : attempt_1480588584072_6545_m_000013_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 14:48:58 INFO mapreduce.Job:  map 93% reduce 29%
16/12/10 14:48:59 INFO mapreduce.Job:  map 94% reduce 30%
16/12/10 14:49:00 INFO mapreduce.Job:  map 95% reduce 31%
16/12/10 14:49:01 INFO mapreduce.Job:  map 96% reduce 31%
16/12/10 14:49:02 INFO mapreduce.Job:  map 97% reduce 32%
16/12/10 14:49:04 INFO mapreduce.Job:  map 98% reduce 32%
16/12/10 14:49:05 INFO mapreduce.Job:  map 98% reduce 33%
16/12/10 14:49:06 INFO mapreduce.Job:  map 99% reduce 33%
16/12/10 14:49:07 INFO mapreduce.Job:  map 100% reduce 33%
16/12/10 14:49:08 INFO mapreduce.Job:  map 100% reduce 36%
16/12/10 14:49:09 INFO mapreduce.Job:  map 100% reduce 40%
16/12/10 14:49:10 INFO mapreduce.Job:  map 100% reduce 46%
16/12/10 14:49:11 INFO mapreduce.Job:  map 100% reduce 62%
16/12/10 14:49:12 INFO mapreduce.Job:  map 100% reduce 70%
16/12/10 14:49:13 INFO mapreduce.Job:  map 100% reduce 74%
16/12/10 14:49:14 INFO mapreduce.Job:  map 100% reduce 84%
16/12/10 14:49:15 INFO mapreduce.Job:  map 100% reduce 89%
16/12/10 14:49:16 INFO mapreduce.Job:  map 100% reduce 91%
16/12/10 14:49:17 INFO mapreduce.Job:  map 100% reduce 95%
16/12/10 14:49:18 INFO mapreduce.Job:  map 100% reduce 96%
16/12/10 14:49:20 INFO mapreduce.Job:  map 100% reduce 98%
16/12/10 14:49:21 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 14:49:29 INFO mapreduce.Job: Job job_1480588584072_6545 completed successfully
16/12/10 14:49:29 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=711820741
		FILE: Number of bytes written=1456023447
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=607315568
		WASB: Number of bytes written=381254016
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=7
		Launched map tasks=204
		Launched reduce tasks=20
		Other local map tasks=7
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=59869240
		Total time spent by all reduces in occupied slots (ms)=5073160
		Total time spent by all map tasks (ms)=29934620
		Total time spent by all reduce tasks (ms)=2536580
		Total vcore-seconds taken by all map tasks=29934620
		Total vcore-seconds taken by all reduce tasks=2536580
		Total megabyte-seconds taken by all map tasks=30653050880
		Total megabyte-seconds taken by all reduce tasks=2597457920
	Map-Reduce Framework
		Map input records=1933876
		Map output records=1721083
		Map output bytes=705176160
		Map output materialized bytes=711844261
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1504761
		Reduce shuffle bytes=711844261
		Reduce input records=1721083
		Reduce output records=1119519
		Spilled Records=3442166
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=526797
		CPU time spent (ms)=1351640
		Physical memory (bytes) snapshot=317216444416
		Virtual memory (bytes) snapshot=742938341376
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=604619564
	File Output Format Counters 
		Bytes Written=381254016
16/12/10 14:49:29 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/0900
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100300
16/12/10 15:45:24 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100600 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100600
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1691270232495310719.jar tmpDir=null
16/12/10 15:45:39 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 15:45:40 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 15:45:40 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 15:45:43 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 15:45:43 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 15:45:47 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6549
16/12/10 15:45:49 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6549
16/12/10 15:45:49 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6549/
16/12/10 15:45:49 INFO mapreduce.Job: Running job: job_1480588584072_6549
16/12/10 15:46:02 INFO mapreduce.Job: Job job_1480588584072_6549 running in uber mode : false
16/12/10 15:46:02 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 15:46:24 INFO mapreduce.Job:  map 2% reduce 0%
16/12/10 15:47:06 INFO mapreduce.Job:  map 3% reduce 0%
16/12/10 15:47:16 INFO mapreduce.Job:  map 5% reduce 0%
16/12/10 15:47:17 INFO mapreduce.Job:  map 7% reduce 0%
16/12/10 15:47:19 INFO mapreduce.Job:  map 8% reduce 0%
16/12/10 15:47:22 INFO mapreduce.Job:  map 12% reduce 0%
16/12/10 15:47:24 INFO mapreduce.Job:  map 14% reduce 0%
16/12/10 15:47:25 INFO mapreduce.Job:  map 15% reduce 0%
16/12/10 15:47:26 INFO mapreduce.Job:  map 16% reduce 0%
16/12/10 15:47:28 INFO mapreduce.Job:  map 18% reduce 0%
16/12/10 15:47:29 INFO mapreduce.Job:  map 20% reduce 0%
16/12/10 15:47:30 INFO mapreduce.Job:  map 21% reduce 0%
16/12/10 15:47:31 INFO mapreduce.Job:  map 22% reduce 0%
16/12/10 15:47:33 INFO mapreduce.Job:  map 23% reduce 0%
16/12/10 15:47:35 INFO mapreduce.Job:  map 24% reduce 0%
16/12/10 15:47:38 INFO mapreduce.Job:  map 24% reduce 2%
16/12/10 15:47:42 INFO mapreduce.Job:  map 24% reduce 4%
16/12/10 15:47:43 INFO mapreduce.Job:  map 25% reduce 4%
16/12/10 15:47:46 INFO mapreduce.Job:  map 26% reduce 4%
16/12/10 15:47:47 INFO mapreduce.Job:  map 26% reduce 5%
16/12/10 15:47:48 INFO mapreduce.Job:  map 26% reduce 7%
16/12/10 15:47:49 INFO mapreduce.Job:  map 26% reduce 8%
16/12/10 15:47:51 INFO mapreduce.Job:  map 27% reduce 8%
16/12/10 15:47:53 INFO mapreduce.Job:  map 27% reduce 9%
16/12/10 15:47:54 INFO mapreduce.Job:  map 28% reduce 9%
16/12/10 15:47:56 INFO mapreduce.Job:  map 29% reduce 9%
16/12/10 15:47:57 INFO mapreduce.Job:  map 30% reduce 9%
16/12/10 15:47:58 INFO mapreduce.Job:  map 31% reduce 9%
16/12/10 15:47:59 INFO mapreduce.Job:  map 32% reduce 9%
16/12/10 15:48:01 INFO mapreduce.Job:  map 33% reduce 9%
16/12/10 15:48:02 INFO mapreduce.Job:  map 35% reduce 9%
16/12/10 15:48:03 INFO mapreduce.Job:  map 36% reduce 9%
16/12/10 15:48:05 INFO mapreduce.Job:  map 39% reduce 10%
16/12/10 15:48:06 INFO mapreduce.Job:  map 41% reduce 10%
16/12/10 15:48:07 INFO mapreduce.Job:  map 42% reduce 10%
16/12/10 15:48:08 INFO mapreduce.Job:  map 44% reduce 11%
16/12/10 15:48:09 INFO mapreduce.Job:  map 47% reduce 11%
16/12/10 15:48:10 INFO mapreduce.Job:  map 48% reduce 12%
16/12/10 15:48:11 INFO mapreduce.Job:  map 50% reduce 12%
16/12/10 15:48:12 INFO mapreduce.Job:  map 54% reduce 13%
16/12/10 15:48:13 INFO mapreduce.Job:  map 55% reduce 13%
16/12/10 15:48:14 INFO mapreduce.Job:  map 57% reduce 14%
16/12/10 15:48:15 INFO mapreduce.Job:  map 59% reduce 15%
16/12/10 15:48:16 INFO mapreduce.Job:  map 63% reduce 15%
16/12/10 15:48:17 INFO mapreduce.Job:  map 66% reduce 16%
16/12/10 15:48:18 INFO mapreduce.Job:  map 70% reduce 17%
16/12/10 15:48:19 INFO mapreduce.Job:  map 73% reduce 18%
16/12/10 15:48:20 INFO mapreduce.Job:  map 76% reduce 20%
16/12/10 15:48:21 INFO mapreduce.Job:  map 79% reduce 22%
16/12/10 15:48:22 INFO mapreduce.Job:  map 79% reduce 23%
16/12/10 15:48:23 INFO mapreduce.Job:  map 79% reduce 24%
16/12/10 15:48:24 INFO mapreduce.Job:  map 80% reduce 24%
16/12/10 15:48:25 INFO mapreduce.Job:  map 80% reduce 25%
16/12/10 15:48:40 INFO mapreduce.Job:  map 81% reduce 25%
16/12/10 15:48:40 INFO mapreduce.Job: Task Id : attempt_1480588584072_6549_m_000007_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 15:48:40 INFO mapreduce.Job: Task Id : attempt_1480588584072_6549_m_000029_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 15:48:40 INFO mapreduce.Job: Task Id : attempt_1480588584072_6549_m_000045_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 15:48:41 INFO mapreduce.Job:  map 80% reduce 25%
16/12/10 15:48:41 INFO mapreduce.Job: Task Id : attempt_1480588584072_6549_m_000011_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 15:48:47 INFO mapreduce.Job:  map 81% reduce 25%
16/12/10 15:48:49 INFO mapreduce.Job:  map 82% reduce 26%
16/12/10 15:48:52 INFO mapreduce.Job:  map 83% reduce 26%
16/12/10 15:48:54 INFO mapreduce.Job:  map 84% reduce 26%
16/12/10 15:48:55 INFO mapreduce.Job:  map 85% reduce 26%
16/12/10 15:48:56 INFO mapreduce.Job:  map 86% reduce 27%
16/12/10 15:48:59 INFO mapreduce.Job:  map 87% reduce 27%
16/12/10 15:49:01 INFO mapreduce.Job:  map 88% reduce 27%
16/12/10 15:49:04 INFO mapreduce.Job:  map 89% reduce 27%
16/12/10 15:49:06 INFO mapreduce.Job:  map 91% reduce 27%
16/12/10 15:49:09 INFO mapreduce.Job:  map 93% reduce 27%
16/12/10 15:49:12 INFO mapreduce.Job:  map 94% reduce 27%
16/12/10 15:49:14 INFO mapreduce.Job:  map 95% reduce 27%
16/12/10 15:49:15 INFO mapreduce.Job:  map 96% reduce 27%
16/12/10 15:49:17 INFO mapreduce.Job:  map 97% reduce 27%
16/12/10 15:49:18 INFO mapreduce.Job:  map 98% reduce 27%
16/12/10 15:49:21 INFO mapreduce.Job:  map 98% reduce 28%
16/12/10 15:49:22 INFO mapreduce.Job:  map 98% reduce 30%
16/12/10 15:49:23 INFO mapreduce.Job:  map 99% reduce 31%
16/12/10 15:49:24 INFO mapreduce.Job:  map 99% reduce 32%
16/12/10 15:49:25 INFO mapreduce.Job:  map 99% reduce 33%
16/12/10 15:49:26 INFO mapreduce.Job:  map 100% reduce 33%
16/12/10 15:49:28 INFO mapreduce.Job:  map 100% reduce 37%
16/12/10 15:49:29 INFO mapreduce.Job:  map 100% reduce 38%
16/12/10 15:49:30 INFO mapreduce.Job:  map 100% reduce 49%
16/12/10 15:49:31 INFO mapreduce.Job:  map 100% reduce 64%
16/12/10 15:49:32 INFO mapreduce.Job:  map 100% reduce 68%
16/12/10 15:49:33 INFO mapreduce.Job:  map 100% reduce 73%
16/12/10 15:49:34 INFO mapreduce.Job:  map 100% reduce 80%
16/12/10 15:49:35 INFO mapreduce.Job:  map 100% reduce 83%
16/12/10 15:49:36 INFO mapreduce.Job:  map 100% reduce 87%
16/12/10 15:49:38 INFO mapreduce.Job:  map 100% reduce 88%
16/12/10 15:49:39 INFO mapreduce.Job:  map 100% reduce 91%
16/12/10 15:49:40 INFO mapreduce.Job:  map 100% reduce 93%
16/12/10 15:49:41 INFO mapreduce.Job:  map 100% reduce 94%
16/12/10 15:49:42 INFO mapreduce.Job:  map 100% reduce 97%
16/12/10 15:49:43 INFO mapreduce.Job:  map 100% reduce 98%
16/12/10 15:49:44 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 15:49:51 INFO mapreduce.Job: Job job_1480588584072_6549 completed successfully
16/12/10 15:49:51 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=819014614
		FILE: Number of bytes written=1670411193
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=696665181
		WASB: Number of bytes written=452816148
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=4
		Launched map tasks=201
		Launched reduce tasks=20
		Other local map tasks=4
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=50241272
		Total time spent by all reduces in occupied slots (ms)=5405744
		Total time spent by all map tasks (ms)=25120636
		Total time spent by all reduce tasks (ms)=2702872
		Total vcore-seconds taken by all map tasks=25120636
		Total vcore-seconds taken by all reduce tasks=2702872
		Total megabyte-seconds taken by all map tasks=25723531264
		Total megabyte-seconds taken by all reduce tasks=2767740928
	Map-Reduce Framework
		Map input records=2214162
		Map output records=1979598
		Map output bytes=811380772
		Map output materialized bytes=819038134
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1738715
		Reduce shuffle bytes=819038134
		Reduce input records=1979598
		Reduce output records=1332417
		Spilled Records=3959196
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=289332
		CPU time spent (ms)=1255790
		Physical memory (bytes) snapshot=319744872448
		Virtual memory (bytes) snapshot=743336398848
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=693969177
	File Output Format Counters 
		Bytes Written=452816148
16/12/10 15:49:51 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100700 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100700
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5981194462555653228.jar tmpDir=null
16/12/10 16:46:00 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 16:46:01 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 16:46:01 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 16:46:04 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 16:46:04 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 16:46:05 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6553
16/12/10 16:46:05 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6553
16/12/10 16:46:06 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6553/
16/12/10 16:46:06 INFO mapreduce.Job: Running job: job_1480588584072_6553
16/12/10 16:46:26 INFO mapreduce.Job: Job job_1480588584072_6553 running in uber mode : false
16/12/10 16:46:26 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 16:47:05 INFO mapreduce.Job:  map 1% reduce 0%
16/12/10 16:47:38 INFO mapreduce.Job:  map 2% reduce 0%
16/12/10 16:47:39 INFO mapreduce.Job:  map 3% reduce 0%
16/12/10 16:47:45 INFO mapreduce.Job:  map 4% reduce 0%
16/12/10 16:47:46 INFO mapreduce.Job:  map 6% reduce 0%
16/12/10 16:47:48 INFO mapreduce.Job:  map 7% reduce 0%
16/12/10 16:47:49 INFO mapreduce.Job:  map 8% reduce 0%
16/12/10 16:47:51 INFO mapreduce.Job:  map 9% reduce 0%
16/12/10 16:47:53 INFO mapreduce.Job:  map 12% reduce 0%
16/12/10 16:47:54 INFO mapreduce.Job:  map 13% reduce 0%
16/12/10 16:47:55 INFO mapreduce.Job:  map 16% reduce 0%
16/12/10 16:47:56 INFO mapreduce.Job:  map 18% reduce 0%
16/12/10 16:47:57 INFO mapreduce.Job:  map 19% reduce 0%
16/12/10 16:47:58 INFO mapreduce.Job:  map 20% reduce 0%
16/12/10 16:47:59 INFO mapreduce.Job:  map 22% reduce 0%
16/12/10 16:48:01 INFO mapreduce.Job:  map 23% reduce 0%
16/12/10 16:48:02 INFO mapreduce.Job:  map 24% reduce 0%
16/12/10 16:48:03 INFO mapreduce.Job:  map 25% reduce 0%
16/12/10 16:48:06 INFO mapreduce.Job:  map 26% reduce 0%
16/12/10 16:48:08 INFO mapreduce.Job:  map 27% reduce 0%
16/12/10 16:48:09 INFO mapreduce.Job:  map 27% reduce 1%
16/12/10 16:48:11 INFO mapreduce.Job:  map 28% reduce 2%
16/12/10 16:48:14 INFO mapreduce.Job:  map 29% reduce 4%
16/12/10 16:48:16 INFO mapreduce.Job:  map 30% reduce 4%
16/12/10 16:48:17 INFO mapreduce.Job:  map 31% reduce 4%
16/12/10 16:48:19 INFO mapreduce.Job:  map 32% reduce 4%
16/12/10 16:48:20 INFO mapreduce.Job:  map 34% reduce 4%
16/12/10 16:48:21 INFO mapreduce.Job:  map 35% reduce 7%
16/12/10 16:48:22 INFO mapreduce.Job:  map 35% reduce 9%
16/12/10 16:48:23 INFO mapreduce.Job:  map 38% reduce 10%
16/12/10 16:48:24 INFO mapreduce.Job:  map 40% reduce 11%
16/12/10 16:48:25 INFO mapreduce.Job:  map 41% reduce 11%
16/12/10 16:48:26 INFO mapreduce.Job:  map 43% reduce 11%
16/12/10 16:48:27 INFO mapreduce.Job:  map 45% reduce 12%
16/12/10 16:48:28 INFO mapreduce.Job:  map 47% reduce 12%
16/12/10 16:48:29 INFO mapreduce.Job:  map 50% reduce 13%
16/12/10 16:48:30 INFO mapreduce.Job:  map 54% reduce 14%
16/12/10 16:48:31 INFO mapreduce.Job:  map 56% reduce 14%
16/12/10 16:48:32 INFO mapreduce.Job:  map 60% reduce 15%
16/12/10 16:48:33 INFO mapreduce.Job:  map 64% reduce 16%
16/12/10 16:48:34 INFO mapreduce.Job:  map 67% reduce 17%
16/12/10 16:48:35 INFO mapreduce.Job:  map 72% reduce 18%
16/12/10 16:48:36 INFO mapreduce.Job:  map 73% reduce 19%
16/12/10 16:48:37 INFO mapreduce.Job:  map 75% reduce 21%
16/12/10 16:48:38 INFO mapreduce.Job:  map 77% reduce 21%
16/12/10 16:48:39 INFO mapreduce.Job:  map 80% reduce 22%
16/12/10 16:48:40 INFO mapreduce.Job:  map 83% reduce 24%
16/12/10 16:48:41 INFO mapreduce.Job:  map 84% reduce 25%
16/12/10 16:48:42 INFO mapreduce.Job:  map 85% reduce 26%
16/12/10 16:48:43 INFO mapreduce.Job:  map 85% reduce 27%
16/12/10 16:48:44 INFO mapreduce.Job:  map 86% reduce 27%
16/12/10 16:48:45 INFO mapreduce.Job:  map 87% reduce 27%
16/12/10 16:48:46 INFO mapreduce.Job:  map 88% reduce 28%
16/12/10 16:48:48 INFO mapreduce.Job:  map 89% reduce 28%
16/12/10 16:48:50 INFO mapreduce.Job:  map 90% reduce 28%
16/12/10 16:48:52 INFO mapreduce.Job:  map 92% reduce 28%
16/12/10 16:48:54 INFO mapreduce.Job:  map 93% reduce 29%
16/12/10 16:48:55 INFO mapreduce.Job:  map 94% reduce 29%
16/12/10 16:48:56 INFO mapreduce.Job:  map 95% reduce 29%
16/12/10 16:48:58 INFO mapreduce.Job:  map 97% reduce 30%
16/12/10 16:49:00 INFO mapreduce.Job:  map 98% reduce 31%
16/12/10 16:49:01 INFO mapreduce.Job:  map 99% reduce 31%
16/12/10 16:49:02 INFO mapreduce.Job:  map 100% reduce 32%
16/12/10 16:49:03 INFO mapreduce.Job:  map 100% reduce 33%
16/12/10 16:49:04 INFO mapreduce.Job:  map 100% reduce 36%
16/12/10 16:49:06 INFO mapreduce.Job:  map 100% reduce 45%
16/12/10 16:49:07 INFO mapreduce.Job:  map 100% reduce 50%
16/12/10 16:49:08 INFO mapreduce.Job:  map 100% reduce 57%
16/12/10 16:49:09 INFO mapreduce.Job:  map 100% reduce 68%
16/12/10 16:49:10 INFO mapreduce.Job:  map 100% reduce 73%
16/12/10 16:49:11 INFO mapreduce.Job:  map 100% reduce 77%
16/12/10 16:49:12 INFO mapreduce.Job:  map 100% reduce 81%
16/12/10 16:49:13 INFO mapreduce.Job:  map 100% reduce 82%
16/12/10 16:49:14 INFO mapreduce.Job:  map 100% reduce 83%
16/12/10 16:49:15 INFO mapreduce.Job:  map 100% reduce 85%
16/12/10 16:49:16 INFO mapreduce.Job:  map 100% reduce 87%
16/12/10 16:49:18 INFO mapreduce.Job:  map 100% reduce 90%
16/12/10 16:49:19 INFO mapreduce.Job:  map 100% reduce 93%
16/12/10 16:49:21 INFO mapreduce.Job:  map 100% reduce 97%
16/12/10 16:49:23 INFO mapreduce.Job:  map 100% reduce 99%
16/12/10 16:49:24 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 16:49:31 INFO mapreduce.Job: Job job_1480588584072_6553 completed successfully
16/12/10 16:49:31 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=779436344
		FILE: Number of bytes written=1591254653
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=668588094
		WASB: Number of bytes written=405159371
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=44726346
		Total time spent by all reduces in occupied slots (ms)=3161710
		Total time spent by all map tasks (ms)=22363173
		Total time spent by all reduce tasks (ms)=1580855
		Total vcore-seconds taken by all map tasks=22363173
		Total vcore-seconds taken by all reduce tasks=1580855
		Total megabyte-seconds taken by all map tasks=22899889152
		Total megabyte-seconds taken by all reduce tasks=1618795520
	Map-Reduce Framework
		Map input records=2145165
		Map output records=1891827
		Map output bytes=772140914
		Map output materialized bytes=779459864
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1647154
		Reduce shuffle bytes=779459864
		Reduce input records=1891827
		Reduce output records=1196088
		Spilled Records=3783654
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=192996
		CPU time spent (ms)=999990
		Physical memory (bytes) snapshot=323068461056
		Virtual memory (bytes) snapshot=743253045248
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=665892090
	File Output Format Counters 
		Bytes Written=405159371
16/12/10 16:49:31 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100800 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100800
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2834888906260337931.jar tmpDir=null
16/12/10 17:45:46 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 17:45:47 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 17:45:48 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 17:45:52 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 17:45:52 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 17:45:53 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6586
16/12/10 17:45:54 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6586
16/12/10 17:45:54 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6586/
16/12/10 17:45:54 INFO mapreduce.Job: Running job: job_1480588584072_6586
16/12/10 17:46:26 INFO mapreduce.Job: Job job_1480588584072_6586 running in uber mode : false
16/12/10 17:46:26 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 17:47:02 INFO mapreduce.Job:  map 1% reduce 0%
16/12/10 17:47:06 INFO mapreduce.Job:  map 2% reduce 0%
16/12/10 17:47:07 INFO mapreduce.Job:  map 3% reduce 0%
16/12/10 17:47:09 INFO mapreduce.Job:  map 4% reduce 0%
16/12/10 17:47:10 INFO mapreduce.Job:  map 6% reduce 0%
16/12/10 17:47:11 INFO mapreduce.Job:  map 8% reduce 0%
16/12/10 17:47:12 INFO mapreduce.Job:  map 9% reduce 0%
16/12/10 17:47:13 INFO mapreduce.Job:  map 11% reduce 0%
16/12/10 17:47:14 INFO mapreduce.Job:  map 12% reduce 0%
16/12/10 17:47:15 INFO mapreduce.Job:  map 14% reduce 0%
16/12/10 17:47:16 INFO mapreduce.Job:  map 16% reduce 0%
16/12/10 17:47:17 INFO mapreduce.Job:  map 19% reduce 0%
16/12/10 17:47:18 INFO mapreduce.Job:  map 20% reduce 0%
16/12/10 17:47:19 INFO mapreduce.Job:  map 22% reduce 0%
16/12/10 17:47:20 INFO mapreduce.Job:  map 23% reduce 0%
16/12/10 17:47:21 INFO mapreduce.Job:  map 26% reduce 0%
16/12/10 17:47:22 INFO mapreduce.Job:  map 28% reduce 0%
16/12/10 17:47:23 INFO mapreduce.Job:  map 31% reduce 0%
16/12/10 17:47:24 INFO mapreduce.Job:  map 33% reduce 0%
16/12/10 17:47:25 INFO mapreduce.Job:  map 35% reduce 0%
16/12/10 17:47:26 INFO mapreduce.Job:  map 36% reduce 0%
16/12/10 17:47:27 INFO mapreduce.Job:  map 37% reduce 0%
16/12/10 17:47:29 INFO mapreduce.Job:  map 37% reduce 1%
16/12/10 17:47:30 INFO mapreduce.Job:  map 37% reduce 2%
16/12/10 17:47:31 INFO mapreduce.Job:  map 37% reduce 3%
16/12/10 17:47:33 INFO mapreduce.Job:  map 37% reduce 5%
16/12/10 17:47:34 INFO mapreduce.Job:  map 37% reduce 8%
16/12/10 17:47:35 INFO mapreduce.Job:  map 37% reduce 9%
16/12/10 17:47:36 INFO mapreduce.Job:  map 37% reduce 10%
16/12/10 17:47:40 INFO mapreduce.Job:  map 38% reduce 10%
16/12/10 17:47:44 INFO mapreduce.Job:  map 40% reduce 10%
16/12/10 17:47:45 INFO mapreduce.Job:  map 41% reduce 10%
16/12/10 17:47:47 INFO mapreduce.Job:  map 41% reduce 11%
16/12/10 17:47:48 INFO mapreduce.Job:  map 42% reduce 11%
16/12/10 17:47:49 INFO mapreduce.Job:  map 44% reduce 11%
16/12/10 17:47:50 INFO mapreduce.Job:  map 45% reduce 11%
16/12/10 17:47:51 INFO mapreduce.Job:  map 46% reduce 12%
16/12/10 17:47:52 INFO mapreduce.Job:  map 47% reduce 12%
16/12/10 17:47:53 INFO mapreduce.Job:  map 49% reduce 13%
16/12/10 17:47:54 INFO mapreduce.Job:  map 50% reduce 14%
16/12/10 17:47:55 INFO mapreduce.Job:  map 50% reduce 15%
16/12/10 17:47:56 INFO mapreduce.Job:  map 50% reduce 16%
16/12/10 17:47:58 INFO mapreduce.Job:  map 50% reduce 17%
16/12/10 17:48:02 INFO mapreduce.Job:  map 51% reduce 17%
16/12/10 17:48:15 INFO mapreduce.Job:  map 52% reduce 17%
16/12/10 17:48:19 INFO mapreduce.Job:  map 53% reduce 17%
16/12/10 17:48:21 INFO mapreduce.Job:  map 54% reduce 17%
16/12/10 17:48:23 INFO mapreduce.Job:  map 54% reduce 18%
16/12/10 17:48:25 INFO mapreduce.Job:  map 55% reduce 18%
16/12/10 17:48:26 INFO mapreduce.Job:  map 56% reduce 18%
16/12/10 17:48:27 INFO mapreduce.Job:  map 57% reduce 18%
16/12/10 17:48:28 INFO mapreduce.Job:  map 58% reduce 18%
16/12/10 17:48:29 INFO mapreduce.Job:  map 59% reduce 18%
16/12/10 17:48:30 INFO mapreduce.Job:  map 60% reduce 18%
16/12/10 17:48:32 INFO mapreduce.Job:  map 62% reduce 19%
16/12/10 17:48:33 INFO mapreduce.Job:  map 63% reduce 19%
16/12/10 17:48:34 INFO mapreduce.Job:  map 64% reduce 19%
16/12/10 17:48:36 INFO mapreduce.Job:  map 65% reduce 20%
16/12/10 17:48:37 INFO mapreduce.Job:  map 66% reduce 20%
16/12/10 17:48:39 INFO mapreduce.Job:  map 68% reduce 20%
16/12/10 17:48:40 INFO mapreduce.Job:  map 69% reduce 20%
16/12/10 17:48:41 INFO mapreduce.Job:  map 71% reduce 20%
16/12/10 17:48:42 INFO mapreduce.Job:  map 72% reduce 20%
16/12/10 17:48:43 INFO mapreduce.Job:  map 73% reduce 21%
16/12/10 17:48:44 INFO mapreduce.Job:  map 74% reduce 21%
16/12/10 17:48:45 INFO mapreduce.Job:  map 75% reduce 21%
16/12/10 17:48:46 INFO mapreduce.Job:  map 76% reduce 22%
16/12/10 17:48:47 INFO mapreduce.Job:  map 78% reduce 22%
16/12/10 17:48:48 INFO mapreduce.Job:  map 80% reduce 23%
16/12/10 17:48:49 INFO mapreduce.Job:  map 80% reduce 24%
16/12/10 17:48:50 INFO mapreduce.Job:  map 81% reduce 24%
16/12/10 17:48:51 INFO mapreduce.Job:  map 81% reduce 25%
16/12/10 17:48:54 INFO mapreduce.Job:  map 82% reduce 25%
16/12/10 17:49:07 INFO mapreduce.Job:  map 83% reduce 25%
16/12/10 17:49:11 INFO mapreduce.Job:  map 84% reduce 25%
16/12/10 17:49:15 INFO mapreduce.Job:  map 85% reduce 25%
16/12/10 17:49:16 INFO mapreduce.Job:  map 85% reduce 26%
16/12/10 17:49:20 INFO mapreduce.Job:  map 86% reduce 26%
16/12/10 17:49:22 INFO mapreduce.Job: Task Id : attempt_1480588584072_6586_m_000014_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 17:49:23 INFO mapreduce.Job: Task Id : attempt_1480588584072_6586_m_000011_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 17:49:23 INFO mapreduce.Job: Task Id : attempt_1480588584072_6586_m_000013_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 17:49:24 INFO mapreduce.Job:  map 86% reduce 27%
16/12/10 17:49:26 INFO mapreduce.Job:  map 87% reduce 27%
16/12/10 17:49:29 INFO mapreduce.Job:  map 88% reduce 27%
16/12/10 17:49:30 INFO mapreduce.Job:  map 89% reduce 27%
16/12/10 17:49:31 INFO mapreduce.Job:  map 91% reduce 27%
16/12/10 17:49:33 INFO mapreduce.Job:  map 92% reduce 27%
16/12/10 17:49:34 INFO mapreduce.Job:  map 93% reduce 27%
16/12/10 17:49:35 INFO mapreduce.Job:  map 93% reduce 28%
16/12/10 17:49:36 INFO mapreduce.Job:  map 95% reduce 28%
16/12/10 17:49:37 INFO mapreduce.Job:  map 96% reduce 29%
16/12/10 17:49:38 INFO mapreduce.Job:  map 97% reduce 30%
16/12/10 17:49:39 INFO mapreduce.Job:  map 99% reduce 30%
16/12/10 17:49:40 INFO mapreduce.Job:  map 99% reduce 31%
16/12/10 17:49:41 INFO mapreduce.Job:  map 100% reduce 32%
16/12/10 17:49:43 INFO mapreduce.Job:  map 100% reduce 33%
16/12/10 17:49:45 INFO mapreduce.Job:  map 100% reduce 34%
16/12/10 17:49:46 INFO mapreduce.Job:  map 100% reduce 41%
16/12/10 17:49:47 INFO mapreduce.Job:  map 100% reduce 55%
16/12/10 17:49:48 INFO mapreduce.Job:  map 100% reduce 60%
16/12/10 17:49:49 INFO mapreduce.Job:  map 100% reduce 69%
16/12/10 17:49:50 INFO mapreduce.Job:  map 100% reduce 75%
16/12/10 17:49:51 INFO mapreduce.Job:  map 100% reduce 77%
16/12/10 17:49:52 INFO mapreduce.Job:  map 100% reduce 84%
16/12/10 17:49:53 INFO mapreduce.Job:  map 100% reduce 91%
16/12/10 17:49:54 INFO mapreduce.Job:  map 100% reduce 94%
16/12/10 17:49:55 INFO mapreduce.Job:  map 100% reduce 95%
16/12/10 17:49:56 INFO mapreduce.Job:  map 100% reduce 98%
16/12/10 17:49:57 INFO mapreduce.Job:  map 100% reduce 99%
16/12/10 17:49:58 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 17:50:06 INFO mapreduce.Job: Job job_1480588584072_6586 completed successfully
16/12/10 17:50:07 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=893408601
		FILE: Number of bytes written=1819199167
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=756665649
		WASB: Number of bytes written=497832490
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=3
		Launched map tasks=200
		Launched reduce tasks=20
		Other local map tasks=3
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=40245400
		Total time spent by all reduces in occupied slots (ms)=6411130
		Total time spent by all map tasks (ms)=20122700
		Total time spent by all reduce tasks (ms)=3205565
		Total vcore-seconds taken by all map tasks=20122700
		Total vcore-seconds taken by all reduce tasks=3205565
		Total megabyte-seconds taken by all map tasks=20605644800
		Total megabyte-seconds taken by all reduce tasks=3282498560
	Map-Reduce Framework
		Map input records=2405822
		Map output records=2161807
		Map output bytes=885086796
		Map output materialized bytes=893432121
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1905713
		Reduce shuffle bytes=893432121
		Reduce input records=2161807
		Reduce output records=1468676
		Spilled Records=4323614
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=250936
		CPU time spent (ms)=1193660
		Physical memory (bytes) snapshot=321041940480
		Virtual memory (bytes) snapshot=743275356160
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=753969645
	File Output Format Counters 
		Bytes Written=497832490
16/12/10 17:50:07 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100900 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100900
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob6885581331399047015.jar tmpDir=null
16/12/10 18:46:19 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 18:46:19 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 18:46:20 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 18:46:25 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 18:46:25 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 18:46:25 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6635
16/12/10 18:46:26 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6635
16/12/10 18:46:26 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6635/
16/12/10 18:46:26 INFO mapreduce.Job: Running job: job_1480588584072_6635
16/12/10 18:46:40 INFO mapreduce.Job: Job job_1480588584072_6635 running in uber mode : false
16/12/10 18:46:40 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 18:47:35 INFO mapreduce.Job:  map 1% reduce 0%
16/12/10 18:47:38 INFO mapreduce.Job:  map 2% reduce 0%
16/12/10 18:47:40 INFO mapreduce.Job:  map 3% reduce 0%
16/12/10 18:47:42 INFO mapreduce.Job:  map 4% reduce 0%
16/12/10 18:47:43 INFO mapreduce.Job:  map 5% reduce 0%
16/12/10 18:47:46 INFO mapreduce.Job:  map 8% reduce 0%
16/12/10 18:47:47 INFO mapreduce.Job:  map 9% reduce 0%
16/12/10 18:47:48 INFO mapreduce.Job:  map 10% reduce 0%
16/12/10 18:47:49 INFO mapreduce.Job:  map 14% reduce 0%
16/12/10 18:47:50 INFO mapreduce.Job:  map 15% reduce 0%
16/12/10 18:47:51 INFO mapreduce.Job:  map 17% reduce 0%
16/12/10 18:47:52 INFO mapreduce.Job:  map 18% reduce 0%
16/12/10 18:47:55 INFO mapreduce.Job:  map 19% reduce 0%
16/12/10 18:48:06 INFO mapreduce.Job:  map 20% reduce 0%
16/12/10 18:48:07 INFO mapreduce.Job:  map 20% reduce 1%
16/12/10 18:48:08 INFO mapreduce.Job:  map 21% reduce 1%
16/12/10 18:48:11 INFO mapreduce.Job:  map 22% reduce 2%
16/12/10 18:48:12 INFO mapreduce.Job:  map 23% reduce 3%
16/12/10 18:48:13 INFO mapreduce.Job:  map 24% reduce 4%
16/12/10 18:48:14 INFO mapreduce.Job:  map 25% reduce 5%
16/12/10 18:48:15 INFO mapreduce.Job:  map 27% reduce 6%
16/12/10 18:48:16 INFO mapreduce.Job:  map 29% reduce 6%
16/12/10 18:48:17 INFO mapreduce.Job:  map 30% reduce 6%
16/12/10 18:48:18 INFO mapreduce.Job:  map 33% reduce 7%
16/12/10 18:48:19 INFO mapreduce.Job:  map 35% reduce 7%
16/12/10 18:48:20 INFO mapreduce.Job:  map 37% reduce 8%
16/12/10 18:48:21 INFO mapreduce.Job:  map 39% reduce 8%
16/12/10 18:48:22 INFO mapreduce.Job:  map 43% reduce 9%
16/12/10 18:48:23 INFO mapreduce.Job:  map 45% reduce 10%
16/12/10 18:48:24 INFO mapreduce.Job:  map 49% reduce 11%
16/12/10 18:48:25 INFO mapreduce.Job:  map 55% reduce 12%
16/12/10 18:48:26 INFO mapreduce.Job:  map 58% reduce 13%
16/12/10 18:48:27 INFO mapreduce.Job:  map 60% reduce 15%
16/12/10 18:48:28 INFO mapreduce.Job:  map 61% reduce 16%
16/12/10 18:48:30 INFO mapreduce.Job:  map 63% reduce 16%
16/12/10 18:48:31 INFO mapreduce.Job:  map 64% reduce 17%
16/12/10 18:48:33 INFO mapreduce.Job:  map 65% reduce 17%
16/12/10 18:48:34 INFO mapreduce.Job:  map 67% reduce 17%
16/12/10 18:48:35 INFO mapreduce.Job:  map 69% reduce 18%
16/12/10 18:48:36 INFO mapreduce.Job:  map 71% reduce 19%
16/12/10 18:48:37 INFO mapreduce.Job:  map 72% reduce 19%
16/12/10 18:48:38 INFO mapreduce.Job:  map 73% reduce 19%
16/12/10 18:48:39 INFO mapreduce.Job:  map 74% reduce 19%
16/12/10 18:48:40 INFO mapreduce.Job:  map 75% reduce 19%
16/12/10 18:48:41 INFO mapreduce.Job:  map 76% reduce 20%
16/12/10 18:48:42 INFO mapreduce.Job:  map 77% reduce 20%
16/12/10 18:48:43 INFO mapreduce.Job:  map 80% reduce 20%
16/12/10 18:48:44 INFO mapreduce.Job:  map 82% reduce 22%
16/12/10 18:48:45 INFO mapreduce.Job:  map 84% reduce 23%
16/12/10 18:48:46 INFO mapreduce.Job:  map 87% reduce 24%
16/12/10 18:48:47 INFO mapreduce.Job:  map 89% reduce 25%
16/12/10 18:48:48 INFO mapreduce.Job:  map 90% reduce 25%
16/12/10 18:48:49 INFO mapreduce.Job:  map 91% reduce 26%
16/12/10 18:48:50 INFO mapreduce.Job:  map 91% reduce 28%
16/12/10 18:48:51 INFO mapreduce.Job:  map 92% reduce 28%
16/12/10 18:48:53 INFO mapreduce.Job:  map 93% reduce 28%
16/12/10 18:48:56 INFO mapreduce.Job:  map 94% reduce 28%
16/12/10 18:48:58 INFO mapreduce.Job:  map 95% reduce 28%
16/12/10 18:48:59 INFO mapreduce.Job:  map 96% reduce 28%
16/12/10 18:49:00 INFO mapreduce.Job:  map 96% reduce 29%
16/12/10 18:49:01 INFO mapreduce.Job:  map 97% reduce 29%
16/12/10 18:49:02 INFO mapreduce.Job:  map 98% reduce 30%
16/12/10 18:49:03 INFO mapreduce.Job:  map 99% reduce 31%
16/12/10 18:49:05 INFO mapreduce.Job:  map 100% reduce 32%
16/12/10 18:49:06 INFO mapreduce.Job:  map 100% reduce 33%
16/12/10 18:49:08 INFO mapreduce.Job:  map 100% reduce 35%
16/12/10 18:49:09 INFO mapreduce.Job:  map 100% reduce 39%
16/12/10 18:49:10 INFO mapreduce.Job:  map 100% reduce 42%
16/12/10 18:49:11 INFO mapreduce.Job:  map 100% reduce 56%
16/12/10 18:49:12 INFO mapreduce.Job:  map 100% reduce 61%
16/12/10 18:49:13 INFO mapreduce.Job:  map 100% reduce 66%
16/12/10 18:49:14 INFO mapreduce.Job:  map 100% reduce 70%
16/12/10 18:49:15 INFO mapreduce.Job:  map 100% reduce 74%
16/12/10 18:49:16 INFO mapreduce.Job:  map 100% reduce 75%
16/12/10 18:49:18 INFO mapreduce.Job:  map 100% reduce 77%
16/12/10 18:49:19 INFO mapreduce.Job:  map 100% reduce 79%
16/12/10 18:49:20 INFO mapreduce.Job:  map 100% reduce 80%
16/12/10 18:49:21 INFO mapreduce.Job:  map 100% reduce 82%
16/12/10 18:49:23 INFO mapreduce.Job:  map 100% reduce 85%
16/12/10 18:49:24 INFO mapreduce.Job:  map 100% reduce 86%
16/12/10 18:49:25 INFO mapreduce.Job:  map 100% reduce 87%
16/12/10 18:49:26 INFO mapreduce.Job:  map 100% reduce 89%
16/12/10 18:49:27 INFO mapreduce.Job:  map 100% reduce 91%
16/12/10 18:49:29 INFO mapreduce.Job:  map 100% reduce 94%
16/12/10 18:49:30 INFO mapreduce.Job:  map 100% reduce 96%
16/12/10 18:49:31 INFO mapreduce.Job:  map 100% reduce 97%
16/12/10 18:49:32 INFO mapreduce.Job:  map 100% reduce 98%
16/12/10 18:49:33 INFO mapreduce.Job:  map 100% reduce 99%
16/12/10 18:49:34 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 18:49:41 INFO mapreduce.Job: Job job_1480588584072_6635 completed successfully
16/12/10 18:49:42 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=933815483
		FILE: Number of bytes written=1900012931
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=791336375
		WASB: Number of bytes written=527580873
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=39278306
		Total time spent by all reduces in occupied slots (ms)=3864698
		Total time spent by all map tasks (ms)=19639153
		Total time spent by all reduce tasks (ms)=1932349
		Total vcore-seconds taken by all map tasks=19639153
		Total vcore-seconds taken by all reduce tasks=1932349
		Total megabyte-seconds taken by all map tasks=20110492672
		Total megabyte-seconds taken by all reduce tasks=1978725376
	Map-Reduce Framework
		Map input records=2505542
		Map output records=2253399
		Map output bytes=925127674
		Map output materialized bytes=933839003
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1990240
		Reduce shuffle bytes=933839003
		Reduce input records=2253399
		Reduce output records=1550084
		Spilled Records=4506798
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=201226
		CPU time spent (ms)=1077290
		Physical memory (bytes) snapshot=324120592384
		Virtual memory (bytes) snapshot=742991331328
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=788640371
	File Output Format Counters 
		Bytes Written=527580873
16/12/10 18:49:42 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1400 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1400': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob69009928563423130.jar tmpDir=null
16/12/10 19:45:55 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 19:45:56 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 19:45:57 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 19:46:00 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 19:46:00 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 19:46:01 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6646
16/12/10 19:46:02 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6646
16/12/10 19:46:02 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6646/
16/12/10 19:46:02 INFO mapreduce.Job: Running job: job_1480588584072_6646
16/12/10 19:46:17 INFO mapreduce.Job: Job job_1480588584072_6646 running in uber mode : false
16/12/10 19:46:17 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 19:47:20 INFO mapreduce.Job:  map 1% reduce 0%
16/12/10 19:47:27 INFO mapreduce.Job:  map 2% reduce 0%
16/12/10 19:47:29 INFO mapreduce.Job:  map 4% reduce 0%
16/12/10 19:47:30 INFO mapreduce.Job:  map 5% reduce 0%
16/12/10 19:47:32 INFO mapreduce.Job:  map 6% reduce 0%
16/12/10 19:47:33 INFO mapreduce.Job:  map 7% reduce 0%
16/12/10 19:47:34 INFO mapreduce.Job:  map 9% reduce 0%
16/12/10 19:47:36 INFO mapreduce.Job:  map 10% reduce 0%
16/12/10 19:47:37 INFO mapreduce.Job:  map 12% reduce 0%
16/12/10 19:47:38 INFO mapreduce.Job:  map 14% reduce 0%
16/12/10 19:47:39 INFO mapreduce.Job:  map 15% reduce 0%
16/12/10 19:47:41 INFO mapreduce.Job:  map 16% reduce 0%
16/12/10 19:47:45 INFO mapreduce.Job:  map 17% reduce 0%
16/12/10 19:47:46 INFO mapreduce.Job:  map 17% reduce 1%
16/12/10 19:47:47 INFO mapreduce.Job:  map 18% reduce 1%
16/12/10 19:47:50 INFO mapreduce.Job:  map 19% reduce 1%
16/12/10 19:47:51 INFO mapreduce.Job:  map 20% reduce 1%
16/12/10 19:47:52 INFO mapreduce.Job:  map 21% reduce 1%
16/12/10 19:47:54 INFO mapreduce.Job:  map 22% reduce 1%
16/12/10 19:47:55 INFO mapreduce.Job:  map 23% reduce 2%
16/12/10 19:47:56 INFO mapreduce.Job:  map 24% reduce 2%
16/12/10 19:47:57 INFO mapreduce.Job:  map 26% reduce 2%
16/12/10 19:47:58 INFO mapreduce.Job:  map 28% reduce 3%
16/12/10 19:47:59 INFO mapreduce.Job:  map 30% reduce 4%
16/12/10 19:48:00 INFO mapreduce.Job:  map 33% reduce 4%
16/12/10 19:48:01 INFO mapreduce.Job:  map 35% reduce 7%
16/12/10 19:48:02 INFO mapreduce.Job:  map 38% reduce 9%
16/12/10 19:48:03 INFO mapreduce.Job:  map 40% reduce 9%
16/12/10 19:48:04 INFO mapreduce.Job:  map 41% reduce 11%
16/12/10 19:48:05 INFO mapreduce.Job:  map 45% reduce 12%
16/12/10 19:48:06 INFO mapreduce.Job:  map 49% reduce 12%
16/12/10 19:48:07 INFO mapreduce.Job:  map 53% reduce 14%
16/12/10 19:48:08 INFO mapreduce.Job:  map 56% reduce 15%
16/12/10 19:48:09 INFO mapreduce.Job:  map 58% reduce 15%
16/12/10 19:48:10 INFO mapreduce.Job:  map 59% reduce 16%
16/12/10 19:48:11 INFO mapreduce.Job:  map 62% reduce 17%
16/12/10 19:48:12 INFO mapreduce.Job:  map 66% reduce 17%
16/12/10 19:48:13 INFO mapreduce.Job:  map 68% reduce 19%
16/12/10 19:48:14 INFO mapreduce.Job:  map 70% reduce 19%
16/12/10 19:48:15 INFO mapreduce.Job:  map 70% reduce 20%
16/12/10 19:48:16 INFO mapreduce.Job:  map 71% reduce 21%
16/12/10 19:48:17 INFO mapreduce.Job:  map 72% reduce 21%
16/12/10 19:48:18 INFO mapreduce.Job:  map 73% reduce 21%
16/12/10 19:48:19 INFO mapreduce.Job:  map 75% reduce 22%
16/12/10 19:48:20 INFO mapreduce.Job:  map 76% reduce 22%
16/12/10 19:48:21 INFO mapreduce.Job:  map 77% reduce 23%
16/12/10 19:48:22 INFO mapreduce.Job:  map 81% reduce 23%
16/12/10 19:48:23 INFO mapreduce.Job:  map 84% reduce 24%
16/12/10 19:48:25 INFO mapreduce.Job:  map 85% reduce 25%
16/12/10 19:48:26 INFO mapreduce.Job:  map 85% reduce 26%
16/12/10 19:48:27 INFO mapreduce.Job:  map 86% reduce 26%
16/12/10 19:48:28 INFO mapreduce.Job:  map 87% reduce 26%
16/12/10 19:48:29 INFO mapreduce.Job:  map 88% reduce 26%
16/12/10 19:48:30 INFO mapreduce.Job:  map 89% reduce 26%
16/12/10 19:48:31 INFO mapreduce.Job:  map 89% reduce 27%
16/12/10 19:48:32 INFO mapreduce.Job:  map 90% reduce 28%
16/12/10 19:48:33 INFO mapreduce.Job:  map 91% reduce 29%
16/12/10 19:48:34 INFO mapreduce.Job:  map 93% reduce 29%
16/12/10 19:48:35 INFO mapreduce.Job:  map 95% reduce 30%
16/12/10 19:48:36 INFO mapreduce.Job:  map 97% reduce 30%
16/12/10 19:48:37 INFO mapreduce.Job:  map 98% reduce 31%
16/12/10 19:48:38 INFO mapreduce.Job:  map 98% reduce 32%
16/12/10 19:48:40 INFO mapreduce.Job:  map 99% reduce 33%
16/12/10 19:48:41 INFO mapreduce.Job:  map 100% reduce 33%
16/12/10 19:48:43 INFO mapreduce.Job:  map 100% reduce 37%
16/12/10 19:48:44 INFO mapreduce.Job:  map 100% reduce 42%
16/12/10 19:48:45 INFO mapreduce.Job:  map 100% reduce 46%
16/12/10 19:48:46 INFO mapreduce.Job:  map 100% reduce 50%
16/12/10 19:48:47 INFO mapreduce.Job:  map 100% reduce 57%
16/12/10 19:48:48 INFO mapreduce.Job:  map 100% reduce 68%
16/12/10 19:48:49 INFO mapreduce.Job:  map 100% reduce 71%
16/12/10 19:48:51 INFO mapreduce.Job:  map 100% reduce 75%
16/12/10 19:48:52 INFO mapreduce.Job:  map 100% reduce 77%
16/12/10 19:48:54 INFO mapreduce.Job:  map 100% reduce 78%
16/12/10 19:48:55 INFO mapreduce.Job:  map 100% reduce 80%
16/12/10 19:48:58 INFO mapreduce.Job:  map 100% reduce 84%
16/12/10 19:48:59 INFO mapreduce.Job:  map 100% reduce 85%
16/12/10 19:49:01 INFO mapreduce.Job:  map 100% reduce 87%
16/12/10 19:49:02 INFO mapreduce.Job:  map 100% reduce 89%
16/12/10 19:49:03 INFO mapreduce.Job:  map 100% reduce 90%
16/12/10 19:49:04 INFO mapreduce.Job:  map 100% reduce 91%
16/12/10 19:49:05 INFO mapreduce.Job:  map 100% reduce 94%
16/12/10 19:49:06 INFO mapreduce.Job:  map 100% reduce 95%
16/12/10 19:49:07 INFO mapreduce.Job:  map 100% reduce 96%
16/12/10 19:49:08 INFO mapreduce.Job:  map 100% reduce 98%
16/12/10 19:49:09 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 19:49:17 INFO mapreduce.Job: Job job_1480588584072_6646 completed successfully
16/12/10 19:49:17 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=932466069
		FILE: Number of bytes written=1897314103
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=788909225
		WASB: Number of bytes written=523052052
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=42324050
		Total time spent by all reduces in occupied slots (ms)=3512488
		Total time spent by all map tasks (ms)=21162025
		Total time spent by all reduce tasks (ms)=1756244
		Total vcore-seconds taken by all map tasks=21162025
		Total vcore-seconds taken by all reduce tasks=1756244
		Total megabyte-seconds taken by all map tasks=21669913600
		Total megabyte-seconds taken by all reduce tasks=1798393856
	Map-Reduce Framework
		Map input records=2497105
		Map output records=2250298
		Map output bytes=923781004
		Map output materialized bytes=932489589
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1983789
		Reduce shuffle bytes=932489589
		Reduce input records=2250298
		Reduce output records=1536098
		Spilled Records=4500596
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=170200
		CPU time spent (ms)=1086250
		Physical memory (bytes) snapshot=324331311104
		Virtual memory (bytes) snapshot=743529684992
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=786213221
	File Output Format Counters 
		Bytes Written=523052052
16/12/10 19:49:17 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1400
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18.done
16/12/10 19:49:33 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1500 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1500': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5070705137145093942.jar tmpDir=null
16/12/10 20:45:27 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 20:45:28 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 20:45:29 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 20:45:34 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 20:45:34 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 20:45:34 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6650
16/12/10 20:45:35 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6650
16/12/10 20:45:35 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6650/
16/12/10 20:45:35 INFO mapreduce.Job: Running job: job_1480588584072_6650
16/12/10 20:45:48 INFO mapreduce.Job: Job job_1480588584072_6650 running in uber mode : false
16/12/10 20:45:48 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 20:47:02 INFO mapreduce.Job:  map 1% reduce 0%
16/12/10 20:47:07 INFO mapreduce.Job:  map 2% reduce 0%
16/12/10 20:47:08 INFO mapreduce.Job:  map 4% reduce 0%
16/12/10 20:47:32 INFO mapreduce.Job:  map 7% reduce 0%
16/12/10 20:47:41 INFO mapreduce.Job:  map 8% reduce 0%
16/12/10 20:47:44 INFO mapreduce.Job:  map 12% reduce 0%
16/12/10 20:47:45 INFO mapreduce.Job:  map 19% reduce 0%
16/12/10 20:47:47 INFO mapreduce.Job:  map 24% reduce 0%
16/12/10 20:47:48 INFO mapreduce.Job:  map 26% reduce 0%
16/12/10 20:47:52 INFO mapreduce.Job:  map 28% reduce 0%
16/12/10 20:47:57 INFO mapreduce.Job:  map 29% reduce 0%
16/12/10 20:47:58 INFO mapreduce.Job:  map 34% reduce 0%
16/12/10 20:47:59 INFO mapreduce.Job:  map 38% reduce 0%
16/12/10 20:48:01 INFO mapreduce.Job:  map 44% reduce 0%
16/12/10 20:48:02 INFO mapreduce.Job:  map 48% reduce 0%
16/12/10 20:48:03 INFO mapreduce.Job:  map 56% reduce 0%
16/12/10 20:48:15 INFO mapreduce.Job:  map 64% reduce 0%
16/12/10 20:48:15 INFO mapreduce.Job: Task Id : attempt_1480588584072_6650_m_000140_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 20:48:15 INFO mapreduce.Job: Task Id : attempt_1480588584072_6650_m_000119_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/10 20:48:16 INFO mapreduce.Job:  map 94% reduce 0%
16/12/10 20:48:19 INFO mapreduce.Job:  map 95% reduce 0%
16/12/10 20:48:20 INFO mapreduce.Job:  map 96% reduce 0%
16/12/10 20:48:24 INFO mapreduce.Job:  map 97% reduce 0%
16/12/10 20:48:25 INFO mapreduce.Job:  map 98% reduce 0%
16/12/10 20:48:26 INFO mapreduce.Job:  map 99% reduce 0%
16/12/10 20:48:27 INFO mapreduce.Job:  map 100% reduce 2%
16/12/10 20:48:28 INFO mapreduce.Job:  map 100% reduce 8%
16/12/10 20:48:31 INFO mapreduce.Job:  map 100% reduce 21%
16/12/10 20:48:32 INFO mapreduce.Job:  map 100% reduce 28%
16/12/10 20:48:33 INFO mapreduce.Job:  map 100% reduce 36%
16/12/10 20:48:34 INFO mapreduce.Job:  map 100% reduce 49%
16/12/10 20:48:35 INFO mapreduce.Job:  map 100% reduce 75%
16/12/10 20:48:36 INFO mapreduce.Job:  map 100% reduce 81%
16/12/10 20:48:37 INFO mapreduce.Job:  map 100% reduce 88%
16/12/10 20:48:38 INFO mapreduce.Job:  map 100% reduce 93%
16/12/10 20:48:39 INFO mapreduce.Job:  map 100% reduce 95%
16/12/10 20:48:41 INFO mapreduce.Job:  map 100% reduce 99%
16/12/10 20:48:42 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 20:48:51 INFO mapreduce.Job: Job job_1480588584072_6650 completed successfully
16/12/10 20:48:51 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=803860988
		FILE: Number of bytes written=1640103941
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=682583376
		WASB: Number of bytes written=418940172
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=2
		Launched map tasks=199
		Launched reduce tasks=20
		Other local map tasks=2
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=54328186
		Total time spent by all reduces in occupied slots (ms)=819042
		Total time spent by all map tasks (ms)=27164093
		Total time spent by all reduce tasks (ms)=409521
		Total vcore-seconds taken by all map tasks=27164093
		Total vcore-seconds taken by all reduce tasks=409521
		Total megabyte-seconds taken by all map tasks=27816031232
		Total megabyte-seconds taken by all reduce tasks=419349504
	Map-Reduce Framework
		Map input records=2179442
		Map output records=1948388
		Map output bytes=796334478
		Map output materialized bytes=803884508
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1702515
		Reduce shuffle bytes=803884508
		Reduce input records=1948388
		Reduce output records=1231641
		Spilled Records=3896776
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=232560
		CPU time spent (ms)=1194970
		Physical memory (bytes) snapshot=312792829952
		Virtual memory (bytes) snapshot=743381995520
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=679887372
	File Output Format Counters 
		Bytes Written=418940172
16/12/10 20:48:51 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1500
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1600 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1600': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob6826060726461596880.jar tmpDir=null
16/12/10 21:45:02 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 21:45:03 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 21:45:03 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 21:45:07 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 21:45:07 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 21:45:07 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6655
16/12/10 21:45:10 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6655
16/12/10 21:45:10 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6655/
16/12/10 21:45:10 INFO mapreduce.Job: Running job: job_1480588584072_6655
16/12/10 21:45:23 INFO mapreduce.Job: Job job_1480588584072_6655 running in uber mode : false
16/12/10 21:45:23 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 21:46:22 INFO mapreduce.Job:  map 1% reduce 0%
16/12/10 21:46:28 INFO mapreduce.Job:  map 2% reduce 0%
16/12/10 21:46:30 INFO mapreduce.Job:  map 3% reduce 0%
16/12/10 21:46:34 INFO mapreduce.Job:  map 4% reduce 0%
16/12/10 21:46:35 INFO mapreduce.Job:  map 5% reduce 0%
16/12/10 21:46:37 INFO mapreduce.Job:  map 6% reduce 0%
16/12/10 21:46:39 INFO mapreduce.Job:  map 7% reduce 0%
16/12/10 21:46:40 INFO mapreduce.Job:  map 8% reduce 0%
16/12/10 21:46:41 INFO mapreduce.Job:  map 9% reduce 0%
16/12/10 21:46:43 INFO mapreduce.Job:  map 11% reduce 0%
16/12/10 21:46:44 INFO mapreduce.Job:  map 12% reduce 0%
16/12/10 21:46:45 INFO mapreduce.Job:  map 13% reduce 0%
16/12/10 21:46:47 INFO mapreduce.Job:  map 14% reduce 0%
16/12/10 21:46:48 INFO mapreduce.Job:  map 15% reduce 0%
16/12/10 21:46:49 INFO mapreduce.Job:  map 16% reduce 0%
16/12/10 21:46:51 INFO mapreduce.Job:  map 17% reduce 0%
16/12/10 21:46:53 INFO mapreduce.Job:  map 18% reduce 0%
16/12/10 21:46:54 INFO mapreduce.Job:  map 19% reduce 0%
16/12/10 21:46:55 INFO mapreduce.Job:  map 20% reduce 0%
16/12/10 21:46:57 INFO mapreduce.Job:  map 24% reduce 0%
16/12/10 21:46:58 INFO mapreduce.Job:  map 25% reduce 0%
16/12/10 21:47:00 INFO mapreduce.Job:  map 27% reduce 0%
16/12/10 21:47:01 INFO mapreduce.Job:  map 29% reduce 0%
16/12/10 21:47:02 INFO mapreduce.Job:  map 32% reduce 0%
16/12/10 21:47:03 INFO mapreduce.Job:  map 35% reduce 0%
16/12/10 21:47:04 INFO mapreduce.Job:  map 38% reduce 2%
16/12/10 21:47:05 INFO mapreduce.Job:  map 41% reduce 2%
16/12/10 21:47:06 INFO mapreduce.Job:  map 44% reduce 2%
16/12/10 21:47:07 INFO mapreduce.Job:  map 48% reduce 3%
16/12/10 21:47:08 INFO mapreduce.Job:  map 50% reduce 3%
16/12/10 21:47:09 INFO mapreduce.Job:  map 51% reduce 5%
16/12/10 21:47:10 INFO mapreduce.Job:  map 53% reduce 7%
16/12/10 21:47:11 INFO mapreduce.Job:  map 56% reduce 9%
16/12/10 21:47:12 INFO mapreduce.Job:  map 57% reduce 14%
16/12/10 21:47:13 INFO mapreduce.Job:  map 59% reduce 15%
16/12/10 21:47:14 INFO mapreduce.Job:  map 60% reduce 18%
16/12/10 21:47:15 INFO mapreduce.Job:  map 61% reduce 19%
16/12/10 21:47:16 INFO mapreduce.Job:  map 62% reduce 19%
16/12/10 21:47:17 INFO mapreduce.Job:  map 63% reduce 19%
16/12/10 21:47:18 INFO mapreduce.Job:  map 64% reduce 20%
16/12/10 21:47:19 INFO mapreduce.Job:  map 66% reduce 20%
16/12/10 21:47:20 INFO mapreduce.Job:  map 67% reduce 20%
16/12/10 21:47:21 INFO mapreduce.Job:  map 68% reduce 21%
16/12/10 21:47:22 INFO mapreduce.Job:  map 70% reduce 21%
16/12/10 21:47:23 INFO mapreduce.Job:  map 72% reduce 22%
16/12/10 21:47:24 INFO mapreduce.Job:  map 73% reduce 22%
16/12/10 21:47:25 INFO mapreduce.Job:  map 76% reduce 23%
16/12/10 21:47:26 INFO mapreduce.Job:  map 79% reduce 23%
16/12/10 21:47:27 INFO mapreduce.Job:  map 79% reduce 24%
16/12/10 21:47:28 INFO mapreduce.Job:  map 80% reduce 25%
16/12/10 21:47:29 INFO mapreduce.Job:  map 80% reduce 26%
16/12/10 21:47:30 INFO mapreduce.Job:  map 81% reduce 26%
16/12/10 21:47:32 INFO mapreduce.Job:  map 82% reduce 26%
16/12/10 21:47:33 INFO mapreduce.Job:  map 83% reduce 26%
16/12/10 21:47:34 INFO mapreduce.Job:  map 85% reduce 27%
16/12/10 21:47:35 INFO mapreduce.Job:  map 86% reduce 27%
16/12/10 21:47:36 INFO mapreduce.Job:  map 88% reduce 27%
16/12/10 21:47:37 INFO mapreduce.Job:  map 89% reduce 28%
16/12/10 21:47:39 INFO mapreduce.Job:  map 91% reduce 28%
16/12/10 21:47:40 INFO mapreduce.Job:  map 93% reduce 29%
16/12/10 21:47:41 INFO mapreduce.Job:  map 94% reduce 29%
16/12/10 21:47:42 INFO mapreduce.Job:  map 97% reduce 30%
16/12/10 21:47:44 INFO mapreduce.Job:  map 99% reduce 31%
16/12/10 21:47:45 INFO mapreduce.Job:  map 100% reduce 32%
16/12/10 21:47:46 INFO mapreduce.Job:  map 100% reduce 33%
16/12/10 21:47:47 INFO mapreduce.Job:  map 100% reduce 37%
16/12/10 21:47:48 INFO mapreduce.Job:  map 100% reduce 41%
16/12/10 21:47:49 INFO mapreduce.Job:  map 100% reduce 49%
16/12/10 21:47:50 INFO mapreduce.Job:  map 100% reduce 54%
16/12/10 21:47:51 INFO mapreduce.Job:  map 100% reduce 65%
16/12/10 21:47:52 INFO mapreduce.Job:  map 100% reduce 69%
16/12/10 21:47:53 INFO mapreduce.Job:  map 100% reduce 76%
16/12/10 21:47:54 INFO mapreduce.Job:  map 100% reduce 78%
16/12/10 21:47:55 INFO mapreduce.Job:  map 100% reduce 79%
16/12/10 21:47:56 INFO mapreduce.Job:  map 100% reduce 82%
16/12/10 21:47:57 INFO mapreduce.Job:  map 100% reduce 84%
16/12/10 21:47:58 INFO mapreduce.Job:  map 100% reduce 87%
16/12/10 21:47:59 INFO mapreduce.Job:  map 100% reduce 89%
16/12/10 21:48:01 INFO mapreduce.Job:  map 100% reduce 90%
16/12/10 21:48:02 INFO mapreduce.Job:  map 100% reduce 95%
16/12/10 21:48:03 INFO mapreduce.Job:  map 100% reduce 96%
16/12/10 21:48:05 INFO mapreduce.Job:  map 100% reduce 97%
16/12/10 21:48:06 INFO mapreduce.Job:  map 100% reduce 98%
16/12/10 21:48:08 INFO mapreduce.Job:  map 100% reduce 99%
16/12/10 21:48:11 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 21:48:18 INFO mapreduce.Job: Job job_1480588584072_6655 completed successfully
16/12/10 21:48:19 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=852387676
		FILE: Number of bytes written=1737157317
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=724119839
		WASB: Number of bytes written=448111465
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=37451582
		Total time spent by all reduces in occupied slots (ms)=2905466
		Total time spent by all map tasks (ms)=18725791
		Total time spent by all reduce tasks (ms)=1452733
		Total vcore-seconds taken by all map tasks=18725791
		Total vcore-seconds taken by all reduce tasks=1452733
		Total megabyte-seconds taken by all map tasks=19175209984
		Total megabyte-seconds taken by all reduce tasks=1487598592
	Map-Reduce Framework
		Map input records=2311224
		Map output records=2064855
		Map output bytes=844415632
		Map output materialized bytes=852411196
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1809066
		Reduce shuffle bytes=852411196
		Reduce input records=2064855
		Reduce output records=1315949
		Spilled Records=4129710
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=173816
		CPU time spent (ms)=1006090
		Physical memory (bytes) snapshot=324866146304
		Virtual memory (bytes) snapshot=742801362944
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=721423835
	File Output Format Counters 
		Bytes Written=448111465
16/12/10 21:48:19 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1600
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1700 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612100900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1700': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5003795277460234796.jar tmpDir=null
16/12/10 22:44:27 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 22:44:28 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 22:44:28 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 22:44:32 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 22:44:33 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 22:44:33 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6659
16/12/10 22:44:34 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6659
16/12/10 22:44:34 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6659/
16/12/10 22:44:34 INFO mapreduce.Job: Running job: job_1480588584072_6659
16/12/10 22:44:49 INFO mapreduce.Job: Job job_1480588584072_6659 running in uber mode : false
16/12/10 22:44:49 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 22:45:51 INFO mapreduce.Job:  map 1% reduce 0%
16/12/10 22:45:57 INFO mapreduce.Job:  map 3% reduce 0%
16/12/10 22:46:05 INFO mapreduce.Job:  map 4% reduce 0%
16/12/10 22:46:06 INFO mapreduce.Job:  map 5% reduce 0%
16/12/10 22:46:08 INFO mapreduce.Job:  map 6% reduce 0%
16/12/10 22:46:09 INFO mapreduce.Job:  map 7% reduce 0%
16/12/10 22:46:11 INFO mapreduce.Job:  map 11% reduce 0%
16/12/10 22:46:12 INFO mapreduce.Job:  map 12% reduce 0%
16/12/10 22:46:16 INFO mapreduce.Job:  map 13% reduce 0%
16/12/10 22:46:18 INFO mapreduce.Job:  map 15% reduce 0%
16/12/10 22:46:19 INFO mapreduce.Job:  map 16% reduce 0%
16/12/10 22:46:20 INFO mapreduce.Job:  map 18% reduce 0%
16/12/10 22:46:21 INFO mapreduce.Job:  map 20% reduce 0%
16/12/10 22:46:22 INFO mapreduce.Job:  map 21% reduce 0%
16/12/10 22:46:23 INFO mapreduce.Job:  map 25% reduce 0%
16/12/10 22:46:24 INFO mapreduce.Job:  map 27% reduce 0%
16/12/10 22:46:25 INFO mapreduce.Job:  map 28% reduce 0%
16/12/10 22:46:27 INFO mapreduce.Job:  map 29% reduce 0%
16/12/10 22:46:28 INFO mapreduce.Job:  map 32% reduce 0%
16/12/10 22:46:30 INFO mapreduce.Job:  map 34% reduce 0%
16/12/10 22:46:31 INFO mapreduce.Job:  map 37% reduce 0%
16/12/10 22:46:32 INFO mapreduce.Job:  map 41% reduce 0%
16/12/10 22:46:33 INFO mapreduce.Job:  map 43% reduce 0%
16/12/10 22:46:34 INFO mapreduce.Job:  map 45% reduce 0%
16/12/10 22:46:35 INFO mapreduce.Job:  map 49% reduce 0%
16/12/10 22:46:36 INFO mapreduce.Job:  map 53% reduce 0%
16/12/10 22:46:38 INFO mapreduce.Job:  map 57% reduce 0%
16/12/10 22:46:39 INFO mapreduce.Job:  map 64% reduce 0%
16/12/10 22:46:40 INFO mapreduce.Job:  map 67% reduce 0%
16/12/10 22:46:41 INFO mapreduce.Job:  map 71% reduce 0%
16/12/10 22:46:43 INFO mapreduce.Job:  map 74% reduce 2%
16/12/10 22:46:44 INFO mapreduce.Job:  map 76% reduce 2%
16/12/10 22:46:45 INFO mapreduce.Job:  map 77% reduce 6%
16/12/10 22:46:46 INFO mapreduce.Job:  map 79% reduce 11%
16/12/10 22:46:47 INFO mapreduce.Job:  map 81% reduce 21%
16/12/10 22:46:48 INFO mapreduce.Job:  map 84% reduce 23%
16/12/10 22:46:49 INFO mapreduce.Job:  map 87% reduce 23%
16/12/10 22:46:50 INFO mapreduce.Job:  map 89% reduce 25%
16/12/10 22:46:51 INFO mapreduce.Job:  map 90% reduce 25%
16/12/10 22:46:52 INFO mapreduce.Job:  map 92% reduce 26%
16/12/10 22:46:53 INFO mapreduce.Job:  map 94% reduce 27%
16/12/10 22:46:54 INFO mapreduce.Job:  map 95% reduce 27%
16/12/10 22:46:55 INFO mapreduce.Job:  map 96% reduce 28%
16/12/10 22:46:56 INFO mapreduce.Job:  map 98% reduce 28%
16/12/10 22:46:57 INFO mapreduce.Job:  map 99% reduce 30%
16/12/10 22:46:58 INFO mapreduce.Job:  map 99% reduce 31%
16/12/10 22:47:00 INFO mapreduce.Job:  map 100% reduce 31%
16/12/10 22:47:01 INFO mapreduce.Job:  map 100% reduce 33%
16/12/10 22:47:02 INFO mapreduce.Job:  map 100% reduce 41%
16/12/10 22:47:03 INFO mapreduce.Job:  map 100% reduce 50%
16/12/10 22:47:04 INFO mapreduce.Job:  map 100% reduce 56%
16/12/10 22:47:05 INFO mapreduce.Job:  map 100% reduce 60%
16/12/10 22:47:06 INFO mapreduce.Job:  map 100% reduce 68%
16/12/10 22:47:08 INFO mapreduce.Job:  map 100% reduce 71%
16/12/10 22:47:09 INFO mapreduce.Job:  map 100% reduce 74%
16/12/10 22:47:10 INFO mapreduce.Job:  map 100% reduce 77%
16/12/10 22:47:11 INFO mapreduce.Job:  map 100% reduce 79%
16/12/10 22:47:12 INFO mapreduce.Job:  map 100% reduce 80%
16/12/10 22:47:13 INFO mapreduce.Job:  map 100% reduce 81%
16/12/10 22:47:14 INFO mapreduce.Job:  map 100% reduce 82%
16/12/10 22:47:15 INFO mapreduce.Job:  map 100% reduce 84%
16/12/10 22:47:16 INFO mapreduce.Job:  map 100% reduce 85%
16/12/10 22:47:17 INFO mapreduce.Job:  map 100% reduce 87%
16/12/10 22:47:18 INFO mapreduce.Job:  map 100% reduce 88%
16/12/10 22:47:19 INFO mapreduce.Job:  map 100% reduce 90%
16/12/10 22:47:20 INFO mapreduce.Job:  map 100% reduce 91%
16/12/10 22:47:21 INFO mapreduce.Job:  map 100% reduce 93%
16/12/10 22:47:22 INFO mapreduce.Job:  map 100% reduce 95%
16/12/10 22:47:23 INFO mapreduce.Job:  map 100% reduce 97%
16/12/10 22:47:24 INFO mapreduce.Job:  map 100% reduce 98%
16/12/10 22:47:25 INFO mapreduce.Job:  map 100% reduce 99%
16/12/10 22:47:26 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 22:47:36 INFO mapreduce.Job: Job job_1480588584072_6659 completed successfully
16/12/10 22:47:37 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=935458174
		FILE: Number of bytes written=1903298313
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=791330294
		WASB: Number of bytes written=502026726
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=37329540
		Total time spent by all reduces in occupied slots (ms)=2316310
		Total time spent by all map tasks (ms)=18664770
		Total time spent by all reduce tasks (ms)=1158155
		Total vcore-seconds taken by all map tasks=18664770
		Total vcore-seconds taken by all reduce tasks=1158155
		Total megabyte-seconds taken by all map tasks=19112724480
		Total megabyte-seconds taken by all reduce tasks=1185950720
	Map-Reduce Framework
		Map input records=2524193
		Map output records=2267072
		Map output bytes=926716020
		Map output materialized bytes=935481694
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1989023
		Reduce shuffle bytes=935481694
		Reduce input records=2267072
		Reduce output records=1477975
		Spilled Records=4534144
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=173826
		CPU time spent (ms)=1035200
		Physical memory (bytes) snapshot=322851438592
		Virtual memory (bytes) snapshot=743396466688
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=788634290
	File Output Format Counters 
		Bytes Written=502026726
16/12/10 22:47:37 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1700
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101400 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1800 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101400
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1800': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8541799288297189176.jar tmpDir=null
16/12/10 23:43:48 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 23:43:48 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/10 23:43:49 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/10 23:43:51 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/10 23:43:51 INFO mapreduce.JobSubmitter: number of splits:197
16/12/10 23:43:52 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6664
16/12/10 23:43:52 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6664
16/12/10 23:43:52 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6664/
16/12/10 23:43:52 INFO mapreduce.Job: Running job: job_1480588584072_6664
16/12/10 23:44:08 INFO mapreduce.Job: Job job_1480588584072_6664 running in uber mode : false
16/12/10 23:44:08 INFO mapreduce.Job:  map 0% reduce 0%
16/12/10 23:45:04 INFO mapreduce.Job:  map 1% reduce 0%
16/12/10 23:45:08 INFO mapreduce.Job:  map 2% reduce 0%
16/12/10 23:45:09 INFO mapreduce.Job:  map 3% reduce 0%
16/12/10 23:45:10 INFO mapreduce.Job:  map 4% reduce 0%
16/12/10 23:45:11 INFO mapreduce.Job:  map 5% reduce 0%
16/12/10 23:45:12 INFO mapreduce.Job:  map 6% reduce 0%
16/12/10 23:45:13 INFO mapreduce.Job:  map 7% reduce 0%
16/12/10 23:45:14 INFO mapreduce.Job:  map 10% reduce 0%
16/12/10 23:45:16 INFO mapreduce.Job:  map 12% reduce 0%
16/12/10 23:45:17 INFO mapreduce.Job:  map 14% reduce 0%
16/12/10 23:45:18 INFO mapreduce.Job:  map 17% reduce 0%
16/12/10 23:45:23 INFO mapreduce.Job:  map 18% reduce 0%
16/12/10 23:45:28 INFO mapreduce.Job:  map 19% reduce 0%
16/12/10 23:45:29 INFO mapreduce.Job:  map 20% reduce 0%
16/12/10 23:45:33 INFO mapreduce.Job:  map 24% reduce 0%
16/12/10 23:45:34 INFO mapreduce.Job:  map 24% reduce 1%
16/12/10 23:45:35 INFO mapreduce.Job:  map 25% reduce 1%
16/12/10 23:45:36 INFO mapreduce.Job:  map 30% reduce 1%
16/12/10 23:45:37 INFO mapreduce.Job:  map 33% reduce 1%
16/12/10 23:45:38 INFO mapreduce.Job:  map 35% reduce 1%
16/12/10 23:45:40 INFO mapreduce.Job:  map 36% reduce 2%
16/12/10 23:45:41 INFO mapreduce.Job:  map 36% reduce 5%
16/12/10 23:45:42 INFO mapreduce.Job:  map 37% reduce 8%
16/12/10 23:45:43 INFO mapreduce.Job:  map 38% reduce 9%
16/12/10 23:45:44 INFO mapreduce.Job:  map 39% reduce 10%
16/12/10 23:45:45 INFO mapreduce.Job:  map 41% reduce 11%
16/12/10 23:45:46 INFO mapreduce.Job:  map 42% reduce 12%
16/12/10 23:45:47 INFO mapreduce.Job:  map 43% reduce 12%
16/12/10 23:45:48 INFO mapreduce.Job:  map 45% reduce 12%
16/12/10 23:45:49 INFO mapreduce.Job:  map 46% reduce 13%
16/12/10 23:45:50 INFO mapreduce.Job:  map 49% reduce 13%
16/12/10 23:45:51 INFO mapreduce.Job:  map 51% reduce 13%
16/12/10 23:45:52 INFO mapreduce.Job:  map 53% reduce 14%
16/12/10 23:45:53 INFO mapreduce.Job:  map 55% reduce 15%
16/12/10 23:45:54 INFO mapreduce.Job:  map 58% reduce 16%
16/12/10 23:45:55 INFO mapreduce.Job:  map 61% reduce 17%
16/12/10 23:45:56 INFO mapreduce.Job:  map 64% reduce 18%
16/12/10 23:45:57 INFO mapreduce.Job:  map 66% reduce 19%
16/12/10 23:45:58 INFO mapreduce.Job:  map 67% reduce 20%
16/12/10 23:45:59 INFO mapreduce.Job:  map 69% reduce 21%
16/12/10 23:46:00 INFO mapreduce.Job:  map 72% reduce 22%
16/12/10 23:46:01 INFO mapreduce.Job:  map 73% reduce 22%
16/12/10 23:46:02 INFO mapreduce.Job:  map 77% reduce 23%
16/12/10 23:46:03 INFO mapreduce.Job:  map 77% reduce 24%
16/12/10 23:46:04 INFO mapreduce.Job:  map 77% reduce 25%
16/12/10 23:46:06 INFO mapreduce.Job:  map 78% reduce 25%
16/12/10 23:46:11 INFO mapreduce.Job:  map 78% reduce 26%
16/12/10 23:46:12 INFO mapreduce.Job:  map 79% reduce 26%
16/12/10 23:46:16 INFO mapreduce.Job:  map 80% reduce 26%
16/12/10 23:46:19 INFO mapreduce.Job:  map 81% reduce 26%
16/12/10 23:46:22 INFO mapreduce.Job:  map 82% reduce 26%
16/12/10 23:46:26 INFO mapreduce.Job:  map 83% reduce 26%
16/12/10 23:46:30 INFO mapreduce.Job:  map 84% reduce 26%
16/12/10 23:46:35 INFO mapreduce.Job:  map 85% reduce 26%
16/12/10 23:46:39 INFO mapreduce.Job:  map 86% reduce 26%
16/12/10 23:46:43 INFO mapreduce.Job:  map 87% reduce 26%
16/12/10 23:46:47 INFO mapreduce.Job:  map 87% reduce 27%
16/12/10 23:46:48 INFO mapreduce.Job:  map 88% reduce 27%
16/12/10 23:46:52 INFO mapreduce.Job:  map 89% reduce 27%
16/12/10 23:46:54 INFO mapreduce.Job:  map 90% reduce 27%
16/12/10 23:46:55 INFO mapreduce.Job:  map 90% reduce 28%
16/12/10 23:47:00 INFO mapreduce.Job:  map 91% reduce 28%
16/12/10 23:47:02 INFO mapreduce.Job:  map 93% reduce 28%
16/12/10 23:47:04 INFO mapreduce.Job:  map 94% reduce 29%
16/12/10 23:47:06 INFO mapreduce.Job:  map 95% reduce 29%
16/12/10 23:47:07 INFO mapreduce.Job:  map 95% reduce 30%
16/12/10 23:47:08 INFO mapreduce.Job:  map 96% reduce 30%
16/12/10 23:47:09 INFO mapreduce.Job:  map 97% reduce 31%
16/12/10 23:47:10 INFO mapreduce.Job:  map 98% reduce 31%
16/12/10 23:47:11 INFO mapreduce.Job:  map 98% reduce 32%
16/12/10 23:47:12 INFO mapreduce.Job:  map 99% reduce 32%
16/12/10 23:47:13 INFO mapreduce.Job:  map 100% reduce 32%
16/12/10 23:47:14 INFO mapreduce.Job:  map 100% reduce 33%
16/12/10 23:47:15 INFO mapreduce.Job:  map 100% reduce 34%
16/12/10 23:47:16 INFO mapreduce.Job:  map 100% reduce 41%
16/12/10 23:47:17 INFO mapreduce.Job:  map 100% reduce 44%
16/12/10 23:47:18 INFO mapreduce.Job:  map 100% reduce 49%
16/12/10 23:47:19 INFO mapreduce.Job:  map 100% reduce 54%
16/12/10 23:47:20 INFO mapreduce.Job:  map 100% reduce 65%
16/12/10 23:47:21 INFO mapreduce.Job:  map 100% reduce 69%
16/12/10 23:47:22 INFO mapreduce.Job:  map 100% reduce 73%
16/12/10 23:47:23 INFO mapreduce.Job:  map 100% reduce 74%
16/12/10 23:47:24 INFO mapreduce.Job:  map 100% reduce 76%
16/12/10 23:47:25 INFO mapreduce.Job:  map 100% reduce 77%
16/12/10 23:47:27 INFO mapreduce.Job:  map 100% reduce 79%
16/12/10 23:47:28 INFO mapreduce.Job:  map 100% reduce 80%
16/12/10 23:47:29 INFO mapreduce.Job:  map 100% reduce 81%
16/12/10 23:47:30 INFO mapreduce.Job:  map 100% reduce 83%
16/12/10 23:47:31 INFO mapreduce.Job:  map 100% reduce 84%
16/12/10 23:47:32 INFO mapreduce.Job:  map 100% reduce 85%
16/12/10 23:47:33 INFO mapreduce.Job:  map 100% reduce 86%
16/12/10 23:47:35 INFO mapreduce.Job:  map 100% reduce 89%
16/12/10 23:47:36 INFO mapreduce.Job:  map 100% reduce 90%
16/12/10 23:47:38 INFO mapreduce.Job:  map 100% reduce 93%
16/12/10 23:47:39 INFO mapreduce.Job:  map 100% reduce 94%
16/12/10 23:47:40 INFO mapreduce.Job:  map 100% reduce 95%
16/12/10 23:47:41 INFO mapreduce.Job:  map 100% reduce 97%
16/12/10 23:47:42 INFO mapreduce.Job:  map 100% reduce 98%
16/12/10 23:47:43 INFO mapreduce.Job:  map 100% reduce 99%
16/12/10 23:47:44 INFO mapreduce.Job:  map 100% reduce 100%
16/12/10 23:47:50 INFO mapreduce.Job: Job job_1480588584072_6664 completed successfully
16/12/10 23:47:50 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=953994382
		FILE: Number of bytes written=1940370729
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=808886729
		WASB: Number of bytes written=500506499
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=40242278
		Total time spent by all reduces in occupied slots (ms)=5563680
		Total time spent by all map tasks (ms)=20121139
		Total time spent by all reduce tasks (ms)=2781840
		Total vcore-seconds taken by all map tasks=20121139
		Total vcore-seconds taken by all reduce tasks=2781840
		Total megabyte-seconds taken by all map tasks=20604046336
		Total megabyte-seconds taken by all reduce tasks=2848604160
	Map-Reduce Framework
		Map input records=2591471
		Map output records=2317156
		Map output bytes=945057403
		Map output materialized bytes=954017902
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2027528
		Reduce shuffle bytes=954017902
		Reduce input records=2317156
		Reduce output records=1476615
		Spilled Records=4634312
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=250679
		CPU time spent (ms)=1202430
		Physical memory (bytes) snapshot=322083020800
		Virtual memory (bytes) snapshot=743039463424
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=806190725
	File Output Format Counters 
		Bytes Written=500506499
16/12/10 23:47:50 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1800
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101500 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1900 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/18/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101500
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1900': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob9050882971730914001.jar tmpDir=null
16/12/11 00:49:03 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 00:49:04 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 00:49:06 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/11 00:49:08 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/11 00:49:08 INFO mapreduce.JobSubmitter: number of splits:197
16/12/11 00:49:08 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6668
16/12/11 00:49:09 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6668
16/12/11 00:49:09 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6668/
16/12/11 00:49:09 INFO mapreduce.Job: Running job: job_1480588584072_6668
16/12/11 00:49:23 INFO mapreduce.Job: Job job_1480588584072_6668 running in uber mode : false
16/12/11 00:49:23 INFO mapreduce.Job:  map 0% reduce 0%
16/12/11 00:50:23 INFO mapreduce.Job:  map 2% reduce 0%
16/12/11 00:50:25 INFO mapreduce.Job:  map 3% reduce 0%
16/12/11 00:50:27 INFO mapreduce.Job:  map 5% reduce 0%
16/12/11 00:50:29 INFO mapreduce.Job:  map 6% reduce 0%
16/12/11 00:50:30 INFO mapreduce.Job:  map 8% reduce 0%
16/12/11 00:50:32 INFO mapreduce.Job:  map 12% reduce 0%
16/12/11 00:50:33 INFO mapreduce.Job:  map 13% reduce 0%
16/12/11 00:50:34 INFO mapreduce.Job:  map 15% reduce 0%
16/12/11 00:50:35 INFO mapreduce.Job:  map 17% reduce 0%
16/12/11 00:50:44 INFO mapreduce.Job:  map 18% reduce 0%
16/12/11 00:50:49 INFO mapreduce.Job:  map 19% reduce 0%
16/12/11 00:50:50 INFO mapreduce.Job:  map 19% reduce 1%
16/12/11 00:50:52 INFO mapreduce.Job:  map 20% reduce 1%
16/12/11 00:50:54 INFO mapreduce.Job:  map 21% reduce 1%
16/12/11 00:50:55 INFO mapreduce.Job:  map 21% reduce 2%
16/12/11 00:50:56 INFO mapreduce.Job:  map 23% reduce 3%
16/12/11 00:50:57 INFO mapreduce.Job:  map 24% reduce 3%
16/12/11 00:50:58 INFO mapreduce.Job:  map 24% reduce 5%
16/12/11 00:50:59 INFO mapreduce.Job:  map 25% reduce 6%
16/12/11 00:51:00 INFO mapreduce.Job:  map 26% reduce 6%
16/12/11 00:51:01 INFO mapreduce.Job:  map 29% reduce 6%
16/12/11 00:51:02 INFO mapreduce.Job:  map 32% reduce 6%
16/12/11 00:51:03 INFO mapreduce.Job:  map 34% reduce 6%
16/12/11 00:51:04 INFO mapreduce.Job:  map 35% reduce 7%
16/12/11 00:51:05 INFO mapreduce.Job:  map 38% reduce 8%
16/12/11 00:51:06 INFO mapreduce.Job:  map 40% reduce 8%
16/12/11 00:51:07 INFO mapreduce.Job:  map 43% reduce 8%
16/12/11 00:51:08 INFO mapreduce.Job:  map 46% reduce 9%
16/12/11 00:51:09 INFO mapreduce.Job:  map 47% reduce 9%
16/12/11 00:51:10 INFO mapreduce.Job:  map 51% reduce 10%
16/12/11 00:51:11 INFO mapreduce.Job:  map 53% reduce 11%
16/12/11 00:51:12 INFO mapreduce.Job:  map 55% reduce 11%
16/12/11 00:51:13 INFO mapreduce.Job:  map 56% reduce 11%
16/12/11 00:51:14 INFO mapreduce.Job:  map 59% reduce 12%
16/12/11 00:51:15 INFO mapreduce.Job:  map 61% reduce 12%
16/12/11 00:51:16 INFO mapreduce.Job:  map 62% reduce 13%
16/12/11 00:51:17 INFO mapreduce.Job:  map 65% reduce 14%
16/12/11 00:51:18 INFO mapreduce.Job:  map 69% reduce 15%
16/12/11 00:51:19 INFO mapreduce.Job:  map 72% reduce 15%
16/12/11 00:51:20 INFO mapreduce.Job:  map 74% reduce 17%
16/12/11 00:51:21 INFO mapreduce.Job:  map 75% reduce 17%
16/12/11 00:51:22 INFO mapreduce.Job:  map 76% reduce 17%
16/12/11 00:51:23 INFO mapreduce.Job:  map 77% reduce 18%
16/12/11 00:51:24 INFO mapreduce.Job:  map 79% reduce 18%
16/12/11 00:51:25 INFO mapreduce.Job:  map 80% reduce 18%
16/12/11 00:51:26 INFO mapreduce.Job:  map 83% reduce 18%
16/12/11 00:51:27 INFO mapreduce.Job:  map 84% reduce 18%
16/12/11 00:51:28 INFO mapreduce.Job:  map 88% reduce 19%
16/12/11 00:51:29 INFO mapreduce.Job:  map 90% reduce 20%
16/12/11 00:51:30 INFO mapreduce.Job:  map 91% reduce 20%
16/12/11 00:51:31 INFO mapreduce.Job:  map 93% reduce 22%
16/12/11 00:51:32 INFO mapreduce.Job:  map 94% reduce 23%
16/12/11 00:51:33 INFO mapreduce.Job:  map 95% reduce 24%
16/12/11 00:51:34 INFO mapreduce.Job:  map 96% reduce 24%
16/12/11 00:51:35 INFO mapreduce.Job:  map 97% reduce 25%
16/12/11 00:51:36 INFO mapreduce.Job:  map 99% reduce 28%
16/12/11 00:51:37 INFO mapreduce.Job:  map 99% reduce 29%
16/12/11 00:51:38 INFO mapreduce.Job:  map 100% reduce 32%
16/12/11 00:51:40 INFO mapreduce.Job:  map 100% reduce 33%
16/12/11 00:51:41 INFO mapreduce.Job:  map 100% reduce 37%
16/12/11 00:51:42 INFO mapreduce.Job:  map 100% reduce 42%
16/12/11 00:51:43 INFO mapreduce.Job:  map 100% reduce 43%
16/12/11 00:51:44 INFO mapreduce.Job:  map 100% reduce 55%
16/12/11 00:51:45 INFO mapreduce.Job:  map 100% reduce 62%
16/12/11 00:51:47 INFO mapreduce.Job:  map 100% reduce 65%
16/12/11 00:51:48 INFO mapreduce.Job:  map 100% reduce 71%
16/12/11 00:51:49 INFO mapreduce.Job:  map 100% reduce 73%
16/12/11 00:51:50 INFO mapreduce.Job:  map 100% reduce 75%
16/12/11 00:51:51 INFO mapreduce.Job:  map 100% reduce 78%
16/12/11 00:51:52 INFO mapreduce.Job:  map 100% reduce 80%
16/12/11 00:51:53 INFO mapreduce.Job:  map 100% reduce 81%
16/12/11 00:51:54 INFO mapreduce.Job:  map 100% reduce 82%
16/12/11 00:51:55 INFO mapreduce.Job:  map 100% reduce 83%
16/12/11 00:51:56 INFO mapreduce.Job:  map 100% reduce 85%
16/12/11 00:51:58 INFO mapreduce.Job:  map 100% reduce 87%
16/12/11 00:51:59 INFO mapreduce.Job:  map 100% reduce 88%
16/12/11 00:52:00 INFO mapreduce.Job:  map 100% reduce 89%
16/12/11 00:52:01 INFO mapreduce.Job:  map 100% reduce 90%
16/12/11 00:52:03 INFO mapreduce.Job:  map 100% reduce 92%
16/12/11 00:52:05 INFO mapreduce.Job:  map 100% reduce 94%
16/12/11 00:52:06 INFO mapreduce.Job:  map 100% reduce 95%
16/12/11 00:52:07 INFO mapreduce.Job:  map 100% reduce 97%
16/12/11 00:52:09 INFO mapreduce.Job:  map 100% reduce 99%
16/12/11 00:52:10 INFO mapreduce.Job:  map 100% reduce 100%
16/12/11 00:52:15 INFO mapreduce.Job: Job job_1480588584072_6668 completed successfully
16/12/11 00:52:15 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=1161406299
		FILE: Number of bytes written=2355194563
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=971381715
		WASB: Number of bytes written=666490730
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=39382446
		Total time spent by all reduces in occupied slots (ms)=3495634
		Total time spent by all map tasks (ms)=19691223
		Total time spent by all reduce tasks (ms)=1747817
		Total vcore-seconds taken by all map tasks=19691223
		Total vcore-seconds taken by all reduce tasks=1747817
		Total megabyte-seconds taken by all map tasks=20163812352
		Total megabyte-seconds taken by all reduce tasks=1789764608
	Map-Reduce Framework
		Map input records=3077276
		Map output records=2810872
		Map output bytes=1150586400
		Map output materialized bytes=1161429819
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2498634
		Reduce shuffle bytes=1161429819
		Reduce input records=2810872
		Reduce output records=1967821
		Spilled Records=5621744
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=176694
		CPU time spent (ms)=1160190
		Physical memory (bytes) snapshot=324870053888
		Virtual memory (bytes) snapshot=743559262208
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=968685711
	File Output Format Counters 
		Bytes Written=666490730
16/12/11 00:52:15 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/1900
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23.done
16/12/11 00:52:32 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101600 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/2000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/19/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101600
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/2000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4327327436305189787.jar tmpDir=null
16/12/11 01:43:21 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 01:43:22 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 01:43:22 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/11 01:43:24 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/11 01:43:25 INFO mapreduce.JobSubmitter: number of splits:197
16/12/11 01:43:25 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6672
16/12/11 01:43:26 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6672
16/12/11 01:43:26 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6672/
16/12/11 01:43:26 INFO mapreduce.Job: Running job: job_1480588584072_6672
16/12/11 01:43:40 INFO mapreduce.Job: Job job_1480588584072_6672 running in uber mode : false
16/12/11 01:43:40 INFO mapreduce.Job:  map 0% reduce 0%
16/12/11 01:44:34 INFO mapreduce.Job:  map 1% reduce 0%
16/12/11 01:44:38 INFO mapreduce.Job:  map 2% reduce 0%
16/12/11 01:44:44 INFO mapreduce.Job:  map 4% reduce 0%
16/12/11 01:44:46 INFO mapreduce.Job:  map 6% reduce 0%
16/12/11 01:44:47 INFO mapreduce.Job:  map 8% reduce 0%
16/12/11 01:44:48 INFO mapreduce.Job:  map 11% reduce 0%
16/12/11 01:44:49 INFO mapreduce.Job:  map 13% reduce 0%
16/12/11 01:44:50 INFO mapreduce.Job:  map 15% reduce 0%
16/12/11 01:44:52 INFO mapreduce.Job:  map 16% reduce 0%
16/12/11 01:44:53 INFO mapreduce.Job:  map 18% reduce 0%
16/12/11 01:44:56 INFO mapreduce.Job:  map 19% reduce 0%
16/12/11 01:45:05 INFO mapreduce.Job:  map 20% reduce 0%
16/12/11 01:45:06 INFO mapreduce.Job:  map 20% reduce 1%
16/12/11 01:45:07 INFO mapreduce.Job:  map 21% reduce 1%
16/12/11 01:45:09 INFO mapreduce.Job:  map 22% reduce 1%
16/12/11 01:45:10 INFO mapreduce.Job:  map 23% reduce 1%
16/12/11 01:45:12 INFO mapreduce.Job:  map 25% reduce 1%
16/12/11 01:45:13 INFO mapreduce.Job:  map 27% reduce 2%
16/12/11 01:45:14 INFO mapreduce.Job:  map 29% reduce 4%
16/12/11 01:45:15 INFO mapreduce.Job:  map 31% reduce 5%
16/12/11 01:45:16 INFO mapreduce.Job:  map 31% reduce 6%
16/12/11 01:45:17 INFO mapreduce.Job:  map 35% reduce 8%
16/12/11 01:45:18 INFO mapreduce.Job:  map 37% reduce 8%
16/12/11 01:45:19 INFO mapreduce.Job:  map 39% reduce 9%
16/12/11 01:45:20 INFO mapreduce.Job:  map 41% reduce 10%
16/12/11 01:45:21 INFO mapreduce.Job:  map 43% reduce 10%
16/12/11 01:45:22 INFO mapreduce.Job:  map 45% reduce 11%
16/12/11 01:45:23 INFO mapreduce.Job:  map 46% reduce 12%
16/12/11 01:45:24 INFO mapreduce.Job:  map 49% reduce 12%
16/12/11 01:45:25 INFO mapreduce.Job:  map 52% reduce 12%
16/12/11 01:45:26 INFO mapreduce.Job:  map 54% reduce 13%
16/12/11 01:45:27 INFO mapreduce.Job:  map 54% reduce 15%
16/12/11 01:45:28 INFO mapreduce.Job:  map 56% reduce 16%
16/12/11 01:45:29 INFO mapreduce.Job:  map 59% reduce 16%
16/12/11 01:45:30 INFO mapreduce.Job:  map 61% reduce 17%
16/12/11 01:45:31 INFO mapreduce.Job:  map 64% reduce 18%
16/12/11 01:45:32 INFO mapreduce.Job:  map 68% reduce 19%
16/12/11 01:45:33 INFO mapreduce.Job:  map 69% reduce 20%
16/12/11 01:45:34 INFO mapreduce.Job:  map 70% reduce 21%
16/12/11 01:45:35 INFO mapreduce.Job:  map 73% reduce 22%
16/12/11 01:45:36 INFO mapreduce.Job:  map 74% reduce 22%
16/12/11 01:45:37 INFO mapreduce.Job:  map 76% reduce 23%
16/12/11 01:45:38 INFO mapreduce.Job:  map 79% reduce 24%
16/12/11 01:45:40 INFO mapreduce.Job:  map 80% reduce 25%
16/12/11 01:45:41 INFO mapreduce.Job:  map 80% reduce 26%
16/12/11 01:45:46 INFO mapreduce.Job:  map 81% reduce 26%
16/12/11 01:45:50 INFO mapreduce.Job:  map 82% reduce 27%
16/12/11 01:45:51 INFO mapreduce.Job:  map 83% reduce 27%
16/12/11 01:45:54 INFO mapreduce.Job:  map 84% reduce 27%
16/12/11 01:45:57 INFO mapreduce.Job:  map 85% reduce 27%
16/12/11 01:46:00 INFO mapreduce.Job:  map 86% reduce 27%
16/12/11 01:46:03 INFO mapreduce.Job:  map 87% reduce 27%
16/12/11 01:46:05 INFO mapreduce.Job:  map 88% reduce 27%
16/12/11 01:46:06 INFO mapreduce.Job:  map 88% reduce 28%
16/12/11 01:46:07 INFO mapreduce.Job:  map 89% reduce 28%
16/12/11 01:46:08 INFO mapreduce.Job:  map 90% reduce 28%
16/12/11 01:46:09 INFO mapreduce.Job:  map 91% reduce 28%
16/12/11 01:46:10 INFO mapreduce.Job:  map 92% reduce 28%
16/12/11 01:46:11 INFO mapreduce.Job:  map 93% reduce 28%
16/12/11 01:46:12 INFO mapreduce.Job:  map 94% reduce 29%
16/12/11 01:46:13 INFO mapreduce.Job:  map 95% reduce 29%
16/12/11 01:46:14 INFO mapreduce.Job:  map 95% reduce 30%
16/12/11 01:46:16 INFO mapreduce.Job:  map 96% reduce 30%
16/12/11 01:46:17 INFO mapreduce.Job:  map 97% reduce 31%
16/12/11 01:46:18 INFO mapreduce.Job:  map 98% reduce 31%
16/12/11 01:46:19 INFO mapreduce.Job:  map 99% reduce 31%
16/12/11 01:46:20 INFO mapreduce.Job:  map 99% reduce 32%
16/12/11 01:46:21 INFO mapreduce.Job:  map 100% reduce 32%
16/12/11 01:46:22 INFO mapreduce.Job:  map 100% reduce 34%
16/12/11 01:46:24 INFO mapreduce.Job:  map 100% reduce 42%
16/12/11 01:46:25 INFO mapreduce.Job:  map 100% reduce 47%
16/12/11 01:46:26 INFO mapreduce.Job:  map 100% reduce 52%
16/12/11 01:46:27 INFO mapreduce.Job:  map 100% reduce 60%
16/12/11 01:46:28 INFO mapreduce.Job:  map 100% reduce 65%
16/12/11 01:46:29 INFO mapreduce.Job:  map 100% reduce 68%
16/12/11 01:46:30 INFO mapreduce.Job:  map 100% reduce 73%
16/12/11 01:46:31 INFO mapreduce.Job:  map 100% reduce 75%
16/12/11 01:46:32 INFO mapreduce.Job:  map 100% reduce 76%
16/12/11 01:46:33 INFO mapreduce.Job:  map 100% reduce 77%
16/12/11 01:46:34 INFO mapreduce.Job:  map 100% reduce 79%
16/12/11 01:46:35 INFO mapreduce.Job:  map 100% reduce 80%
16/12/11 01:46:36 INFO mapreduce.Job:  map 100% reduce 81%
16/12/11 01:46:37 INFO mapreduce.Job:  map 100% reduce 82%
16/12/11 01:46:38 INFO mapreduce.Job:  map 100% reduce 83%
16/12/11 01:46:39 INFO mapreduce.Job:  map 100% reduce 85%
16/12/11 01:46:40 INFO mapreduce.Job:  map 100% reduce 86%
16/12/11 01:46:41 INFO mapreduce.Job:  map 100% reduce 87%
16/12/11 01:46:42 INFO mapreduce.Job:  map 100% reduce 89%
16/12/11 01:46:43 INFO mapreduce.Job:  map 100% reduce 90%
16/12/11 01:46:44 INFO mapreduce.Job:  map 100% reduce 92%
16/12/11 01:46:45 INFO mapreduce.Job:  map 100% reduce 93%
16/12/11 01:46:46 INFO mapreduce.Job:  map 100% reduce 94%
16/12/11 01:46:47 INFO mapreduce.Job:  map 100% reduce 95%
16/12/11 01:46:48 INFO mapreduce.Job:  map 100% reduce 97%
16/12/11 01:46:51 INFO mapreduce.Job:  map 100% reduce 99%
16/12/11 01:46:54 INFO mapreduce.Job:  map 100% reduce 100%
16/12/11 01:47:03 INFO mapreduce.Job: Job job_1480588584072_6672 completed successfully
16/12/11 01:47:04 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=1007745522
		FILE: Number of bytes written=2047873009
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=846280759
		WASB: Number of bytes written=557593645
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=39990630
		Total time spent by all reduces in occupied slots (ms)=4544828
		Total time spent by all map tasks (ms)=19995315
		Total time spent by all reduce tasks (ms)=2272414
		Total vcore-seconds taken by all map tasks=19995315
		Total vcore-seconds taken by all reduce tasks=2272414
		Total megabyte-seconds taken by all map tasks=20475202560
		Total megabyte-seconds taken by all reduce tasks=2326951936
	Map-Reduce Framework
		Map input records=2692194
		Map output records=2443237
		Map output bytes=998329311
		Map output materialized bytes=1007769042
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2155766
		Reduce shuffle bytes=1007769042
		Reduce input records=2443237
		Reduce output records=1646792
		Spilled Records=4886474
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=174195
		CPU time spent (ms)=1094580
		Physical memory (bytes) snapshot=326009741312
		Virtual memory (bytes) snapshot=743617089536
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=843584755
	File Output Format Counters 
		Bytes Written=557593645
16/12/11 01:47:04 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/2000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101700 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/2100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/20/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101700
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/2100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1349403990849184988.jar tmpDir=null
16/12/11 02:43:12 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 02:43:13 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 02:43:14 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/11 02:43:18 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/11 02:43:18 INFO mapreduce.JobSubmitter: number of splits:229
16/12/11 02:43:19 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6676
16/12/11 02:43:20 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6676
16/12/11 02:43:20 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6676/
16/12/11 02:43:20 INFO mapreduce.Job: Running job: job_1480588584072_6676
16/12/11 02:43:33 INFO mapreduce.Job: Job job_1480588584072_6676 running in uber mode : false
16/12/11 02:43:33 INFO mapreduce.Job:  map 0% reduce 0%
16/12/11 02:44:18 INFO mapreduce.Job:  map 1% reduce 0%
16/12/11 02:44:33 INFO mapreduce.Job:  map 3% reduce 0%
16/12/11 02:44:34 INFO mapreduce.Job:  map 4% reduce 0%
16/12/11 02:44:36 INFO mapreduce.Job:  map 6% reduce 0%
16/12/11 02:44:37 INFO mapreduce.Job:  map 8% reduce 0%
16/12/11 02:44:38 INFO mapreduce.Job:  map 9% reduce 0%
16/12/11 02:44:39 INFO mapreduce.Job:  map 11% reduce 0%
16/12/11 02:44:40 INFO mapreduce.Job:  map 14% reduce 0%
16/12/11 02:44:41 INFO mapreduce.Job:  map 16% reduce 0%
16/12/11 02:44:42 INFO mapreduce.Job:  map 18% reduce 0%
16/12/11 02:44:43 INFO mapreduce.Job:  map 19% reduce 0%
16/12/11 02:44:45 INFO mapreduce.Job:  map 20% reduce 0%
16/12/11 02:44:47 INFO mapreduce.Job:  map 25% reduce 0%
16/12/11 02:44:48 INFO mapreduce.Job:  map 26% reduce 0%
16/12/11 02:44:49 INFO mapreduce.Job:  map 28% reduce 0%
16/12/11 02:44:58 INFO mapreduce.Job:  map 28% reduce 1%
16/12/11 02:45:01 INFO mapreduce.Job:  map 28% reduce 2%
16/12/11 02:45:02 INFO mapreduce.Job:  map 29% reduce 2%
16/12/11 02:45:03 INFO mapreduce.Job:  map 29% reduce 3%
16/12/11 02:45:04 INFO mapreduce.Job:  map 30% reduce 3%
16/12/11 02:45:05 INFO mapreduce.Job:  map 30% reduce 4%
16/12/11 02:45:06 INFO mapreduce.Job:  map 31% reduce 5%
16/12/11 02:45:07 INFO mapreduce.Job:  map 32% reduce 8%
16/12/11 02:45:08 INFO mapreduce.Job:  map 33% reduce 9%
16/12/11 02:45:09 INFO mapreduce.Job:  map 33% reduce 10%
16/12/11 02:45:10 INFO mapreduce.Job:  map 36% reduce 10%
16/12/11 02:45:11 INFO mapreduce.Job:  map 38% reduce 10%
16/12/11 02:45:12 INFO mapreduce.Job:  map 38% reduce 11%
16/12/11 02:45:13 INFO mapreduce.Job:  map 41% reduce 11%
16/12/11 02:45:14 INFO mapreduce.Job:  map 44% reduce 12%
16/12/11 02:45:15 INFO mapreduce.Job:  map 46% reduce 12%
16/12/11 02:45:16 INFO mapreduce.Job:  map 47% reduce 14%
16/12/11 02:45:17 INFO mapreduce.Job:  map 49% reduce 14%
16/12/11 02:45:18 INFO mapreduce.Job:  map 49% reduce 15%
16/12/11 02:45:19 INFO mapreduce.Job:  map 51% reduce 15%
16/12/11 02:45:20 INFO mapreduce.Job:  map 54% reduce 15%
16/12/11 02:45:21 INFO mapreduce.Job:  map 56% reduce 15%
16/12/11 02:45:22 INFO mapreduce.Job:  map 58% reduce 16%
16/12/11 02:45:23 INFO mapreduce.Job:  map 60% reduce 16%
16/12/11 02:45:24 INFO mapreduce.Job:  map 62% reduce 17%
16/12/11 02:45:25 INFO mapreduce.Job:  map 63% reduce 18%
16/12/11 02:45:26 INFO mapreduce.Job:  map 66% reduce 18%
16/12/11 02:45:27 INFO mapreduce.Job:  map 69% reduce 18%
16/12/11 02:45:28 INFO mapreduce.Job:  map 71% reduce 20%
16/12/11 02:45:29 INFO mapreduce.Job:  map 72% reduce 21%
16/12/11 02:45:30 INFO mapreduce.Job:  map 73% reduce 21%
16/12/11 02:45:31 INFO mapreduce.Job:  map 74% reduce 22%
16/12/11 02:45:32 INFO mapreduce.Job:  map 76% reduce 22%
16/12/11 02:45:33 INFO mapreduce.Job:  map 77% reduce 22%
16/12/11 02:45:34 INFO mapreduce.Job:  map 77% reduce 23%
16/12/11 02:45:35 INFO mapreduce.Job:  map 78% reduce 23%
16/12/11 02:45:37 INFO mapreduce.Job:  map 79% reduce 23%
16/12/11 02:45:38 INFO mapreduce.Job:  map 80% reduce 24%
16/12/11 02:45:39 INFO mapreduce.Job:  map 81% reduce 24%
16/12/11 02:45:41 INFO mapreduce.Job:  map 83% reduce 25%
16/12/11 02:45:42 INFO mapreduce.Job:  map 84% reduce 25%
16/12/11 02:45:43 INFO mapreduce.Job:  map 85% reduce 25%
16/12/11 02:45:44 INFO mapreduce.Job:  map 86% reduce 26%
16/12/11 02:45:45 INFO mapreduce.Job:  map 87% reduce 26%
16/12/11 02:45:46 INFO mapreduce.Job:  map 89% reduce 26%
16/12/11 02:45:47 INFO mapreduce.Job:  map 91% reduce 27%
16/12/11 02:45:48 INFO mapreduce.Job:  map 92% reduce 28%
16/12/11 02:45:49 INFO mapreduce.Job:  map 94% reduce 28%
16/12/11 02:45:50 INFO mapreduce.Job:  map 96% reduce 30%
16/12/11 02:45:51 INFO mapreduce.Job:  map 97% reduce 31%
16/12/11 02:45:52 INFO mapreduce.Job:  map 99% reduce 31%
16/12/11 02:45:53 INFO mapreduce.Job:  map 100% reduce 32%
16/12/11 02:45:54 INFO mapreduce.Job:  map 100% reduce 33%
16/12/11 02:45:56 INFO mapreduce.Job:  map 100% reduce 36%
16/12/11 02:45:57 INFO mapreduce.Job:  map 100% reduce 44%
16/12/11 02:45:58 INFO mapreduce.Job:  map 100% reduce 50%
16/12/11 02:45:59 INFO mapreduce.Job:  map 100% reduce 55%
16/12/11 02:46:00 INFO mapreduce.Job:  map 100% reduce 63%
16/12/11 02:46:01 INFO mapreduce.Job:  map 100% reduce 65%
16/12/11 02:46:02 INFO mapreduce.Job:  map 100% reduce 67%
16/12/11 02:46:03 INFO mapreduce.Job:  map 100% reduce 70%
16/12/11 02:46:04 INFO mapreduce.Job:  map 100% reduce 71%
16/12/11 02:46:05 INFO mapreduce.Job:  map 100% reduce 72%
16/12/11 02:46:06 INFO mapreduce.Job:  map 100% reduce 73%
16/12/11 02:46:08 INFO mapreduce.Job:  map 100% reduce 74%
16/12/11 02:46:09 INFO mapreduce.Job:  map 100% reduce 76%
16/12/11 02:46:10 INFO mapreduce.Job:  map 100% reduce 77%
16/12/11 02:46:11 INFO mapreduce.Job:  map 100% reduce 79%
16/12/11 02:46:12 INFO mapreduce.Job:  map 100% reduce 80%
16/12/11 02:46:13 INFO mapreduce.Job:  map 100% reduce 81%
16/12/11 02:46:14 INFO mapreduce.Job:  map 100% reduce 82%
16/12/11 02:46:15 INFO mapreduce.Job:  map 100% reduce 83%
16/12/11 02:46:16 INFO mapreduce.Job:  map 100% reduce 85%
16/12/11 02:46:17 INFO mapreduce.Job:  map 100% reduce 86%
16/12/11 02:46:18 INFO mapreduce.Job:  map 100% reduce 87%
16/12/11 02:46:19 INFO mapreduce.Job:  map 100% reduce 89%
16/12/11 02:46:20 INFO mapreduce.Job:  map 100% reduce 90%
16/12/11 02:46:21 INFO mapreduce.Job:  map 100% reduce 91%
16/12/11 02:46:22 INFO mapreduce.Job:  map 100% reduce 92%
16/12/11 02:46:23 INFO mapreduce.Job:  map 100% reduce 94%
16/12/11 02:46:24 INFO mapreduce.Job:  map 100% reduce 95%
16/12/11 02:46:25 INFO mapreduce.Job:  map 100% reduce 96%
16/12/11 02:46:26 INFO mapreduce.Job:  map 100% reduce 98%
16/12/11 02:46:28 INFO mapreduce.Job:  map 100% reduce 99%
16/12/11 02:46:31 INFO mapreduce.Job:  map 100% reduce 100%
16/12/11 02:46:39 INFO mapreduce.Job: Job job_1480588584072_6676 completed successfully
16/12/11 02:46:39 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=1032432095
		FILE: Number of bytes written=2102023275
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=864054225
		WASB: Number of bytes written=616868145
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=229
		Launched reduce tasks=20
		Rack-local map tasks=229
		Total time spent by all maps in occupied slots (ms)=45378754
		Total time spent by all reduces in occupied slots (ms)=4038670
		Total time spent by all map tasks (ms)=22689377
		Total time spent by all reduce tasks (ms)=2019335
		Total vcore-seconds taken by all map tasks=22689377
		Total vcore-seconds taken by all reduce tasks=2019335
		Total megabyte-seconds taken by all map tasks=23233922048
		Total megabyte-seconds taken by all reduce tasks=2067799040
	Map-Reduce Framework
		Map input records=2684867
		Map output records=2492534
		Map output bytes=1022844016
		Map output materialized bytes=1032459455
		Input split bytes=31932
		Combine input records=0
		Combine output records=0
		Reduce input groups=2225152
		Reduce shuffle bytes=1032459455
		Reduce input records=2492534
		Reduce output records=1818592
		Spilled Records=4985068
		Shuffled Maps =4580
		Failed Shuffles=0
		Merged Map outputs=4580
		GC time elapsed (ms)=201792
		CPU time spent (ms)=1221270
		Physical memory (bytes) snapshot=376061509632
		Virtual memory (bytes) snapshot=852941750272
		Total committed heap usage (bytes)=659265945600
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=860401415
	File Output Format Counters 
		Bytes Written=616868145
16/12/11 02:46:39 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/2100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101800 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/2200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/21/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101800
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/2200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5631168245914871663.jar tmpDir=null
16/12/11 03:42:49 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 03:42:49 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 03:42:50 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/11 03:42:57 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/11 03:42:57 INFO mapreduce.JobSubmitter: number of splits:218
16/12/11 03:42:57 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6682
16/12/11 03:42:58 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6682
16/12/11 03:42:58 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6682/
16/12/11 03:42:58 INFO mapreduce.Job: Running job: job_1480588584072_6682
16/12/11 03:43:12 INFO mapreduce.Job: Job job_1480588584072_6682 running in uber mode : false
16/12/11 03:43:12 INFO mapreduce.Job:  map 0% reduce 0%
16/12/11 03:44:10 INFO mapreduce.Job:  map 3% reduce 0%
16/12/11 03:44:13 INFO mapreduce.Job:  map 7% reduce 0%
16/12/11 03:44:14 INFO mapreduce.Job:  map 9% reduce 0%
16/12/11 03:44:26 INFO mapreduce.Job:  map 11% reduce 0%
16/12/11 03:44:29 INFO mapreduce.Job:  map 12% reduce 0%
16/12/11 03:44:33 INFO mapreduce.Job:  map 13% reduce 0%
16/12/11 03:44:34 INFO mapreduce.Job:  map 14% reduce 1%
16/12/11 03:44:36 INFO mapreduce.Job:  map 15% reduce 1%
16/12/11 03:44:37 INFO mapreduce.Job:  map 17% reduce 1%
16/12/11 03:44:40 INFO mapreduce.Job:  map 19% reduce 2%
16/12/11 03:44:43 INFO mapreduce.Job:  map 20% reduce 2%
16/12/11 03:44:44 INFO mapreduce.Job:  map 21% reduce 2%
16/12/11 03:44:45 INFO mapreduce.Job:  map 25% reduce 2%
16/12/11 03:44:47 INFO mapreduce.Job:  map 28% reduce 3%
16/12/11 03:44:48 INFO mapreduce.Job:  map 32% reduce 3%
16/12/11 03:44:49 INFO mapreduce.Job:  map 35% reduce 5%
16/12/11 03:44:50 INFO mapreduce.Job:  map 37% reduce 5%
16/12/11 03:44:51 INFO mapreduce.Job:  map 44% reduce 5%
16/12/11 03:44:52 INFO mapreduce.Job:  map 47% reduce 7%
16/12/11 03:44:53 INFO mapreduce.Job:  map 49% reduce 7%
16/12/11 03:44:54 INFO mapreduce.Job:  map 53% reduce 8%
16/12/11 03:44:55 INFO mapreduce.Job:  map 56% reduce 10%
16/12/11 03:44:56 INFO mapreduce.Job:  map 60% reduce 11%
16/12/11 03:44:57 INFO mapreduce.Job:  map 65% reduce 11%
16/12/11 03:44:58 INFO mapreduce.Job:  map 69% reduce 14%
16/12/11 03:44:59 INFO mapreduce.Job:  map 73% reduce 18%
16/12/11 03:45:00 INFO mapreduce.Job:  map 76% reduce 20%
16/12/11 03:45:01 INFO mapreduce.Job:  map 78% reduce 22%
16/12/11 03:45:02 INFO mapreduce.Job:  map 83% reduce 23%
16/12/11 03:45:03 INFO mapreduce.Job:  map 85% reduce 24%
16/12/11 03:45:04 INFO mapreduce.Job:  map 87% reduce 26%
16/12/11 03:45:05 INFO mapreduce.Job:  map 89% reduce 27%
16/12/11 03:45:06 INFO mapreduce.Job:  map 92% reduce 27%
16/12/11 03:45:07 INFO mapreduce.Job:  map 92% reduce 28%
16/12/11 03:45:08 INFO mapreduce.Job:  map 93% reduce 29%
16/12/11 03:45:09 INFO mapreduce.Job:  map 94% reduce 29%
16/12/11 03:45:10 INFO mapreduce.Job:  map 95% reduce 29%
16/12/11 03:45:11 INFO mapreduce.Job:  map 95% reduce 30%
16/12/11 03:45:13 INFO mapreduce.Job:  map 96% reduce 30%
16/12/11 03:45:15 INFO mapreduce.Job:  map 98% reduce 30%
16/12/11 03:45:16 INFO mapreduce.Job:  map 98% reduce 31%
16/12/11 03:45:17 INFO mapreduce.Job:  map 99% reduce 32%
16/12/11 03:45:18 INFO mapreduce.Job:  map 100% reduce 32%
16/12/11 03:45:19 INFO mapreduce.Job:  map 100% reduce 33%
16/12/11 03:45:20 INFO mapreduce.Job:  map 100% reduce 34%
16/12/11 03:45:21 INFO mapreduce.Job:  map 100% reduce 36%
16/12/11 03:45:23 INFO mapreduce.Job:  map 100% reduce 47%
16/12/11 03:45:24 INFO mapreduce.Job:  map 100% reduce 53%
16/12/11 03:45:25 INFO mapreduce.Job:  map 100% reduce 55%
16/12/11 03:45:26 INFO mapreduce.Job:  map 100% reduce 67%
16/12/11 03:45:27 INFO mapreduce.Job:  map 100% reduce 73%
16/12/11 03:45:29 INFO mapreduce.Job:  map 100% reduce 77%
16/12/11 03:45:30 INFO mapreduce.Job:  map 100% reduce 79%
16/12/11 03:45:32 INFO mapreduce.Job:  map 100% reduce 80%
16/12/11 03:45:34 INFO mapreduce.Job:  map 100% reduce 83%
16/12/11 03:45:35 INFO mapreduce.Job:  map 100% reduce 85%
16/12/11 03:45:38 INFO mapreduce.Job:  map 100% reduce 90%
16/12/11 03:45:40 INFO mapreduce.Job:  map 100% reduce 91%
16/12/11 03:45:41 INFO mapreduce.Job:  map 100% reduce 95%
16/12/11 03:45:43 INFO mapreduce.Job:  map 100% reduce 97%
16/12/11 03:45:44 INFO mapreduce.Job:  map 100% reduce 99%
16/12/11 03:45:48 INFO mapreduce.Job:  map 100% reduce 100%
16/12/11 03:45:52 INFO mapreduce.Job: Job job_1480588584072_6682 completed successfully
16/12/11 03:45:52 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=812059904
		FILE: Number of bytes written=1659636758
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=678504292
		WASB: Number of bytes written=480317656
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=218
		Launched reduce tasks=20
		Rack-local map tasks=218
		Total time spent by all maps in occupied slots (ms)=40096536
		Total time spent by all reduces in occupied slots (ms)=2996408
		Total time spent by all map tasks (ms)=20048268
		Total time spent by all reduce tasks (ms)=1498204
		Total vcore-seconds taken by all map tasks=20048268
		Total vcore-seconds taken by all reduce tasks=1498204
		Total megabyte-seconds taken by all map tasks=20529426432
		Total megabyte-seconds taken by all reduce tasks=1534160896
	Map-Reduce Framework
		Map input records=2110783
		Map output records=1958698
		Map output bytes=804515423
		Map output materialized bytes=812085944
		Input split bytes=30359
		Combine input records=0
		Combine output records=0
		Reduce input groups=1743502
		Reduce shuffle bytes=812085944
		Reduce input records=1958698
		Reduce output records=1410744
		Spilled Records=3917396
		Shuffled Maps =4360
		Failed Shuffles=0
		Merged Map outputs=4360
		GC time elapsed (ms)=183952
		CPU time spent (ms)=1060470
		Physical memory (bytes) snapshot=358484127744
		Virtual memory (bytes) snapshot=815062065152
		Total committed heap usage (bytes)=630141747200
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=675194059
	File Output Format Counters 
		Bytes Written=480317656
16/12/11 03:45:52 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/2200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101900 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/2300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161210/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/22/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101900
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/2300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob9201657292984089136.jar tmpDir=null
16/12/11 04:42:01 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 04:42:04 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 04:42:04 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/11 04:42:06 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/11 04:42:07 INFO mapreduce.JobSubmitter: number of splits:199
16/12/11 04:42:07 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6687
16/12/11 04:42:08 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6687
16/12/11 04:42:08 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6687/
16/12/11 04:42:08 INFO mapreduce.Job: Running job: job_1480588584072_6687
16/12/11 04:42:21 INFO mapreduce.Job: Job job_1480588584072_6687 running in uber mode : false
16/12/11 04:42:21 INFO mapreduce.Job:  map 0% reduce 0%
16/12/11 04:43:06 INFO mapreduce.Job:  map 1% reduce 0%
16/12/11 04:43:18 INFO mapreduce.Job:  map 2% reduce 0%
16/12/11 04:43:19 INFO mapreduce.Job:  map 4% reduce 0%
16/12/11 04:43:20 INFO mapreduce.Job:  map 5% reduce 0%
16/12/11 04:43:22 INFO mapreduce.Job:  map 6% reduce 0%
16/12/11 04:43:25 INFO mapreduce.Job:  map 7% reduce 0%
16/12/11 04:43:26 INFO mapreduce.Job:  map 9% reduce 0%
16/12/11 04:43:28 INFO mapreduce.Job:  map 11% reduce 0%
16/12/11 04:43:29 INFO mapreduce.Job:  map 12% reduce 0%
16/12/11 04:43:30 INFO mapreduce.Job:  map 14% reduce 0%
16/12/11 04:43:31 INFO mapreduce.Job:  map 15% reduce 0%
16/12/11 04:43:32 INFO mapreduce.Job:  map 16% reduce 0%
16/12/11 04:43:34 INFO mapreduce.Job:  map 17% reduce 0%
16/12/11 04:43:36 INFO mapreduce.Job:  map 18% reduce 0%
16/12/11 04:43:45 INFO mapreduce.Job:  map 18% reduce 1%
16/12/11 04:43:47 INFO mapreduce.Job:  map 19% reduce 1%
16/12/11 04:43:50 INFO mapreduce.Job:  map 20% reduce 1%
16/12/11 04:43:51 INFO mapreduce.Job:  map 21% reduce 2%
16/12/11 04:43:52 INFO mapreduce.Job:  map 22% reduce 3%
16/12/11 04:43:54 INFO mapreduce.Job:  map 24% reduce 5%
16/12/11 04:43:55 INFO mapreduce.Job:  map 26% reduce 6%
16/12/11 04:43:56 INFO mapreduce.Job:  map 27% reduce 6%
16/12/11 04:43:57 INFO mapreduce.Job:  map 29% reduce 7%
16/12/11 04:43:58 INFO mapreduce.Job:  map 31% reduce 7%
16/12/11 04:43:59 INFO mapreduce.Job:  map 33% reduce 7%
16/12/11 04:44:00 INFO mapreduce.Job:  map 36% reduce 8%
16/12/11 04:44:01 INFO mapreduce.Job:  map 39% reduce 8%
16/12/11 04:44:02 INFO mapreduce.Job:  map 42% reduce 8%
16/12/11 04:44:03 INFO mapreduce.Job:  map 43% reduce 10%
16/12/11 04:44:04 INFO mapreduce.Job:  map 46% reduce 11%
16/12/11 04:44:05 INFO mapreduce.Job:  map 51% reduce 11%
16/12/11 04:44:06 INFO mapreduce.Job:  map 56% reduce 13%
16/12/11 04:44:07 INFO mapreduce.Job:  map 62% reduce 14%
16/12/11 04:44:08 INFO mapreduce.Job:  map 64% reduce 14%
16/12/11 04:44:09 INFO mapreduce.Job:  map 65% reduce 17%
16/12/11 04:44:11 INFO mapreduce.Job:  map 69% reduce 17%
16/12/11 04:44:12 INFO mapreduce.Job:  map 71% reduce 18%
16/12/11 04:44:16 INFO mapreduce.Job:  map 73% reduce 18%
16/12/11 04:44:17 INFO mapreduce.Job:  map 75% reduce 19%
16/12/11 04:44:18 INFO mapreduce.Job:  map 76% reduce 19%
16/12/11 04:44:19 INFO mapreduce.Job:  map 77% reduce 19%
16/12/11 04:44:20 INFO mapreduce.Job:  map 79% reduce 19%
16/12/11 04:44:21 INFO mapreduce.Job:  map 80% reduce 20%
16/12/11 04:44:22 INFO mapreduce.Job:  map 82% reduce 21%
16/12/11 04:44:23 INFO mapreduce.Job:  map 84% reduce 23%
16/12/11 04:44:24 INFO mapreduce.Job:  map 87% reduce 23%
16/12/11 04:44:25 INFO mapreduce.Job:  map 88% reduce 24%
16/12/11 04:44:26 INFO mapreduce.Job:  map 91% reduce 25%
16/12/11 04:44:27 INFO mapreduce.Job:  map 92% reduce 26%
16/12/11 04:44:28 INFO mapreduce.Job:  map 93% reduce 27%
16/12/11 04:44:29 INFO mapreduce.Job:  map 94% reduce 27%
16/12/11 04:44:30 INFO mapreduce.Job:  map 95% reduce 28%
16/12/11 04:44:31 INFO mapreduce.Job:  map 97% reduce 28%
16/12/11 04:44:32 INFO mapreduce.Job:  map 98% reduce 29%
16/12/11 04:44:33 INFO mapreduce.Job:  map 99% reduce 29%
16/12/11 04:44:34 INFO mapreduce.Job:  map 100% reduce 29%
16/12/11 04:44:35 INFO mapreduce.Job:  map 100% reduce 30%
16/12/11 04:44:36 INFO mapreduce.Job:  map 100% reduce 32%
16/12/11 04:44:37 INFO mapreduce.Job:  map 100% reduce 59%
16/12/11 04:44:38 INFO mapreduce.Job:  map 100% reduce 64%
16/12/11 04:44:39 INFO mapreduce.Job:  map 100% reduce 67%
16/12/11 04:44:40 INFO mapreduce.Job:  map 100% reduce 77%
16/12/11 04:44:41 INFO mapreduce.Job:  map 100% reduce 80%
16/12/11 04:44:43 INFO mapreduce.Job:  map 100% reduce 82%
16/12/11 04:44:44 INFO mapreduce.Job:  map 100% reduce 84%
16/12/11 04:44:45 INFO mapreduce.Job:  map 100% reduce 85%
16/12/11 04:44:46 INFO mapreduce.Job:  map 100% reduce 86%
16/12/11 04:44:47 INFO mapreduce.Job:  map 100% reduce 90%
16/12/11 04:44:48 INFO mapreduce.Job:  map 100% reduce 91%
16/12/11 04:44:49 INFO mapreduce.Job:  map 100% reduce 93%
16/12/11 04:44:50 INFO mapreduce.Job:  map 100% reduce 96%
16/12/11 04:44:51 INFO mapreduce.Job:  map 100% reduce 99%
16/12/11 04:44:54 INFO mapreduce.Job:  map 100% reduce 100%
16/12/11 04:45:04 INFO mapreduce.Job: Job job_1480588584072_6687 completed successfully
16/12/11 04:45:05 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=556793664
		FILE: Number of bytes written=1146267863
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=460414638
		WASB: Number of bytes written=324443581
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=199
		Launched reduce tasks=20
		Rack-local map tasks=199
		Total time spent by all maps in occupied slots (ms)=37832726
		Total time spent by all reduces in occupied slots (ms)=3071302
		Total time spent by all map tasks (ms)=18916363
		Total time spent by all reduce tasks (ms)=1535651
		Total vcore-seconds taken by all map tasks=18916363
		Total vcore-seconds taken by all reduce tasks=1535651
		Total megabyte-seconds taken by all map tasks=19370355712
		Total megabyte-seconds taken by all reduce tasks=1572506624
	Map-Reduce Framework
		Map input records=1439879
		Map output records=1344362
		Map output bytes=551620227
		Map output materialized bytes=556817424
		Input split bytes=27642
		Combine input records=0
		Combine output records=0
		Reduce input groups=1195027
		Reduce shuffle bytes=556817424
		Reduce input records=1344362
		Reduce output records=952568
		Spilled Records=2688724
		Shuffled Maps =3980
		Failed Shuffles=0
		Merged Map outputs=3980
		GC time elapsed (ms)=142535
		CPU time spent (ms)=872270
		Physical memory (bytes) snapshot=326661804032
		Virtual memory (bytes) snapshot=750179454976
		Total committed heap usage (bytes)=579836313600
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=457662853
	File Output Format Counters 
		Bytes Written=324443581
16/12/11 04:45:05 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161210/2300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161210/23/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8924088271060140849.jar tmpDir=null
16/12/11 05:46:15 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 05:46:16 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 05:46:17 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/11 05:46:19 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/11 05:46:19 INFO mapreduce.JobSubmitter: number of splits:197
16/12/11 05:46:20 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6693
16/12/11 05:46:21 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6693
16/12/11 05:46:21 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6693/
16/12/11 05:46:21 INFO mapreduce.Job: Running job: job_1480588584072_6693
16/12/11 05:46:37 INFO mapreduce.Job: Job job_1480588584072_6693 running in uber mode : false
16/12/11 05:46:37 INFO mapreduce.Job:  map 0% reduce 0%
16/12/11 05:47:37 INFO mapreduce.Job:  map 1% reduce 0%
16/12/11 05:47:46 INFO mapreduce.Job:  map 2% reduce 0%
16/12/11 05:47:49 INFO mapreduce.Job:  map 3% reduce 0%
16/12/11 05:47:55 INFO mapreduce.Job:  map 5% reduce 0%
16/12/11 05:47:59 INFO mapreduce.Job:  map 6% reduce 0%
16/12/11 05:48:00 INFO mapreduce.Job:  map 7% reduce 0%
16/12/11 05:48:05 INFO mapreduce.Job:  map 12% reduce 0%
16/12/11 05:48:06 INFO mapreduce.Job:  map 13% reduce 0%
16/12/11 05:48:07 INFO mapreduce.Job:  map 14% reduce 0%
16/12/11 05:48:08 INFO mapreduce.Job:  map 15% reduce 0%
16/12/11 05:48:09 INFO mapreduce.Job:  map 20% reduce 0%
16/12/11 05:48:10 INFO mapreduce.Job:  map 24% reduce 0%
16/12/11 05:48:11 INFO mapreduce.Job:  map 25% reduce 0%
16/12/11 05:48:14 INFO mapreduce.Job:  map 32% reduce 0%
16/12/11 05:48:15 INFO mapreduce.Job:  map 37% reduce 0%
16/12/11 05:48:16 INFO mapreduce.Job:  map 40% reduce 0%
16/12/11 05:48:17 INFO mapreduce.Job:  map 44% reduce 0%
16/12/11 05:48:18 INFO mapreduce.Job:  map 48% reduce 0%
16/12/11 05:48:19 INFO mapreduce.Job:  map 55% reduce 0%
16/12/11 05:48:20 INFO mapreduce.Job:  map 59% reduce 0%
16/12/11 05:48:21 INFO mapreduce.Job:  map 62% reduce 0%
16/12/11 05:48:22 INFO mapreduce.Job:  map 65% reduce 0%
16/12/11 05:48:23 INFO mapreduce.Job:  map 70% reduce 0%
16/12/11 05:48:24 INFO mapreduce.Job:  map 73% reduce 0%
16/12/11 05:48:25 INFO mapreduce.Job:  map 79% reduce 0%
16/12/11 05:48:26 INFO mapreduce.Job:  map 83% reduce 0%
16/12/11 05:48:27 INFO mapreduce.Job:  map 88% reduce 1%
16/12/11 05:48:28 INFO mapreduce.Job:  map 92% reduce 11%
16/12/11 05:48:29 INFO mapreduce.Job:  map 94% reduce 15%
16/12/11 05:48:30 INFO mapreduce.Job:  map 95% reduce 16%
16/12/11 05:48:31 INFO mapreduce.Job:  map 99% reduce 19%
16/12/11 05:48:32 INFO mapreduce.Job:  map 99% reduce 21%
16/12/11 05:48:33 INFO mapreduce.Job:  map 100% reduce 26%
16/12/11 05:48:34 INFO mapreduce.Job:  map 100% reduce 28%
16/12/11 05:48:35 INFO mapreduce.Job:  map 100% reduce 36%
16/12/11 05:48:36 INFO mapreduce.Job:  map 100% reduce 43%
16/12/11 05:48:37 INFO mapreduce.Job:  map 100% reduce 56%
16/12/11 05:48:38 INFO mapreduce.Job:  map 100% reduce 75%
16/12/11 05:48:39 INFO mapreduce.Job:  map 100% reduce 81%
16/12/11 05:48:40 INFO mapreduce.Job:  map 100% reduce 94%
16/12/11 05:48:42 INFO mapreduce.Job:  map 100% reduce 97%
16/12/11 05:48:43 INFO mapreduce.Job:  map 100% reduce 99%
16/12/11 05:48:45 INFO mapreduce.Job:  map 100% reduce 100%
16/12/11 05:48:49 INFO mapreduce.Job: Job job_1480588584072_6693 completed successfully
16/12/11 05:48:49 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=356295376
		FILE: Number of bytes written=744972717
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=294281409
		WASB: Number of bytes written=205374923
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=34215626
		Total time spent by all reduces in occupied slots (ms)=1203340
		Total time spent by all map tasks (ms)=17107813
		Total time spent by all reduce tasks (ms)=601670
		Total vcore-seconds taken by all map tasks=17107813
		Total vcore-seconds taken by all reduce tasks=601670
		Total megabyte-seconds taken by all map tasks=17518400512
		Total megabyte-seconds taken by all reduce tasks=616110080
	Map-Reduce Framework
		Map input records=921773
		Map output records=863436
		Map output bytes=352978654
		Map output materialized bytes=356318896
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=769801
		Reduce shuffle bytes=356318896
		Reduce input records=863436
		Reduce output records=604039
		Spilled Records=1726872
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=147107
		CPU time spent (ms)=736500
		Physical memory (bytes) snapshot=322549538816
		Virtual memory (bytes) snapshot=743319531520
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=291585405
	File Output Format Counters 
		Bytes Written=205374923
16/12/11 05:48:49 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/01.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01.done
16/12/11 05:48:58 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2561745168704481355.jar tmpDir=null
16/12/11 06:44:58 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 06:44:59 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 06:44:59 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/11 06:45:02 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/11 06:45:02 INFO mapreduce.JobSubmitter: number of splits:197
16/12/11 06:45:02 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6726
16/12/11 06:45:03 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6726
16/12/11 06:45:03 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6726/
16/12/11 06:45:03 INFO mapreduce.Job: Running job: job_1480588584072_6726
16/12/11 06:45:17 INFO mapreduce.Job: Job job_1480588584072_6726 running in uber mode : false
16/12/11 06:45:17 INFO mapreduce.Job:  map 0% reduce 0%
16/12/11 06:46:00 INFO mapreduce.Job:  map 1% reduce 0%
16/12/11 06:46:01 INFO mapreduce.Job:  map 3% reduce 0%
16/12/11 06:46:02 INFO mapreduce.Job:  map 4% reduce 0%
16/12/11 06:46:05 INFO mapreduce.Job:  map 5% reduce 0%
16/12/11 06:46:11 INFO mapreduce.Job:  map 6% reduce 0%
16/12/11 06:46:15 INFO mapreduce.Job:  map 7% reduce 0%
16/12/11 06:46:18 INFO mapreduce.Job:  map 8% reduce 0%
16/12/11 06:46:19 INFO mapreduce.Job:  map 9% reduce 0%
16/12/11 06:46:21 INFO mapreduce.Job:  map 10% reduce 0%
16/12/11 06:46:22 INFO mapreduce.Job:  map 12% reduce 0%
16/12/11 06:46:24 INFO mapreduce.Job:  map 13% reduce 0%
16/12/11 06:46:25 INFO mapreduce.Job:  map 15% reduce 0%
16/12/11 06:46:27 INFO mapreduce.Job:  map 16% reduce 0%
16/12/11 06:46:28 INFO mapreduce.Job:  map 17% reduce 0%
16/12/11 06:46:31 INFO mapreduce.Job:  map 18% reduce 0%
16/12/11 06:46:33 INFO mapreduce.Job:  map 20% reduce 1%
16/12/11 06:46:37 INFO mapreduce.Job:  map 21% reduce 1%
16/12/11 06:46:39 INFO mapreduce.Job:  map 22% reduce 3%
16/12/11 06:46:42 INFO mapreduce.Job:  map 23% reduce 3%
16/12/11 06:46:45 INFO mapreduce.Job:  map 24% reduce 3%
16/12/11 06:46:47 INFO mapreduce.Job:  map 26% reduce 3%
16/12/11 06:46:48 INFO mapreduce.Job:  map 27% reduce 3%
16/12/11 06:46:49 INFO mapreduce.Job:  map 28% reduce 3%
16/12/11 06:46:50 INFO mapreduce.Job:  map 30% reduce 3%
16/12/11 06:46:51 INFO mapreduce.Job:  map 30% reduce 4%
16/12/11 06:46:52 INFO mapreduce.Job:  map 32% reduce 4%
16/12/11 06:46:53 INFO mapreduce.Job:  map 34% reduce 4%
16/12/11 06:46:54 INFO mapreduce.Job:  map 36% reduce 5%
16/12/11 06:46:55 INFO mapreduce.Job:  map 38% reduce 7%
16/12/11 06:46:56 INFO mapreduce.Job:  map 42% reduce 8%
16/12/11 06:46:57 INFO mapreduce.Job:  map 44% reduce 10%
16/12/11 06:46:58 INFO mapreduce.Job:  map 49% reduce 11%
16/12/11 06:46:59 INFO mapreduce.Job:  map 53% reduce 12%
16/12/11 06:47:00 INFO mapreduce.Job:  map 57% reduce 13%
16/12/11 06:47:01 INFO mapreduce.Job:  map 61% reduce 15%
16/12/11 06:47:02 INFO mapreduce.Job:  map 67% reduce 17%
16/12/11 06:47:03 INFO mapreduce.Job:  map 72% reduce 19%
16/12/11 06:47:04 INFO mapreduce.Job:  map 74% reduce 21%
16/12/11 06:47:05 INFO mapreduce.Job:  map 79% reduce 22%
16/12/11 06:47:06 INFO mapreduce.Job:  map 83% reduce 24%
16/12/11 06:47:07 INFO mapreduce.Job:  map 86% reduce 26%
16/12/11 06:47:08 INFO mapreduce.Job:  map 92% reduce 27%
16/12/11 06:47:09 INFO mapreduce.Job:  map 94% reduce 28%
16/12/11 06:47:10 INFO mapreduce.Job:  map 98% reduce 30%
16/12/11 06:47:11 INFO mapreduce.Job:  map 99% reduce 31%
16/12/11 06:47:12 INFO mapreduce.Job:  map 100% reduce 32%
16/12/11 06:47:13 INFO mapreduce.Job:  map 100% reduce 33%
16/12/11 06:47:16 INFO mapreduce.Job:  map 100% reduce 40%
16/12/11 06:47:17 INFO mapreduce.Job:  map 100% reduce 45%
16/12/11 06:47:18 INFO mapreduce.Job:  map 100% reduce 50%
16/12/11 06:47:19 INFO mapreduce.Job:  map 100% reduce 59%
16/12/11 06:47:20 INFO mapreduce.Job:  map 100% reduce 69%
16/12/11 06:47:21 INFO mapreduce.Job:  map 100% reduce 75%
16/12/11 06:47:22 INFO mapreduce.Job:  map 100% reduce 84%
16/12/11 06:47:23 INFO mapreduce.Job:  map 100% reduce 89%
16/12/11 06:47:24 INFO mapreduce.Job:  map 100% reduce 92%
16/12/11 06:47:25 INFO mapreduce.Job:  map 100% reduce 94%
16/12/11 06:47:27 INFO mapreduce.Job:  map 100% reduce 97%
16/12/11 06:47:28 INFO mapreduce.Job:  map 100% reduce 98%
16/12/11 06:47:30 INFO mapreduce.Job:  map 100% reduce 100%
16/12/11 06:47:39 INFO mapreduce.Job: Job job_1480588584072_6726 completed successfully
16/12/11 06:47:39 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=230853404
		FILE: Number of bytes written=494088773
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=191732791
		WASB: Number of bytes written=128118951
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=30132150
		Total time spent by all reduces in occupied slots (ms)=2491264
		Total time spent by all map tasks (ms)=15066075
		Total time spent by all reduce tasks (ms)=1245632
		Total vcore-seconds taken by all map tasks=15066075
		Total vcore-seconds taken by all reduce tasks=1245632
		Total megabyte-seconds taken by all map tasks=15427660800
		Total megabyte-seconds taken by all reduce tasks=1275527168
	Map-Reduce Framework
		Map input records=606749
		Map output records=565147
		Map output bytes=228695111
		Map output materialized bytes=230876924
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=504393
		Reduce shuffle bytes=230876924
		Reduce input records=565147
		Reduce output records=380644
		Spilled Records=1130294
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=147884
		CPU time spent (ms)=718730
		Physical memory (bytes) snapshot=321913077760
		Virtual memory (bytes) snapshot=743484973056
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=189036787
	File Output Format Counters 
		Bytes Written=128118951
16/12/11 06:47:39 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01.done
16/12/11 06:47:45 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5271837398133576382.jar tmpDir=null
16/12/11 07:43:49 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 07:43:49 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 07:43:51 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/11 07:43:55 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/11 07:43:55 INFO mapreduce.JobSubmitter: number of splits:197
16/12/11 07:43:55 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6770
16/12/11 07:43:56 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6770
16/12/11 07:43:56 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6770/
16/12/11 07:43:56 INFO mapreduce.Job: Running job: job_1480588584072_6770
16/12/11 07:44:15 INFO mapreduce.Job: Job job_1480588584072_6770 running in uber mode : false
16/12/11 07:44:15 INFO mapreduce.Job:  map 0% reduce 0%
16/12/11 07:45:19 INFO mapreduce.Job:  map 1% reduce 0%
16/12/11 07:45:25 INFO mapreduce.Job:  map 2% reduce 0%
16/12/11 07:45:27 INFO mapreduce.Job:  map 4% reduce 0%
16/12/11 07:45:30 INFO mapreduce.Job:  map 5% reduce 0%
16/12/11 07:45:31 INFO mapreduce.Job:  map 6% reduce 0%
16/12/11 07:45:34 INFO mapreduce.Job:  map 9% reduce 0%
16/12/11 07:45:36 INFO mapreduce.Job:  map 11% reduce 0%
16/12/11 07:45:37 INFO mapreduce.Job:  map 12% reduce 0%
16/12/11 07:45:38 INFO mapreduce.Job:  map 13% reduce 0%
16/12/11 07:45:39 INFO mapreduce.Job:  map 15% reduce 0%
16/12/11 07:45:41 INFO mapreduce.Job:  map 17% reduce 0%
16/12/11 07:45:42 INFO mapreduce.Job:  map 18% reduce 0%
16/12/11 07:45:44 INFO mapreduce.Job:  map 19% reduce 0%
16/12/11 07:45:45 INFO mapreduce.Job:  map 20% reduce 1%
16/12/11 07:45:46 INFO mapreduce.Job:  map 21% reduce 1%
16/12/11 07:45:47 INFO mapreduce.Job:  map 22% reduce 1%
16/12/11 07:45:48 INFO mapreduce.Job:  map 24% reduce 1%
16/12/11 07:45:49 INFO mapreduce.Job:  map 24% reduce 2%
16/12/11 07:45:50 INFO mapreduce.Job:  map 26% reduce 2%
16/12/11 07:45:51 INFO mapreduce.Job:  map 28% reduce 2%
16/12/11 07:45:52 INFO mapreduce.Job:  map 29% reduce 3%
16/12/11 07:45:53 INFO mapreduce.Job:  map 33% reduce 3%
16/12/11 07:45:54 INFO mapreduce.Job:  map 36% reduce 3%
16/12/11 07:45:55 INFO mapreduce.Job:  map 40% reduce 4%
16/12/11 07:45:56 INFO mapreduce.Job:  map 42% reduce 5%
16/12/11 07:45:58 INFO mapreduce.Job:  map 47% reduce 8%
16/12/11 07:45:59 INFO mapreduce.Job:  map 52% reduce 11%
16/12/11 07:46:00 INFO mapreduce.Job:  map 55% reduce 12%
16/12/11 07:46:01 INFO mapreduce.Job:  map 61% reduce 14%
16/12/11 07:46:02 INFO mapreduce.Job:  map 63% reduce 16%
16/12/11 07:46:03 INFO mapreduce.Job:  map 67% reduce 17%
16/12/11 07:46:04 INFO mapreduce.Job:  map 73% reduce 18%
16/12/11 07:46:05 INFO mapreduce.Job:  map 75% reduce 21%
16/12/11 07:46:06 INFO mapreduce.Job:  map 76% reduce 22%
16/12/11 07:46:07 INFO mapreduce.Job:  map 76% reduce 23%
16/12/11 07:46:08 INFO mapreduce.Job:  map 76% reduce 24%
16/12/11 07:46:11 INFO mapreduce.Job:  map 77% reduce 24%
16/12/11 07:46:12 INFO mapreduce.Job:  map 77% reduce 25%
16/12/11 07:46:13 INFO mapreduce.Job:  map 78% reduce 25%
16/12/11 07:46:15 INFO mapreduce.Job:  map 79% reduce 25%
16/12/11 07:46:16 INFO mapreduce.Job:  map 79% reduce 26%
16/12/11 07:46:17 INFO mapreduce.Job:  map 80% reduce 26%
16/12/11 07:46:19 INFO mapreduce.Job:  map 81% reduce 26%
16/12/11 07:46:20 INFO mapreduce.Job:  map 83% reduce 26%
16/12/11 07:46:21 INFO mapreduce.Job:  map 84% reduce 27%
16/12/11 07:46:22 INFO mapreduce.Job:  map 86% reduce 27%
16/12/11 07:46:23 INFO mapreduce.Job:  map 88% reduce 28%
16/12/11 07:46:25 INFO mapreduce.Job:  map 90% reduce 29%
16/12/11 07:46:26 INFO mapreduce.Job:  map 93% reduce 29%
16/12/11 07:46:27 INFO mapreduce.Job:  map 97% reduce 29%
16/12/11 07:46:28 INFO mapreduce.Job:  map 99% reduce 31%
16/12/11 07:46:29 INFO mapreduce.Job:  map 100% reduce 32%
16/12/11 07:46:31 INFO mapreduce.Job:  map 100% reduce 39%
16/12/11 07:46:32 INFO mapreduce.Job:  map 100% reduce 51%
16/12/11 07:46:33 INFO mapreduce.Job:  map 100% reduce 65%
16/12/11 07:46:34 INFO mapreduce.Job:  map 100% reduce 74%
16/12/11 07:46:35 INFO mapreduce.Job:  map 100% reduce 82%
16/12/11 07:46:36 INFO mapreduce.Job:  map 100% reduce 89%
16/12/11 07:46:37 INFO mapreduce.Job:  map 100% reduce 91%
16/12/11 07:46:38 INFO mapreduce.Job:  map 100% reduce 96%
16/12/11 07:46:39 INFO mapreduce.Job:  map 100% reduce 100%
16/12/11 07:46:42 INFO mapreduce.Job: Job job_1480588584072_6770 completed successfully
16/12/11 07:46:42 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=170724733
		FILE: Number of bytes written=373831431
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=144293180
		WASB: Number of bytes written=81739239
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=39233578
		Total time spent by all reduces in occupied slots (ms)=2396676
		Total time spent by all map tasks (ms)=19616789
		Total time spent by all reduce tasks (ms)=1198338
		Total vcore-seconds taken by all map tasks=19616789
		Total vcore-seconds taken by all reduce tasks=1198338
		Total megabyte-seconds taken by all map tasks=20087591936
		Total megabyte-seconds taken by all reduce tasks=1227098112
	Map-Reduce Framework
		Map input records=463826
		Map output records=421893
		Map output bytes=169110277
		Map output materialized bytes=170748253
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=370685
		Reduce shuffle bytes=170748253
		Reduce input records=421893
		Reduce output records=243366
		Spilled Records=843786
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=157284
		CPU time spent (ms)=677520
		Physical memory (bytes) snapshot=321758674944
		Virtual memory (bytes) snapshot=743425998848
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=141597176
	File Output Format Counters 
		Bytes Written=81739239
16/12/11 07:46:42 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612101900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob6641390815770394526.jar tmpDir=null
16/12/11 08:42:52 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 08:42:55 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 08:42:55 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/11 08:42:58 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/11 08:42:58 INFO mapreduce.JobSubmitter: number of splits:197
16/12/11 08:42:58 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6781
16/12/11 08:42:59 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6781
16/12/11 08:42:59 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6781/
16/12/11 08:42:59 INFO mapreduce.Job: Running job: job_1480588584072_6781
16/12/11 08:43:12 INFO mapreduce.Job: Job job_1480588584072_6781 running in uber mode : false
16/12/11 08:43:12 INFO mapreduce.Job:  map 0% reduce 0%
16/12/11 08:44:02 INFO mapreduce.Job:  map 1% reduce 0%
16/12/11 08:44:08 INFO mapreduce.Job:  map 2% reduce 0%
16/12/11 08:44:10 INFO mapreduce.Job:  map 3% reduce 0%
16/12/11 08:44:12 INFO mapreduce.Job:  map 4% reduce 0%
16/12/11 08:44:13 INFO mapreduce.Job:  map 6% reduce 0%
16/12/11 08:44:14 INFO mapreduce.Job:  map 8% reduce 0%
16/12/11 08:44:15 INFO mapreduce.Job:  map 9% reduce 0%
16/12/11 08:44:16 INFO mapreduce.Job:  map 10% reduce 0%
16/12/11 08:44:18 INFO mapreduce.Job:  map 14% reduce 0%
16/12/11 08:44:19 INFO mapreduce.Job:  map 15% reduce 0%
16/12/11 08:44:20 INFO mapreduce.Job:  map 16% reduce 0%
16/12/11 08:44:21 INFO mapreduce.Job:  map 18% reduce 0%
16/12/11 08:44:23 INFO mapreduce.Job:  map 19% reduce 0%
16/12/11 08:44:32 INFO mapreduce.Job:  map 20% reduce 0%
16/12/11 08:44:33 INFO mapreduce.Job:  map 21% reduce 0%
16/12/11 08:44:34 INFO mapreduce.Job:  map 21% reduce 1%
16/12/11 08:44:36 INFO mapreduce.Job:  map 21% reduce 2%
16/12/11 08:44:38 INFO mapreduce.Job:  map 22% reduce 3%
16/12/11 08:44:39 INFO mapreduce.Job:  map 23% reduce 4%
16/12/11 08:44:41 INFO mapreduce.Job:  map 24% reduce 5%
16/12/11 08:44:42 INFO mapreduce.Job:  map 25% reduce 6%
16/12/11 08:44:43 INFO mapreduce.Job:  map 27% reduce 6%
16/12/11 08:44:44 INFO mapreduce.Job:  map 29% reduce 7%
16/12/11 08:44:45 INFO mapreduce.Job:  map 30% reduce 7%
16/12/11 08:44:46 INFO mapreduce.Job:  map 31% reduce 7%
16/12/11 08:44:47 INFO mapreduce.Job:  map 33% reduce 8%
16/12/11 08:44:48 INFO mapreduce.Job:  map 34% reduce 8%
16/12/11 08:44:49 INFO mapreduce.Job:  map 38% reduce 8%
16/12/11 08:44:50 INFO mapreduce.Job:  map 41% reduce 9%
16/12/11 08:44:51 INFO mapreduce.Job:  map 45% reduce 9%
16/12/11 08:44:52 INFO mapreduce.Job:  map 49% reduce 10%
16/12/11 08:44:53 INFO mapreduce.Job:  map 55% reduce 11%
16/12/11 08:44:54 INFO mapreduce.Job:  map 60% reduce 13%
16/12/11 08:44:55 INFO mapreduce.Job:  map 64% reduce 14%
16/12/11 08:44:56 INFO mapreduce.Job:  map 65% reduce 16%
16/12/11 08:44:57 INFO mapreduce.Job:  map 67% reduce 17%
16/12/11 08:44:58 INFO mapreduce.Job:  map 69% reduce 18%
16/12/11 08:44:59 INFO mapreduce.Job:  map 71% reduce 19%
16/12/11 08:45:00 INFO mapreduce.Job:  map 72% reduce 22%
16/12/11 08:45:01 INFO mapreduce.Job:  map 74% reduce 23%
16/12/11 08:45:02 INFO mapreduce.Job:  map 76% reduce 24%
16/12/11 08:45:03 INFO mapreduce.Job:  map 78% reduce 25%
16/12/11 08:45:04 INFO mapreduce.Job:  map 79% reduce 25%
16/12/11 08:45:05 INFO mapreduce.Job:  map 80% reduce 26%
16/12/11 08:45:06 INFO mapreduce.Job:  map 81% reduce 26%
16/12/11 08:45:07 INFO mapreduce.Job:  map 82% reduce 26%
16/12/11 08:45:08 INFO mapreduce.Job:  map 83% reduce 27%
16/12/11 08:45:10 INFO mapreduce.Job:  map 85% reduce 27%
16/12/11 08:45:11 INFO mapreduce.Job:  map 86% reduce 28%
16/12/11 08:45:13 INFO mapreduce.Job:  map 87% reduce 28%
16/12/11 08:45:15 INFO mapreduce.Job:  map 88% reduce 29%
16/12/11 08:45:16 INFO mapreduce.Job:  map 89% reduce 29%
16/12/11 08:45:18 INFO mapreduce.Job:  map 90% reduce 29%
16/12/11 08:45:19 INFO mapreduce.Job:  map 90% reduce 30%
16/12/11 08:45:20 INFO mapreduce.Job:  map 92% reduce 30%
16/12/11 08:45:21 INFO mapreduce.Job:  map 94% reduce 30%
16/12/11 08:45:22 INFO mapreduce.Job:  map 96% reduce 31%
16/12/11 08:45:23 INFO mapreduce.Job:  map 99% reduce 31%
16/12/11 08:45:24 INFO mapreduce.Job:  map 100% reduce 33%
16/12/11 08:45:25 INFO mapreduce.Job:  map 100% reduce 35%
16/12/11 08:45:26 INFO mapreduce.Job:  map 100% reduce 40%
16/12/11 08:45:27 INFO mapreduce.Job:  map 100% reduce 75%
16/12/11 08:45:29 INFO mapreduce.Job:  map 100% reduce 83%
16/12/11 08:45:30 INFO mapreduce.Job:  map 100% reduce 89%
16/12/11 08:45:31 INFO mapreduce.Job:  map 100% reduce 92%
16/12/11 08:45:32 INFO mapreduce.Job:  map 100% reduce 98%
16/12/11 08:45:33 INFO mapreduce.Job:  map 100% reduce 100%
16/12/11 08:45:38 INFO mapreduce.Job: Job job_1480588584072_6781 completed successfully
16/12/11 08:45:38 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=166959602
		FILE: Number of bytes written=366301169
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=142678956
		WASB: Number of bytes written=68294830
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=35690088
		Total time spent by all reduces in occupied slots (ms)=2846068
		Total time spent by all map tasks (ms)=17845044
		Total time spent by all reduce tasks (ms)=1423034
		Total vcore-seconds taken by all map tasks=17845044
		Total vcore-seconds taken by all reduce tasks=1423034
		Total megabyte-seconds taken by all map tasks=18273325056
		Total megabyte-seconds taken by all reduce tasks=1457186816
	Map-Reduce Framework
		Map input records=465639
		Map output records=415151
		Map output bytes=165368922
		Map output materialized bytes=166983122
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=359214
		Reduce shuffle bytes=166983122
		Reduce input records=415151
		Reduce output records=205258
		Spilled Records=830302
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=141128
		CPU time spent (ms)=674760
		Physical memory (bytes) snapshot=321621237760
		Virtual memory (bytes) snapshot=743634096128
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=139982952
	File Output Format Counters 
		Bytes Written=68294830
16/12/11 08:45:38 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0400 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0400': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2803459682191210251.jar tmpDir=null
16/12/11 09:41:53 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 09:41:54 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 09:41:55 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/11 09:41:57 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/11 09:42:01 INFO mapreduce.JobSubmitter: number of splits:197
16/12/11 09:42:02 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6793
16/12/11 09:42:03 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6793
16/12/11 09:42:03 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6793/
16/12/11 09:42:03 INFO mapreduce.Job: Running job: job_1480588584072_6793
16/12/11 09:42:19 INFO mapreduce.Job: Job job_1480588584072_6793 running in uber mode : false
16/12/11 09:42:19 INFO mapreduce.Job:  map 0% reduce 0%
16/12/11 09:43:04 INFO mapreduce.Job:  map 1% reduce 0%
16/12/11 09:43:15 INFO mapreduce.Job:  map 2% reduce 0%
16/12/11 09:43:16 INFO mapreduce.Job:  map 5% reduce 0%
16/12/11 09:43:17 INFO mapreduce.Job:  map 7% reduce 0%
16/12/11 09:43:18 INFO mapreduce.Job:  map 8% reduce 0%
16/12/11 09:43:19 INFO mapreduce.Job:  map 10% reduce 0%
16/12/11 09:43:21 INFO mapreduce.Job:  map 12% reduce 0%
16/12/11 09:43:22 INFO mapreduce.Job:  map 14% reduce 0%
16/12/11 09:43:23 INFO mapreduce.Job:  map 16% reduce 0%
16/12/11 09:43:24 INFO mapreduce.Job:  map 17% reduce 0%
16/12/11 09:43:27 INFO mapreduce.Job:  map 18% reduce 0%
16/12/11 09:43:38 INFO mapreduce.Job:  map 19% reduce 1%
16/12/11 09:43:39 INFO mapreduce.Job:  map 20% reduce 1%
16/12/11 09:43:40 INFO mapreduce.Job:  map 20% reduce 2%
16/12/11 09:43:42 INFO mapreduce.Job:  map 21% reduce 3%
16/12/11 09:43:43 INFO mapreduce.Job:  map 21% reduce 4%
16/12/11 09:43:44 INFO mapreduce.Job:  map 23% reduce 5%
16/12/11 09:43:45 INFO mapreduce.Job:  map 26% reduce 6%
16/12/11 09:43:46 INFO mapreduce.Job:  map 29% reduce 6%
16/12/11 09:43:47 INFO mapreduce.Job:  map 31% reduce 6%
16/12/11 09:43:48 INFO mapreduce.Job:  map 34% reduce 7%
16/12/11 09:43:49 INFO mapreduce.Job:  map 36% reduce 8%
16/12/11 09:43:50 INFO mapreduce.Job:  map 36% reduce 9%
16/12/11 09:43:51 INFO mapreduce.Job:  map 38% reduce 9%
16/12/11 09:43:53 INFO mapreduce.Job:  map 39% reduce 9%
16/12/11 09:43:54 INFO mapreduce.Job:  map 40% reduce 10%
16/12/11 09:43:56 INFO mapreduce.Job:  map 42% reduce 12%
16/12/11 09:43:57 INFO mapreduce.Job:  map 44% reduce 12%
16/12/11 09:43:58 INFO mapreduce.Job:  map 45% reduce 13%
16/12/11 09:43:59 INFO mapreduce.Job:  map 47% reduce 13%
16/12/11 09:44:00 INFO mapreduce.Job:  map 49% reduce 14%
16/12/11 09:44:01 INFO mapreduce.Job:  map 51% reduce 14%
16/12/11 09:44:02 INFO mapreduce.Job:  map 54% reduce 15%
16/12/11 09:44:03 INFO mapreduce.Job:  map 56% reduce 16%
16/12/11 09:44:04 INFO mapreduce.Job:  map 59% reduce 16%
16/12/11 09:44:05 INFO mapreduce.Job:  map 61% reduce 17%
16/12/11 09:44:06 INFO mapreduce.Job:  map 62% reduce 18%
16/12/11 09:44:07 INFO mapreduce.Job:  map 64% reduce 19%
16/12/11 09:44:08 INFO mapreduce.Job:  map 66% reduce 20%
16/12/11 09:44:09 INFO mapreduce.Job:  map 68% reduce 21%
16/12/11 09:44:11 INFO mapreduce.Job:  map 69% reduce 22%
16/12/11 09:44:12 INFO mapreduce.Job:  map 72% reduce 22%
16/12/11 09:44:13 INFO mapreduce.Job:  map 75% reduce 22%
16/12/11 09:44:14 INFO mapreduce.Job:  map 76% reduce 23%
16/12/11 09:44:15 INFO mapreduce.Job:  map 77% reduce 24%
16/12/11 09:44:16 INFO mapreduce.Job:  map 77% reduce 25%
16/12/11 09:44:17 INFO mapreduce.Job:  map 78% reduce 25%
16/12/11 09:44:18 INFO mapreduce.Job:  map 79% reduce 26%
16/12/11 09:44:19 INFO mapreduce.Job:  map 80% reduce 26%
16/12/11 09:44:20 INFO mapreduce.Job:  map 81% reduce 26%
16/12/11 09:44:24 INFO mapreduce.Job:  map 82% reduce 26%
16/12/11 09:44:25 INFO mapreduce.Job:  map 84% reduce 26%
16/12/11 09:44:26 INFO mapreduce.Job:  map 85% reduce 26%
16/12/11 09:44:27 INFO mapreduce.Job:  map 85% reduce 27%
16/12/11 09:44:28 INFO mapreduce.Job:  map 87% reduce 27%
16/12/11 09:44:29 INFO mapreduce.Job:  map 88% reduce 27%
16/12/11 09:44:30 INFO mapreduce.Job:  map 90% reduce 28%
16/12/11 09:44:31 INFO mapreduce.Job:  map 91% reduce 28%
16/12/11 09:44:32 INFO mapreduce.Job:  map 93% reduce 29%
16/12/11 09:44:33 INFO mapreduce.Job:  map 95% reduce 30%
16/12/11 09:44:34 INFO mapreduce.Job:  map 97% reduce 31%
16/12/11 09:44:35 INFO mapreduce.Job:  map 99% reduce 31%
16/12/11 09:44:36 INFO mapreduce.Job:  map 99% reduce 32%
16/12/11 09:44:37 INFO mapreduce.Job:  map 99% reduce 33%
16/12/11 09:44:40 INFO mapreduce.Job:  map 100% reduce 33%
16/12/11 09:44:41 INFO mapreduce.Job:  map 100% reduce 37%
16/12/11 09:44:42 INFO mapreduce.Job:  map 100% reduce 42%
16/12/11 09:44:43 INFO mapreduce.Job:  map 100% reduce 63%
16/12/11 09:44:44 INFO mapreduce.Job:  map 100% reduce 74%
16/12/11 09:44:45 INFO mapreduce.Job:  map 100% reduce 80%
16/12/11 09:44:46 INFO mapreduce.Job:  map 100% reduce 84%
16/12/11 09:44:47 INFO mapreduce.Job:  map 100% reduce 88%
16/12/11 09:44:48 INFO mapreduce.Job:  map 100% reduce 90%
16/12/11 09:44:49 INFO mapreduce.Job:  map 100% reduce 96%
16/12/11 09:44:50 INFO mapreduce.Job:  map 100% reduce 98%
16/12/11 09:44:51 INFO mapreduce.Job:  map 100% reduce 100%
16/12/11 09:44:56 INFO mapreduce.Job: Job job_1480588584072_6793 completed successfully
16/12/11 09:44:56 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=242606293
		FILE: Number of bytes written=517594551
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=208484664
		WASB: Number of bytes written=103919711
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=37185476
		Total time spent by all reduces in occupied slots (ms)=3391830
		Total time spent by all map tasks (ms)=18592738
		Total time spent by all reduce tasks (ms)=1695915
		Total vcore-seconds taken by all map tasks=18592738
		Total vcore-seconds taken by all reduce tasks=1695915
		Total megabyte-seconds taken by all map tasks=19038963712
		Total megabyte-seconds taken by all reduce tasks=1736616960
	Map-Reduce Framework
		Map input records=683807
		Map output records=603063
		Map output bytes=240298635
		Map output materialized bytes=242629813
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=521919
		Reduce shuffle bytes=242629813
		Reduce input records=603063
		Reduce output records=314125
		Spilled Records=1206126
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=170849
		CPU time spent (ms)=758550
		Physical memory (bytes) snapshot=322176266240
		Virtual memory (bytes) snapshot=742784954368
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=205788660
	File Output Format Counters 
		Bytes Written=103919711
16/12/11 09:44:56 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0400
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0500 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0500': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob3530241707970066727.jar tmpDir=null
16/12/11 10:46:13 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 10:46:14 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 10:46:14 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/11 10:46:17 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/11 10:46:17 INFO mapreduce.JobSubmitter: number of splits:197
16/12/11 10:46:18 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6797
16/12/11 10:46:19 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6797
16/12/11 10:46:19 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6797/
16/12/11 10:46:19 INFO mapreduce.Job: Running job: job_1480588584072_6797
16/12/11 10:46:33 INFO mapreduce.Job: Job job_1480588584072_6797 running in uber mode : false
16/12/11 10:46:33 INFO mapreduce.Job:  map 0% reduce 0%
16/12/11 10:47:39 INFO mapreduce.Job:  map 1% reduce 0%
16/12/11 10:47:40 INFO mapreduce.Job:  map 2% reduce 0%
16/12/11 10:47:42 INFO mapreduce.Job:  map 4% reduce 0%
16/12/11 10:47:43 INFO mapreduce.Job:  map 5% reduce 0%
16/12/11 10:47:44 INFO mapreduce.Job:  map 6% reduce 0%
16/12/11 10:47:45 INFO mapreduce.Job:  map 7% reduce 0%
16/12/11 10:47:46 INFO mapreduce.Job:  map 9% reduce 0%
16/12/11 10:47:47 INFO mapreduce.Job:  map 11% reduce 0%
16/12/11 10:47:48 INFO mapreduce.Job:  map 12% reduce 0%
16/12/11 10:47:49 INFO mapreduce.Job:  map 14% reduce 0%
16/12/11 10:47:50 INFO mapreduce.Job:  map 15% reduce 0%
16/12/11 10:47:57 INFO mapreduce.Job:  map 16% reduce 0%
16/12/11 10:47:58 INFO mapreduce.Job:  map 16% reduce 1%
16/12/11 10:48:00 INFO mapreduce.Job:  map 17% reduce 1%
16/12/11 10:48:03 INFO mapreduce.Job:  map 18% reduce 1%
16/12/11 10:48:06 INFO mapreduce.Job:  map 20% reduce 1%
16/12/11 10:48:07 INFO mapreduce.Job:  map 20% reduce 2%
16/12/11 10:48:08 INFO mapreduce.Job:  map 22% reduce 2%
16/12/11 10:48:09 INFO mapreduce.Job:  map 23% reduce 2%
16/12/11 10:48:10 INFO mapreduce.Job:  map 25% reduce 4%
16/12/11 10:48:11 INFO mapreduce.Job:  map 29% reduce 4%
16/12/11 10:48:12 INFO mapreduce.Job:  map 31% reduce 5%
16/12/11 10:48:13 INFO mapreduce.Job:  map 34% reduce 6%
16/12/11 10:48:14 INFO mapreduce.Job:  map 37% reduce 8%
16/12/11 10:48:15 INFO mapreduce.Job:  map 41% reduce 9%
16/12/11 10:48:16 INFO mapreduce.Job:  map 44% reduce 10%
16/12/11 10:48:17 INFO mapreduce.Job:  map 46% reduce 11%
16/12/11 10:48:18 INFO mapreduce.Job:  map 49% reduce 12%
16/12/11 10:48:19 INFO mapreduce.Job:  map 51% reduce 13%
16/12/11 10:48:20 INFO mapreduce.Job:  map 54% reduce 14%
16/12/11 10:48:21 INFO mapreduce.Job:  map 55% reduce 14%
16/12/11 10:48:22 INFO mapreduce.Job:  map 58% reduce 15%
16/12/11 10:48:23 INFO mapreduce.Job:  map 61% reduce 15%
16/12/11 10:48:24 INFO mapreduce.Job:  map 64% reduce 16%
16/12/11 10:48:25 INFO mapreduce.Job:  map 68% reduce 18%
16/12/11 10:48:26 INFO mapreduce.Job:  map 69% reduce 19%
16/12/11 10:48:27 INFO mapreduce.Job:  map 72% reduce 20%
16/12/11 10:48:28 INFO mapreduce.Job:  map 74% reduce 21%
16/12/11 10:48:29 INFO mapreduce.Job:  map 75% reduce 22%
16/12/11 10:48:30 INFO mapreduce.Job:  map 78% reduce 23%
16/12/11 10:48:31 INFO mapreduce.Job:  map 80% reduce 24%
16/12/11 10:48:32 INFO mapreduce.Job:  map 81% reduce 25%
16/12/11 10:48:34 INFO mapreduce.Job:  map 82% reduce 26%
16/12/11 10:48:35 INFO mapreduce.Job:  map 83% reduce 26%
16/12/11 10:48:37 INFO mapreduce.Job:  map 84% reduce 27%
16/12/11 10:48:41 INFO mapreduce.Job:  map 85% reduce 28%
16/12/11 10:48:42 INFO mapreduce.Job:  map 86% reduce 28%
16/12/11 10:48:44 INFO mapreduce.Job:  map 88% reduce 28%
16/12/11 10:48:45 INFO mapreduce.Job:  map 89% reduce 29%
16/12/11 10:48:46 INFO mapreduce.Job:  map 91% reduce 29%
16/12/11 10:48:47 INFO mapreduce.Job:  map 93% reduce 29%
16/12/11 10:48:48 INFO mapreduce.Job:  map 95% reduce 30%
16/12/11 10:48:49 INFO mapreduce.Job:  map 96% reduce 30%
16/12/11 10:48:50 INFO mapreduce.Job:  map 98% reduce 31%
16/12/11 10:48:51 INFO mapreduce.Job:  map 99% reduce 32%
16/12/11 10:48:52 INFO mapreduce.Job:  map 100% reduce 33%
16/12/11 10:48:53 INFO mapreduce.Job:  map 100% reduce 35%
16/12/11 10:48:54 INFO mapreduce.Job:  map 100% reduce 40%
16/12/11 10:48:55 INFO mapreduce.Job:  map 100% reduce 48%
16/12/11 10:48:56 INFO mapreduce.Job:  map 100% reduce 57%
16/12/11 10:48:57 INFO mapreduce.Job:  map 100% reduce 64%
16/12/11 10:48:58 INFO mapreduce.Job:  map 100% reduce 72%
16/12/11 10:48:59 INFO mapreduce.Job:  map 100% reduce 73%
16/12/11 10:49:00 INFO mapreduce.Job:  map 100% reduce 76%
16/12/11 10:49:01 INFO mapreduce.Job:  map 100% reduce 80%
16/12/11 10:49:02 INFO mapreduce.Job:  map 100% reduce 81%
16/12/11 10:49:03 INFO mapreduce.Job:  map 100% reduce 82%
16/12/11 10:49:04 INFO mapreduce.Job:  map 100% reduce 86%
16/12/11 10:49:05 INFO mapreduce.Job:  map 100% reduce 89%
16/12/11 10:49:06 INFO mapreduce.Job:  map 100% reduce 90%
16/12/11 10:49:07 INFO mapreduce.Job:  map 100% reduce 95%
16/12/11 10:49:08 INFO mapreduce.Job:  map 100% reduce 98%
16/12/11 10:49:09 INFO mapreduce.Job:  map 100% reduce 99%
16/12/11 10:49:10 INFO mapreduce.Job:  map 100% reduce 100%
16/12/11 10:49:16 INFO mapreduce.Job: Job job_1480588584072_6797 completed successfully
16/12/11 10:49:16 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=385962341
		FILE: Number of bytes written=804306647
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=327840245
		WASB: Number of bytes written=189724758
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=40720278
		Total time spent by all reduces in occupied slots (ms)=3100712
		Total time spent by all map tasks (ms)=20360139
		Total time spent by all reduce tasks (ms)=1550356
		Total vcore-seconds taken by all map tasks=20360139
		Total vcore-seconds taken by all reduce tasks=1550356
		Total megabyte-seconds taken by all map tasks=20848782336
		Total megabyte-seconds taken by all reduce tasks=1587564544
	Map-Reduce Framework
		Map input records=1056100
		Map output records=946307
		Map output bytes=382325192
		Map output materialized bytes=385985861
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=825112
		Reduce shuffle bytes=385985861
		Reduce input records=946307
		Reduce output records=564687
		Spilled Records=1892614
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=145720
		CPU time spent (ms)=840260
		Physical memory (bytes) snapshot=323044274176
		Virtual memory (bytes) snapshot=743819431936
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=325144241
	File Output Format Counters 
		Bytes Written=189724758
16/12/11 10:49:16 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0500
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0600 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0600': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2571714588728712952.jar tmpDir=null
16/12/11 11:45:24 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 11:45:25 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 11:45:25 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/11 11:45:28 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/11 11:45:28 INFO mapreduce.JobSubmitter: number of splits:197
16/12/11 11:45:29 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6802
16/12/11 11:45:29 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6802
16/12/11 11:45:29 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6802/
16/12/11 11:45:29 INFO mapreduce.Job: Running job: job_1480588584072_6802
16/12/11 11:45:44 INFO mapreduce.Job: Job job_1480588584072_6802 running in uber mode : false
16/12/11 11:45:44 INFO mapreduce.Job:  map 0% reduce 0%
16/12/11 11:46:40 INFO mapreduce.Job:  map 1% reduce 0%
16/12/11 11:46:43 INFO mapreduce.Job:  map 2% reduce 0%
16/12/11 11:46:45 INFO mapreduce.Job:  map 3% reduce 0%
16/12/11 11:46:47 INFO mapreduce.Job:  map 4% reduce 0%
16/12/11 11:46:49 INFO mapreduce.Job:  map 5% reduce 0%
16/12/11 11:46:50 INFO mapreduce.Job:  map 6% reduce 0%
16/12/11 11:46:53 INFO mapreduce.Job:  map 9% reduce 0%
16/12/11 11:46:54 INFO mapreduce.Job:  map 10% reduce 0%
16/12/11 11:46:57 INFO mapreduce.Job:  map 14% reduce 0%
16/12/11 11:47:00 INFO mapreduce.Job:  map 15% reduce 0%
16/12/11 11:47:01 INFO mapreduce.Job:  map 17% reduce 0%
16/12/11 11:47:02 INFO mapreduce.Job:  map 18% reduce 0%
16/12/11 11:47:06 INFO mapreduce.Job:  map 19% reduce 0%
16/12/11 11:47:09 INFO mapreduce.Job:  map 20% reduce 0%
16/12/11 11:47:10 INFO mapreduce.Job:  map 21% reduce 0%
16/12/11 11:47:12 INFO mapreduce.Job:  map 22% reduce 0%
16/12/11 11:47:14 INFO mapreduce.Job:  map 23% reduce 1%
16/12/11 11:47:17 INFO mapreduce.Job:  map 25% reduce 1%
16/12/11 11:47:18 INFO mapreduce.Job:  map 26% reduce 1%
16/12/11 11:47:19 INFO mapreduce.Job:  map 27% reduce 1%
16/12/11 11:47:20 INFO mapreduce.Job:  map 28% reduce 1%
16/12/11 11:47:21 INFO mapreduce.Job:  map 29% reduce 3%
16/12/11 11:47:22 INFO mapreduce.Job:  map 30% reduce 5%
16/12/11 11:47:23 INFO mapreduce.Job:  map 33% reduce 7%
16/12/11 11:47:24 INFO mapreduce.Job:  map 34% reduce 7%
16/12/11 11:47:25 INFO mapreduce.Job:  map 38% reduce 8%
16/12/11 11:47:26 INFO mapreduce.Job:  map 42% reduce 8%
16/12/11 11:47:27 INFO mapreduce.Job:  map 45% reduce 9%
16/12/11 11:47:28 INFO mapreduce.Job:  map 50% reduce 9%
16/12/11 11:47:29 INFO mapreduce.Job:  map 54% reduce 10%
16/12/11 11:47:30 INFO mapreduce.Job:  map 58% reduce 11%
16/12/11 11:47:31 INFO mapreduce.Job:  map 64% reduce 13%
16/12/11 11:47:32 INFO mapreduce.Job:  map 69% reduce 14%
16/12/11 11:47:33 INFO mapreduce.Job:  map 72% reduce 16%
16/12/11 11:47:34 INFO mapreduce.Job:  map 74% reduce 17%
16/12/11 11:47:35 INFO mapreduce.Job:  map 78% reduce 18%
16/12/11 11:47:36 INFO mapreduce.Job:  map 79% reduce 21%
16/12/11 11:47:38 INFO mapreduce.Job:  map 80% reduce 23%
16/12/11 11:47:39 INFO mapreduce.Job:  map 81% reduce 26%
16/12/11 11:47:41 INFO mapreduce.Job:  map 82% reduce 26%
16/12/11 11:47:42 INFO mapreduce.Job:  map 83% reduce 26%
16/12/11 11:47:43 INFO mapreduce.Job:  map 83% reduce 27%
16/12/11 11:47:44 INFO mapreduce.Job:  map 84% reduce 27%
16/12/11 11:47:46 INFO mapreduce.Job:  map 84% reduce 28%
16/12/11 11:47:47 INFO mapreduce.Job:  map 86% reduce 28%
16/12/11 11:47:48 INFO mapreduce.Job:  map 87% reduce 28%
16/12/11 11:47:50 INFO mapreduce.Job:  map 88% reduce 29%
16/12/11 11:47:51 INFO mapreduce.Job:  map 89% reduce 29%
16/12/11 11:47:52 INFO mapreduce.Job:  map 90% reduce 29%
16/12/11 11:47:53 INFO mapreduce.Job:  map 91% reduce 29%
16/12/11 11:47:54 INFO mapreduce.Job:  map 93% reduce 30%
16/12/11 11:47:55 INFO mapreduce.Job:  map 95% reduce 30%
16/12/11 11:47:56 INFO mapreduce.Job:  map 96% reduce 30%
16/12/11 11:47:57 INFO mapreduce.Job:  map 99% reduce 31%
16/12/11 11:47:58 INFO mapreduce.Job:  map 99% reduce 32%
16/12/11 11:47:59 INFO mapreduce.Job:  map 100% reduce 32%
16/12/11 11:48:00 INFO mapreduce.Job:  map 100% reduce 33%
16/12/11 11:48:01 INFO mapreduce.Job:  map 100% reduce 34%
16/12/11 11:48:02 INFO mapreduce.Job:  map 100% reduce 41%
16/12/11 11:48:03 INFO mapreduce.Job:  map 100% reduce 46%
16/12/11 11:48:04 INFO mapreduce.Job:  map 100% reduce 56%
16/12/11 11:48:05 INFO mapreduce.Job:  map 100% reduce 69%
16/12/11 11:48:06 INFO mapreduce.Job:  map 100% reduce 73%
16/12/11 11:48:07 INFO mapreduce.Job:  map 100% reduce 77%
16/12/11 11:48:08 INFO mapreduce.Job:  map 100% reduce 81%
16/12/11 11:48:09 INFO mapreduce.Job:  map 100% reduce 83%
16/12/11 11:48:10 INFO mapreduce.Job:  map 100% reduce 84%
16/12/11 11:48:11 INFO mapreduce.Job:  map 100% reduce 89%
16/12/11 11:48:12 INFO mapreduce.Job:  map 100% reduce 90%
16/12/11 11:48:13 INFO mapreduce.Job:  map 100% reduce 92%
16/12/11 11:48:14 INFO mapreduce.Job:  map 100% reduce 97%
16/12/11 11:48:15 INFO mapreduce.Job:  map 100% reduce 98%
16/12/11 11:48:16 INFO mapreduce.Job:  map 100% reduce 99%
16/12/11 11:48:17 INFO mapreduce.Job:  map 100% reduce 100%
16/12/11 11:48:20 INFO mapreduce.Job: Job job_1480588584072_6802 completed successfully
16/12/11 11:48:20 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=479453332
		FILE: Number of bytes written=991288629
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=408644789
		WASB: Number of bytes written=235874833
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=36999000
		Total time spent by all reduces in occupied slots (ms)=2887678
		Total time spent by all map tasks (ms)=18499500
		Total time spent by all reduce tasks (ms)=1443839
		Total vcore-seconds taken by all map tasks=18499500
		Total vcore-seconds taken by all reduce tasks=1443839
		Total megabyte-seconds taken by all map tasks=18943488000
		Total megabyte-seconds taken by all reduce tasks=1478491136
	Map-Reduce Framework
		Map input records=1308987
		Map output records=1167980
		Map output bytes=474946929
		Map output materialized bytes=479476852
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1015269
		Reduce shuffle bytes=479476852
		Reduce input records=1167980
		Reduce output records=694385
		Spilled Records=2335960
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=157789
		CPU time spent (ms)=860330
		Physical memory (bytes) snapshot=323291500544
		Virtual memory (bytes) snapshot=742986514432
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=405948785
	File Output Format Counters 
		Bytes Written=235874833
16/12/11 11:48:20 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0600
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0700 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161210/201612102300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0700': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7680866713045744848.jar tmpDir=null
16/12/11 12:49:34 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 12:49:35 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 12:49:35 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/11 12:49:39 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/11 12:49:40 INFO mapreduce.JobSubmitter: number of splits:197
16/12/11 12:49:40 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6806
16/12/11 12:49:41 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6806
16/12/11 12:49:41 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6806/
16/12/11 12:49:41 INFO mapreduce.Job: Running job: job_1480588584072_6806
16/12/11 12:49:56 INFO mapreduce.Job: Job job_1480588584072_6806 running in uber mode : false
16/12/11 12:49:56 INFO mapreduce.Job:  map 0% reduce 0%
16/12/11 12:50:19 INFO mapreduce.Job:  map 1% reduce 0%
16/12/11 12:50:22 INFO mapreduce.Job:  map 3% reduce 0%
16/12/11 12:50:52 INFO mapreduce.Job:  map 4% reduce 0%
16/12/11 12:50:55 INFO mapreduce.Job:  map 5% reduce 0%
16/12/11 12:51:00 INFO mapreduce.Job:  map 7% reduce 0%
16/12/11 12:51:05 INFO mapreduce.Job:  map 9% reduce 0%
16/12/11 12:51:06 INFO mapreduce.Job:  map 10% reduce 0%
16/12/11 12:51:07 INFO mapreduce.Job:  map 11% reduce 0%
16/12/11 12:51:11 INFO mapreduce.Job:  map 12% reduce 0%
16/12/11 12:51:12 INFO mapreduce.Job:  map 15% reduce 0%
16/12/11 12:51:14 INFO mapreduce.Job:  map 17% reduce 0%
16/12/11 12:51:16 INFO mapreduce.Job:  map 19% reduce 0%
16/12/11 12:51:17 INFO mapreduce.Job:  map 20% reduce 0%
16/12/11 12:51:18 INFO mapreduce.Job:  map 21% reduce 0%
16/12/11 12:51:20 INFO mapreduce.Job:  map 22% reduce 1%
16/12/11 12:51:22 INFO mapreduce.Job:  map 22% reduce 2%
16/12/11 12:51:23 INFO mapreduce.Job:  map 23% reduce 2%
16/12/11 12:51:24 INFO mapreduce.Job:  map 24% reduce 3%
16/12/11 12:51:27 INFO mapreduce.Job:  map 25% reduce 3%
16/12/11 12:51:28 INFO mapreduce.Job:  map 26% reduce 3%
16/12/11 12:51:31 INFO mapreduce.Job:  map 27% reduce 3%
16/12/11 12:51:32 INFO mapreduce.Job:  map 30% reduce 3%
16/12/11 12:51:33 INFO mapreduce.Job:  map 31% reduce 3%
16/12/11 12:51:34 INFO mapreduce.Job:  map 33% reduce 4%
16/12/11 12:51:35 INFO mapreduce.Job:  map 34% reduce 6%
16/12/11 12:51:36 INFO mapreduce.Job:  map 38% reduce 9%
16/12/11 12:51:37 INFO mapreduce.Job:  map 41% reduce 9%
16/12/11 12:51:38 INFO mapreduce.Job:  map 45% reduce 10%
16/12/11 12:51:39 INFO mapreduce.Job:  map 50% reduce 11%
16/12/11 12:51:40 INFO mapreduce.Job:  map 56% reduce 12%
16/12/11 12:51:41 INFO mapreduce.Job:  map 60% reduce 13%
16/12/11 12:51:42 INFO mapreduce.Job:  map 63% reduce 16%
16/12/11 12:51:43 INFO mapreduce.Job:  map 64% reduce 18%
16/12/11 12:51:44 INFO mapreduce.Job:  map 68% reduce 18%
16/12/11 12:51:45 INFO mapreduce.Job:  map 72% reduce 20%
16/12/11 12:51:46 INFO mapreduce.Job:  map 75% reduce 21%
16/12/11 12:51:47 INFO mapreduce.Job:  map 78% reduce 21%
16/12/11 12:51:48 INFO mapreduce.Job:  map 79% reduce 23%
16/12/11 12:51:49 INFO mapreduce.Job:  map 83% reduce 23%
16/12/11 12:51:50 INFO mapreduce.Job:  map 86% reduce 24%
16/12/11 12:51:51 INFO mapreduce.Job:  map 87% reduce 25%
16/12/11 12:51:52 INFO mapreduce.Job:  map 88% reduce 26%
16/12/11 12:51:54 INFO mapreduce.Job:  map 89% reduce 27%
16/12/11 12:51:57 INFO mapreduce.Job:  map 90% reduce 27%
16/12/11 12:52:00 INFO mapreduce.Job:  map 91% reduce 28%
16/12/11 12:52:01 INFO mapreduce.Job:  map 92% reduce 28%
16/12/11 12:52:02 INFO mapreduce.Job:  map 93% reduce 28%
16/12/11 12:52:04 INFO mapreduce.Job:  map 94% reduce 28%
16/12/11 12:52:06 INFO mapreduce.Job:  map 96% reduce 28%
16/12/11 12:52:07 INFO mapreduce.Job:  map 96% reduce 29%
16/12/11 12:52:08 INFO mapreduce.Job:  map 97% reduce 29%
16/12/11 12:52:09 INFO mapreduce.Job:  map 99% reduce 30%
16/12/11 12:52:11 INFO mapreduce.Job:  map 100% reduce 31%
16/12/11 12:52:12 INFO mapreduce.Job:  map 100% reduce 32%
16/12/11 12:52:13 INFO mapreduce.Job:  map 100% reduce 39%
16/12/11 12:52:14 INFO mapreduce.Job:  map 100% reduce 41%
16/12/11 12:52:15 INFO mapreduce.Job:  map 100% reduce 46%
16/12/11 12:52:16 INFO mapreduce.Job:  map 100% reduce 58%
16/12/11 12:52:17 INFO mapreduce.Job:  map 100% reduce 65%
16/12/11 12:52:18 INFO mapreduce.Job:  map 100% reduce 67%
16/12/11 12:52:19 INFO mapreduce.Job:  map 100% reduce 71%
16/12/11 12:52:20 INFO mapreduce.Job:  map 100% reduce 74%
16/12/11 12:52:21 INFO mapreduce.Job:  map 100% reduce 75%
16/12/11 12:52:22 INFO mapreduce.Job:  map 100% reduce 83%
16/12/11 12:52:23 INFO mapreduce.Job:  map 100% reduce 86%
16/12/11 12:52:24 INFO mapreduce.Job:  map 100% reduce 87%
16/12/11 12:52:25 INFO mapreduce.Job:  map 100% reduce 90%
16/12/11 12:52:26 INFO mapreduce.Job:  map 100% reduce 93%
16/12/11 12:52:27 INFO mapreduce.Job:  map 100% reduce 95%
16/12/11 12:52:28 INFO mapreduce.Job:  map 100% reduce 97%
16/12/11 12:52:29 INFO mapreduce.Job:  map 100% reduce 98%
16/12/11 12:52:31 INFO mapreduce.Job:  map 100% reduce 99%
16/12/11 12:52:34 INFO mapreduce.Job:  map 100% reduce 100%
16/12/11 12:52:38 INFO mapreduce.Job: Job job_1480588584072_6806 completed successfully
16/12/11 12:52:38 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=672912132
		FILE: Number of bytes written=1378206229
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=568233573
		WASB: Number of bytes written=365760513
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=37079914
		Total time spent by all reduces in occupied slots (ms)=3140644
		Total time spent by all map tasks (ms)=18539957
		Total time spent by all reduce tasks (ms)=1570322
		Total vcore-seconds taken by all map tasks=18539957
		Total vcore-seconds taken by all reduce tasks=1570322
		Total megabyte-seconds taken by all map tasks=18984915968
		Total megabyte-seconds taken by all reduce tasks=1608009728
	Map-Reduce Framework
		Map input records=1799617
		Map output records=1629146
		Map output bytes=666633166
		Map output materialized bytes=672935652
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1436241
		Reduce shuffle bytes=672935652
		Reduce input records=1629146
		Reduce output records=1075161
		Spilled Records=3258292
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=156725
		CPU time spent (ms)=993560
		Physical memory (bytes) snapshot=321490984960
		Virtual memory (bytes) snapshot=743623057408
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=565537569
	File Output Format Counters 
		Bytes Written=365760513
16/12/11 12:52:38 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0700
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110400 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0800 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110400
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0800': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob9057701250365336167.jar tmpDir=null
16/12/11 13:48:47 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 13:48:48 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 13:48:49 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/11 13:48:52 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/11 13:48:52 INFO mapreduce.JobSubmitter: number of splits:197
16/12/11 13:48:53 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6810
16/12/11 13:48:54 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6810
16/12/11 13:48:54 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6810/
16/12/11 13:48:54 INFO mapreduce.Job: Running job: job_1480588584072_6810
16/12/11 13:49:07 INFO mapreduce.Job: Job job_1480588584072_6810 running in uber mode : false
16/12/11 13:49:07 INFO mapreduce.Job:  map 0% reduce 0%
16/12/11 13:49:58 INFO mapreduce.Job:  map 1% reduce 0%
16/12/11 13:50:02 INFO mapreduce.Job:  map 2% reduce 0%
16/12/11 13:50:03 INFO mapreduce.Job:  map 3% reduce 0%
16/12/11 13:50:06 INFO mapreduce.Job:  map 4% reduce 0%
16/12/11 13:50:07 INFO mapreduce.Job:  map 5% reduce 0%
16/12/11 13:50:09 INFO mapreduce.Job:  map 6% reduce 0%
16/12/11 13:50:11 INFO mapreduce.Job:  map 7% reduce 0%
16/12/11 13:50:12 INFO mapreduce.Job:  map 9% reduce 0%
16/12/11 13:50:13 INFO mapreduce.Job:  map 13% reduce 0%
16/12/11 13:50:14 INFO mapreduce.Job:  map 14% reduce 0%
16/12/11 13:50:15 INFO mapreduce.Job:  map 17% reduce 0%
16/12/11 13:50:17 INFO mapreduce.Job:  map 18% reduce 0%
16/12/11 13:50:26 INFO mapreduce.Job:  map 19% reduce 0%
16/12/11 13:50:32 INFO mapreduce.Job:  map 20% reduce 0%
16/12/11 13:50:34 INFO mapreduce.Job:  map 20% reduce 1%
16/12/11 13:50:35 INFO mapreduce.Job:  map 21% reduce 1%
16/12/11 13:50:38 INFO mapreduce.Job:  map 21% reduce 2%
16/12/11 13:50:39 INFO mapreduce.Job:  map 23% reduce 3%
16/12/11 13:50:40 INFO mapreduce.Job:  map 26% reduce 5%
16/12/11 13:50:41 INFO mapreduce.Job:  map 27% reduce 6%
16/12/11 13:50:42 INFO mapreduce.Job:  map 29% reduce 6%
16/12/11 13:50:43 INFO mapreduce.Job:  map 30% reduce 6%
16/12/11 13:50:44 INFO mapreduce.Job:  map 33% reduce 7%
16/12/11 13:50:45 INFO mapreduce.Job:  map 34% reduce 7%
16/12/11 13:50:46 INFO mapreduce.Job:  map 38% reduce 7%
16/12/11 13:50:47 INFO mapreduce.Job:  map 41% reduce 8%
16/12/11 13:50:48 INFO mapreduce.Job:  map 45% reduce 9%
16/12/11 13:50:49 INFO mapreduce.Job:  map 49% reduce 10%
16/12/11 13:50:50 INFO mapreduce.Job:  map 52% reduce 11%
16/12/11 13:50:51 INFO mapreduce.Job:  map 55% reduce 12%
16/12/11 13:50:52 INFO mapreduce.Job:  map 59% reduce 14%
16/12/11 13:50:53 INFO mapreduce.Job:  map 61% reduce 15%
16/12/11 13:50:54 INFO mapreduce.Job:  map 61% reduce 16%
16/12/11 13:50:55 INFO mapreduce.Job:  map 64% reduce 18%
16/12/11 13:50:56 INFO mapreduce.Job:  map 65% reduce 19%
16/12/11 13:50:58 INFO mapreduce.Job:  map 66% reduce 20%
16/12/11 13:51:00 INFO mapreduce.Job:  map 67% reduce 20%
16/12/11 13:51:02 INFO mapreduce.Job:  map 69% reduce 21%
16/12/11 13:51:03 INFO mapreduce.Job:  map 70% reduce 21%
16/12/11 13:51:04 INFO mapreduce.Job:  map 71% reduce 21%
16/12/11 13:51:05 INFO mapreduce.Job:  map 72% reduce 22%
16/12/11 13:51:06 INFO mapreduce.Job:  map 73% reduce 22%
16/12/11 13:51:07 INFO mapreduce.Job:  map 75% reduce 23%
16/12/11 13:51:08 INFO mapreduce.Job:  map 77% reduce 23%
16/12/11 13:51:09 INFO mapreduce.Job:  map 78% reduce 24%
16/12/11 13:51:10 INFO mapreduce.Job:  map 79% reduce 24%
16/12/11 13:51:11 INFO mapreduce.Job:  map 81% reduce 25%
16/12/11 13:51:13 INFO mapreduce.Job:  map 82% reduce 26%
16/12/11 13:51:14 INFO mapreduce.Job:  map 84% reduce 26%
16/12/11 13:51:15 INFO mapreduce.Job:  map 84% reduce 27%
16/12/11 13:51:16 INFO mapreduce.Job:  map 85% reduce 27%
16/12/11 13:51:17 INFO mapreduce.Job:  map 86% reduce 27%
16/12/11 13:51:18 INFO mapreduce.Job:  map 87% reduce 28%
16/12/11 13:51:19 INFO mapreduce.Job:  map 88% reduce 28%
16/12/11 13:51:20 INFO mapreduce.Job:  map 89% reduce 28%
16/12/11 13:51:21 INFO mapreduce.Job:  map 90% reduce 29%
16/12/11 13:51:23 INFO mapreduce.Job:  map 92% reduce 29%
16/12/11 13:51:24 INFO mapreduce.Job:  map 94% reduce 30%
16/12/11 13:51:25 INFO mapreduce.Job:  map 95% reduce 30%
16/12/11 13:51:26 INFO mapreduce.Job:  map 98% reduce 31%
16/12/11 13:51:27 INFO mapreduce.Job:  map 99% reduce 32%
16/12/11 13:51:28 INFO mapreduce.Job:  map 100% reduce 33%
16/12/11 13:51:31 INFO mapreduce.Job:  map 100% reduce 37%
16/12/11 13:51:32 INFO mapreduce.Job:  map 100% reduce 47%
16/12/11 13:51:33 INFO mapreduce.Job:  map 100% reduce 55%
16/12/11 13:51:34 INFO mapreduce.Job:  map 100% reduce 59%
16/12/11 13:51:35 INFO mapreduce.Job:  map 100% reduce 68%
16/12/11 13:51:36 INFO mapreduce.Job:  map 100% reduce 73%
16/12/11 13:51:37 INFO mapreduce.Job:  map 100% reduce 75%
16/12/11 13:51:38 INFO mapreduce.Job:  map 100% reduce 76%
16/12/11 13:51:39 INFO mapreduce.Job:  map 100% reduce 77%
16/12/11 13:51:41 INFO mapreduce.Job:  map 100% reduce 78%
16/12/11 13:51:42 INFO mapreduce.Job:  map 100% reduce 79%
16/12/11 13:51:43 INFO mapreduce.Job:  map 100% reduce 80%
16/12/11 13:51:44 INFO mapreduce.Job:  map 100% reduce 82%
16/12/11 13:51:45 INFO mapreduce.Job:  map 100% reduce 85%
16/12/11 13:51:46 INFO mapreduce.Job:  map 100% reduce 87%
16/12/11 13:51:47 INFO mapreduce.Job:  map 100% reduce 89%
16/12/11 13:51:48 INFO mapreduce.Job:  map 100% reduce 92%
16/12/11 13:51:49 INFO mapreduce.Job:  map 100% reduce 94%
16/12/11 13:51:50 INFO mapreduce.Job:  map 100% reduce 96%
16/12/11 13:51:51 INFO mapreduce.Job:  map 100% reduce 97%
16/12/11 13:51:52 INFO mapreduce.Job:  map 100% reduce 98%
16/12/11 13:51:55 INFO mapreduce.Job:  map 100% reduce 100%
16/12/11 13:51:59 INFO mapreduce.Job: Job job_1480588584072_6810 completed successfully
16/12/11 13:51:59 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=722329654
		FILE: Number of bytes written=1477041273
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=613976646
		WASB: Number of bytes written=385837653
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=37892972
		Total time spent by all reduces in occupied slots (ms)=3704638
		Total time spent by all map tasks (ms)=18946486
		Total time spent by all reduce tasks (ms)=1852319
		Total vcore-seconds taken by all map tasks=18946486
		Total vcore-seconds taken by all reduce tasks=1852319
		Total megabyte-seconds taken by all map tasks=19401201664
		Total megabyte-seconds taken by all reduce tasks=1896774656
	Map-Reduce Framework
		Map input records=1946254
		Map output records=1746819
		Map output bytes=715587716
		Map output materialized bytes=722353174
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1533336
		Reduce shuffle bytes=722353174
		Reduce input records=1746819
		Reduce output records=1129490
		Spilled Records=3493638
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=170686
		CPU time spent (ms)=996170
		Physical memory (bytes) snapshot=324379152384
		Virtual memory (bytes) snapshot=743470190592
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=611280642
	File Output Format Counters 
		Bytes Written=385837653
16/12/11 13:51:59 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0800
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110500 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0900 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110500
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0900': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7433956472215496600.jar tmpDir=null
16/12/11 14:48:07 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 14:48:08 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 14:48:08 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/11 14:48:14 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/11 14:48:14 INFO mapreduce.JobSubmitter: number of splits:197
16/12/11 14:48:15 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6815
16/12/11 14:48:16 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6815
16/12/11 14:48:16 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6815/
16/12/11 14:48:16 INFO mapreduce.Job: Running job: job_1480588584072_6815
16/12/11 14:48:29 INFO mapreduce.Job: Job job_1480588584072_6815 running in uber mode : false
16/12/11 14:48:29 INFO mapreduce.Job:  map 0% reduce 0%
16/12/11 14:49:13 INFO mapreduce.Job:  map 1% reduce 0%
16/12/11 14:49:16 INFO mapreduce.Job:  map 2% reduce 0%
16/12/11 14:49:17 INFO mapreduce.Job:  map 4% reduce 0%
16/12/11 14:49:19 INFO mapreduce.Job:  map 5% reduce 0%
16/12/11 14:49:21 INFO mapreduce.Job:  map 7% reduce 0%
16/12/11 14:49:22 INFO mapreduce.Job:  map 8% reduce 0%
16/12/11 14:49:23 INFO mapreduce.Job:  map 9% reduce 0%
16/12/11 14:49:24 INFO mapreduce.Job:  map 11% reduce 0%
16/12/11 14:49:25 INFO mapreduce.Job:  map 13% reduce 0%
16/12/11 14:49:26 INFO mapreduce.Job:  map 15% reduce 0%
16/12/11 14:49:27 INFO mapreduce.Job:  map 16% reduce 0%
16/12/11 14:49:42 INFO mapreduce.Job:  map 16% reduce 1%
16/12/11 14:49:45 INFO mapreduce.Job:  map 16% reduce 2%
16/12/11 14:49:48 INFO mapreduce.Job:  map 16% reduce 3%
16/12/11 14:49:49 INFO mapreduce.Job:  map 16% reduce 4%
16/12/11 14:49:50 INFO mapreduce.Job:  map 17% reduce 5%
16/12/11 14:49:57 INFO mapreduce.Job:  map 17% reduce 6%
16/12/11 14:49:58 INFO mapreduce.Job:  map 18% reduce 6%
16/12/11 14:50:00 INFO mapreduce.Job:  map 19% reduce 6%
16/12/11 14:50:01 INFO mapreduce.Job:  map 20% reduce 6%
16/12/11 14:50:02 INFO mapreduce.Job:  map 21% reduce 6%
16/12/11 14:50:03 INFO mapreduce.Job:  map 22% reduce 6%
16/12/11 14:50:04 INFO mapreduce.Job:  map 23% reduce 6%
16/12/11 14:50:05 INFO mapreduce.Job:  map 26% reduce 6%
16/12/11 14:50:06 INFO mapreduce.Job:  map 28% reduce 7%
16/12/11 14:50:07 INFO mapreduce.Job:  map 29% reduce 7%
16/12/11 14:50:08 INFO mapreduce.Job:  map 30% reduce 8%
16/12/11 14:50:09 INFO mapreduce.Job:  map 33% reduce 8%
16/12/11 14:50:10 INFO mapreduce.Job:  map 34% reduce 9%
16/12/11 14:50:11 INFO mapreduce.Job:  map 36% reduce 9%
16/12/11 14:50:12 INFO mapreduce.Job:  map 40% reduce 10%
16/12/11 14:50:13 INFO mapreduce.Job:  map 44% reduce 11%
16/12/11 14:50:14 INFO mapreduce.Job:  map 48% reduce 12%
16/12/11 14:50:15 INFO mapreduce.Job:  map 51% reduce 13%
16/12/11 14:50:16 INFO mapreduce.Job:  map 54% reduce 14%
16/12/11 14:50:17 INFO mapreduce.Job:  map 55% reduce 16%
16/12/11 14:50:18 INFO mapreduce.Job:  map 59% reduce 17%
16/12/11 14:50:19 INFO mapreduce.Job:  map 60% reduce 18%
16/12/11 14:50:20 INFO mapreduce.Job:  map 61% reduce 18%
16/12/11 14:50:21 INFO mapreduce.Job:  map 62% reduce 19%
16/12/11 14:50:23 INFO mapreduce.Job:  map 64% reduce 19%
16/12/11 14:50:24 INFO mapreduce.Job:  map 65% reduce 19%
16/12/11 14:50:25 INFO mapreduce.Job:  map 66% reduce 19%
16/12/11 14:50:27 INFO mapreduce.Job:  map 68% reduce 20%
16/12/11 14:50:28 INFO mapreduce.Job:  map 70% reduce 20%
16/12/11 14:50:30 INFO mapreduce.Job:  map 72% reduce 20%
16/12/11 14:50:31 INFO mapreduce.Job:  map 75% reduce 21%
16/12/11 14:50:32 INFO mapreduce.Job:  map 76% reduce 21%
16/12/11 14:50:33 INFO mapreduce.Job:  map 77% reduce 22%
16/12/11 14:50:34 INFO mapreduce.Job:  map 79% reduce 22%
16/12/11 14:50:35 INFO mapreduce.Job:  map 80% reduce 23%
16/12/11 14:50:36 INFO mapreduce.Job:  map 81% reduce 23%
16/12/11 14:50:37 INFO mapreduce.Job:  map 83% reduce 23%
16/12/11 14:50:38 INFO mapreduce.Job:  map 85% reduce 24%
16/12/11 14:50:39 INFO mapreduce.Job:  map 87% reduce 25%
16/12/11 14:50:40 INFO mapreduce.Job:  map 88% reduce 25%
16/12/11 14:50:41 INFO mapreduce.Job:  map 91% reduce 26%
16/12/11 14:50:42 INFO mapreduce.Job:  map 93% reduce 28%
16/12/11 14:50:43 INFO mapreduce.Job:  map 97% reduce 29%
16/12/11 14:50:44 INFO mapreduce.Job:  map 99% reduce 30%
16/12/11 14:50:45 INFO mapreduce.Job:  map 100% reduce 32%
16/12/11 14:50:46 INFO mapreduce.Job:  map 100% reduce 35%
16/12/11 14:50:47 INFO mapreduce.Job:  map 100% reduce 39%
16/12/11 14:50:48 INFO mapreduce.Job:  map 100% reduce 46%
16/12/11 14:50:49 INFO mapreduce.Job:  map 100% reduce 54%
16/12/11 14:50:50 INFO mapreduce.Job:  map 100% reduce 60%
16/12/11 14:50:51 INFO mapreduce.Job:  map 100% reduce 65%
16/12/11 14:50:52 INFO mapreduce.Job:  map 100% reduce 70%
16/12/11 14:50:53 INFO mapreduce.Job:  map 100% reduce 75%
16/12/11 14:50:54 INFO mapreduce.Job:  map 100% reduce 76%
16/12/11 14:50:55 INFO mapreduce.Job:  map 100% reduce 77%
16/12/11 14:50:56 INFO mapreduce.Job:  map 100% reduce 79%
16/12/11 14:50:58 INFO mapreduce.Job:  map 100% reduce 81%
16/12/11 14:50:59 INFO mapreduce.Job:  map 100% reduce 83%
16/12/11 14:51:01 INFO mapreduce.Job:  map 100% reduce 84%
16/12/11 14:51:02 INFO mapreduce.Job:  map 100% reduce 85%
16/12/11 14:51:03 INFO mapreduce.Job:  map 100% reduce 88%
16/12/11 14:51:04 INFO mapreduce.Job:  map 100% reduce 89%
16/12/11 14:51:05 INFO mapreduce.Job:  map 100% reduce 90%
16/12/11 14:51:06 INFO mapreduce.Job:  map 100% reduce 92%
16/12/11 14:51:07 INFO mapreduce.Job:  map 100% reduce 95%
16/12/11 14:51:08 INFO mapreduce.Job:  map 100% reduce 96%
16/12/11 14:51:09 INFO mapreduce.Job:  map 100% reduce 98%
16/12/11 14:51:10 INFO mapreduce.Job:  map 100% reduce 99%
16/12/11 14:51:12 INFO mapreduce.Job:  map 100% reduce 100%
16/12/11 14:51:17 INFO mapreduce.Job: Job job_1480588584072_6815 completed successfully
16/12/11 14:51:17 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=802313620
		FILE: Number of bytes written=1637009205
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=683694862
		WASB: Number of bytes written=431632425
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=40472316
		Total time spent by all reduces in occupied slots (ms)=3924944
		Total time spent by all map tasks (ms)=20236158
		Total time spent by all reduce tasks (ms)=1962472
		Total vcore-seconds taken by all map tasks=20236158
		Total vcore-seconds taken by all reduce tasks=1962472
		Total megabyte-seconds taken by all map tasks=20721825792
		Total megabyte-seconds taken by all reduce tasks=2009571328
	Map-Reduce Framework
		Map input records=2168673
		Map output records=1940345
		Map output bytes=794825126
		Map output materialized bytes=802337140
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1705590
		Reduce shuffle bytes=802337140
		Reduce input records=1940345
		Reduce output records=1265944
		Spilled Records=3880690
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=172680
		CPU time spent (ms)=1033040
		Physical memory (bytes) snapshot=324266209280
		Virtual memory (bytes) snapshot=743160315904
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=680998858
	File Output Format Counters 
		Bytes Written=431632425
16/12/11 14:51:17 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/0900
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110600 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/1000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110600
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/1000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8119318923110200911.jar tmpDir=null
16/12/11 15:47:27 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 15:47:28 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 15:47:29 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/11 15:47:33 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/11 15:47:33 INFO mapreduce.JobSubmitter: number of splits:197
16/12/11 15:47:34 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6820
16/12/11 15:47:35 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6820
16/12/11 15:47:35 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6820/
16/12/11 15:47:35 INFO mapreduce.Job: Running job: job_1480588584072_6820
16/12/11 15:47:49 INFO mapreduce.Job: Job job_1480588584072_6820 running in uber mode : false
16/12/11 15:47:49 INFO mapreduce.Job:  map 0% reduce 0%
16/12/11 15:49:03 INFO mapreduce.Job:  map 2% reduce 0%
16/12/11 15:49:04 INFO mapreduce.Job:  map 3% reduce 0%
16/12/11 15:49:05 INFO mapreduce.Job:  map 5% reduce 0%
16/12/11 15:49:07 INFO mapreduce.Job:  map 6% reduce 0%
16/12/11 15:49:08 INFO mapreduce.Job:  map 7% reduce 0%
16/12/11 15:49:09 INFO mapreduce.Job:  map 8% reduce 0%
16/12/11 15:49:10 INFO mapreduce.Job:  map 10% reduce 0%
16/12/11 15:49:11 INFO mapreduce.Job:  map 11% reduce 0%
16/12/11 15:49:12 INFO mapreduce.Job:  map 12% reduce 0%
16/12/11 15:49:13 INFO mapreduce.Job:  map 14% reduce 0%
16/12/11 15:49:15 INFO mapreduce.Job:  map 16% reduce 0%
16/12/11 15:49:17 INFO mapreduce.Job:  map 17% reduce 0%
16/12/11 15:49:19 INFO mapreduce.Job:  map 19% reduce 0%
16/12/11 15:49:21 INFO mapreduce.Job:  map 20% reduce 1%
16/12/11 15:49:22 INFO mapreduce.Job:  map 22% reduce 1%
16/12/11 15:49:23 INFO mapreduce.Job:  map 24% reduce 1%
16/12/11 15:49:24 INFO mapreduce.Job:  map 24% reduce 2%
16/12/11 15:49:25 INFO mapreduce.Job:  map 26% reduce 2%
16/12/11 15:49:26 INFO mapreduce.Job:  map 28% reduce 2%
16/12/11 15:49:27 INFO mapreduce.Job:  map 30% reduce 2%
16/12/11 15:49:28 INFO mapreduce.Job:  map 32% reduce 2%
16/12/11 15:49:29 INFO mapreduce.Job:  map 34% reduce 2%
16/12/11 15:49:30 INFO mapreduce.Job:  map 36% reduce 2%
16/12/11 15:49:31 INFO mapreduce.Job:  map 40% reduce 2%
16/12/11 15:49:32 INFO mapreduce.Job:  map 45% reduce 3%
16/12/11 15:49:33 INFO mapreduce.Job:  map 50% reduce 3%
16/12/11 15:49:34 INFO mapreduce.Job:  map 53% reduce 5%
16/12/11 15:49:35 INFO mapreduce.Job:  map 54% reduce 7%
16/12/11 15:49:36 INFO mapreduce.Job:  map 56% reduce 12%
16/12/11 15:49:37 INFO mapreduce.Job:  map 59% reduce 14%
16/12/11 15:49:38 INFO mapreduce.Job:  map 62% reduce 15%
16/12/11 15:49:39 INFO mapreduce.Job:  map 64% reduce 16%
16/12/11 15:49:40 INFO mapreduce.Job:  map 65% reduce 18%
16/12/11 15:49:41 INFO mapreduce.Job:  map 66% reduce 19%
16/12/11 15:49:42 INFO mapreduce.Job:  map 67% reduce 19%
16/12/11 15:49:43 INFO mapreduce.Job:  map 68% reduce 19%
16/12/11 15:49:44 INFO mapreduce.Job:  map 69% reduce 20%
16/12/11 15:49:45 INFO mapreduce.Job:  map 70% reduce 20%
16/12/11 15:49:46 INFO mapreduce.Job:  map 71% reduce 21%
16/12/11 15:49:47 INFO mapreduce.Job:  map 73% reduce 21%
16/12/11 15:49:48 INFO mapreduce.Job:  map 74% reduce 21%
16/12/11 15:49:49 INFO mapreduce.Job:  map 75% reduce 21%
16/12/11 15:49:50 INFO mapreduce.Job:  map 76% reduce 22%
16/12/11 15:49:51 INFO mapreduce.Job:  map 78% reduce 22%
16/12/11 15:49:52 INFO mapreduce.Job:  map 81% reduce 23%
16/12/11 15:49:53 INFO mapreduce.Job:  map 82% reduce 24%
16/12/11 15:49:54 INFO mapreduce.Job:  map 84% reduce 25%
16/12/11 15:49:55 INFO mapreduce.Job:  map 85% reduce 26%
16/12/11 15:49:56 INFO mapreduce.Job:  map 87% reduce 27%
16/12/11 15:49:57 INFO mapreduce.Job:  map 88% reduce 27%
16/12/11 15:49:58 INFO mapreduce.Job:  map 89% reduce 28%
16/12/11 15:49:59 INFO mapreduce.Job:  map 90% reduce 29%
16/12/11 15:50:00 INFO mapreduce.Job:  map 91% reduce 29%
16/12/11 15:50:01 INFO mapreduce.Job:  map 91% reduce 30%
16/12/11 15:50:02 INFO mapreduce.Job:  map 92% reduce 30%
16/12/11 15:50:03 INFO mapreduce.Job:  map 94% reduce 30%
16/12/11 15:50:04 INFO mapreduce.Job:  map 94% reduce 31%
16/12/11 15:50:05 INFO mapreduce.Job:  map 97% reduce 31%
16/12/11 15:50:06 INFO mapreduce.Job:  map 99% reduce 31%
16/12/11 15:50:07 INFO mapreduce.Job:  map 100% reduce 32%
16/12/11 15:50:08 INFO mapreduce.Job:  map 100% reduce 33%
16/12/11 15:50:09 INFO mapreduce.Job:  map 100% reduce 37%
16/12/11 15:50:10 INFO mapreduce.Job:  map 100% reduce 43%
16/12/11 15:50:11 INFO mapreduce.Job:  map 100% reduce 51%
16/12/11 15:50:12 INFO mapreduce.Job:  map 100% reduce 55%
16/12/11 15:50:13 INFO mapreduce.Job:  map 100% reduce 61%
16/12/11 15:50:14 INFO mapreduce.Job:  map 100% reduce 72%
16/12/11 15:50:15 INFO mapreduce.Job:  map 100% reduce 75%
16/12/11 15:50:16 INFO mapreduce.Job:  map 100% reduce 77%
16/12/11 15:50:17 INFO mapreduce.Job:  map 100% reduce 79%
16/12/11 15:50:18 INFO mapreduce.Job:  map 100% reduce 82%
16/12/11 15:50:19 INFO mapreduce.Job:  map 100% reduce 83%
16/12/11 15:50:21 INFO mapreduce.Job:  map 100% reduce 86%
16/12/11 15:50:23 INFO mapreduce.Job:  map 100% reduce 88%
16/12/11 15:50:24 INFO mapreduce.Job:  map 100% reduce 90%
16/12/11 15:50:25 INFO mapreduce.Job:  map 100% reduce 91%
16/12/11 15:50:26 INFO mapreduce.Job:  map 100% reduce 93%
16/12/11 15:50:27 INFO mapreduce.Job:  map 100% reduce 95%
16/12/11 15:50:28 INFO mapreduce.Job:  map 100% reduce 97%
16/12/11 15:50:30 INFO mapreduce.Job:  map 100% reduce 100%
16/12/11 15:50:37 INFO mapreduce.Job: Job job_1480588584072_6820 completed successfully
16/12/11 15:50:37 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=863222687
		FILE: Number of bytes written=1758827339
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=733875934
		WASB: Number of bytes written=473894423
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=41445790
		Total time spent by all reduces in occupied slots (ms)=2963588
		Total time spent by all map tasks (ms)=20722895
		Total time spent by all reduce tasks (ms)=1481794
		Total vcore-seconds taken by all map tasks=20722895
		Total vcore-seconds taken by all reduce tasks=1481794
		Total megabyte-seconds taken by all map tasks=21220244480
		Total megabyte-seconds taken by all reduce tasks=1517357056
	Map-Reduce Framework
		Map input records=2321802
		Map output records=2084694
		Map output bytes=855172182
		Map output materialized bytes=863246207
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1834744
		Reduce shuffle bytes=863246207
		Reduce input records=2084694
		Reduce output records=1388573
		Spilled Records=4169388
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=177731
		CPU time spent (ms)=1022800
		Physical memory (bytes) snapshot=325082275840
		Virtual memory (bytes) snapshot=743414759424
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=731179930
	File Output Format Counters 
		Bytes Written=473894423
16/12/11 15:50:37 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/1000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110700 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/1100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110700
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/1100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5692184187218831133.jar tmpDir=null
16/12/11 16:46:48 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 16:46:49 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 16:46:49 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/11 16:46:52 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/11 16:46:52 INFO mapreduce.JobSubmitter: number of splits:197
16/12/11 16:46:52 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6824
16/12/11 16:46:53 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6824
16/12/11 16:46:53 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6824/
16/12/11 16:46:53 INFO mapreduce.Job: Running job: job_1480588584072_6824
16/12/11 16:47:07 INFO mapreduce.Job: Job job_1480588584072_6824 running in uber mode : false
16/12/11 16:47:07 INFO mapreduce.Job:  map 0% reduce 0%
16/12/11 16:48:11 INFO mapreduce.Job:  map 1% reduce 0%
16/12/11 16:48:20 INFO mapreduce.Job:  map 4% reduce 0%
16/12/11 16:48:21 INFO mapreduce.Job:  map 6% reduce 0%
16/12/11 16:48:23 INFO mapreduce.Job:  map 8% reduce 0%
16/12/11 16:48:25 INFO mapreduce.Job:  map 9% reduce 0%
16/12/11 16:48:29 INFO mapreduce.Job:  map 10% reduce 0%
16/12/11 16:48:32 INFO mapreduce.Job:  map 13% reduce 0%
16/12/11 16:48:33 INFO mapreduce.Job:  map 17% reduce 0%
16/12/11 16:48:34 INFO mapreduce.Job:  map 22% reduce 0%
16/12/11 16:48:35 INFO mapreduce.Job:  map 23% reduce 0%
16/12/11 16:48:39 INFO mapreduce.Job:  map 24% reduce 0%
16/12/11 16:48:48 INFO mapreduce.Job:  map 24% reduce 2%
16/12/11 16:48:49 INFO mapreduce.Job:  map 24% reduce 4%
16/12/11 16:48:50 INFO mapreduce.Job:  map 24% reduce 7%
16/12/11 16:48:51 INFO mapreduce.Job:  map 25% reduce 8%
16/12/11 16:48:52 INFO mapreduce.Job:  map 26% reduce 8%
16/12/11 16:48:57 INFO mapreduce.Job:  map 27% reduce 8%
16/12/11 16:48:59 INFO mapreduce.Job:  map 28% reduce 8%
16/12/11 16:49:01 INFO mapreduce.Job:  map 29% reduce 8%
16/12/11 16:49:02 INFO mapreduce.Job:  map 31% reduce 9%
16/12/11 16:49:06 INFO mapreduce.Job:  map 33% reduce 10%
16/12/11 16:49:07 INFO mapreduce.Job:  map 35% reduce 10%
16/12/11 16:49:09 INFO mapreduce.Job:  map 37% reduce 10%
16/12/11 16:49:10 INFO mapreduce.Job:  map 40% reduce 10%
16/12/11 16:49:11 INFO mapreduce.Job:  map 42% reduce 10%
16/12/11 16:49:12 INFO mapreduce.Job:  map 43% reduce 11%
16/12/11 16:49:13 INFO mapreduce.Job:  map 44% reduce 11%
16/12/11 16:49:14 INFO mapreduce.Job:  map 46% reduce 11%
16/12/11 16:49:15 INFO mapreduce.Job:  map 49% reduce 12%
16/12/11 16:49:17 INFO mapreduce.Job:  map 51% reduce 13%
16/12/11 16:49:18 INFO mapreduce.Job:  map 54% reduce 13%
16/12/11 16:49:19 INFO mapreduce.Job:  map 57% reduce 14%
16/12/11 16:49:20 INFO mapreduce.Job:  map 58% reduce 14%
16/12/11 16:49:21 INFO mapreduce.Job:  map 63% reduce 16%
16/12/11 16:49:22 INFO mapreduce.Job:  map 67% reduce 16%
16/12/11 16:49:23 INFO mapreduce.Job:  map 68% reduce 17%
16/12/11 16:49:24 INFO mapreduce.Job:  map 71% reduce 19%
16/12/11 16:49:25 INFO mapreduce.Job:  map 71% reduce 20%
16/12/11 16:49:26 INFO mapreduce.Job:  map 73% reduce 21%
16/12/11 16:49:27 INFO mapreduce.Job:  map 74% reduce 21%
16/12/11 16:49:28 INFO mapreduce.Job:  map 75% reduce 22%
16/12/11 16:49:29 INFO mapreduce.Job:  map 77% reduce 22%
16/12/11 16:49:30 INFO mapreduce.Job:  map 79% reduce 23%
16/12/11 16:49:31 INFO mapreduce.Job:  map 80% reduce 23%
16/12/11 16:49:32 INFO mapreduce.Job:  map 82% reduce 24%
16/12/11 16:49:33 INFO mapreduce.Job:  map 84% reduce 25%
16/12/11 16:49:35 INFO mapreduce.Job:  map 84% reduce 26%
16/12/11 16:49:45 INFO mapreduce.Job:  map 85% reduce 26%
16/12/11 16:49:45 INFO mapreduce.Job: Task Id : attempt_1480588584072_6824_m_000009_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/11 16:49:45 INFO mapreduce.Job: Task Id : attempt_1480588584072_6824_m_000000_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/11 16:49:46 INFO mapreduce.Job:  map 84% reduce 26%
16/12/11 16:49:49 INFO mapreduce.Job:  map 85% reduce 26%
16/12/11 16:49:52 INFO mapreduce.Job:  map 86% reduce 26%
16/12/11 16:49:55 INFO mapreduce.Job:  map 87% reduce 26%
16/12/11 16:49:57 INFO mapreduce.Job:  map 88% reduce 26%
16/12/11 16:49:58 INFO mapreduce.Job:  map 88% reduce 27%
16/12/11 16:50:00 INFO mapreduce.Job:  map 89% reduce 27%
16/12/11 16:50:04 INFO mapreduce.Job:  map 90% reduce 27%
16/12/11 16:50:05 INFO mapreduce.Job:  map 91% reduce 27%
16/12/11 16:50:14 INFO mapreduce.Job:  map 92% reduce 27%
16/12/11 16:50:16 INFO mapreduce.Job:  map 92% reduce 28%
16/12/11 16:50:16 INFO mapreduce.Job: Task Id : attempt_1480588584072_6824_m_000013_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/11 16:50:17 INFO mapreduce.Job:  map 92% reduce 29%
16/12/11 16:50:18 INFO mapreduce.Job:  map 92% reduce 30%
16/12/11 16:50:20 INFO mapreduce.Job:  map 93% reduce 30%
16/12/11 16:50:21 INFO mapreduce.Job:  map 94% reduce 30%
16/12/11 16:50:22 INFO mapreduce.Job:  map 95% reduce 30%
16/12/11 16:50:23 INFO mapreduce.Job:  map 96% reduce 30%
16/12/11 16:50:24 INFO mapreduce.Job:  map 97% reduce 31%
16/12/11 16:50:25 INFO mapreduce.Job:  map 98% reduce 31%
16/12/11 16:50:26 INFO mapreduce.Job:  map 99% reduce 31%
16/12/11 16:50:27 INFO mapreduce.Job:  map 100% reduce 32%
16/12/11 16:50:28 INFO mapreduce.Job:  map 100% reduce 33%
16/12/11 16:50:29 INFO mapreduce.Job:  map 100% reduce 38%
16/12/11 16:50:30 INFO mapreduce.Job:  map 100% reduce 48%
16/12/11 16:50:31 INFO mapreduce.Job:  map 100% reduce 55%
16/12/11 16:50:32 INFO mapreduce.Job:  map 100% reduce 65%
16/12/11 16:50:33 INFO mapreduce.Job:  map 100% reduce 70%
16/12/11 16:50:34 INFO mapreduce.Job:  map 100% reduce 74%
16/12/11 16:50:35 INFO mapreduce.Job:  map 100% reduce 79%
16/12/11 16:50:36 INFO mapreduce.Job:  map 100% reduce 82%
16/12/11 16:50:37 INFO mapreduce.Job:  map 100% reduce 87%
16/12/11 16:50:38 INFO mapreduce.Job:  map 100% reduce 92%
16/12/11 16:50:40 INFO mapreduce.Job:  map 100% reduce 95%
16/12/11 16:50:41 INFO mapreduce.Job:  map 100% reduce 97%
16/12/11 16:50:42 INFO mapreduce.Job:  map 100% reduce 98%
16/12/11 16:50:43 INFO mapreduce.Job:  map 100% reduce 99%
16/12/11 16:50:44 INFO mapreduce.Job:  map 100% reduce 100%
16/12/11 16:50:53 INFO mapreduce.Job: Job job_1480588584072_6824 completed successfully
16/12/11 16:50:53 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=873210711
		FILE: Number of bytes written=1778803387
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=743567305
		WASB: Number of bytes written=472316690
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=3
		Launched map tasks=200
		Launched reduce tasks=20
		Other local map tasks=3
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=50728424
		Total time spent by all reduces in occupied slots (ms)=5074952
		Total time spent by all map tasks (ms)=25364212
		Total time spent by all reduce tasks (ms)=2537476
		Total vcore-seconds taken by all map tasks=25364212
		Total vcore-seconds taken by all reduce tasks=2537476
		Total megabyte-seconds taken by all map tasks=25972953088
		Total megabyte-seconds taken by all reduce tasks=2598375424
	Map-Reduce Framework
		Map input records=2365149
		Map output records=2116913
		Map output bytes=865052188
		Map output materialized bytes=873234231
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1861646
		Reduce shuffle bytes=873234231
		Reduce input records=2116913
		Reduce output records=1392303
		Spilled Records=4233826
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=272506
		CPU time spent (ms)=1234500
		Physical memory (bytes) snapshot=321297813504
		Virtual memory (bytes) snapshot=743022133248
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=740871301
	File Output Format Counters 
		Bytes Written=472316690
16/12/11 16:50:53 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/1100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110800 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/1200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110800
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/1200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5055076625445616530.jar tmpDir=null
16/12/11 17:47:09 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 17:47:10 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 17:47:11 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/11 17:47:13 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/11 17:47:13 INFO mapreduce.JobSubmitter: number of splits:197
16/12/11 17:47:14 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6857
16/12/11 17:47:14 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6857
16/12/11 17:47:15 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6857/
16/12/11 17:47:15 INFO mapreduce.Job: Running job: job_1480588584072_6857
16/12/11 17:48:06 INFO mapreduce.Job: Job job_1480588584072_6857 running in uber mode : false
16/12/11 17:48:06 INFO mapreduce.Job:  map 0% reduce 0%
16/12/11 17:48:52 INFO mapreduce.Job:  map 1% reduce 0%
16/12/11 17:49:00 INFO mapreduce.Job:  map 2% reduce 0%
16/12/11 17:49:15 INFO mapreduce.Job:  map 3% reduce 0%
16/12/11 17:49:19 INFO mapreduce.Job:  map 5% reduce 0%
16/12/11 17:49:23 INFO mapreduce.Job:  map 7% reduce 0%
16/12/11 17:49:26 INFO mapreduce.Job:  map 8% reduce 0%
16/12/11 17:49:27 INFO mapreduce.Job:  map 10% reduce 0%
16/12/11 17:49:30 INFO mapreduce.Job:  map 11% reduce 0%
16/12/11 17:49:32 INFO mapreduce.Job:  map 15% reduce 0%
16/12/11 17:49:33 INFO mapreduce.Job:  map 17% reduce 0%
16/12/11 17:49:35 INFO mapreduce.Job:  map 18% reduce 0%
16/12/11 17:49:36 INFO mapreduce.Job:  map 20% reduce 0%
16/12/11 17:49:37 INFO mapreduce.Job:  map 21% reduce 0%
16/12/11 17:49:39 INFO mapreduce.Job:  map 22% reduce 0%
16/12/11 17:49:40 INFO mapreduce.Job:  map 23% reduce 0%
16/12/11 17:49:42 INFO mapreduce.Job:  map 25% reduce 0%
16/12/11 17:49:47 INFO mapreduce.Job:  map 26% reduce 1%
16/12/11 17:49:48 INFO mapreduce.Job:  map 26% reduce 2%
16/12/11 17:49:49 INFO mapreduce.Job:  map 27% reduce 2%
16/12/11 17:49:50 INFO mapreduce.Job:  map 27% reduce 3%
16/12/11 17:49:51 INFO mapreduce.Job:  map 27% reduce 5%
16/12/11 17:49:53 INFO mapreduce.Job:  map 28% reduce 6%
16/12/11 17:49:54 INFO mapreduce.Job:  map 28% reduce 7%
16/12/11 17:49:55 INFO mapreduce.Job:  map 28% reduce 9%
16/12/11 17:49:56 INFO mapreduce.Job:  map 29% reduce 9%
16/12/11 17:50:01 INFO mapreduce.Job:  map 30% reduce 9%
16/12/11 17:50:02 INFO mapreduce.Job:  map 30% reduce 10%
16/12/11 17:50:03 INFO mapreduce.Job:  map 31% reduce 10%
16/12/11 17:50:04 INFO mapreduce.Job:  map 32% reduce 10%
16/12/11 17:50:05 INFO mapreduce.Job:  map 33% reduce 10%
16/12/11 17:50:06 INFO mapreduce.Job:  map 34% reduce 10%
16/12/11 17:50:07 INFO mapreduce.Job:  map 35% reduce 10%
16/12/11 17:50:09 INFO mapreduce.Job:  map 38% reduce 10%
16/12/11 17:50:10 INFO mapreduce.Job:  map 39% reduce 10%
16/12/11 17:50:11 INFO mapreduce.Job:  map 41% reduce 11%
16/12/11 17:50:12 INFO mapreduce.Job:  map 42% reduce 11%
16/12/11 17:50:13 INFO mapreduce.Job:  map 43% reduce 12%
16/12/11 17:50:14 INFO mapreduce.Job:  map 45% reduce 12%
16/12/11 17:50:15 INFO mapreduce.Job:  map 46% reduce 13%
16/12/11 17:50:17 INFO mapreduce.Job:  map 48% reduce 13%
16/12/11 17:50:18 INFO mapreduce.Job:  map 50% reduce 14%
16/12/11 17:50:20 INFO mapreduce.Job:  map 52% reduce 14%
16/12/11 17:50:21 INFO mapreduce.Job:  map 55% reduce 14%
16/12/11 17:50:22 INFO mapreduce.Job:  map 55% reduce 15%
16/12/11 17:50:23 INFO mapreduce.Job:  map 59% reduce 15%
16/12/11 17:50:24 INFO mapreduce.Job:  map 60% reduce 16%
16/12/11 17:50:25 INFO mapreduce.Job:  map 63% reduce 16%
16/12/11 17:50:26 INFO mapreduce.Job:  map 64% reduce 16%
16/12/11 17:50:27 INFO mapreduce.Job:  map 65% reduce 17%
16/12/11 17:50:31 INFO mapreduce.Job:  map 66% reduce 17%
16/12/11 17:50:37 INFO mapreduce.Job:  map 67% reduce 17%
16/12/11 17:50:43 INFO mapreduce.Job:  map 68% reduce 17%
16/12/11 17:50:49 INFO mapreduce.Job:  map 69% reduce 17%
16/12/11 17:50:56 INFO mapreduce.Job:  map 70% reduce 17%
16/12/11 17:50:57 INFO mapreduce.Job:  map 70% reduce 18%
16/12/11 17:50:59 INFO mapreduce.Job:  map 71% reduce 18%
16/12/11 17:51:03 INFO mapreduce.Job:  map 72% reduce 18%
16/12/11 17:51:10 INFO mapreduce.Job:  map 73% reduce 18%
16/12/11 17:51:16 INFO mapreduce.Job:  map 74% reduce 18%
16/12/11 17:51:17 INFO mapreduce.Job:  map 75% reduce 18%
16/12/11 17:51:18 INFO mapreduce.Job:  map 76% reduce 18%
16/12/11 17:51:42 INFO mapreduce.Job:  map 77% reduce 18%
16/12/11 17:51:47 INFO mapreduce.Job:  map 78% reduce 18%
16/12/11 17:51:51 INFO mapreduce.Job:  map 79% reduce 18%
16/12/11 17:51:53 INFO mapreduce.Job:  map 80% reduce 18%
16/12/11 17:51:54 INFO mapreduce.Job:  map 81% reduce 19%
16/12/11 17:51:55 INFO mapreduce.Job:  map 81% reduce 20%
16/12/11 17:51:56 INFO mapreduce.Job:  map 83% reduce 21%
16/12/11 17:51:57 INFO mapreduce.Job: Task Id : attempt_1480588584072_6857_m_000145_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/11 17:51:57 INFO mapreduce.Job: Task Id : attempt_1480588584072_6857_m_000151_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/11 17:51:57 INFO mapreduce.Job: Task Id : attempt_1480588584072_6857_m_000149_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/11 17:51:57 INFO mapreduce.Job: Task Id : attempt_1480588584072_6857_m_000176_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/11 17:51:58 INFO mapreduce.Job:  map 86% reduce 23%
16/12/11 17:51:58 INFO mapreduce.Job: Task Id : attempt_1480588584072_6857_m_000003_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/11 17:51:59 INFO mapreduce.Job:  map 87% reduce 24%
16/12/11 17:51:59 INFO mapreduce.Job: Task Id : attempt_1480588584072_6857_m_000006_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/11 17:52:00 INFO mapreduce.Job:  map 88% reduce 26%
16/12/11 17:52:01 INFO mapreduce.Job:  map 88% reduce 28%
16/12/11 17:52:02 INFO mapreduce.Job:  map 88% reduce 29%
16/12/11 17:52:03 INFO mapreduce.Job:  map 91% reduce 29%
16/12/11 17:52:04 INFO mapreduce.Job:  map 92% reduce 29%
16/12/11 17:52:05 INFO mapreduce.Job:  map 95% reduce 30%
16/12/11 17:52:07 INFO mapreduce.Job:  map 95% reduce 31%
16/12/11 17:52:08 INFO mapreduce.Job:  map 96% reduce 31%
16/12/11 17:52:09 INFO mapreduce.Job:  map 97% reduce 31%
16/12/11 17:52:10 INFO mapreduce.Job:  map 98% reduce 31%
16/12/11 17:52:11 INFO mapreduce.Job:  map 99% reduce 31%
16/12/11 17:52:12 INFO mapreduce.Job:  map 99% reduce 32%
16/12/11 17:52:14 INFO mapreduce.Job:  map 100% reduce 33%
16/12/11 17:52:15 INFO mapreduce.Job:  map 100% reduce 34%
16/12/11 17:52:17 INFO mapreduce.Job:  map 100% reduce 37%
16/12/11 17:52:18 INFO mapreduce.Job:  map 100% reduce 41%
16/12/11 17:52:19 INFO mapreduce.Job:  map 100% reduce 51%
16/12/11 17:52:20 INFO mapreduce.Job:  map 100% reduce 63%
16/12/11 17:52:21 INFO mapreduce.Job:  map 100% reduce 68%
16/12/11 17:52:22 INFO mapreduce.Job:  map 100% reduce 71%
16/12/11 17:52:23 INFO mapreduce.Job:  map 100% reduce 75%
16/12/11 17:52:24 INFO mapreduce.Job:  map 100% reduce 78%
16/12/11 17:52:25 INFO mapreduce.Job:  map 100% reduce 82%
16/12/11 17:52:26 INFO mapreduce.Job:  map 100% reduce 87%
16/12/11 17:52:27 INFO mapreduce.Job:  map 100% reduce 91%
16/12/11 17:52:28 INFO mapreduce.Job:  map 100% reduce 93%
16/12/11 17:52:29 INFO mapreduce.Job:  map 100% reduce 95%
16/12/11 17:52:30 INFO mapreduce.Job:  map 100% reduce 96%
16/12/11 17:52:31 INFO mapreduce.Job:  map 100% reduce 97%
16/12/11 17:52:32 INFO mapreduce.Job:  map 100% reduce 98%
16/12/11 17:52:33 INFO mapreduce.Job:  map 100% reduce 99%
16/12/11 17:52:35 INFO mapreduce.Job:  map 100% reduce 100%
16/12/11 17:52:40 INFO mapreduce.Job: Job job_1480588584072_6857 completed successfully
16/12/11 17:52:40 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=998003415
		FILE: Number of bytes written=2028388795
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=842701049
		WASB: Number of bytes written=571596296
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=6
		Launched map tasks=203
		Launched reduce tasks=20
		Other local map tasks=6
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=59989200
		Total time spent by all reduces in occupied slots (ms)=7085628
		Total time spent by all map tasks (ms)=29994600
		Total time spent by all reduce tasks (ms)=3542814
		Total vcore-seconds taken by all map tasks=29994600
		Total vcore-seconds taken by all reduce tasks=3542814
		Total megabyte-seconds taken by all map tasks=30714470400
		Total megabyte-seconds taken by all reduce tasks=3627841536
	Map-Reduce Framework
		Map input records=2651842
		Map output records=2405069
		Map output bytes=988729971
		Map output materialized bytes=998026935
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=2133537
		Reduce shuffle bytes=998026935
		Reduce input records=2405069
		Reduce output records=1674370
		Spilled Records=4810138
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=455012
		CPU time spent (ms)=1558260
		Physical memory (bytes) snapshot=316044279808
		Virtual memory (bytes) snapshot=742595313664
		Total committed heap usage (bytes)=574116331520
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=840005045
	File Output Format Counters 
		Bytes Written=571596296
16/12/11 17:52:40 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/1200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110900 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/1300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161211/201612110900
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/1300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob220681230725671792.jar tmpDir=null
16/12/11 18:48:51 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 18:48:53 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/11 18:48:53 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/11 18:48:56 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/11 18:48:56 INFO mapreduce.JobSubmitter: number of splits:197
16/12/11 18:48:57 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_6914
16/12/11 18:48:57 INFO impl.YarnClientImpl: Submitted application application_1480588584072_6914
16/12/11 18:48:57 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_6914/
16/12/11 18:48:57 INFO mapreduce.Job: Running job: job_1480588584072_6914
16/12/11 18:49:10 INFO mapreduce.Job: Job job_1480588584072_6914 running in uber mode : false
16/12/11 18:49:10 INFO mapreduce.Job:  map 0% reduce 0%
16/12/11 18:49:59 INFO mapreduce.Job:  map 1% reduce 0%
16/12/11 18:50:22 INFO mapreduce.Job:  map 2% reduce 0%
16/12/11 18:50:26 INFO mapreduce.Job:  map 3% reduce 0%
16/12/11 18:50:28 INFO mapreduce.Job:  map 4% reduce 0%
16/12/11 18:51:09 INFO mapreduce.Job:  map 5% reduce 0%
16/12/11 18:51:12 INFO mapreduce.Job:  map 6% reduce 0%
16/12/11 18:51:13 INFO mapreduce.Job:  map 7% reduce 0%
16/12/11 18:51:14 INFO mapreduce.Job:  map 8% reduce 0%
16/12/11 18:51:15 INFO mapreduce.Job:  map 10% reduce 0%
16/12/11 18:51:24 INFO mapreduce.Job:  map 13% reduce 0%
16/12/11 18:51:26 INFO mapreduce.Job:  map 17% reduce 0%
16/12/11 18:51:30 INFO mapreduce.Job:  map 18% reduce 0%
16/12/11 18:51:32 INFO mapreduce.Job:  map 19% reduce 0%
16/12/11 18:51:32 INFO mapreduce.Job: Task Id : attempt_1480588584072_6914_m_000001_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/11 18:51:34 INFO mapreduce.Job:  map 21% reduce 0%
16/12/11 18:51:35 INFO mapreduce.Job: Task Id : attempt_1480588584072_6914_m_000019_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/11 18:51:35 INFO mapreduce.Job: Task Id : attempt_1480588584072_6914_m_000014_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/11 18:51:35 INFO mapreduce.Job: Task Id : attempt_1480588584072_6914_m_000002_0, Status : FAILED
Container killed on request. Exit code is 137
Container exited with a non-zero exit code 137
Killed by external signal

16/12/11 18:51:37 INFO mapreduce.Job:  map 25% reduce 0%
16/12/11 18:51:38 INFO mapreduce.Job:  map 34% reduce 0%
16/12/11 18:51:39 INFO mapreduce.Job:  map 38% reduce 0%
16/12/11 18:51:40 INFO mapreduce.Job:  map 39% reduce 0%
16/12/11 18:51:42 INFO mapreduce.Job:  map 41% reduce 0%
16/12/11 18:51:43 INFO mapreduce.Job:  map 42% reduce 0%
16/12/11 18:51:44 INFO mapreduce.Job:  map 43% reduce 0%
16/12/11 18:51:45 INFO mapreduce.Job:  map 45% reduce 0%
16/12/11 18:51:46 INFO mapreduce.Job:  map 47% reduce 0%
16/12/11 18:51:49 INFO mapreduce.Job:  map 49% reduce 0%
16/12/11 18:51:50 INFO mapreduce.Job:  map 53% reduce 0%
16/12/11 18:51:51 INFO mapreduce.Job:  map 57% reduce 1%
16/12/11 18:51:52 INFO mapreduce.Job:  map 66% reduce 1%
16/12/11 18:51:53 INFO mapreduce.Job:  map 69% reduce 1%
16/12/11 18:51:54 INFO mapreduce.Job:  map 72% reduce 2%
16/12/11 18:51:56 INFO mapreduce.Job:  map 79% reduce 2%
16/12/11 18:51:57 INFO mapreduce.Job:  map 83% reduce 2%
16/12/11 18:51:58 INFO mapreduce.Job:  map 86% reduce 6%
16/12/11 18:51:59 INFO mapreduce.Job:  map 90% reduce 8%
16/12/11 18:52:01 INFO mapreduce.Job:  map 91% reduce 9%
16/12/11 18:52:02 INFO mapreduce.Job:  map 94% reduce 10%
16/12/11 18:52:03 INFO mapreduce.Job:  map 97% reduce 10%
16/12/11 18:52:04 INFO mapreduce.Job:  map 98% reduce 10%
16/12/11 18:52:05 INFO mapreduce.Job:  map 99% reduce 11%
16/12/11 18:52:06 INFO mapreduce.Job:  map 99% reduce 13%
16/12/11 18:52:07 INFO mapreduce.Job:  map 99% reduce 23%
16/12/11 18:52:08 INFO mapreduce.Job:  map 100% reduce 25%
16/12/11 18:52:09 INFO mapreduce.Job:  map 100% reduce 30%
16/12/11 18:52:11 INFO mapreduce.Job:  map 100% reduce 39%
16/12/11 18:52:12 INFO mapreduce.Job:  map 100% reduce 48%
16/12/11 18:52:13 INFO mapreduce.Job:  map 100% reduce 62%
16/12/11 18:52:14 INFO mapreduce.Job:  map 100% reduce 70%
16/12/11 18:52:15 INFO mapreduce.Job:  map 100% reduce 73%
16/12/11 18:52:16 INFO mapreduce.Job:  map 100% reduce 78%
16/12/11 18:52:17 INFO mapreduce.Job:  map 100% reduce 84%
16/12/11 18:52:18 INFO mapreduce.Job:  map 100% reduce 88%
16/12/11 18:52:19 INFO mapreduce.Job:  map 100% reduce 91%
16/12/11 18:52:20 INFO mapreduce.Job:  map 100% reduce 95%
16/12/11 18:52:21 INFO mapreduce.Job:  map 100% reduce 96%
16/12/11 18:52:22 INFO mapreduce.Job:  map 100% reduce 98%
16/12/11 18:52:23 INFO mapreduce.Job:  map 100% reduce 99%
16/12/11 18:52:24 INFO mapreduce.Job:  map 100% reduce 100%
16/12/11 18:52:28 INFO mapreduce.Job: Job job_1480588584072_6914 completed successfully
16/12/11 18:52:28 INFO mapreduce.Job: Counters: 51
	File System Counters
		FILE: Number of bytes read=857828601
		FILE: Number of bytes written=1748039167
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=728901865
		WASB: Number of bytes written=460158742
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Failed map tasks=4
		Launched map tasks=201
		Launched reduce tasks=20
		Other local map tasks=4
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=56466164
		Total time spent by all reduces in occupied slots (ms)=1819162
		Total time spent by all map tasks (ms)=28233082
		Total time spent by all reduce tasks (ms)=909581
		Total vcore-seconds taken by all map tasks=28233082
		Total vcore-seconds taken by all reduce tasks=909581
		Total megabyte-seconds taken by all map tasks=28910675968
		Total megabyte-seconds taken by all reduce tasks=931410944
	Map-Reduce Framework
		Map input records=2312715
		Map output records=2076229
		Map output bytes=849818959
		Map output materialized bytes=857852121
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1820947
		Reduce shuffle bytes=857852121
		Reduce input records=2076229
		Reduce output records=1350887
		Spilled Records=4152458
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=242365
		CPU time spent (ms)=1161820
		Physical memory (bytes) snapshot=314006921216
		Virtual memory (bytes) snapshot=742128652288
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=726205861
	File Output Format Counters 
		Bytes Written=460158742
16/12/11 18:52:28 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161211/1300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161211/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
16/12/12 02:52:24 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
16/12/13 05:53:20 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
16/12/13 08:34:58 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
16/12/13 22:03:04 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
16/12/14 02:00:21 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
16/12/14 11:51:02 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
16/12/14 20:25:59 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
16/12/15 10:24:00 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/* not ready, wait 300s
hfs -lswasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/^C
zhangrn@hn0-niphdi:~/offline_task/click_show_zan_join$ hfs -ls wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/
Found 32 items
-rwxrwxrwx   1    2030757 2016-12-11 19:33 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/00
-rwxrwxrwx   1    2033853 2016-12-11 19:33 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/01
-rwxrwxrwx   1    2024873 2016-12-11 19:33 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/02
-rwxrwxrwx   1    2036491 2016-12-11 19:33 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/03
-rwxrwxrwx   1    2036088 2016-12-11 19:32 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/04
-rwxrwxrwx   1    2031920 2016-12-11 19:33 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/05
-rwxrwxrwx   1    2021817 2016-12-11 19:39 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/06
-rwxrwxrwx   1    2023897 2016-12-11 19:33 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/07
-rwxrwxrwx   1    2020963 2016-12-11 19:32 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/08
-rwxrwxrwx   1    2028183 2016-12-11 19:38 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/09
-rwxrwxrwx   1    2055336 2016-12-11 19:34 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/10
-rwxrwxrwx   1    2057571 2016-12-11 19:33 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/11
-rwxrwxrwx   1    2058458 2016-12-11 19:34 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/12
-rwxrwxrwx   1    2051087 2016-12-11 19:38 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/13
-rwxrwxrwx   1    2070006 2016-12-11 19:33 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/14
-rwxrwxrwx   1    2074165 2016-12-11 19:32 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/15
-rwxrwxrwx   1    2054521 2016-12-11 19:33 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/16
-rwxrwxrwx   1    2051397 2016-12-11 19:39 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/17
-rwxrwxrwx   1    2058496 2016-12-11 19:33 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/18
-rwxrwxrwx   1    2031146 2016-12-11 19:34 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/19
-rwxrwxrwx   1    2028966 2016-12-11 19:34 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/20
-rwxrwxrwx   1    2001179 2016-12-11 19:34 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/21
-rwxrwxrwx   1    2004026 2016-12-11 19:32 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/22
-rwxrwxrwx   1    1998381 2016-12-11 19:34 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/23
-rwxrwxrwx   1    1971830 2016-12-11 19:39 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/24
-rwxrwxrwx   1    1971785 2016-12-11 19:33 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/25
-rwxrwxrwx   1    1965762 2016-12-11 19:32 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/26
-rwxrwxrwx   1    1997507 2016-12-11 19:34 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/27
-rwxrwxrwx   1    2003942 2016-12-11 19:37 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/28
-rwxrwxrwx   1    2031584 2016-12-11 19:33 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/29
-rwxrwxrwx   1    2026540 2016-12-11 19:34 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/30
-rwxrwxrwx   1    2039071 2016-12-11 19:38 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/31
zhangrn@hn0-niphdi:~/offline_task/click_show_zan_join$ hfs -ls wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17/[K[K[K[K
Found 37 items
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00
-rwxrwxrwx   1          0 2016-12-11 02:40 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/00.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01
-rwxrwxrwx   1          0 2016-12-11 03:41 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/01.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02
-rwxrwxrwx   1          0 2016-12-11 04:41 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/02.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03
-rwxrwxrwx   1          0 2016-12-11 05:41 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/03.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04
-rwxrwxrwx   1          0 2016-12-11 06:41 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/04.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05
-rwxrwxrwx   1          0 2016-12-11 07:41 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/05.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06
-rwxrwxrwx   1          0 2016-12-11 08:41 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/06.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07
-rwxrwxrwx   1          0 2016-12-11 09:41 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/07.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08
-rwxrwxrwx   1          0 2016-12-11 10:41 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/08.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09
-rwxrwxrwx   1          0 2016-12-11 11:42 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/09.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10
-rwxrwxrwx   1          0 2016-12-11 12:44 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/10.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11
-rwxrwxrwx   1          0 2016-12-11 13:44 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/11.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12
-rwxrwxrwx   1          0 2016-12-11 14:46 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/12.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13
-rwxrwxrwx   1          0 2016-12-11 15:44 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/13.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14
-rwxrwxrwx   1          0 2016-12-11 16:45 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/14.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15
-rwxrwxrwx   1          0 2016-12-11 17:45 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/15.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16
-rwxrwxrwx   1          0 2016-12-11 18:43 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/16.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/17
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/Daily
-rwxrwxrwx   1          0 2016-12-12 23:31 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211/Daily.done
zhangrn@hn0-niphdi:~/offline_task/click_show_zan_join$ hfs -ls wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161211[K2
Found 19 items
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161212/15
-rwxrwxrwx   1          0 2016-12-12 17:42 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161212/15.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161212/16
-rwxrwxrwx   1          0 2016-12-12 18:40 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161212/16.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161212/17
-rwxrwxrwx   1          0 2016-12-12 20:31 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161212/17.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161212/18
-rwxrwxrwx   1          0 2016-12-12 20:44 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161212/18.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161212/19
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161212/20
-rwxrwxrwx   1          0 2016-12-12 22:54 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161212/20.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161212/21
-rwxrwxrwx   1          0 2016-12-12 23:47 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161212/21.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161212/22
-rwxrwxrwx   1          0 2016-12-13 00:43 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161212/22.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161212/23
-rwxrwxrwx   1          0 2016-12-13 01:40 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161212/23.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161212/Daily
-rwxrwxrwx   1          0 2016-12-13 14:22 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161212/Daily.done
zhangrn@hn0-niphdi:~/offline_task/click_show_zan_join$ hfs -ls wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161212[K3
Found 48 items
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/00
-rwxrwxrwx   1          0 2016-12-13 02:40 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/00.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/01
-rwxrwxrwx   1          0 2016-12-13 03:41 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/01.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/02
-rwxrwxrwx   1          0 2016-12-13 04:40 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/02.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/03
-rwxrwxrwx   1          0 2016-12-13 05:41 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/03.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/04
-rwxrwxrwx   1          0 2016-12-13 06:41 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/04.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/05
-rwxrwxrwx   1          0 2016-12-13 07:40 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/05.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/06
-rwxrwxrwx   1          0 2016-12-13 08:41 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/06.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/07
-rwxrwxrwx   1          0 2016-12-13 10:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/07.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/08
-rwxrwxrwx   1          0 2016-12-13 10:39 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/08.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/09
-rwxrwxrwx   1          0 2016-12-13 11:42 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/09.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/10
-rwxrwxrwx   1          0 2016-12-13 12:45 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/10.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/11
-rwxrwxrwx   1          0 2016-12-13 13:41 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/11.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/12
-rwxrwxrwx   1          0 2016-12-13 14:38 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/12.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/13
-rwxrwxrwx   1          0 2016-12-13 15:37 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/13.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/14
-rwxrwxrwx   1          0 2016-12-13 16:39 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/14.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/15
-rwxrwxrwx   1          0 2016-12-13 17:40 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/15.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/16
-rwxrwxrwx   1          0 2016-12-13 18:39 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/16.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/17
-rwxrwxrwx   1          0 2016-12-13 19:39 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/17.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/18
-rwxrwxrwx   1          0 2016-12-13 20:38 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/18.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/19
-rwxrwxrwx   1          0 2016-12-13 21:40 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/19.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/20
-rwxrwxrwx   1          0 2016-12-13 22:39 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/20.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/21
-rwxrwxrwx   1          0 2016-12-13 23:39 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/21.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/22
-rwxrwxrwx   1          0 2016-12-14 00:38 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/22.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/23
-rwxrwxrwx   1          0 2016-12-14 01:36 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/23.done
zhangrn@hn0-niphdi:~/offline_task/click_show_zan_join$ hfs -ls wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213[K4
Found 48 items
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/00
-rwxrwxrwx   1          0 2016-12-14 02:36 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/00.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/01
-rwxrwxrwx   1          0 2016-12-14 03:36 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/01.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/02
-rwxrwxrwx   1          0 2016-12-14 04:37 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/02.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/03
-rwxrwxrwx   1          0 2016-12-14 05:36 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/03.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/04
-rwxrwxrwx   1          0 2016-12-14 06:36 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/04.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/05
-rwxrwxrwx   1          0 2016-12-14 07:39 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/05.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/06
-rwxrwxrwx   1          0 2016-12-14 08:39 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/06.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/07
-rwxrwxrwx   1          0 2016-12-14 09:37 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/07.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/08
-rwxrwxrwx   1          0 2016-12-14 10:40 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/08.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/09
-rwxrwxrwx   1          0 2016-12-14 11:36 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/09.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/10
-rwxrwxrwx   1          0 2016-12-14 12:39 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/10.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/11
-rwxrwxrwx   1          0 2016-12-14 13:37 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/11.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/12
-rwxrwxrwx   1          0 2016-12-14 14:45 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/12.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/13
-rwxrwxrwx   1          0 2016-12-14 15:39 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/13.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/14
-rwxrwxrwx   1          0 2016-12-14 16:39 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/14.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/15
-rwxrwxrwx   1          0 2016-12-14 17:38 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/15.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/16
-rwxrwxrwx   1          0 2016-12-14 18:37 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/16.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/17
-rwxrwxrwx   1          0 2016-12-14 19:40 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/17.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/18
-rwxrwxrwx   1          0 2016-12-14 20:38 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/18.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/19
-rwxrwxrwx   1          0 2016-12-14 21:41 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/19.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/20
-rwxrwxrwx   1          0 2016-12-14 22:39 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/20.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/21
-rwxrwxrwx   1          0 2016-12-14 23:43 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/21.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/22
-rwxrwxrwx   1          0 2016-12-15 00:39 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/22.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/23
-rwxrwxrwx   1          0 2016-12-15 01:35 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214/23.done
zhangrn@hn0-niphdi:~/offline_task/click_show_zan_join$ hfs -ls wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161214[K5
Found 18 items
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161215/00
-rwxrwxrwx   1          0 2016-12-15 02:35 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161215/00.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161215/01
-rwxrwxrwx   1          0 2016-12-15 03:35 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161215/01.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161215/02
-rwxrwxrwx   1          0 2016-12-15 04:36 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161215/02.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161215/03
-rwxrwxrwx   1          0 2016-12-15 05:35 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161215/03.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161215/04
-rwxrwxrwx   1          0 2016-12-15 06:35 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161215/04.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161215/05
-rwxrwxrwx   1          0 2016-12-15 07:35 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161215/05.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161215/06
-rwxrwxrwx   1          0 2016-12-15 08:35 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161215/06.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161215/07
-rwxrwxrwx   1          0 2016-12-15 09:36 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161215/07.done
drwxrwxrwx   -          0 1970-01-01 08:00 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161215/08
-rwxrwxrwx   1          0 2016-12-15 10:38 wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161215/08.done
zhangrn@hn0-niphdi:~/offline_task/click_show_zan_join$ ls
[0m[01;34mdata[0m  [01;34mhive[0m  [01;34mjoin_script[0m  [01;32mrun.sh[0m  [01;34mschema[0m  screenlog.0
zhangrn@hn0-niphdi:~/offline_task/click_show_zan_join$ cd join_script/
zhangrn@hn0-niphdi:~/offline_task/click_show_zan_join/join_script$ ls
[0m[01;32mclick.schema[0m  [01;32mconfig.py[0m  config.pyc  [01;32mlike.schema[0m  [01;32mmapper.py[0m  [01;32moutput.schema[0m  [01;32mreducer.py[0m  [01;32mshow.schema[0m  [01;32mutil.py[0m  util.pyc
zhangrn@hn0-niphdi:~/offline_task/click_show_zan_join/join_script$ cd ..
zhangrn@hn0-niphdi:~/offline_task/click_show_zan_join$ ls
[0m[01;34mdata[0m  [01;34mhive[0m  [01;34mjoin_script[0m  [01;32mrun.sh[0m  [01;34mschema[0m  screenlog.0
zhangrn@hn0-niphdi:~/offline_task/click_show_zan_join$ vim run.sh
[?1000h[?1049h[?1h=[1;55r[34l[34h[?25h[23m[24m[0m[38;5;244m[H[J[?25l[55;1H"run.sh" 99L, 3236C[?1000l[?1000h[1;1H[38;5;239m[48;5;235m 23 
 24 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [38;5;33mtmp_check[0m[38;5;244m=[38;5;64m"[0m[38;5;244m[38;5;37mCHECK_DONE_[0m[38;5;244m[38;5;166m$i[0m[38;5;244m[38;5;64m"[0m[38;5;244m
[38;5;239m[48;5;235m 25 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [38;5;33mcheck_current[0m[38;5;244m=[38;5;166m${!tmp_check[0m[38;5;244m[38;5;64m//[0m[38;5;244mDATE[38;5;64m/[0m[38;5;244m[38;5;166m$input_date_date}[0m[38;5;244m
[38;5;239m[48;5;235m 26 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [38;5;33mcheck_current[0m[38;5;244m=[38;5;166m${check_current[0m[38;5;244m[38;5;64m//[0m[38;5;244mHOUR[38;5;64m/[0m[38;5;244m[38;5;166m$input_date_hour}[0m[38;5;244m
[38;5;239m[48;5;235m 27 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [38;5;64mwhile true[0m[38;5;244m
[38;5;239m[48;5;235m 28 [0m[38;5;244m[38;5;64m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;64m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;64m   do[0m[38;5;244m
[38;5;239m[48;5;235m 29 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [30m[48;5;242m [0m[38;5;244m   [38;5;33mcheckcmd[0m[38;5;244m=[38;5;64m"[0m[38;5;244m[4m[38;5;37mhdfs[24m[0m[38;5;244m[38;5;37m [0m[38;5;244m[4m[38;5;37mdfs[24m[0m[38;5;244m[38;5;37m -test -[0m[38;5;244m[4m[38;5;37me[24m[0m[38;5;244m[38;5;37m [0m[38;5;244m[38;5;166m$check_current[0m[38;5;244m[38;5;64m"[0m[38;5;244m
[38;5;239m[48;5;235m 30 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [30m[48;5;242m [0m[38;5;244m   [38;5;64mecho[0m[38;5;244m[38;5;37m [0m[38;5;244m[38;5;166m$checkcmd[0m[38;5;244m
[38;5;239m[48;5;235m 31 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [30m[48;5;242m [0m[38;5;244m   [38;5;64meval[0m[38;5;244m [38;5;166m$checkcmd[0m[38;5;244m
[38;5;239m[48;5;235m 32 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [30m[48;5;242m [0m[38;5;244m   [38;5;64mif [[0m[38;5;244m [38;5;166m$?[0m[38;5;244m [38;5;64m-eq[0m[38;5;244m [38;5;37m0[0m[38;5;244m [38;5;64m][0m[38;5;244m
[38;5;239m[48;5;235m 33 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [30m[48;5;242m [0m[38;5;244m   [38;5;64mthen[0m[38;5;244m
[38;5;239m[48;5;235m 34 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [38;5;64mecho[0m[38;5;244m[38;5;37m [0m[38;5;244m[38;5;166m$input_current[0m[38;5;244m[38;5;64m'[0m[38;5;244m[38;5;37m ready[0m[38;5;244m[38;5;64m'[0m[38;5;244m
[38;5;239m[48;5;235m 35 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [38;5;33mINPUT[0m[38;5;244m=[38;5;166m$INPUT[0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;37m,[0m[38;5;244m[38;5;166m${input_current}[0m[38;5;244m[38;5;64m"[0m[38;5;244m
[38;5;239m[48;5;235m 36 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [38;5;64mbreak[0m[38;5;244m
[38;5;239m[48;5;235m 37 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [30m[48;5;242m [0m[38;5;244m   [38;5;64melse[0m[38;5;244m
[38;5;239m[48;5;235m 38 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [38;5;64mecho[0m[38;5;244m[38;5;37m [0m[38;5;244m[38;5;166m$input_current[0m[38;5;244m[38;5;64m'[0m[38;5;244m[38;5;37m not ready, wait 300[0m[38;5;244m[4m[38;5;37ms[24m[0m[38;5;244m[38;5;64m'[0m[38;5;244m
[38;5;239m[48;5;235m 39 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [38;5;64msleep[0m[38;5;244m [38;5;37m300[0m[38;5;244m
[38;5;239m[48;5;235m 40 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [30m[48;5;242m [0m[38;5;244m   [38;5;64mfi[0m[38;5;244m
[38;5;239m[48;5;235m 41 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;242m[40m [0m[38;5;244m   [38;5;64mdone[0m[38;5;244m
[38;5;239m[48;5;235m 42 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;64mdone[0m[38;5;244m
[38;5;239m[48;5;235m 43 
 44 [0m[38;5;244m    [38;5;64mdone[0m[38;5;244m
[38;5;239m[48;5;235m 45 [0m[38;5;244m    [38;5;33mINPUT[0m[38;5;244m=[38;5;64m'[0m[38;5;244m[38;5;37m -input [0m[38;5;244m[38;5;64m'[0m[38;5;244m[38;5;166m${INPUT[0m[38;5;244m[38;5;64m:[0m[38;5;244m[38;5;37m1[0m[38;5;244m[38;5;166m}[0m[38;5;244m
[38;5;239m[48;5;235m 46 [0m[38;5;244m[38;5;81m}[0m[38;5;244m
[38;5;239m[48;5;235m 47 
 48 [0m[38;5;244mfunction updatefiles[38;5;81m(){[0m[38;5;244m
[38;5;239m[48;5;235m 49 [0m[38;5;244m    [38;5;33mUPDATE_FILES[0m[38;5;244m=[38;5;64m'[0m[38;5;244m[38;5;37m -files join_script[0m[38;5;244m[38;5;64m'[0m[38;5;244m
[38;5;239m[48;5;235m 50 [0m[38;5;244m[38;5;81m}[0m[38;5;244m
[38;5;239m[48;5;235m 51 
 52 [0m[38;5;244mfunction run[38;5;81m(){[0m[38;5;244m
[38;5;239m[48;5;235m 53 [0m[38;5;244m    [38;5;33mcmd[0m[38;5;244m=[38;5;64m"[0m[38;5;244m[38;5;37myarn jar /[0m[38;5;244m[4m[38;5;37musr[24m[0m[38;5;244m[38;5;37m/[0m[38;5;244m[4m[38;5;37mhdp[24m[0m[38;5;244m[38;5;37m/current/[0m[38;5;244m[4m[38;5;37mhadoop[24m[0m[38;5;244m[38;5;37m-[0m[38;5;244m[4m[38;5;37mmapreduce[24m[0m[38;5;244m[38;5;37m-client/[0m[38;5;244m[4m[38;5;37mhadoop[24m[0m[38;5;244m[38;5;37m-streaming.jar \[0m[38;5;244m
[38;5;239m[48;5;235m 54 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D [0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.job.name='click_show_[0m[38;5;244m[4m[38;5;37mzan[24m[0m[38;5;244m[38;5;37m_join' \[0m[38;5;244m
[38;5;239m[48;5;235m 55 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D [0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.reduce.tasks=20 \[0m[38;5;244m
[38;5;239m[48;5;235m 56 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D [0m[38;5;244m[4m[38;5;37mmapreduce[24m[0m[38;5;244m[38;5;37m.map.memory.[0m[38;5;244m[4m[38;5;37mmb[24m[0m[38;5;244m[38;5;37m=1024 \[0m[38;5;244m
[38;5;239m[48;5;235m 57 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D [0m[38;5;244m[4m[38;5;37mmapreduce[24m[0m[38;5;244m[38;5;37m.reduce.memory.[0m[38;5;244m[4m[38;5;37mmb[24m[0m[38;5;244m[38;5;37m=1024\[0m[38;5;244m
[38;5;239m[48;5;235m 58 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D [0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.map.tasks=50 \[0m[38;5;244m
[38;5;239m[48;5;235m 59 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D [0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.job.map.capacity=30 \[0m[38;5;244m
[38;5;239m[48;5;235m 60 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D [0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.job.reduce.capacity=15 \[0m[38;5;244m
[38;5;239m[48;5;235m 61 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D [0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.job.priority=NORMAL\[0m[38;5;244m
[38;5;239m[48;5;235m 62 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D stream.[0m[38;5;244m[4m[38;5;37mnum[24m[0m[38;5;244m[38;5;37m.map.output.key.fields=4\[0m[38;5;244m
[38;5;239m[48;5;235m 63 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D [0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.text.key.partitioner.options=[0m[38;5;244m[38;5;124m\"[0m[38;5;244m[38;5;37m-[0m[38;5;244m[4m[38;5;37mk1[24m[0m[38;5;244m[38;5;37m,2[0m[38;5;244m[38;5;124m\"[0m[38;5;244m[38;5;37m \[0m[38;5;244m
[38;5;239m[48;5;235m 64 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D  [0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.output.key.comparator.class=[0m[38;5;244m[4m[38;5;37morg[24m[0m[38;5;244m[38;5;37m.apache.[0m[38;5;244m[4m[38;5;37mhadoop[24m[0m[38;5;244m[38;5;37m.[0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.lib.[0m[38;5;244m[4m[38;5;37mKeyFieldBasedComparator[24m[0m[38;5;244m[38;5;37m \[0m[38;5;244m
[38;5;239m[48;5;235m 65 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D [0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.text.key.comparator.options=[0m[38;5;244m[38;5;124m\"[0m[38;5;244m[38;5;37m-[0m[38;5;244m[4m[38;5;37mk1[24m[0m[38;5;244m[38;5;37m,4[0m[38;5;244m[38;5;124m\"[0m[38;5;244m[38;5;37m\[0m[38;5;244m
[93m 66 [0m[38;5;244m[38;5;37m[48;5;235m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m[48;5;235m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m[48;5;235m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m[48;5;235m-files join_script \[0m[38;5;244m[48;5;235m                                                                                                                                                                               [0m[38;5;244m[45;1H[38;5;239m[48;5;235m 67 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-reducer [0m[38;5;244m[38;5;124m\"[0m[38;5;244m[38;5;37mpython join_script/reducer.[0m[38;5;244m[4m[38;5;37mpy[24m[0m[38;5;244m[38;5;37m [0m[38;5;244m[38;5;124m\"[0m[38;5;244m[38;5;37m\[0m[38;5;244m
[38;5;239m[48;5;235m 68 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-mapper [0m[38;5;244m[38;5;124m\"[0m[38;5;244m[38;5;37mpython join_script/mapper.[0m[38;5;244m[4m[38;5;37mpy[24m[0m[38;5;244m[38;5;124m\"[0m[38;5;244m[38;5;37m \[0m[38;5;244m
[38;5;239m[48;5;235m 69 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-output [0m[38;5;244m[38;5;166m$OUTPUT_CURRENT[0m[38;5;244m[38;5;37m \[0m[38;5;244m
[38;5;239m[48;5;235m 70 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-partitioner [0m[38;5;244m[4m[38;5;37morg[24m[0m[38;5;244m[38;5;37m.apache.[0m[38;5;244m[4m[38;5;37mhadoop[24m[0m[38;5;244m[38;5;37m.[0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.lib.[0m[38;5;244m[4m[38;5;37mKeyFieldBasedPartitioner[24m[0m[38;5;244m[38;5;37m\[0m[38;5;244m
[38;5;239m[48;5;235m 71 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;64m"[0m[38;5;244m
[38;5;239m[48;5;235m 72 [0m[38;5;244m    [38;5;33mcmd[0m[38;5;244m=[38;5;166m$cmd${INPUT}[0m[38;5;244m
[38;5;239m[48;5;235m 73 [0m[38;5;244m    [38;5;64mecho[0m[38;5;244m[38;5;37m date +[0m[38;5;244m[38;5;64m'[0m[38;5;244m[38;5;37m%Y-%[0m[38;5;244m[4m[38;5;37mm[24m[0m[38;5;244m[38;5;37m-%[0m[38;5;244m[4m[38;5;37md[24m[0m[38;5;244m[38;5;37m %H:%M[0m[38;5;244m[38;5;64m'[0m[38;5;244m[38;5;37m [0m[38;5;244m[38;5;166m$cmd[0m[38;5;244m
[38;5;239m[48;5;235m 74 [0m[38;5;244m    [4mhdfs[24m[38;5;244m [4mdfs[24m[38;5;244m [38;5;124m-rm[0m[38;5;244m [38;5;124m-r[0m[38;5;244m [38;5;166m$OUTPUT_CURRENT[0m[38;5;244m
[38;5;239m[48;5;235m 75 [0m[38;5;244m    [38;5;64meval[0m[38;5;244m [38;5;166m$cmd[?1000l[?1000h[?1000l[?1000h[?1000l[?1000h[0m[38;5;244m
[1m[38;5;230m[48;5;245m NORMAL > SPELL [0m[38;5;244m[38;5;245m[48;5;241m[0m[38;5;244m[38;5;241m[48;5;235m[0m[38;5;244m[38;5;240m[48;5;235m [0m[38;5;244m[1m run.sh  [0m[38;5;244m[38;5;240m[48;5;235m                                                                                                                                          [0m[38;5;244m[38;5;235m[48;5;235m[0m[38;5;244m[38;5;240m[48;5;235m run < sh [0m[38;5;244m[38;5;241m[48;5;235m[0m[38;5;244m[38;5;254m[48;5;241m utf-8[unix] [0m[38;5;244m[38;5;245m[48;5;241m[0m[38;5;244m[38;5;230m[48;5;245m  66% [0m[38;5;244m[1m[38;5;230m[48;5;245m:  66/99[0m[38;5;244m[38;5;230m[48;5;245m :  1 [0m[38;5;244m[54;21H[1m1:run.sh  [44;5H[34h[?25h[?25l[0m[38;5;244m[55;1H1:run.sh[55;10H[K[44;5H[34h[?25h[?25l[55;202Hgj[44;5H[55;202H  [45;5H[44;1H[38;5;239m[48;5;235m 66 [0m[38;5;244m[38;5;37m    [1C   [1C   [1C-files join_script \[0m[38;5;244m[44;38H[K[45;1H[93m 67 [0m[38;5;244m[38;5;37m[48;5;235m    [1C   [1C   [1C-reducer [0m[38;5;244m[38;5;124m[48;5;235m\"[0m[38;5;244m[38;5;37m[48;5;235mpython join_script/reducer.[0m[38;5;244m[4m[38;5;37m[48;5;235mpy[24m[0m[38;5;244m[38;5;37m[48;5;235m [0m[38;5;244m[38;5;124m[48;5;235m\"[0m[38;5;244m[38;5;37m[48;5;235m\[0m[38;5;244m[48;5;235m                                                                                                                                                       [0m[38;5;244m[54;196H[38;5;230m[48;5;245m7[0m[38;5;244m[6C[1m[38;5;230m[48;5;245m7[45;5H[34h[?25h[?25l[0m[38;5;244m[55;202HG[45;5H[55;202H [53;5H[1;53r[1;1H[24M[1;55r[21;1H[38;5;239m[48;5;235m 67 [0m[38;5;244m[38;5;37m    [1C   [1C   [1C-reducer [0m[38;5;244m[38;5;124m\"[0m[38;5;244m[38;5;37mpython join_script/reducer.[0m[38;5;244m[4m[38;5;37mpy[24m[0m[38;5;244m[38;5;37m [0m[38;5;244m[38;5;124m\"[0m[38;5;244m[38;5;37m\[0m[38;5;244m[21;62H[K[30;1H[38;5;239m[48;5;235m 76 [0m[38;5;244m[38;5;81m}[0m[38;5;244m
[38;5;239m[48;5;235m 77 
 78 [0m[38;5;244mupdatefiles
[38;5;239m[48;5;235m 79 [0m[38;5;244m[38;5;33mstart_date[0m[38;5;244m=[38;5;64m"[0m[38;5;244m[38;5;37m2016-12-01 05:00[0m[38;5;244m[38;5;64m"[0m[38;5;244m
[38;5;239m[48;5;235m 80 
 81 [0m[38;5;244m[38;5;64mwhile true[0m[38;5;244m
[38;5;239m[48;5;235m 82 [0m[38;5;244m[38;5;64mdo[0m[38;5;244m
[38;5;239m[48;5;235m 83 [0m[38;5;244m    input_join [38;5;64m"[0m[38;5;244m[38;5;166m$start_date[0m[38;5;244m[38;5;64m"[0m[38;5;244m
[38;5;239m[48;5;235m 84 [0m[38;5;244m    [38;5;33mstart_date_array[0m[38;5;244m=[38;5;166m($start_date)[0m[38;5;244m
[38;5;239m[48;5;235m 85 [0m[38;5;244m    [38;5;33mdate_part[0m[38;5;244m=[38;5;166m${start_date_array[[0m[38;5;244m[38;5;37m0[0m[38;5;244m[38;5;166m]}[0m[38;5;244m
[38;5;239m[48;5;235m 86 [0m[38;5;244m    [38;5;33mhour_part[0m[38;5;244m=[38;5;166m${start_date_array[[0m[38;5;244m[38;5;37m1[0m[38;5;244m[38;5;166m]}[0m[38;5;244m
[38;5;239m[48;5;235m 87 [0m[38;5;244m    [38;5;33mOUTPUT_CURRENT[0m[38;5;244m=[38;5;166m${OUTPUT[0m[38;5;244m[38;5;64m//[0m[38;5;244mDATE[38;5;64m/[0m[38;5;244m[38;5;166m$date_part}[0m[38;5;244m
[38;5;239m[48;5;235m 88 [0m[38;5;244m    [38;5;33mOUTPUT_CURRENT[0m[38;5;244m=[38;5;166m${OUTPUT_CURRENT[0m[38;5;244m[38;5;64m//[0m[38;5;244m-[38;5;64m/[0m[38;5;244m[38;5;166m}[0m[38;5;244m
[38;5;239m[48;5;235m 89 [0m[38;5;244m    [38;5;33mOUTPUT_CURRENT[0m[38;5;244m=[38;5;166m${OUTPUT_CURRENT[0m[38;5;244m[38;5;64m//[0m[38;5;244mHOUR[38;5;64m/[0m[38;5;244m[38;5;166m${hour_part[0m[38;5;244m[38;5;64m:[0m[38;5;244m[38;5;37m0[0m[38;5;244m[38;5;64m:[0m[38;5;244m[38;5;37m2[0m[38;5;244m[38;5;166m}}[0m[38;5;244m
[38;5;239m[48;5;235m 90 
 91 [0m[38;5;244m    run
[38;5;239m[48;5;235m 92 [0m[38;5;244m    [38;5;64mif [[0m[38;5;244m [38;5;166m$?[0m[38;5;244m [38;5;64m-ne[0m[38;5;244m [38;5;37m0[0m[38;5;244m [38;5;64m][0m[38;5;244m
[38;5;239m[48;5;235m 93 [0m[38;5;244m    [38;5;64mthen[0m[38;5;244m
[38;5;239m[48;5;235m 94 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;64mecho[0m[38;5;244m[38;5;37m [0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;37mrun error, date=[[0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;166m$input_date[0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;37m][0m[38;5;244m[38;5;64m"[0m[38;5;244m
[38;5;239m[48;5;235m 95 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;64mbreak[0m[38;5;244m
[38;5;239m[48;5;235m 96 [0m[38;5;244m    [38;5;64mfi[0m[38;5;244m
[38;5;239m[48;5;235m 97 [0m[38;5;244m    [38;5;33mstart_date[0m[38;5;244m=[38;5;124m`date -d [0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;166m$start_date[0m[38;5;244m[38;5;37m 1 hour[0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;124m +[0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;37m%Y%[0m[38;5;244m[4m[38;5;37mm[24m[0m[38;5;244m[38;5;37m%[0m[38;5;244m[4m[38;5;37md[24m[0m[38;5;244m[38;5;37m %H:%M[0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;124m`[0m[38;5;244m
[38;5;239m[48;5;235m 98 [0m[38;5;244m[38;5;64mdone[0m[38;5;244m
[93m 99 [0m[38;5;244m[48;5;235m                                                                                                                                                                                                                [0m[38;5;244m[55;1H[K[54;194H[38;5;230m[48;5;245m100[0m[38;5;244m[5C[1m[38;5;230m[48;5;245m99[53;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[53;5H[55;202H  [52;5H[93m 98 [0m[38;5;244m[38;5;64m[48;5;235mdone[0m[38;5;244m[48;5;235m                                                                                                                                                                                                            [0m[38;5;244m[53;1H[38;5;239m[48;5;235m 99 [0m[38;5;244m[53;5H[K[54;194H[38;5;230m[48;5;245m 98[0m[38;5;244m[6C[1m[38;5;230m[48;5;245m8[52;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[52;5H[55;202H  [51;5H[93m 97 [0m[38;5;244m[48;5;235m    [0m[38;5;244m[38;5;33m[48;5;235mstart_date[0m[38;5;244m[48;5;235m=[0m[38;5;244m[38;5;124m[48;5;235m`date -d [0m[38;5;244m[38;5;64m[48;5;235m"[0m[38;5;244m[38;5;166m[48;5;235m$start_date[0m[38;5;244m[38;5;37m[48;5;235m 1 hour[0m[38;5;244m[38;5;64m[48;5;235m"[0m[38;5;244m[38;5;124m[48;5;235m +[0m[38;5;244m[38;5;64m[48;5;235m"[0m[38;5;244m[38;5;37m[48;5;235m%Y%[0m[38;5;244m[4m[38;5;37m[48;5;235mm[24m[0m[38;5;244m[38;5;37m[48;5;235m%[0m[38;5;244m[4m[38;5;37m[48;5;235md[24m[0m[38;5;244m[38;5;37m[48;5;235m %H:%M[0m[38;5;244m[38;5;64m[48;5;235m"[0m[38;5;244m[38;5;124m[48;5;235m`[0m[38;5;244m[48;5;235m                                                                                                                                                   [0m[38;5;244m[52;1H[38;5;239m[48;5;235m 98 [0m[38;5;244m[38;5;64mdone[0m[38;5;244m[52;9H[K[54;196H[38;5;230m[48;5;245m7[0m[38;5;244m[6C[1m[38;5;230m[48;5;245m7[51;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[51;5H[55;202H  [50;5H[93m 96 [0m[38;5;244m[48;5;235m    [0m[38;5;244m[38;5;64m[48;5;235mfi[0m[38;5;244m[48;5;235m                                                                                                                                                                                                          [0m[38;5;244m[51;1H[38;5;239m[48;5;235m 97 [0m[38;5;244m    [38;5;33mstart_date[0m[38;5;244m=[38;5;124m`date -d [0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;166m$start_date[0m[38;5;244m[38;5;37m 1 hour[0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;124m +[0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;37m%Y%[0m[38;5;244m[4m[38;5;37mm[24m[0m[38;5;244m[38;5;37m%[0m[38;5;244m[4m[38;5;37md[24m[0m[38;5;244m[38;5;37m %H:%M[0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;124m`[0m[38;5;244m[51;66H[K[54;196H[38;5;230m[48;5;245m6[0m[38;5;244m[6C[1m[38;5;230m[48;5;245m6[50;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[50;5H[55;202H  [49;5H[93m 95 [0m[38;5;244m[48;5;235m    [1C   [0m[38;5;244m[38;5;64m[48;5;235mbreak[0m[38;5;244m[48;5;235m                                                                                                                                                                                                   [0m[38;5;244m[50;1H[38;5;239m[48;5;235m 96 [0m[38;5;244m    [38;5;64mfi[0m[38;5;244m[50;11H[K[54;196H[38;5;230m[48;5;245m5[0m[38;5;244m[6C[1m[38;5;230m[48;5;245m5[49;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[49;5H[55;202H  [48;5H[93m 94 [0m[38;5;244m[48;5;235m    [1C   [0m[38;5;244m[38;5;64m[48;5;235mecho[0m[38;5;244m[38;5;37m[48;5;235m [0m[38;5;244m[38;5;64m[48;5;235m"[0m[38;5;244m[38;5;37m[48;5;235mrun error, date=[[0m[38;5;244m[38;5;64m[48;5;235m"[0m[38;5;244m[38;5;166m[48;5;235m$input_date[0m[38;5;244m[38;5;64m[48;5;235m"[0m[38;5;244m[38;5;37m[48;5;235m][0m[38;5;244m[38;5;64m[48;5;235m"[0m[38;5;244m[48;5;235m                                                                                                                                                                  [0m[38;5;244m[49;1H[38;5;239m[48;5;235m 95 [0m[38;5;244m    [1C   [38;5;64mbreak[0m[38;5;244m[49;18H[K[54;196H[38;5;230m[48;5;245m4[0m[38;5;244m[6C[1m[38;5;230m[48;5;245m4[48;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[48;5H[55;202H  [47;5H[93m 93 [0m[38;5;244m[48;5;235m    [0m[38;5;244m[38;5;64m[48;5;235mthen[0m[38;5;244m[48;5;235m                                                                                                                                                                                                        [0m[38;5;244m[48;1H[38;5;239m[48;5;235m 94 [0m[38;5;244m    [1C   [38;5;64mecho[0m[38;5;244m[38;5;37m [0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;37mrun error, date=[[0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;166m$input_date[0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;37m][0m[38;5;244m[38;5;64m"[0m[38;5;244m[48;51H[K[54;196H[38;5;230m[48;5;245m3[0m[38;5;244m[6C[1m[38;5;230m[48;5;245m3[47;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[47;5H[55;202H  [46;5H[93m 92 [0m[38;5;244m[48;5;235m    [0m[38;5;244m[38;5;64m[48;5;235mif [[0m[38;5;244m[48;5;235m [0m[38;5;244m[38;5;166m[48;5;235m$?[0m[38;5;244m[48;5;235m [0m[38;5;244m[38;5;64m[48;5;235m-ne[0m[38;5;244m[48;5;235m [0m[38;5;244m[38;5;37m[48;5;235m0[0m[38;5;244m[48;5;235m [0m[38;5;244m[38;5;64m[48;5;235m][0m[38;5;244m[48;5;235m                                                                                                                                                                                             [0m[38;5;244m[47;1H[38;5;239m[48;5;235m 93 [0m[38;5;244m    [38;5;64mthen[0m[38;5;244m[47;13H[K[54;196H[38;5;230m[48;5;245m2[0m[38;5;244m[6C[1m[38;5;230m[48;5;245m2[46;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[46;5H[55;202H  [45;5H[93m 91 [0m[38;5;244m[48;5;235m    run                                                                                                                                                                                                         [0m[38;5;244m[46;1H[38;5;239m[48;5;235m 92 [0m[38;5;244m    [38;5;64mif [[0m[38;5;244m [38;5;166m$?[0m[38;5;244m [38;5;64m-ne[0m[38;5;244m [38;5;37m0[0m[38;5;244m [38;5;64m][0m[38;5;244m[46;24H[K[54;196H[38;5;230m[48;5;245m1[0m[38;5;244m[6C[1m[38;5;230m[48;5;245m1[45;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[45;5H[55;202H  [44;5H[93m 90 [0m[38;5;244m[48;5;235m                                                                                                                                                                                                                [0m[38;5;244m[45;1H[38;5;239m[48;5;235m 91 [0m[38;5;244m    run[45;12H[K[54;196H[38;5;230m[48;5;245m0[0m[38;5;244m[6C[1m[38;5;230m[48;5;245m0[44;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[44;5H[55;202H  [43;5H[93m 89 [0m[38;5;244m[48;5;235m    [0m[38;5;244m[38;5;33m[48;5;235mOUTPUT_CURRENT[0m[38;5;244m[48;5;235m=[0m[38;5;244m[38;5;166m[48;5;235m${OUTPUT_CURRENT[0m[38;5;244m[38;5;64m[48;5;235m//[0m[38;5;244m[48;5;235mHOUR[0m[38;5;244m[38;5;64m[48;5;235m/[0m[38;5;244m[38;5;166m[48;5;235m${hour_part[0m[38;5;244m[38;5;64m[48;5;235m:[0m[38;5;244m[38;5;37m[48;5;235m0[0m[38;5;244m[38;5;64m[48;5;235m:[0m[38;5;244m[38;5;37m[48;5;235m2[0m[38;5;244m[38;5;166m[48;5;235m}}[0m[38;5;244m[48;5;235m                                                                                                                                                     [0m[38;5;244m[44;1H[38;5;239m[48;5;235m 90 [0m[38;5;244m[44;5H[K[54;195H[38;5;230m[48;5;245m89[0m[38;5;244m[5C[1m[38;5;230m[48;5;245m89[43;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[43;5H[55;202H  [42;5H[93m 88 [0m[38;5;244m[48;5;235m    [0m[38;5;244m[38;5;33m[48;5;235mOUTPUT_CURRENT[0m[38;5;244m[48;5;235m=[0m[38;5;244m[38;5;166m[48;5;235m${OUTPUT_CURRENT[0m[38;5;244m[38;5;64m[48;5;235m//[0m[38;5;244m[48;5;235m-[0m[38;5;244m[38;5;64m[48;5;235m/[0m[38;5;244m[38;5;166m[48;5;235m}[0m[38;5;244m[48;5;235m                                                                                                                                                                        [0m[38;5;244m[43;1H[38;5;239m[48;5;235m 89 [0m[38;5;244m    [38;5;33mOUTPUT_CURRENT[0m[38;5;244m=[38;5;166m${OUTPUT_CURRENT[0m[38;5;244m[38;5;64m//[0m[38;5;244mHOUR[38;5;64m/[0m[38;5;244m[38;5;166m${hour_part[0m[38;5;244m[38;5;64m:[0m[38;5;244m[38;5;37m0[0m[38;5;244m[38;5;64m:[0m[38;5;244m[38;5;37m2[0m[38;5;244m[38;5;166m}}[0m[38;5;244m[43;64H[K[54;196H[38;5;230m[48;5;245m8[0m[38;5;244m[6C[1m[38;5;230m[48;5;245m8[42;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[42;5H[55;202H  [41;5H[93m 87 [0m[38;5;244m[48;5;235m    [0m[38;5;244m[38;5;33m[48;5;235mOUTPUT_CURRENT[0m[38;5;244m[48;5;235m=[0m[38;5;244m[38;5;166m[48;5;235m${OUTPUT[0m[38;5;244m[38;5;64m[48;5;235m//[0m[38;5;244m[48;5;235mDATE[0m[38;5;244m[38;5;64m[48;5;235m/[0m[38;5;244m[38;5;166m[48;5;235m$date_part}[0m[38;5;244m[48;5;235m                                                                                                                                                                   [0m[38;5;244m[42;1H[38;5;239m[48;5;235m 88 [0m[38;5;244m    [38;5;33mOUTPUT_CURRENT[0m[38;5;244m=[38;5;166m${OUTPUT_CURRENT[0m[38;5;244m[38;5;64m//[0m[38;5;244m-[38;5;64m/[0m[38;5;244m[38;5;166m}[0m[38;5;244m[42;45H[K[54;196H[38;5;230m[48;5;245m7[0m[38;5;244m[6C[1m[38;5;230m[48;5;245m7[41;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[41;5H[55;202H  [40;5H[93m 86 [0m[38;5;244m[48;5;235m    [0m[38;5;244m[38;5;33m[48;5;235mhour_part[0m[38;5;244m[48;5;235m=[0m[38;5;244m[38;5;166m[48;5;235m${start_date_array[[0m[38;5;244m[38;5;37m[48;5;235m1[0m[38;5;244m[38;5;166m[48;5;235m]}[0m[38;5;244m[48;5;235m                                                                                                                                                                            [0m[38;5;244m[41;1H[38;5;239m[48;5;235m 87 [0m[38;5;244m    [38;5;33mOUTPUT_CURRENT[0m[38;5;244m=[38;5;166m${OUTPUT[0m[38;5;244m[38;5;64m//[0m[38;5;244mDATE[38;5;64m/[0m[38;5;244m[38;5;166m$date_part}[0m[38;5;244m[41;50H[K[54;196H[38;5;230m[48;5;245m6[0m[38;5;244m[6C[1m[38;5;230m[48;5;245m6[40;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[40;5H[55;202H  [39;5H[93m 85 [0m[38;5;244m[48;5;235m    [0m[38;5;244m[38;5;33m[48;5;235mdate_part[0m[38;5;244m[48;5;235m=[0m[38;5;244m[38;5;166m[48;5;235m${start_date_array[[0m[38;5;244m[38;5;37m[48;5;235m0[0m[38;5;244m[38;5;166m[48;5;235m]}[0m[38;5;244m[48;5;235m                                                                                                                                                                            [0m[38;5;244m[40;1H[38;5;239m[48;5;235m 86 [0m[38;5;244m    [38;5;33mhour_part[0m[38;5;244m=[38;5;166m${start_date_array[[0m[38;5;244m[38;5;37m1[0m[38;5;244m[38;5;166m]}[0m[38;5;244m[40;41H[K[54;196H[38;5;230m[48;5;245m5[0m[38;5;244m[6C[1m[38;5;230m[48;5;245m5[39;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[39;5H[55;202H  [38;5H[93m 84 [0m[38;5;244m[48;5;235m    [0m[38;5;244m[38;5;33m[48;5;235mstart_date_array[0m[38;5;244m[48;5;235m=[0m[38;5;244m[38;5;166m[48;5;235m($start_date)[0m[38;5;244m[48;5;235m                                                                                                                                                                              [0m[38;5;244m[39;1H[38;5;239m[48;5;235m 85 [0m[38;5;244m    [38;5;33mdate_part[0m[38;5;244m=[38;5;166m${start_date_array[[0m[38;5;244m[38;5;37m0[0m[38;5;244m[38;5;166m]}[0m[38;5;244m[39;41H[K[54;196H[38;5;230m[48;5;245m4[0m[38;5;244m[6C[1m[38;5;230m[48;5;245m4[38;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[38;5H[55;202H  [37;5H[93m 83 [0m[38;5;244m[48;5;235m    input_join [0m[38;5;244m[38;5;64m[48;5;235m"[0m[38;5;244m[38;5;166m[48;5;235m$start_date[0m[38;5;244m[38;5;64m[48;5;235m"[0m[38;5;244m[48;5;235m                                                                                                                                                                                    [0m[38;5;244m[38;1H[38;5;239m[48;5;235m 84 [0m[38;5;244m    [38;5;33mstart_date_array[0m[38;5;244m=[38;5;166m($start_date)[0m[38;5;244m[38;39H[K[54;196H[38;5;230m[48;5;245m3[0m[38;5;244m[6C[1m[38;5;230m[48;5;245m3[37;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[37;5H[55;202H  [36;5H[93m 82 [0m[38;5;244m[38;5;64m[48;5;235mdo[0m[38;5;244m[48;5;235m                                                                                                                                                                                                              [0m[38;5;244m[37;1H[38;5;239m[48;5;235m 83 [0m[38;5;244m    input_join [38;5;64m"[0m[38;5;244m[38;5;166m$start_date[0m[38;5;244m[38;5;64m"[0m[38;5;244m[37;33H[K[54;196H[38;5;230m[48;5;245m2[0m[38;5;244m[6C[1m[38;5;230m[48;5;245m2[36;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[36;5H[55;202H  [35;5H[93m 81 [0m[38;5;244m[38;5;64m[48;5;235mwhile true[0m[38;5;244m[48;5;235m                                                                                                                                                                                                      [0m[38;5;244m[36;1H[38;5;239m[48;5;235m 82 [0m[38;5;244m[38;5;64mdo[0m[38;5;244m[36;7H[K[54;196H[38;5;230m[48;5;245m1[0m[38;5;244m[6C[1m[38;5;230m[48;5;245m1[35;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[35;5H[55;202H  [34;5H[93m 80 [0m[38;5;244m[48;5;235m                                                                                                                                                                                                                [0m[38;5;244m[35;1H[38;5;239m[48;5;235m 81 [0m[38;5;244m[38;5;64mwhile true[0m[38;5;244m[35;15H[K[54;196H[38;5;230m[48;5;245m0[0m[38;5;244m[6C[1m[38;5;230m[48;5;245m0[34;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[34;5H[55;202H  [33;5H[93m 79 [0m[38;5;244m[38;5;33m[48;5;235mstart_date[0m[38;5;244m[48;5;235m=[0m[38;5;244m[38;5;64m[48;5;235m"[0m[38;5;244m[38;5;37m[48;5;235m2016-12-01 05:00[0m[38;5;244m[38;5;64m[48;5;235m"[0m[38;5;244m[48;5;235m                                                                                                                                                                                   [0m[38;5;244m[34;1H[38;5;239m[48;5;235m 80 [0m[38;5;244m[34;5H[K[54;195H[38;5;230m[48;5;245m79[0m[38;5;244m[5C[1m[38;5;230m[48;5;245m79[33;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[33;5H[55;202H  [32;5H[93m 78 [0m[38;5;244m[48;5;235mupdatefiles                                                                                                                                                                                                     [0m[38;5;244m[33;1H[38;5;239m[48;5;235m 79 [0m[38;5;244m[38;5;33mstart_date[0m[38;5;244m=[38;5;64m"[0m[38;5;244m[38;5;37m2016-12-01 05:00[0m[38;5;244m[38;5;64m"[0m[38;5;244m[33;34H[K[54;196H[38;5;230m[48;5;245m8[0m[38;5;244m[6C[1m[38;5;230m[48;5;245m8[32;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hw[32;5H[55;202H [33;5H[32;1H[38;5;239m[48;5;235m 78 [0m[38;5;244mupdatefiles[32;16H[K[33;1H[93m 79 [0m[38;5;244m[38;5;33m[48;5;235mstart_date[0m[38;5;244m[48;5;235m=[0m[38;5;244m[38;5;64m[48;5;235m"[0m[38;5;244m[38;5;37m[48;5;235m2016-12-01 05:00[0m[38;5;244m[38;5;64m[48;5;235m"[0m[38;5;244m[48;5;235m                                                                                                                                                                                   [0m[38;5;244m[54;196H[38;5;230m[48;5;245m9[0m[38;5;244m[6C[1m[38;5;230m[48;5;245m9[33;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgj[33;5H[55;202H  [34;5H[33;1H[38;5;239m[48;5;235m 79 [0m[38;5;244m[38;5;33mstart_date[0m[38;5;244m=[38;5;64m"[0m[38;5;244m[38;5;37m2016-12-01 05:00[0m[38;5;244m[38;5;64m"[0m[38;5;244m[33;34H[K[34;1H[93m 80 [0m[38;5;244m[48;5;235m                                                                                                                                                                                                                [0m[38;5;244m[54;195H[38;5;230m[48;5;245m80[0m[38;5;244m[5C[1m[38;5;230m[48;5;245m80[34;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hgk[34;5H[55;202H  [33;5H[93m 79 [0m[38;5;244m[38;5;33m[48;5;235mstart_date[0m[38;5;244m[48;5;235m=[0m[38;5;244m[38;5;64m[48;5;235m"[0m[38;5;244m[38;5;37m[48;5;235m2016-12-01 05:00[0m[38;5;244m[38;5;64m[48;5;235m"[0m[38;5;244m[48;5;235m                                                                                                                                                                                   [0m[38;5;244m[34;1H[38;5;239m[48;5;235m 80 [0m[38;5;244m[34;5H[K[54;195H[38;5;230m[48;5;245m79[0m[38;5;244m[5C[1m[38;5;230m[48;5;245m79[33;5H[34h[?25h[?25l[0m[38;5;244m[55;202Hw[33;5H[55;202H [33;15H[54;210H[38;5;230m[48;5;245m1[33;15H[34h[?25h[?25l[0m[38;5;244m[55;202Hw[33;15H[55;202H [33;17H[54;211H[38;5;230m[48;5;245m3[33;17H[34h[?25h[?25l[0m[38;5;244m[55;202Hw[33;17H[55;202H [33;21H[54;211H[38;5;230m[48;5;245m7[33;21H[34h[?25h[?25l[0m[38;5;244m[55;202Hw[33;21H[55;202H [33;22H[54;211H[38;5;230m[48;5;245m8[33;22H[34h[?25h[?25l[0m[38;5;244m[55;202Hw[33;22H[55;202H [33;24H[54;210H[38;5;230m[48;5;245m20[33;24H[34h[?25h[?25l[0m[38;5;244m[55;202Hw[33;24H[55;202H [33;25H[54;211H[38;5;230m[48;5;245m1[33;25H[34h[?25h[?25l[0m[38;5;244m[55;202Hr[33;25H[34h[?25h[?25l[55;203H1[33;25H[55;202H  [33;25H[38;5;37m[48;5;235m1[0m[38;5;244m[54;19H[38;5;245m[48;5;235m [0m[38;5;244m[9C[1m+[0m[38;5;244m[1C[38;5;245m[48;5;235m                                                                                                                                        [33;25H[34h[?25h[?25l[0m[38;5;244m[55;202Hl[33;25H[55;202H [33;26H[54;211H[38;5;230m[48;5;245m2[33;26H[34h[?25h[?25l[0m[38;5;244m[55;202Hr[33;26H[34h[?25h[?25l[55;203H3[33;26H[55;202H  [33;26H[38;5;37m[48;5;235m3[33;26H[34h[?25h[?25l[0m[38;5;244m[55;202Hl[33;26H[55;202H [33;27H[54;211H[38;5;230m[48;5;245m3[33;27H[34h[?25h[?25l[0m[38;5;244m[55;202Hl[33;27H[55;202H [33;28H[54;211H[38;5;230m[48;5;245m4[33;28H[34h[?25h[?25l[0m[38;5;244m[55;202Hl[33;28H[55;202H [33;29H[54;211H[38;5;230m[48;5;245m5[33;29H[34h[?25h[?25l[0m[38;5;244m[55;202Hr[33;29H[34h[?25h[?25l[55;203H0[33;29H[55;202H  [33;29H[38;5;37m[48;5;235m0[33;29H[34h[?25h[?25l[0m[38;5;244m[55;202H:[33;29H[55;202H[K[55;1H:[34h[?25hw wq[?25l[34h[?25h[?25l[?1000l"run.sh" 99L, 3236C written
[39;49m[?1l>[34h[?25h[?1049lzhangrn@hn0-niphdi:~/offline_task/click_show_zan_join$ vim run.shls[Kcd ..[3Plscd join_script/ls[Khfs -ls wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161215432^C
zhangrn@hn0-niphdi:~/offline_task/click_show_zan_join$ vim run.shls[Kcd ..[3Plscd join_script/ls[Kcd ..[3Plscd ..[3Plscd join_script/^C
zhangrn@hn0-niphdi:~/offline_task/click_show_zan_join$ vim urn[K[K[Krun.sh
[?1000h[?1049h[?1h=[1;55r[34l[34h[?25h[23m[24m[0m[38;5;244m[H[J[?25l[55;1H"run.sh" 99L, 3236C[?1000l[?1000h[1;1H[38;5;239m[48;5;235m 47 
 48 [0m[38;5;244mfunction updatefiles[38;5;81m(){[0m[38;5;244m
[38;5;239m[48;5;235m 49 [0m[38;5;244m    [38;5;33mUPDATE_FILES[0m[38;5;244m=[38;5;64m'[0m[38;5;244m[38;5;37m -files join_script[0m[38;5;244m[38;5;64m'[0m[38;5;244m
[38;5;239m[48;5;235m 50 [0m[38;5;244m[38;5;81m}[0m[38;5;244m
[38;5;239m[48;5;235m 51 
 52 [0m[38;5;244mfunction run[38;5;81m(){[0m[38;5;244m
[38;5;239m[48;5;235m 53 [0m[38;5;244m    [38;5;33mcmd[0m[38;5;244m=[38;5;64m"[0m[38;5;244m[38;5;37myarn jar /[0m[38;5;244m[4m[38;5;37musr[24m[0m[38;5;244m[38;5;37m/[0m[38;5;244m[4m[38;5;37mhdp[24m[0m[38;5;244m[38;5;37m/current/[0m[38;5;244m[4m[38;5;37mhadoop[24m[0m[38;5;244m[38;5;37m-[0m[38;5;244m[4m[38;5;37mmapreduce[24m[0m[38;5;244m[38;5;37m-client/[0m[38;5;244m[4m[38;5;37mhadoop[24m[0m[38;5;244m[38;5;37m-streaming.jar \[0m[38;5;244m
[38;5;239m[48;5;235m 54 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D [0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.job.name='click_show_[0m[38;5;244m[4m[38;5;37mzan[24m[0m[38;5;244m[38;5;37m_join' \[0m[38;5;244m
[38;5;239m[48;5;235m 55 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D [0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.reduce.tasks=20 \[0m[38;5;244m
[38;5;239m[48;5;235m 56 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D [0m[38;5;244m[4m[38;5;37mmapreduce[24m[0m[38;5;244m[38;5;37m.map.memory.[0m[38;5;244m[4m[38;5;37mmb[24m[0m[38;5;244m[38;5;37m=1024 \[0m[38;5;244m
[38;5;239m[48;5;235m 57 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D [0m[38;5;244m[4m[38;5;37mmapreduce[24m[0m[38;5;244m[38;5;37m.reduce.memory.[0m[38;5;244m[4m[38;5;37mmb[24m[0m[38;5;244m[38;5;37m=1024\[0m[38;5;244m
[38;5;239m[48;5;235m 58 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D [0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.map.tasks=50 \[0m[38;5;244m
[38;5;239m[48;5;235m 59 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D [0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.job.map.capacity=30 \[0m[38;5;244m
[38;5;239m[48;5;235m 60 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D [0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.job.reduce.capacity=15 \[0m[38;5;244m
[38;5;239m[48;5;235m 61 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D [0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.job.priority=NORMAL\[0m[38;5;244m
[38;5;239m[48;5;235m 62 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D stream.[0m[38;5;244m[4m[38;5;37mnum[24m[0m[38;5;244m[38;5;37m.map.output.key.fields=4\[0m[38;5;244m
[38;5;239m[48;5;235m 63 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D [0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.text.key.partitioner.options=[0m[38;5;244m[38;5;124m\"[0m[38;5;244m[38;5;37m-[0m[38;5;244m[4m[38;5;37mk1[24m[0m[38;5;244m[38;5;37m,2[0m[38;5;244m[38;5;124m\"[0m[38;5;244m[38;5;37m \[0m[38;5;244m
[38;5;239m[48;5;235m 64 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D  [0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.output.key.comparator.class=[0m[38;5;244m[4m[38;5;37morg[24m[0m[38;5;244m[38;5;37m.apache.[0m[38;5;244m[4m[38;5;37mhadoop[24m[0m[38;5;244m[38;5;37m.[0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.lib.[0m[38;5;244m[4m[38;5;37mKeyFieldBasedComparator[24m[0m[38;5;244m[38;5;37m \[0m[38;5;244m
[38;5;239m[48;5;235m 65 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-D [0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.text.key.comparator.options=[0m[38;5;244m[38;5;124m\"[0m[38;5;244m[38;5;37m-[0m[38;5;244m[4m[38;5;37mk1[24m[0m[38;5;244m[38;5;37m,4[0m[38;5;244m[38;5;124m\"[0m[38;5;244m[38;5;37m\[0m[38;5;244m
[38;5;239m[48;5;235m 66 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-files join_script \[0m[38;5;244m
[38;5;239m[48;5;235m 67 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-reducer [0m[38;5;244m[38;5;124m\"[0m[38;5;244m[38;5;37mpython join_script/reducer.[0m[38;5;244m[4m[38;5;37mpy[24m[0m[38;5;244m[38;5;37m [0m[38;5;244m[38;5;124m\"[0m[38;5;244m[38;5;37m\[0m[38;5;244m
[38;5;239m[48;5;235m 68 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-mapper [0m[38;5;244m[38;5;124m\"[0m[38;5;244m[38;5;37mpython join_script/mapper.[0m[38;5;244m[4m[38;5;37mpy[24m[0m[38;5;244m[38;5;124m\"[0m[38;5;244m[38;5;37m \[0m[38;5;244m
[38;5;239m[48;5;235m 69 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-output [0m[38;5;244m[38;5;166m$OUTPUT_CURRENT[0m[38;5;244m[38;5;37m \[0m[38;5;244m
[38;5;239m[48;5;235m 70 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;242m[40m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m-partitioner [0m[38;5;244m[4m[38;5;37morg[24m[0m[38;5;244m[38;5;37m.apache.[0m[38;5;244m[4m[38;5;37mhadoop[24m[0m[38;5;244m[38;5;37m.[0m[38;5;244m[4m[38;5;37mmapred[24m[0m[38;5;244m[38;5;37m.lib.[0m[38;5;244m[4m[38;5;37mKeyFieldBasedPartitioner[24m[0m[38;5;244m[38;5;37m\[0m[38;5;244m
[38;5;239m[48;5;235m 71 [0m[38;5;244m[38;5;37m    [0m[38;5;244m[30m[48;5;242m [0m[38;5;244m[38;5;37m   [0m[38;5;244m[38;5;64m"[0m[38;5;244m
[38;5;239m[48;5;235m 72 [0m[38;5;244m    [38;5;33mcmd[0m[38;5;244m=[38;5;166m$cmd${INPUT}[0m[38;5;244m
[38;5;239m[48;5;235m 73 [0m[38;5;244m    [38;5;64mecho[0m[38;5;244m[38;5;37m date +[0m[38;5;244m[38;5;64m'[0m[38;5;244m[38;5;37m%Y-%[0m[38;5;244m[4m[38;5;37mm[24m[0m[38;5;244m[38;5;37m-%[0m[38;5;244m[4m[38;5;37md[24m[0m[38;5;244m[38;5;37m %H:%M[0m[38;5;244m[38;5;64m'[0m[38;5;244m[38;5;37m [0m[38;5;244m[38;5;166m$cmd[0m[38;5;244m
[38;5;239m[48;5;235m 74 [0m[38;5;244m    [4mhdfs[24m[38;5;244m [4mdfs[24m[38;5;244m [38;5;124m-rm[0m[38;5;244m [38;5;124m-r[0m[38;5;244m [38;5;166m$OUTPUT_CURRENT[0m[38;5;244m
[38;5;239m[48;5;235m 75 [0m[38;5;244m    [38;5;64meval[0m[38;5;244m [38;5;166m$cmd[0m[38;5;244m
[38;5;239m[48;5;235m 76 [0m[38;5;244m[38;5;81m}[0m[38;5;244m
[38;5;239m[48;5;235m 77 
 78 [0m[38;5;244mupdatefiles
[93m 79 [0m[38;5;244m[38;5;33m[48;5;235mstart_date[0m[38;5;244m[48;5;235m=[0m[38;5;244m[38;5;64m[48;5;235m"[0m[38;5;244m[38;5;37m[48;5;235m2016-12-13 00:00[0m[38;5;244m[38;5;64m[48;5;235m"[0m[38;5;244m[48;5;235m                                                                                                                                                                                   [0m[38;5;244m[34;1H[38;5;239m[48;5;235m 80 
 81 [0m[38;5;244m[38;5;64mwhile true[0m[38;5;244m
[38;5;239m[48;5;235m 82 [0m[38;5;244m[38;5;64mdo[0m[38;5;244m
[38;5;239m[48;5;235m 83 [0m[38;5;244m    input_join [38;5;64m"[0m[38;5;244m[38;5;166m$start_date[0m[38;5;244m[38;5;64m"[0m[38;5;244m
[38;5;239m[48;5;235m 84 [0m[38;5;244m    [38;5;33mstart_date_array[0m[38;5;244m=[38;5;166m($start_date)[0m[38;5;244m
[38;5;239m[48;5;235m 85 [0m[38;5;244m    [38;5;33mdate_part[0m[38;5;244m=[38;5;166m${start_date_array[[0m[38;5;244m[38;5;37m0[0m[38;5;244m[38;5;166m]}[0m[38;5;244m
[38;5;239m[48;5;235m 86 [0m[38;5;244m    [38;5;33mhour_part[0m[38;5;244m=[38;5;166m${start_date_array[[0m[38;5;244m[38;5;37m1[0m[38;5;244m[38;5;166m]}[0m[38;5;244m
[38;5;239m[48;5;235m 87 [0m[38;5;244m    [38;5;33mOUTPUT_CURRENT[0m[38;5;244m=[38;5;166m${OUTPUT[0m[38;5;244m[38;5;64m//[0m[38;5;244mDATE[38;5;64m/[0m[38;5;244m[38;5;166m$date_part}[0m[38;5;244m
[38;5;239m[48;5;235m 88 [0m[38;5;244m    [38;5;33mOUTPUT_CURRENT[0m[38;5;244m=[38;5;166m${OUTPUT_CURRENT[0m[38;5;244m[38;5;64m//[0m[38;5;244m-[38;5;64m/[0m[38;5;244m[38;5;166m}[0m[38;5;244m
[38;5;239m[48;5;235m 89 [0m[38;5;244m    [38;5;33mOUTPUT_CURRENT[0m[38;5;244m=[38;5;166m${OUTPUT_CURRENT[0m[38;5;244m[38;5;64m//[0m[38;5;244mHOUR[38;5;64m/[0m[38;5;244m[38;5;166m${hour_part[0m[38;5;244m[38;5;64m:[0m[38;5;244m[38;5;37m0[0m[38;5;244m[38;5;64m:[0m[38;5;244m[38;5;37m2[0m[38;5;244m[38;5;166m}}[0m[38;5;244m
[38;5;239m[48;5;235m 90 
 91 [0m[38;5;244m    run
[38;5;239m[48;5;235m 92 [0m[38;5;244m    [38;5;64mif [[0m[38;5;244m [38;5;166m$?[0m[38;5;244m [38;5;64m-ne[0m[38;5;244m [38;5;37m0[0m[38;5;244m [38;5;64m][0m[38;5;244m
[38;5;239m[48;5;235m 93 [0m[38;5;244m    [38;5;64mthen[0m[38;5;244m
[38;5;239m[48;5;235m 94 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;64mecho[0m[38;5;244m[38;5;37m [0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;37mrun error, date=[[0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;166m$input_date[0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;37m][0m[38;5;244m[38;5;64m"[0m[38;5;244m
[38;5;239m[48;5;235m 95 [0m[38;5;244m    [30m[48;5;242m [0m[38;5;244m   [38;5;64mbreak[0m[38;5;244m
[38;5;239m[48;5;235m 96 [0m[38;5;244m    [38;5;64mfi[0m[38;5;244m
[38;5;239m[48;5;235m 97 [0m[38;5;244m    [38;5;33mstart_date[0m[38;5;244m=[38;5;124m`date -d [0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;166m$start_date[0m[38;5;244m[38;5;37m 1 hour[0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;124m +[0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;37m%Y%[0m[38;5;244m[4m[38;5;37mm[24m[0m[38;5;244m[38;5;37m%[0m[38;5;244m[4m[38;5;37md[24m[0m[38;5;244m[38;5;37m %H:%M[0m[38;5;244m[38;5;64m"[0m[38;5;244m[38;5;124m`[0m[38;5;244m
[38;5;239m[48;5;235m 98 [0m[38;5;244m[38;5;64mdone[0m[38;5;244m
[38;5;239m[48;5;235m 99 [?1000l[?1000h[?1000l[?1000h[?1000l[?1000h[0m[38;5;244m
[1m[38;5;230m[48;5;245m NORMAL > SPELL [0m[38;5;244m[38;5;245m[48;5;241m[0m[38;5;244m[38;5;241m[48;5;235m[0m[38;5;244m[38;5;240m[48;5;235m [0m[38;5;244m[1m run.sh  [0m[38;5;244m[38;5;240m[48;5;235m                                                                                                                                          [0m[38;5;244m[38;5;235m[48;5;235m[0m[38;5;244m[38;5;240m[48;5;235m run < sh [0m[38;5;244m[38;5;241m[48;5;235m[0m[38;5;244m[38;5;254m[48;5;241m utf-8[unix] [0m[38;5;244m[38;5;245m[48;5;241m[0m[38;5;244m[38;5;230m[48;5;245m  79% [0m[38;5;244m[1m[38;5;230m[48;5;245m:  79/99[0m[38;5;244m[38;5;230m[48;5;245m : 25 [0m[38;5;244m[54;21H[1m1:run.sh  [33;29H[34h[?25h[?25l[0m[38;5;244m[55;1H1:run.sh[55;10H[K[33;29H[34h[?25h[?25l[55;202Hr[33;29H[34h[?25h[?25l[55;203H5[33;29H[55;202H  [33;29H[38;5;37m[48;5;235m5[0m[38;5;244m[54;19H[38;5;245m[48;5;235m [0m[38;5;244m[9C[1m+[0m[38;5;244m[1C[38;5;245m[48;5;235m                                                                                                                                        [33;29H[34h[?25h[?25l[0m[38;5;244m[55;202H:[33;29H[55;1H[K[55;1H:[34h[?25hw wq[?25l[34h[?25h[?25l[?1000l"run.sh" 99L, 3236C written
[39;49m[?1l>[34h[?25h[?1049lzhangrn@hn0-niphdi:~/offline_task/click_show_zan_join$ vim run.shls[Kcd ..[3Plscd join_script/ls[Khfs -ls wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-201612154321/17/[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cbash run.sh[K[1Pvim[C[C[C[C[C[C[Cls[Kvim run.sh[1@bash[C[C[C[C[C[C[C
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/04.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/04/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161212/201612122100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161212/201612122100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161212/201612122200
16/12/15 10:46:04 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161212/201612122200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161212/201612122300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161212/201612122300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130100
16/12/15 10:46:12 WARN impl.MetricsSinkAdapter: azurefs2 has a full queue and can't consume the given metrics.
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130100 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/0500 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/04/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161212/201612122100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161212/201612122200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161212/201612122300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130100
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/0500': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob4969378552832494975.jar tmpDir=null
16/12/15 10:46:19 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/15 10:46:20 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/15 10:46:20 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/15 10:46:22 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/15 10:46:22 INFO mapreduce.JobSubmitter: number of splits:197
16/12/15 10:46:22 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_8680
16/12/15 10:46:23 INFO impl.YarnClientImpl: Submitted application application_1480588584072_8680
16/12/15 10:46:23 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_8680/
16/12/15 10:46:23 INFO mapreduce.Job: Running job: job_1480588584072_8680
16/12/15 10:46:37 INFO mapreduce.Job: Job job_1480588584072_8680 running in uber mode : false
16/12/15 10:46:37 INFO mapreduce.Job:  map 0% reduce 0%
16/12/15 10:47:04 INFO mapreduce.Job:  map 1% reduce 0%
16/12/15 10:47:08 INFO mapreduce.Job:  map 2% reduce 0%
16/12/15 10:47:09 INFO mapreduce.Job:  map 3% reduce 0%
16/12/15 10:47:10 INFO mapreduce.Job:  map 4% reduce 0%
16/12/15 10:47:14 INFO mapreduce.Job:  map 6% reduce 0%
16/12/15 10:47:15 INFO mapreduce.Job:  map 7% reduce 0%
16/12/15 10:47:16 INFO mapreduce.Job:  map 8% reduce 0%
16/12/15 10:47:19 INFO mapreduce.Job:  map 9% reduce 0%
16/12/15 10:47:21 INFO mapreduce.Job:  map 11% reduce 0%
16/12/15 10:47:22 INFO mapreduce.Job:  map 12% reduce 0%
16/12/15 10:47:23 INFO mapreduce.Job:  map 14% reduce 0%
16/12/15 10:47:24 INFO mapreduce.Job:  map 16% reduce 0%
16/12/15 10:47:25 INFO mapreduce.Job:  map 19% reduce 0%
16/12/15 10:47:27 INFO mapreduce.Job:  map 23% reduce 0%
16/12/15 10:47:28 INFO mapreduce.Job:  map 27% reduce 0%
16/12/15 10:47:29 INFO mapreduce.Job:  map 30% reduce 0%
16/12/15 10:47:30 INFO mapreduce.Job:  map 31% reduce 0%
16/12/15 10:47:31 INFO mapreduce.Job:  map 37% reduce 0%
16/12/15 10:47:33 INFO mapreduce.Job:  map 41% reduce 0%
16/12/15 10:47:34 INFO mapreduce.Job:  map 43% reduce 0%
16/12/15 10:47:35 INFO mapreduce.Job:  map 45% reduce 0%
16/12/15 10:47:37 INFO mapreduce.Job:  map 46% reduce 0%
16/12/15 10:47:38 INFO mapreduce.Job:  map 47% reduce 0%
16/12/15 10:47:39 INFO mapreduce.Job:  map 48% reduce 0%
16/12/15 10:47:42 INFO mapreduce.Job:  map 49% reduce 0%
16/12/15 10:47:43 INFO mapreduce.Job:  map 50% reduce 1%
16/12/15 10:47:45 INFO mapreduce.Job:  map 51% reduce 2%
16/12/15 10:47:46 INFO mapreduce.Job:  map 51% reduce 3%
16/12/15 10:47:47 INFO mapreduce.Job:  map 52% reduce 3%
16/12/15 10:47:48 INFO mapreduce.Job:  map 52% reduce 6%
16/12/15 10:47:49 INFO mapreduce.Job:  map 52% reduce 8%
16/12/15 10:47:50 INFO mapreduce.Job:  map 53% reduce 8%
16/12/15 10:47:51 INFO mapreduce.Job:  map 53% reduce 10%
16/12/15 10:47:53 INFO mapreduce.Job:  map 54% reduce 11%
16/12/15 10:47:54 INFO mapreduce.Job:  map 56% reduce 13%
16/12/15 10:47:55 INFO mapreduce.Job:  map 58% reduce 15%
16/12/15 10:47:57 INFO mapreduce.Job:  map 61% reduce 16%
16/12/15 10:47:58 INFO mapreduce.Job:  map 63% reduce 17%
16/12/15 10:47:59 INFO mapreduce.Job:  map 66% reduce 19%
16/12/15 10:48:00 INFO mapreduce.Job:  map 66% reduce 20%
16/12/15 10:48:01 INFO mapreduce.Job:  map 67% reduce 21%
16/12/15 10:48:02 INFO mapreduce.Job:  map 71% reduce 22%
16/12/15 10:48:03 INFO mapreduce.Job:  map 74% reduce 22%
16/12/15 10:48:04 INFO mapreduce.Job:  map 76% reduce 23%
16/12/15 10:48:05 INFO mapreduce.Job:  map 79% reduce 24%
16/12/15 10:48:06 INFO mapreduce.Job:  map 81% reduce 25%
16/12/15 10:48:07 INFO mapreduce.Job:  map 85% reduce 26%
16/12/15 10:48:08 INFO mapreduce.Job:  map 90% reduce 27%
16/12/15 10:48:09 INFO mapreduce.Job:  map 91% reduce 28%
16/12/15 10:48:10 INFO mapreduce.Job:  map 93% reduce 29%
16/12/15 10:48:11 INFO mapreduce.Job:  map 95% reduce 30%
16/12/15 10:48:12 INFO mapreduce.Job:  map 97% reduce 31%
16/12/15 10:48:13 INFO mapreduce.Job:  map 98% reduce 32%
16/12/15 10:48:14 INFO mapreduce.Job:  map 99% reduce 32%
16/12/15 10:48:15 INFO mapreduce.Job:  map 100% reduce 33%
16/12/15 10:48:16 INFO mapreduce.Job:  map 100% reduce 34%
16/12/15 10:48:17 INFO mapreduce.Job:  map 100% reduce 43%
16/12/15 10:48:18 INFO mapreduce.Job:  map 100% reduce 54%
16/12/15 10:48:19 INFO mapreduce.Job:  map 100% reduce 60%
16/12/15 10:48:20 INFO mapreduce.Job:  map 100% reduce 79%
16/12/15 10:48:21 INFO mapreduce.Job:  map 100% reduce 86%
16/12/15 10:48:22 INFO mapreduce.Job:  map 100% reduce 94%
16/12/15 10:48:23 INFO mapreduce.Job:  map 100% reduce 98%
16/12/15 10:48:24 INFO mapreduce.Job:  map 100% reduce 100%
16/12/15 10:48:29 INFO mapreduce.Job: Job job_1480588584072_8680 completed successfully
16/12/15 10:48:29 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=340797947
		FILE: Number of bytes written=713977859
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=294014160
		WASB: Number of bytes written=170049372
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13347180
		Total time spent by all reduces in occupied slots (ms)=2277946
		Total time spent by all map tasks (ms)=6673590
		Total time spent by all reduce tasks (ms)=1138973
		Total vcore-seconds taken by all map tasks=6673590
		Total vcore-seconds taken by all reduce tasks=1138973
		Total megabyte-seconds taken by all map tasks=6833756160
		Total megabyte-seconds taken by all reduce tasks=1166308352
	Map-Reduce Framework
		Map input records=932552
		Map output records=825759
		Map output bytes=337606038
		Map output materialized bytes=340821467
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=717681
		Reduce shuffle bytes=340821467
		Reduce input records=825759
		Reduce output records=500076
		Spilled Records=1651518
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=85761
		CPU time spent (ms)=764950
		Physical memory (bytes) snapshot=322417098752
		Virtual memory (bytes) snapshot=743749943296
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=291318156
	File Output Format Counters 
		Bytes Written=170049372
16/12/15 10:48:29 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/0500
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/05.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/05/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161212/201612122200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161212/201612122200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161212/201612122300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161212/201612122300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130200 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/0600 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/05/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161212/201612122200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161212/201612122300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130200
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/0600': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1177052584414522711.jar tmpDir=null
16/12/15 10:49:06 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/15 10:49:06 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/15 10:49:07 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/15 10:49:09 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/15 10:49:09 INFO mapreduce.JobSubmitter: number of splits:197
16/12/15 10:49:09 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_8681
16/12/15 10:49:11 INFO impl.YarnClientImpl: Submitted application application_1480588584072_8681
16/12/15 10:49:11 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_8681/
16/12/15 10:49:11 INFO mapreduce.Job: Running job: job_1480588584072_8681
16/12/15 10:49:24 INFO mapreduce.Job: Job job_1480588584072_8681 running in uber mode : false
16/12/15 10:49:24 INFO mapreduce.Job:  map 0% reduce 0%
16/12/15 10:49:49 INFO mapreduce.Job:  map 1% reduce 0%
16/12/15 10:49:51 INFO mapreduce.Job:  map 2% reduce 0%
16/12/15 10:49:52 INFO mapreduce.Job:  map 4% reduce 0%
16/12/15 10:49:54 INFO mapreduce.Job:  map 6% reduce 0%
16/12/15 10:49:55 INFO mapreduce.Job:  map 7% reduce 0%
16/12/15 10:50:08 INFO mapreduce.Job:  map 8% reduce 0%
16/12/15 10:50:09 INFO mapreduce.Job:  map 9% reduce 0%
16/12/15 10:50:11 INFO mapreduce.Job:  map 10% reduce 0%
16/12/15 10:50:13 INFO mapreduce.Job:  map 14% reduce 0%
16/12/15 10:50:14 INFO mapreduce.Job:  map 18% reduce 0%
16/12/15 10:50:15 INFO mapreduce.Job:  map 22% reduce 0%
16/12/15 10:50:16 INFO mapreduce.Job:  map 24% reduce 0%
16/12/15 10:50:17 INFO mapreduce.Job:  map 27% reduce 0%
16/12/15 10:50:18 INFO mapreduce.Job:  map 33% reduce 0%
16/12/15 10:50:20 INFO mapreduce.Job:  map 39% reduce 0%
16/12/15 10:50:21 INFO mapreduce.Job:  map 42% reduce 1%
16/12/15 10:50:22 INFO mapreduce.Job:  map 45% reduce 1%
16/12/15 10:50:24 INFO mapreduce.Job:  map 47% reduce 1%
16/12/15 10:50:25 INFO mapreduce.Job:  map 48% reduce 1%
16/12/15 10:50:26 INFO mapreduce.Job:  map 49% reduce 1%
16/12/15 10:50:27 INFO mapreduce.Job:  map 51% reduce 1%
16/12/15 10:50:31 INFO mapreduce.Job:  map 52% reduce 1%
16/12/15 10:50:39 INFO mapreduce.Job:  map 53% reduce 5%
16/12/15 10:50:40 INFO mapreduce.Job:  map 54% reduce 5%
16/12/15 10:50:41 INFO mapreduce.Job:  map 55% reduce 8%
16/12/15 10:50:42 INFO mapreduce.Job:  map 57% reduce 9%
16/12/15 10:50:43 INFO mapreduce.Job:  map 59% reduce 10%
16/12/15 10:50:44 INFO mapreduce.Job:  map 61% reduce 13%
16/12/15 10:50:45 INFO mapreduce.Job:  map 62% reduce 15%
16/12/15 10:50:46 INFO mapreduce.Job:  map 63% reduce 16%
16/12/15 10:50:47 INFO mapreduce.Job:  map 63% reduce 17%
16/12/15 10:50:49 INFO mapreduce.Job:  map 64% reduce 19%
16/12/15 10:50:50 INFO mapreduce.Job:  map 66% reduce 21%
16/12/15 10:50:51 INFO mapreduce.Job:  map 68% reduce 21%
16/12/15 10:50:52 INFO mapreduce.Job:  map 71% reduce 21%
16/12/15 10:50:53 INFO mapreduce.Job:  map 74% reduce 22%
16/12/15 10:50:54 INFO mapreduce.Job:  map 75% reduce 23%
16/12/15 10:50:55 INFO mapreduce.Job:  map 77% reduce 24%
16/12/15 10:50:56 INFO mapreduce.Job:  map 80% reduce 25%
16/12/15 10:50:57 INFO mapreduce.Job:  map 82% reduce 25%
16/12/15 10:50:58 INFO mapreduce.Job:  map 86% reduce 26%
16/12/15 10:50:59 INFO mapreduce.Job:  map 93% reduce 27%
16/12/15 10:51:00 INFO mapreduce.Job:  map 97% reduce 29%
16/12/15 10:51:01 INFO mapreduce.Job:  map 99% reduce 30%
16/12/15 10:51:02 INFO mapreduce.Job:  map 99% reduce 32%
16/12/15 10:51:03 INFO mapreduce.Job:  map 100% reduce 33%
16/12/15 10:51:04 INFO mapreduce.Job:  map 100% reduce 35%
16/12/15 10:51:05 INFO mapreduce.Job:  map 100% reduce 42%
16/12/15 10:51:06 INFO mapreduce.Job:  map 100% reduce 54%
16/12/15 10:51:07 INFO mapreduce.Job:  map 100% reduce 61%
16/12/15 10:51:08 INFO mapreduce.Job:  map 100% reduce 75%
16/12/15 10:51:09 INFO mapreduce.Job:  map 100% reduce 84%
16/12/15 10:51:10 INFO mapreduce.Job:  map 100% reduce 89%
16/12/15 10:51:11 INFO mapreduce.Job:  map 100% reduce 94%
16/12/15 10:51:12 INFO mapreduce.Job:  map 100% reduce 97%
16/12/15 10:51:13 INFO mapreduce.Job:  map 100% reduce 99%
16/12/15 10:51:14 INFO mapreduce.Job:  map 100% reduce 100%
16/12/15 10:51:17 INFO mapreduce.Job: Job job_1480588584072_8681 completed successfully
16/12/15 10:51:17 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=418755257
		FILE: Number of bytes written=869892479
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=359790765
		WASB: Number of bytes written=210680706
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=14004944
		Total time spent by all reduces in occupied slots (ms)=2229794
		Total time spent by all map tasks (ms)=7002472
		Total time spent by all reduce tasks (ms)=1114897
		Total vcore-seconds taken by all map tasks=7002472
		Total vcore-seconds taken by all reduce tasks=1114897
		Total megabyte-seconds taken by all map tasks=7170531328
		Total megabyte-seconds taken by all reduce tasks=1141654528
	Map-Reduce Framework
		Map input records=1138149
		Map output records=1011352
		Map output bytes=414837729
		Map output materialized bytes=418778777
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=877574
		Reduce shuffle bytes=418778777
		Reduce input records=1011352
		Reduce output records=616033
		Spilled Records=2022704
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=88565
		CPU time spent (ms)=826160
		Physical memory (bytes) snapshot=322826461184
		Virtual memory (bytes) snapshot=743685492736
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=357094761
	File Output Format Counters 
		Bytes Written=210680706
16/12/15 10:51:17 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/0600
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/06.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/06/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161212/201612122300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161212/201612122300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130300 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/0700 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/06/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161212/201612122300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130300
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/0700': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob956113964772315732.jar tmpDir=null
16/12/15 10:51:55 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/15 10:51:56 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/15 10:51:56 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/15 10:51:58 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/15 10:51:58 INFO mapreduce.JobSubmitter: number of splits:197
16/12/15 10:51:59 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_8682
16/12/15 10:52:00 INFO impl.YarnClientImpl: Submitted application application_1480588584072_8682
16/12/15 10:52:00 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_8682/
16/12/15 10:52:00 INFO mapreduce.Job: Running job: job_1480588584072_8682
16/12/15 10:52:13 INFO mapreduce.Job: Job job_1480588584072_8682 running in uber mode : false
16/12/15 10:52:13 INFO mapreduce.Job:  map 0% reduce 0%
16/12/15 10:52:41 INFO mapreduce.Job:  map 1% reduce 0%
16/12/15 10:52:45 INFO mapreduce.Job:  map 2% reduce 0%
16/12/15 10:52:46 INFO mapreduce.Job:  map 3% reduce 0%
16/12/15 10:52:48 INFO mapreduce.Job:  map 4% reduce 0%
16/12/15 10:52:50 INFO mapreduce.Job:  map 5% reduce 0%
16/12/15 10:52:51 INFO mapreduce.Job:  map 6% reduce 0%
16/12/15 10:52:52 INFO mapreduce.Job:  map 7% reduce 0%
16/12/15 10:52:54 INFO mapreduce.Job:  map 8% reduce 0%
16/12/15 10:52:57 INFO mapreduce.Job:  map 9% reduce 0%
16/12/15 10:53:00 INFO mapreduce.Job:  map 12% reduce 0%
16/12/15 10:53:01 INFO mapreduce.Job:  map 15% reduce 0%
16/12/15 10:53:04 INFO mapreduce.Job:  map 17% reduce 0%
16/12/15 10:53:05 INFO mapreduce.Job:  map 21% reduce 0%
16/12/15 10:53:06 INFO mapreduce.Job:  map 32% reduce 0%
16/12/15 10:53:07 INFO mapreduce.Job:  map 33% reduce 0%
16/12/15 10:53:09 INFO mapreduce.Job:  map 43% reduce 0%
16/12/15 10:53:10 INFO mapreduce.Job:  map 45% reduce 0%
16/12/15 10:53:12 INFO mapreduce.Job:  map 46% reduce 0%
16/12/15 10:53:14 INFO mapreduce.Job:  map 47% reduce 0%
16/12/15 10:53:18 INFO mapreduce.Job:  map 48% reduce 1%
16/12/15 10:53:19 INFO mapreduce.Job:  map 48% reduce 2%
16/12/15 10:53:21 INFO mapreduce.Job:  map 51% reduce 3%
16/12/15 10:53:23 INFO mapreduce.Job:  map 51% reduce 4%
16/12/15 10:53:27 INFO mapreduce.Job:  map 52% reduce 5%
16/12/15 10:53:30 INFO mapreduce.Job:  map 53% reduce 5%
16/12/15 10:53:31 INFO mapreduce.Job:  map 55% reduce 8%
16/12/15 10:53:32 INFO mapreduce.Job:  map 56% reduce 10%
16/12/15 10:53:33 INFO mapreduce.Job:  map 58% reduce 13%
16/12/15 10:53:34 INFO mapreduce.Job:  map 63% reduce 15%
16/12/15 10:53:36 INFO mapreduce.Job:  map 65% reduce 16%
16/12/15 10:53:37 INFO mapreduce.Job:  map 68% reduce 17%
16/12/15 10:53:38 INFO mapreduce.Job:  map 68% reduce 18%
16/12/15 10:53:39 INFO mapreduce.Job:  map 69% reduce 22%
16/12/15 10:53:40 INFO mapreduce.Job:  map 71% reduce 22%
16/12/15 10:53:41 INFO mapreduce.Job:  map 72% reduce 23%
16/12/15 10:53:42 INFO mapreduce.Job:  map 76% reduce 23%
16/12/15 10:53:43 INFO mapreduce.Job:  map 80% reduce 24%
16/12/15 10:53:44 INFO mapreduce.Job:  map 83% reduce 25%
16/12/15 10:53:45 INFO mapreduce.Job:  map 86% reduce 26%
16/12/15 10:53:46 INFO mapreduce.Job:  map 88% reduce 27%
16/12/15 10:53:47 INFO mapreduce.Job:  map 90% reduce 28%
16/12/15 10:53:48 INFO mapreduce.Job:  map 90% reduce 29%
16/12/15 10:53:49 INFO mapreduce.Job:  map 92% reduce 30%
16/12/15 10:53:51 INFO mapreduce.Job:  map 93% reduce 31%
16/12/15 10:53:52 INFO mapreduce.Job:  map 94% reduce 31%
16/12/15 10:53:53 INFO mapreduce.Job:  map 96% reduce 31%
16/12/15 10:53:55 INFO mapreduce.Job:  map 98% reduce 32%
16/12/15 10:53:56 INFO mapreduce.Job:  map 99% reduce 32%
16/12/15 10:53:57 INFO mapreduce.Job:  map 100% reduce 33%
16/12/15 10:53:58 INFO mapreduce.Job:  map 100% reduce 37%
16/12/15 10:53:59 INFO mapreduce.Job:  map 100% reduce 49%
16/12/15 10:54:00 INFO mapreduce.Job:  map 100% reduce 60%
16/12/15 10:54:01 INFO mapreduce.Job:  map 100% reduce 68%
16/12/15 10:54:02 INFO mapreduce.Job:  map 100% reduce 77%
16/12/15 10:54:03 INFO mapreduce.Job:  map 100% reduce 84%
16/12/15 10:54:04 INFO mapreduce.Job:  map 100% reduce 88%
16/12/15 10:54:06 INFO mapreduce.Job:  map 100% reduce 94%
16/12/15 10:54:07 INFO mapreduce.Job:  map 100% reduce 96%
16/12/15 10:54:08 INFO mapreduce.Job:  map 100% reduce 98%
16/12/15 10:54:09 INFO mapreduce.Job:  map 100% reduce 100%
16/12/15 10:54:12 INFO mapreduce.Job: Job job_1480588584072_8682 completed successfully
16/12/15 10:54:12 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=586543258
		FILE: Number of bytes written=1205468481
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=501093701
		WASB: Number of bytes written=319972009
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=13886194
		Total time spent by all reduces in occupied slots (ms)=2435330
		Total time spent by all map tasks (ms)=6943097
		Total time spent by all reduce tasks (ms)=1217665
		Total vcore-seconds taken by all map tasks=6943097
		Total vcore-seconds taken by all reduce tasks=1217665
		Total megabyte-seconds taken by all map tasks=7109731328
		Total megabyte-seconds taken by all reduce tasks=1246888960
	Map-Reduce Framework
		Map input records=1574180
		Map output records=1410508
		Map output bytes=581085161
		Map output materialized bytes=586566778
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1240418
		Reduce shuffle bytes=586566778
		Reduce input records=1410508
		Reduce output records=934362
		Spilled Records=2821016
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=91387
		CPU time spent (ms)=877740
		Physical memory (bytes) snapshot=323673903104
		Virtual memory (bytes) snapshot=743816507392
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=498397697
	File Output Format Counters 
		Bytes Written=319972009
16/12/15 10:54:12 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/0700
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/07.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/07/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130000 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130400 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/0800 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/07/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130000,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130400
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/0800': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob2327654060380563237.jar tmpDir=null
16/12/15 10:54:51 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/15 10:54:52 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/15 10:54:52 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/15 10:54:54 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/15 10:54:54 INFO mapreduce.JobSubmitter: number of splits:197
16/12/15 10:54:55 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_8684
16/12/15 10:54:56 INFO impl.YarnClientImpl: Submitted application application_1480588584072_8684
16/12/15 10:54:56 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_8684/
16/12/15 10:54:56 INFO mapreduce.Job: Running job: job_1480588584072_8684
16/12/15 10:55:12 INFO mapreduce.Job: Job job_1480588584072_8684 running in uber mode : false
16/12/15 10:55:12 INFO mapreduce.Job:  map 0% reduce 0%
16/12/15 10:55:29 INFO mapreduce.Job:  map 1% reduce 0%
16/12/15 10:55:30 INFO mapreduce.Job:  map 2% reduce 0%
16/12/15 10:55:39 INFO mapreduce.Job:  map 3% reduce 0%
16/12/15 10:55:40 INFO mapreduce.Job:  map 5% reduce 0%
16/12/15 10:55:42 INFO mapreduce.Job:  map 6% reduce 0%
16/12/15 10:55:43 INFO mapreduce.Job:  map 7% reduce 0%
16/12/15 10:55:44 INFO mapreduce.Job:  map 8% reduce 0%
16/12/15 10:55:45 INFO mapreduce.Job:  map 9% reduce 0%
16/12/15 10:55:47 INFO mapreduce.Job:  map 10% reduce 0%
16/12/15 10:55:49 INFO mapreduce.Job:  map 12% reduce 0%
16/12/15 10:55:51 INFO mapreduce.Job:  map 13% reduce 0%
16/12/15 10:55:52 INFO mapreduce.Job:  map 14% reduce 0%
16/12/15 10:55:53 INFO mapreduce.Job:  map 16% reduce 0%
16/12/15 10:55:54 INFO mapreduce.Job:  map 18% reduce 0%
16/12/15 10:55:56 INFO mapreduce.Job:  map 20% reduce 0%
16/12/15 10:55:58 INFO mapreduce.Job:  map 21% reduce 0%
16/12/15 10:55:59 INFO mapreduce.Job:  map 22% reduce 0%
16/12/15 10:56:00 INFO mapreduce.Job:  map 24% reduce 0%
16/12/15 10:56:01 INFO mapreduce.Job:  map 26% reduce 0%
16/12/15 10:56:03 INFO mapreduce.Job:  map 26% reduce 1%
16/12/15 10:56:04 INFO mapreduce.Job:  map 27% reduce 1%
16/12/15 10:56:05 INFO mapreduce.Job:  map 28% reduce 1%
16/12/15 10:56:07 INFO mapreduce.Job:  map 29% reduce 1%
16/12/15 10:56:09 INFO mapreduce.Job:  map 30% reduce 1%
16/12/15 10:56:10 INFO mapreduce.Job:  map 31% reduce 1%
16/12/15 10:56:11 INFO mapreduce.Job:  map 31% reduce 2%
16/12/15 10:56:12 INFO mapreduce.Job:  map 32% reduce 2%
16/12/15 10:56:13 INFO mapreduce.Job:  map 33% reduce 2%
16/12/15 10:56:14 INFO mapreduce.Job:  map 36% reduce 3%
16/12/15 10:56:15 INFO mapreduce.Job:  map 37% reduce 3%
16/12/15 10:56:16 INFO mapreduce.Job:  map 39% reduce 3%
16/12/15 10:56:17 INFO mapreduce.Job:  map 40% reduce 4%
16/12/15 10:56:18 INFO mapreduce.Job:  map 41% reduce 6%
16/12/15 10:56:19 INFO mapreduce.Job:  map 42% reduce 6%
16/12/15 10:56:20 INFO mapreduce.Job:  map 43% reduce 6%
16/12/15 10:56:24 INFO mapreduce.Job:  map 44% reduce 7%
16/12/15 10:56:25 INFO mapreduce.Job:  map 44% reduce 8%
16/12/15 10:56:29 INFO mapreduce.Job:  map 46% reduce 8%
16/12/15 10:56:30 INFO mapreduce.Job:  map 48% reduce 9%
16/12/15 10:56:31 INFO mapreduce.Job:  map 49% reduce 10%
16/12/15 10:56:32 INFO mapreduce.Job:  map 51% reduce 10%
16/12/15 10:56:33 INFO mapreduce.Job:  map 52% reduce 11%
16/12/15 10:56:34 INFO mapreduce.Job:  map 52% reduce 12%
16/12/15 10:56:35 INFO mapreduce.Job:  map 53% reduce 12%
16/12/15 10:56:36 INFO mapreduce.Job:  map 54% reduce 12%
16/12/15 10:56:39 INFO mapreduce.Job:  map 55% reduce 13%
16/12/15 10:56:43 INFO mapreduce.Job:  map 56% reduce 14%
16/12/15 10:56:44 INFO mapreduce.Job:  map 57% reduce 14%
16/12/15 10:56:45 INFO mapreduce.Job:  map 58% reduce 14%
16/12/15 10:56:46 INFO mapreduce.Job:  map 61% reduce 15%
16/12/15 10:56:47 INFO mapreduce.Job:  map 61% reduce 16%
16/12/15 10:56:48 INFO mapreduce.Job:  map 62% reduce 17%
16/12/15 10:56:50 INFO mapreduce.Job:  map 63% reduce 18%
16/12/15 10:56:52 INFO mapreduce.Job:  map 64% reduce 19%
16/12/15 10:56:57 INFO mapreduce.Job:  map 66% reduce 19%
16/12/15 10:56:58 INFO mapreduce.Job:  map 68% reduce 20%
16/12/15 10:56:59 INFO mapreduce.Job:  map 69% reduce 20%
16/12/15 10:57:00 INFO mapreduce.Job:  map 70% reduce 20%
16/12/15 10:57:01 INFO mapreduce.Job:  map 70% reduce 21%
16/12/15 10:57:02 INFO mapreduce.Job:  map 72% reduce 21%
16/12/15 10:57:05 INFO mapreduce.Job:  map 73% reduce 22%
16/12/15 10:57:07 INFO mapreduce.Job:  map 74% reduce 22%
16/12/15 10:57:09 INFO mapreduce.Job:  map 75% reduce 22%
16/12/15 10:57:10 INFO mapreduce.Job:  map 76% reduce 22%
16/12/15 10:57:11 INFO mapreduce.Job:  map 77% reduce 23%
16/12/15 10:57:13 INFO mapreduce.Job:  map 78% reduce 23%
16/12/15 10:57:14 INFO mapreduce.Job:  map 79% reduce 23%
16/12/15 10:57:15 INFO mapreduce.Job:  map 80% reduce 23%
16/12/15 10:57:17 INFO mapreduce.Job:  map 82% reduce 24%
16/12/15 10:57:20 INFO mapreduce.Job:  map 83% reduce 24%
16/12/15 10:57:21 INFO mapreduce.Job:  map 84% reduce 25%
16/12/15 10:57:23 INFO mapreduce.Job:  map 85% reduce 25%
16/12/15 10:57:25 INFO mapreduce.Job:  map 86% reduce 25%
16/12/15 10:57:27 INFO mapreduce.Job:  map 88% reduce 26%
16/12/15 10:57:29 INFO mapreduce.Job:  map 89% reduce 26%
16/12/15 10:57:30 INFO mapreduce.Job:  map 89% reduce 27%
16/12/15 10:57:31 INFO mapreduce.Job:  map 90% reduce 27%
16/12/15 10:57:32 INFO mapreduce.Job:  map 92% reduce 27%
16/12/15 10:57:34 INFO mapreduce.Job:  map 93% reduce 27%
16/12/15 10:57:35 INFO mapreduce.Job:  map 94% reduce 28%
16/12/15 10:57:36 INFO mapreduce.Job:  map 95% reduce 28%
16/12/15 10:57:38 INFO mapreduce.Job:  map 97% reduce 29%
16/12/15 10:57:39 INFO mapreduce.Job:  map 98% reduce 29%
16/12/15 10:57:40 INFO mapreduce.Job:  map 100% reduce 29%
16/12/15 10:57:41 INFO mapreduce.Job:  map 100% reduce 30%
16/12/15 10:57:42 INFO mapreduce.Job:  map 100% reduce 40%
16/12/15 10:57:43 INFO mapreduce.Job:  map 100% reduce 45%
16/12/15 10:57:44 INFO mapreduce.Job:  map 100% reduce 52%
16/12/15 10:57:45 INFO mapreduce.Job:  map 100% reduce 58%
16/12/15 10:57:46 INFO mapreduce.Job:  map 100% reduce 75%
16/12/15 10:57:47 INFO mapreduce.Job:  map 100% reduce 78%
16/12/15 10:57:48 INFO mapreduce.Job:  map 100% reduce 81%
16/12/15 10:57:49 INFO mapreduce.Job:  map 100% reduce 91%
16/12/15 10:57:50 INFO mapreduce.Job:  map 100% reduce 94%
16/12/15 10:57:51 INFO mapreduce.Job:  map 100% reduce 95%
16/12/15 10:57:52 INFO mapreduce.Job:  map 100% reduce 98%
16/12/15 10:57:55 INFO mapreduce.Job:  map 100% reduce 100%
16/12/15 10:58:00 INFO mapreduce.Job: Job job_1480588584072_8684 completed successfully
16/12/15 10:58:00 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=663638494
		FILE: Number of bytes written=1359658953
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=565383401
		WASB: Number of bytes written=364381746
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=6634884
		Total time spent by all reduces in occupied slots (ms)=3768134
		Total time spent by all map tasks (ms)=3317442
		Total time spent by all reduce tasks (ms)=1884067
		Total vcore-seconds taken by all map tasks=3317442
		Total vcore-seconds taken by all reduce tasks=1884067
		Total megabyte-seconds taken by all map tasks=3397060608
		Total megabyte-seconds taken by all reduce tasks=1929284608
	Map-Reduce Framework
		Map input records=1772376
		Map output records=1593270
		Map output bytes=657465521
		Map output materialized bytes=663662014
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1400065
		Reduce shuffle bytes=663662014
		Reduce input records=1593270
		Reduce output records=1061115
		Spilled Records=3186540
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=52058
		CPU time spent (ms)=880160
		Physical memory (bytes) snapshot=323868651520
		Virtual memory (bytes) snapshot=744131633152
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=562687397
	File Output Format Counters 
		Bytes Written=364381746
16/12/15 10:58:00 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/0800
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/08.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/08/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130100
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130100 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130500 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/0900 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/08/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130100,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130500
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/0900': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob6277371077276670050.jar tmpDir=null
16/12/15 10:58:39 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/15 10:58:40 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/15 10:58:40 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/15 10:58:42 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/15 10:58:42 INFO mapreduce.JobSubmitter: number of splits:197
16/12/15 10:58:43 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_8687
16/12/15 10:58:44 INFO impl.YarnClientImpl: Submitted application application_1480588584072_8687
16/12/15 10:58:44 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_8687/
16/12/15 10:58:44 INFO mapreduce.Job: Running job: job_1480588584072_8687
16/12/15 10:58:57 INFO mapreduce.Job: Job job_1480588584072_8687 running in uber mode : false
16/12/15 10:58:57 INFO mapreduce.Job:  map 0% reduce 0%
16/12/15 10:59:22 INFO mapreduce.Job:  map 1% reduce 0%
16/12/15 10:59:33 INFO mapreduce.Job:  map 2% reduce 0%
16/12/15 10:59:37 INFO mapreduce.Job:  map 3% reduce 0%
16/12/15 10:59:39 INFO mapreduce.Job:  map 5% reduce 0%
16/12/15 10:59:42 INFO mapreduce.Job:  map 6% reduce 0%
16/12/15 10:59:43 INFO mapreduce.Job:  map 7% reduce 0%
16/12/15 10:59:44 INFO mapreduce.Job:  map 10% reduce 0%
16/12/15 10:59:45 INFO mapreduce.Job:  map 11% reduce 0%
16/12/15 10:59:46 INFO mapreduce.Job:  map 13% reduce 0%
16/12/15 10:59:47 INFO mapreduce.Job:  map 16% reduce 0%
16/12/15 10:59:49 INFO mapreduce.Job:  map 17% reduce 0%
16/12/15 10:59:50 INFO mapreduce.Job:  map 19% reduce 0%
16/12/15 10:59:51 INFO mapreduce.Job:  map 20% reduce 0%
16/12/15 10:59:57 INFO mapreduce.Job:  map 21% reduce 0%
16/12/15 10:59:59 INFO mapreduce.Job:  map 22% reduce 0%
16/12/15 11:00:00 INFO mapreduce.Job:  map 26% reduce 1%
16/12/15 11:00:01 INFO mapreduce.Job:  map 27% reduce 1%
16/12/15 11:00:02 INFO mapreduce.Job:  map 28% reduce 1%
16/12/15 11:00:03 INFO mapreduce.Job:  map 29% reduce 2%
16/12/15 11:00:04 INFO mapreduce.Job:  map 33% reduce 2%
16/12/15 11:00:05 INFO mapreduce.Job:  map 34% reduce 3%
16/12/15 11:00:06 INFO mapreduce.Job:  map 35% reduce 3%
16/12/15 11:00:07 INFO mapreduce.Job:  map 37% reduce 3%
16/12/15 11:00:09 INFO mapreduce.Job:  map 37% reduce 4%
16/12/15 11:00:10 INFO mapreduce.Job:  map 38% reduce 4%
16/12/15 11:00:11 INFO mapreduce.Job:  map 39% reduce 4%
16/12/15 11:00:12 INFO mapreduce.Job:  map 40% reduce 4%
16/12/15 11:00:14 INFO mapreduce.Job:  map 40% reduce 5%
16/12/15 11:00:16 INFO mapreduce.Job:  map 40% reduce 6%
16/12/15 11:00:17 INFO mapreduce.Job:  map 41% reduce 6%
16/12/15 11:00:19 INFO mapreduce.Job:  map 43% reduce 6%
16/12/15 11:00:20 INFO mapreduce.Job:  map 43% reduce 7%
16/12/15 11:00:21 INFO mapreduce.Job:  map 46% reduce 8%
16/12/15 11:00:22 INFO mapreduce.Job:  map 47% reduce 9%
16/12/15 11:00:23 INFO mapreduce.Job:  map 49% reduce 10%
16/12/15 11:00:24 INFO mapreduce.Job:  map 50% reduce 11%
16/12/15 11:00:25 INFO mapreduce.Job:  map 51% reduce 12%
16/12/15 11:00:26 INFO mapreduce.Job:  map 52% reduce 12%
16/12/15 11:00:27 INFO mapreduce.Job:  map 53% reduce 13%
16/12/15 11:00:30 INFO mapreduce.Job:  map 55% reduce 13%
16/12/15 11:00:32 INFO mapreduce.Job:  map 56% reduce 14%
16/12/15 11:00:33 INFO mapreduce.Job:  map 57% reduce 15%
16/12/15 11:00:34 INFO mapreduce.Job:  map 58% reduce 16%
16/12/15 11:00:36 INFO mapreduce.Job:  map 60% reduce 16%
16/12/15 11:00:37 INFO mapreduce.Job:  map 61% reduce 18%
16/12/15 11:00:38 INFO mapreduce.Job:  map 62% reduce 18%
16/12/15 11:00:40 INFO mapreduce.Job:  map 63% reduce 20%
16/12/15 11:00:41 INFO mapreduce.Job:  map 64% reduce 20%
16/12/15 11:00:42 INFO mapreduce.Job:  map 65% reduce 20%
16/12/15 11:00:43 INFO mapreduce.Job:  map 68% reduce 20%
16/12/15 11:00:44 INFO mapreduce.Job:  map 69% reduce 21%
16/12/15 11:00:46 INFO mapreduce.Job:  map 71% reduce 22%
16/12/15 11:00:49 INFO mapreduce.Job:  map 72% reduce 22%
16/12/15 11:00:50 INFO mapreduce.Job:  map 73% reduce 23%
16/12/15 11:00:51 INFO mapreduce.Job:  map 74% reduce 23%
16/12/15 11:00:53 INFO mapreduce.Job:  map 77% reduce 23%
16/12/15 11:00:54 INFO mapreduce.Job:  map 78% reduce 24%
16/12/15 11:00:55 INFO mapreduce.Job:  map 79% reduce 24%
16/12/15 11:00:56 INFO mapreduce.Job:  map 79% reduce 25%
16/12/15 11:00:57 INFO mapreduce.Job:  map 80% reduce 25%
16/12/15 11:00:58 INFO mapreduce.Job:  map 81% reduce 25%
16/12/15 11:01:00 INFO mapreduce.Job:  map 83% reduce 26%
16/12/15 11:01:01 INFO mapreduce.Job:  map 85% reduce 26%
16/12/15 11:01:03 INFO mapreduce.Job:  map 86% reduce 26%
16/12/15 11:01:04 INFO mapreduce.Job:  map 87% reduce 27%
16/12/15 11:01:05 INFO mapreduce.Job:  map 88% reduce 27%
16/12/15 11:01:07 INFO mapreduce.Job:  map 88% reduce 28%
16/12/15 11:01:09 INFO mapreduce.Job:  map 90% reduce 28%
16/12/15 11:01:10 INFO mapreduce.Job:  map 91% reduce 28%
16/12/15 11:01:11 INFO mapreduce.Job:  map 92% reduce 28%
16/12/15 11:01:12 INFO mapreduce.Job:  map 93% reduce 29%
16/12/15 11:01:14 INFO mapreduce.Job:  map 95% reduce 29%
16/12/15 11:01:15 INFO mapreduce.Job:  map 95% reduce 30%
16/12/15 11:01:16 INFO mapreduce.Job:  map 96% reduce 30%
16/12/15 11:01:17 INFO mapreduce.Job:  map 97% reduce 30%
16/12/15 11:01:19 INFO mapreduce.Job:  map 99% reduce 31%
16/12/15 11:01:22 INFO mapreduce.Job:  map 100% reduce 32%
16/12/15 11:01:23 INFO mapreduce.Job:  map 100% reduce 38%
16/12/15 11:01:24 INFO mapreduce.Job:  map 100% reduce 48%
16/12/15 11:01:25 INFO mapreduce.Job:  map 100% reduce 62%
16/12/15 11:01:26 INFO mapreduce.Job:  map 100% reduce 72%
16/12/15 11:01:27 INFO mapreduce.Job:  map 100% reduce 76%
16/12/15 11:01:28 INFO mapreduce.Job:  map 100% reduce 83%
16/12/15 11:01:29 INFO mapreduce.Job:  map 100% reduce 91%
16/12/15 11:01:30 INFO mapreduce.Job:  map 100% reduce 98%
16/12/15 11:01:31 INFO mapreduce.Job:  map 100% reduce 100%
16/12/15 11:01:34 INFO mapreduce.Job: Job job_1480588584072_8687 completed successfully
16/12/15 11:01:34 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=659709979
		FILE: Number of bytes written=1351801923
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=565886964
		WASB: Number of bytes written=343621636
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=5392252
		Total time spent by all reduces in occupied slots (ms)=3335202
		Total time spent by all map tasks (ms)=2696126
		Total time spent by all reduce tasks (ms)=1667601
		Total vcore-seconds taken by all map tasks=2696126
		Total vcore-seconds taken by all reduce tasks=1667601
		Total megabyte-seconds taken by all map tasks=2760833024
		Total megabyte-seconds taken by all reduce tasks=1707623424
	Map-Reduce Framework
		Map input records=1788824
		Map output records=1590451
		Map output bytes=653549988
		Map output materialized bytes=659733499
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1389031
		Reduce shuffle bytes=659733499
		Reduce input records=1590451
		Reduce output records=1003800
		Spilled Records=3180902
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=40675
		CPU time spent (ms)=865570
		Physical memory (bytes) snapshot=323902365696
		Virtual memory (bytes) snapshot=744251731968
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=563190960
	File Output Format Counters 
		Bytes Written=343621636
16/12/15 11:01:34 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/0900
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/09.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/09/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130200
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130200 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130600 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/1000 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/09/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130200,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130600
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/1000': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob7762806718934278142.jar tmpDir=null
16/12/15 11:02:14 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/15 11:02:15 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/15 11:02:15 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/15 11:02:18 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/15 11:02:19 INFO mapreduce.JobSubmitter: number of splits:197
16/12/15 11:02:20 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_8690
16/12/15 11:02:21 INFO impl.YarnClientImpl: Submitted application application_1480588584072_8690
16/12/15 11:02:21 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_8690/
16/12/15 11:02:21 INFO mapreduce.Job: Running job: job_1480588584072_8690
16/12/15 11:07:23 INFO mapreduce.Job: Job job_1480588584072_8690 running in uber mode : false
16/12/15 11:07:23 INFO mapreduce.Job:  map 0% reduce 0%
16/12/15 11:07:38 INFO mapreduce.Job:  map 1% reduce 0%
16/12/15 11:07:39 INFO mapreduce.Job:  map 2% reduce 0%
16/12/15 11:07:48 INFO mapreduce.Job:  map 3% reduce 0%
16/12/15 11:07:51 INFO mapreduce.Job:  map 5% reduce 0%
16/12/15 11:07:52 INFO mapreduce.Job:  map 6% reduce 0%
16/12/15 11:07:53 INFO mapreduce.Job:  map 8% reduce 0%
16/12/15 11:07:55 INFO mapreduce.Job:  map 9% reduce 0%
16/12/15 11:07:56 INFO mapreduce.Job:  map 10% reduce 0%
16/12/15 11:07:58 INFO mapreduce.Job:  map 11% reduce 0%
16/12/15 11:08:00 INFO mapreduce.Job:  map 12% reduce 0%
16/12/15 11:08:01 INFO mapreduce.Job:  map 14% reduce 0%
16/12/15 11:08:03 INFO mapreduce.Job:  map 15% reduce 0%
16/12/15 11:08:04 INFO mapreduce.Job:  map 17% reduce 0%
16/12/15 11:08:06 INFO mapreduce.Job:  map 18% reduce 0%
16/12/15 11:08:07 INFO mapreduce.Job:  map 19% reduce 0%
16/12/15 11:08:08 INFO mapreduce.Job:  map 22% reduce 0%
16/12/15 11:08:09 INFO mapreduce.Job:  map 24% reduce 0%
16/12/15 11:08:10 INFO mapreduce.Job:  map 27% reduce 0%
16/12/15 11:08:11 INFO mapreduce.Job:  map 27% reduce 1%
16/12/15 11:08:12 INFO mapreduce.Job:  map 28% reduce 1%
16/12/15 11:08:18 INFO mapreduce.Job:  map 29% reduce 1%
16/12/15 11:08:19 INFO mapreduce.Job:  map 31% reduce 1%
16/12/15 11:08:20 INFO mapreduce.Job:  map 33% reduce 2%
16/12/15 11:08:21 INFO mapreduce.Job:  map 35% reduce 3%
16/12/15 11:08:22 INFO mapreduce.Job:  map 37% reduce 3%
16/12/15 11:08:23 INFO mapreduce.Job:  map 37% reduce 4%
16/12/15 11:08:24 INFO mapreduce.Job:  map 38% reduce 4%
16/12/15 11:08:27 INFO mapreduce.Job:  map 39% reduce 5%
16/12/15 11:08:28 INFO mapreduce.Job:  map 41% reduce 5%
16/12/15 11:08:29 INFO mapreduce.Job:  map 43% reduce 6%
16/12/15 11:08:30 INFO mapreduce.Job:  map 44% reduce 7%
16/12/15 11:08:32 INFO mapreduce.Job:  map 45% reduce 8%
16/12/15 11:08:34 INFO mapreduce.Job:  map 46% reduce 8%
16/12/15 11:08:35 INFO mapreduce.Job:  map 48% reduce 8%
16/12/15 11:08:36 INFO mapreduce.Job:  map 49% reduce 9%
16/12/15 11:08:37 INFO mapreduce.Job:  map 50% reduce 9%
16/12/15 11:08:38 INFO mapreduce.Job:  map 50% reduce 10%
16/12/15 11:08:43 INFO mapreduce.Job:  map 52% reduce 10%
16/12/15 11:08:45 INFO mapreduce.Job:  map 53% reduce 11%
16/12/15 11:08:46 INFO mapreduce.Job:  map 55% reduce 12%
16/12/15 11:08:47 INFO mapreduce.Job:  map 57% reduce 13%
16/12/15 11:08:48 INFO mapreduce.Job:  map 58% reduce 14%
16/12/15 11:08:50 INFO mapreduce.Job:  map 59% reduce 14%
16/12/15 11:08:51 INFO mapreduce.Job:  map 59% reduce 16%
16/12/15 11:08:54 INFO mapreduce.Job:  map 60% reduce 17%
16/12/15 11:08:59 INFO mapreduce.Job:  map 61% reduce 17%
16/12/15 11:09:01 INFO mapreduce.Job:  map 62% reduce 17%
16/12/15 11:09:02 INFO mapreduce.Job:  map 64% reduce 17%
16/12/15 11:09:03 INFO mapreduce.Job:  map 66% reduce 18%
16/12/15 11:09:06 INFO mapreduce.Job:  map 66% reduce 19%
16/12/15 11:09:11 INFO mapreduce.Job:  map 68% reduce 19%
16/12/15 11:09:12 INFO mapreduce.Job:  map 69% reduce 19%
16/12/15 11:09:14 INFO mapreduce.Job:  map 70% reduce 19%
16/12/15 11:09:15 INFO mapreduce.Job:  map 72% reduce 20%
16/12/15 11:09:16 INFO mapreduce.Job:  map 73% reduce 20%
16/12/15 11:09:19 INFO mapreduce.Job:  map 73% reduce 21%
16/12/15 11:09:20 INFO mapreduce.Job:  map 74% reduce 21%
16/12/15 11:09:21 INFO mapreduce.Job:  map 75% reduce 21%
16/12/15 11:09:22 INFO mapreduce.Job:  map 76% reduce 21%
16/12/15 11:09:23 INFO mapreduce.Job:  map 77% reduce 21%
16/12/15 11:09:24 INFO mapreduce.Job:  map 78% reduce 22%
16/12/15 11:09:27 INFO mapreduce.Job:  map 80% reduce 22%
16/12/15 11:09:28 INFO mapreduce.Job:  map 82% reduce 22%
16/12/15 11:09:29 INFO mapreduce.Job:  map 83% reduce 22%
16/12/15 11:09:30 INFO mapreduce.Job:  map 83% reduce 23%
16/12/15 11:09:33 INFO mapreduce.Job:  map 83% reduce 24%
16/12/15 11:09:34 INFO mapreduce.Job:  map 84% reduce 24%
16/12/15 11:09:36 INFO mapreduce.Job:  map 86% reduce 25%
16/12/15 11:09:37 INFO mapreduce.Job:  map 90% reduce 27%
16/12/15 11:09:39 INFO mapreduce.Job:  map 91% reduce 28%
16/12/15 11:09:40 INFO mapreduce.Job:  map 93% reduce 29%
16/12/15 11:09:42 INFO mapreduce.Job:  map 94% reduce 29%
16/12/15 11:09:43 INFO mapreduce.Job:  map 94% reduce 30%
16/12/15 11:09:44 INFO mapreduce.Job:  map 96% reduce 30%
16/12/15 11:09:47 INFO mapreduce.Job:  map 96% reduce 31%
16/12/15 11:09:50 INFO mapreduce.Job:  map 98% reduce 31%
16/12/15 11:09:51 INFO mapreduce.Job:  map 100% reduce 31%
16/12/15 11:09:53 INFO mapreduce.Job:  map 100% reduce 38%
16/12/15 11:09:54 INFO mapreduce.Job:  map 100% reduce 44%
16/12/15 11:09:55 INFO mapreduce.Job:  map 100% reduce 55%
16/12/15 11:09:56 INFO mapreduce.Job:  map 100% reduce 71%
16/12/15 11:09:57 INFO mapreduce.Job:  map 100% reduce 75%
16/12/15 11:09:58 INFO mapreduce.Job:  map 100% reduce 79%
16/12/15 11:09:59 INFO mapreduce.Job:  map 100% reduce 90%
16/12/15 11:10:00 INFO mapreduce.Job:  map 100% reduce 93%
16/12/15 11:10:01 INFO mapreduce.Job:  map 100% reduce 95%
16/12/15 11:10:02 INFO mapreduce.Job:  map 100% reduce 99%
16/12/15 11:10:03 INFO mapreduce.Job:  map 100% reduce 100%
16/12/15 11:10:08 INFO mapreduce.Job: Job job_1480588584072_8690 completed successfully
16/12/15 11:10:08 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=832835594
		FILE: Number of bytes written=1698053153
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=703273162
		WASB: Number of bytes written=474467183
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=6255182
		Total time spent by all reduces in occupied slots (ms)=3752142
		Total time spent by all map tasks (ms)=3127591
		Total time spent by all reduce tasks (ms)=1876071
		Total vcore-seconds taken by all map tasks=3127591
		Total vcore-seconds taken by all reduce tasks=1876071
		Total megabyte-seconds taken by all map tasks=3202653184
		Total megabyte-seconds taken by all reduce tasks=1921096704
	Map-Reduce Framework
		Map input records=2200533
		Map output records=1999827
		Map output bytes=825103412
		Map output materialized bytes=832859114
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1771247
		Reduce shuffle bytes=832859114
		Reduce input records=1999827
		Reduce output records=1385683
		Spilled Records=3999654
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=45049
		CPU time spent (ms)=924920
		Physical memory (bytes) snapshot=324954103808
		Virtual memory (bytes) snapshot=744483733504
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=700577158
	File Output Format Counters 
		Bytes Written=474467183
16/12/15 11:10:08 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/1000
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/10.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/10/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130300
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130300 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130700 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/1100 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/10/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130300,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130700
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/1100': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5680059054268948583.jar tmpDir=null
16/12/15 11:10:46 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/15 11:10:47 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/15 11:10:47 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/15 11:10:49 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/15 11:10:49 INFO mapreduce.JobSubmitter: number of splits:197
16/12/15 11:10:50 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_8694
16/12/15 11:10:51 INFO impl.YarnClientImpl: Submitted application application_1480588584072_8694
16/12/15 11:10:51 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_8694/
16/12/15 11:10:51 INFO mapreduce.Job: Running job: job_1480588584072_8694
16/12/15 11:14:30 INFO mapreduce.Job: Job job_1480588584072_8694 running in uber mode : false
16/12/15 11:14:30 INFO mapreduce.Job:  map 0% reduce 0%
16/12/15 11:14:42 INFO mapreduce.Job:  map 2% reduce 0%
16/12/15 11:14:46 INFO mapreduce.Job:  map 4% reduce 0%
16/12/15 11:14:51 INFO mapreduce.Job:  map 6% reduce 0%
16/12/15 11:14:54 INFO mapreduce.Job:  map 7% reduce 0%
16/12/15 11:14:55 INFO mapreduce.Job:  map 10% reduce 0%
16/12/15 11:14:56 INFO mapreduce.Job:  map 11% reduce 0%
16/12/15 11:14:58 INFO mapreduce.Job:  map 12% reduce 0%
16/12/15 11:14:59 INFO mapreduce.Job:  map 15% reduce 0%
16/12/15 11:15:00 INFO mapreduce.Job:  map 19% reduce 0%
16/12/15 11:15:01 INFO mapreduce.Job:  map 21% reduce 0%
16/12/15 11:15:02 INFO mapreduce.Job:  map 24% reduce 0%
16/12/15 11:15:07 INFO mapreduce.Job:  map 25% reduce 0%
16/12/15 11:15:08 INFO mapreduce.Job:  map 28% reduce 0%
16/12/15 11:15:09 INFO mapreduce.Job:  map 30% reduce 0%
16/12/15 11:15:12 INFO mapreduce.Job:  map 30% reduce 1%
16/12/15 11:15:13 INFO mapreduce.Job:  map 31% reduce 1%
16/12/15 11:15:15 INFO mapreduce.Job:  map 33% reduce 2%
16/12/15 11:15:16 INFO mapreduce.Job:  map 37% reduce 2%
16/12/15 11:15:17 INFO mapreduce.Job:  map 39% reduce 2%
16/12/15 11:15:18 INFO mapreduce.Job:  map 42% reduce 3%
16/12/15 11:15:19 INFO mapreduce.Job:  map 43% reduce 4%
16/12/15 11:15:20 INFO mapreduce.Job:  map 43% reduce 5%
16/12/15 11:15:21 INFO mapreduce.Job:  map 43% reduce 6%
16/12/15 11:15:23 INFO mapreduce.Job:  map 44% reduce 6%
16/12/15 11:15:25 INFO mapreduce.Job:  map 47% reduce 6%
16/12/15 11:15:26 INFO mapreduce.Job:  map 49% reduce 6%
16/12/15 11:15:27 INFO mapreduce.Job:  map 50% reduce 6%
16/12/15 11:15:28 INFO mapreduce.Job:  map 51% reduce 7%
16/12/15 11:15:29 INFO mapreduce.Job:  map 51% reduce 8%
16/12/15 11:15:30 INFO mapreduce.Job:  map 53% reduce 8%
16/12/15 11:15:31 INFO mapreduce.Job:  map 53% reduce 9%
16/12/15 11:15:32 INFO mapreduce.Job:  map 53% reduce 11%
16/12/15 11:15:33 INFO mapreduce.Job:  map 55% reduce 12%
16/12/15 11:15:34 INFO mapreduce.Job:  map 57% reduce 12%
16/12/15 11:15:35 INFO mapreduce.Job:  map 58% reduce 13%
16/12/15 11:15:37 INFO mapreduce.Job:  map 59% reduce 14%
16/12/15 11:15:38 INFO mapreduce.Job:  map 59% reduce 15%
16/12/15 11:15:39 INFO mapreduce.Job:  map 60% reduce 15%
16/12/15 11:15:40 INFO mapreduce.Job:  map 61% reduce 15%
16/12/15 11:15:41 INFO mapreduce.Job:  map 65% reduce 15%
16/12/15 11:15:42 INFO mapreduce.Job:  map 66% reduce 16%
16/12/15 11:15:43 INFO mapreduce.Job:  map 67% reduce 17%
16/12/15 11:15:44 INFO mapreduce.Job:  map 68% reduce 18%
16/12/15 11:15:48 INFO mapreduce.Job:  map 71% reduce 18%
16/12/15 11:15:49 INFO mapreduce.Job:  map 72% reduce 18%
16/12/15 11:15:51 INFO mapreduce.Job:  map 74% reduce 19%
16/12/15 11:15:52 INFO mapreduce.Job:  map 76% reduce 19%
16/12/15 11:15:53 INFO mapreduce.Job:  map 76% reduce 20%
16/12/15 11:15:56 INFO mapreduce.Job:  map 77% reduce 20%
16/12/15 11:15:57 INFO mapreduce.Job:  map 79% reduce 20%
16/12/15 11:15:58 INFO mapreduce.Job:  map 81% reduce 21%
16/12/15 11:16:00 INFO mapreduce.Job:  map 82% reduce 21%
16/12/15 11:16:01 INFO mapreduce.Job:  map 84% reduce 22%
16/12/15 11:16:03 INFO mapreduce.Job:  map 85% reduce 22%
16/12/15 11:16:04 INFO mapreduce.Job:  map 86% reduce 23%
16/12/15 11:16:05 INFO mapreduce.Job:  map 87% reduce 23%
16/12/15 11:16:06 INFO mapreduce.Job:  map 89% reduce 23%
16/12/15 11:16:07 INFO mapreduce.Job:  map 90% reduce 23%
16/12/15 11:16:08 INFO mapreduce.Job:  map 91% reduce 24%
16/12/15 11:16:10 INFO mapreduce.Job:  map 92% reduce 24%
16/12/15 11:16:11 INFO mapreduce.Job:  map 93% reduce 24%
16/12/15 11:16:12 INFO mapreduce.Job:  map 95% reduce 25%
16/12/15 11:16:13 INFO mapreduce.Job:  map 96% reduce 25%
16/12/15 11:16:14 INFO mapreduce.Job:  map 98% reduce 25%
16/12/15 11:16:15 INFO mapreduce.Job:  map 98% reduce 26%
16/12/15 11:16:16 INFO mapreduce.Job:  map 99% reduce 26%
16/12/15 11:16:17 INFO mapreduce.Job:  map 100% reduce 26%
16/12/15 11:16:18 INFO mapreduce.Job:  map 100% reduce 30%
16/12/15 11:16:19 INFO mapreduce.Job:  map 100% reduce 35%
16/12/15 11:16:20 INFO mapreduce.Job:  map 100% reduce 45%
16/12/15 11:16:21 INFO mapreduce.Job:  map 100% reduce 53%
16/12/15 11:16:22 INFO mapreduce.Job:  map 100% reduce 57%
16/12/15 11:16:23 INFO mapreduce.Job:  map 100% reduce 65%
16/12/15 11:16:24 INFO mapreduce.Job:  map 100% reduce 74%
16/12/15 11:16:25 INFO mapreduce.Job:  map 100% reduce 88%
16/12/15 11:16:26 INFO mapreduce.Job:  map 100% reduce 93%
16/12/15 11:16:27 INFO mapreduce.Job:  map 100% reduce 96%
16/12/15 11:16:28 INFO mapreduce.Job:  map 100% reduce 98%
16/12/15 11:16:29 INFO mapreduce.Job:  map 100% reduce 99%
16/12/15 11:16:31 INFO mapreduce.Job:  map 100% reduce 100%
16/12/15 11:16:36 INFO mapreduce.Job: Job job_1480588584072_8694 completed successfully
16/12/15 11:16:36 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=755170296
		FILE: Number of bytes written=1542722557
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=645259162
		WASB: Number of bytes written=398345196
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=4314302
		Total time spent by all reduces in occupied slots (ms)=2505966
		Total time spent by all map tasks (ms)=2157151
		Total time spent by all reduce tasks (ms)=1252983
		Total vcore-seconds taken by all map tasks=2157151
		Total vcore-seconds taken by all reduce tasks=1252983
		Total megabyte-seconds taken by all map tasks=2208922624
		Total megabyte-seconds taken by all reduce tasks=1283054592
	Map-Reduce Framework
		Map input records=2039725
		Map output records=1821405
		Map output bytes=748118974
		Map output materialized bytes=755193816
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1593017
		Reduce shuffle bytes=755193816
		Reduce input records=1821405
		Reduce output records=1165150
		Spilled Records=3642810
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=26222
		CPU time spent (ms)=865430
		Physical memory (bytes) snapshot=324052246528
		Virtual memory (bytes) snapshot=744427675648
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=642563158
	File Output Format Counters 
		Bytes Written=398345196
16/12/15 11:16:36 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/1100
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/11.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/11/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130400
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130400 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130800 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/1200 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/11/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130400,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130800
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/1200': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob1064660206264029448.jar tmpDir=null
16/12/15 11:17:16 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/15 11:17:17 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/15 11:17:17 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/15 11:17:20 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/15 11:17:20 INFO mapreduce.JobSubmitter: number of splits:197
16/12/15 11:17:20 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_8696
16/12/15 11:17:21 INFO impl.YarnClientImpl: Submitted application application_1480588584072_8696
16/12/15 11:17:21 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_8696/
16/12/15 11:17:21 INFO mapreduce.Job: Running job: job_1480588584072_8696
16/12/15 11:17:53 INFO mapreduce.Job: Job job_1480588584072_8696 running in uber mode : false
16/12/15 11:17:53 INFO mapreduce.Job:  map 0% reduce 0%
16/12/15 11:18:07 INFO mapreduce.Job:  map 1% reduce 0%
16/12/15 11:18:13 INFO mapreduce.Job:  map 2% reduce 0%
16/12/15 11:18:14 INFO mapreduce.Job:  map 3% reduce 0%
16/12/15 11:18:15 INFO mapreduce.Job:  map 9% reduce 0%
16/12/15 11:18:16 INFO mapreduce.Job:  map 10% reduce 0%
16/12/15 11:18:17 INFO mapreduce.Job:  map 11% reduce 0%
16/12/15 11:18:18 INFO mapreduce.Job:  map 12% reduce 0%
16/12/15 11:18:19 INFO mapreduce.Job:  map 13% reduce 0%
16/12/15 11:18:20 INFO mapreduce.Job:  map 14% reduce 0%
16/12/15 11:18:21 INFO mapreduce.Job:  map 15% reduce 0%
16/12/15 11:18:22 INFO mapreduce.Job:  map 16% reduce 0%
16/12/15 11:18:24 INFO mapreduce.Job:  map 17% reduce 0%
16/12/15 11:18:25 INFO mapreduce.Job:  map 18% reduce 0%
16/12/15 11:18:26 INFO mapreduce.Job:  map 21% reduce 0%
16/12/15 11:18:27 INFO mapreduce.Job:  map 26% reduce 0%
16/12/15 11:18:28 INFO mapreduce.Job:  map 28% reduce 0%
16/12/15 11:18:29 INFO mapreduce.Job:  map 29% reduce 0%
16/12/15 11:18:30 INFO mapreduce.Job:  map 30% reduce 0%
16/12/15 11:18:33 INFO mapreduce.Job:  map 30% reduce 1%
16/12/15 11:18:34 INFO mapreduce.Job:  map 31% reduce 1%
16/12/15 11:18:36 INFO mapreduce.Job:  map 34% reduce 2%
16/12/15 11:18:37 INFO mapreduce.Job:  map 39% reduce 2%
16/12/15 11:18:39 INFO mapreduce.Job:  map 41% reduce 3%
16/12/15 11:18:40 INFO mapreduce.Job:  map 43% reduce 5%
16/12/15 11:18:42 INFO mapreduce.Job:  map 44% reduce 5%
16/12/15 11:18:43 INFO mapreduce.Job:  map 44% reduce 6%
16/12/15 11:18:44 INFO mapreduce.Job:  map 45% reduce 6%
16/12/15 11:18:45 INFO mapreduce.Job:  map 46% reduce 7%
16/12/15 11:18:46 INFO mapreduce.Job:  map 48% reduce 8%
16/12/15 11:18:47 INFO mapreduce.Job:  map 50% reduce 8%
16/12/15 11:18:48 INFO mapreduce.Job:  map 52% reduce 10%
16/12/15 11:18:49 INFO mapreduce.Job:  map 53% reduce 10%
16/12/15 11:18:50 INFO mapreduce.Job:  map 54% reduce 10%
16/12/15 11:18:51 INFO mapreduce.Job:  map 55% reduce 12%
16/12/15 11:18:52 INFO mapreduce.Job:  map 56% reduce 14%
16/12/15 11:18:54 INFO mapreduce.Job:  map 57% reduce 15%
16/12/15 11:18:55 INFO mapreduce.Job:  map 60% reduce 15%
16/12/15 11:18:56 INFO mapreduce.Job:  map 61% reduce 16%
16/12/15 11:18:57 INFO mapreduce.Job:  map 63% reduce 17%
16/12/15 11:18:58 INFO mapreduce.Job:  map 64% reduce 18%
16/12/15 11:18:59 INFO mapreduce.Job:  map 66% reduce 19%
16/12/15 11:19:01 INFO mapreduce.Job:  map 66% reduce 21%
16/12/15 11:19:02 INFO mapreduce.Job:  map 68% reduce 21%
16/12/15 11:19:04 INFO mapreduce.Job:  map 69% reduce 21%
16/12/15 11:19:05 INFO mapreduce.Job:  map 71% reduce 21%
16/12/15 11:19:06 INFO mapreduce.Job:  map 72% reduce 22%
16/12/15 11:19:07 INFO mapreduce.Job:  map 74% reduce 22%
16/12/15 11:19:08 INFO mapreduce.Job:  map 76% reduce 23%
16/12/15 11:19:09 INFO mapreduce.Job:  map 77% reduce 23%
16/12/15 11:19:10 INFO mapreduce.Job:  map 77% reduce 24%
16/12/15 11:19:11 INFO mapreduce.Job:  map 78% reduce 24%
16/12/15 11:19:12 INFO mapreduce.Job:  map 79% reduce 24%
16/12/15 11:19:14 INFO mapreduce.Job:  map 83% reduce 25%
16/12/15 11:19:15 INFO mapreduce.Job:  map 84% reduce 25%
16/12/15 11:19:16 INFO mapreduce.Job:  map 86% reduce 26%
16/12/15 11:19:17 INFO mapreduce.Job:  map 86% reduce 27%
16/12/15 11:19:18 INFO mapreduce.Job:  map 87% reduce 27%
16/12/15 11:19:19 INFO mapreduce.Job:  map 88% reduce 27%
16/12/15 11:19:20 INFO mapreduce.Job:  map 89% reduce 28%
16/12/15 11:19:22 INFO mapreduce.Job:  map 91% reduce 28%
16/12/15 11:19:23 INFO mapreduce.Job:  map 94% reduce 28%
16/12/15 11:19:24 INFO mapreduce.Job:  map 96% reduce 29%
16/12/15 11:19:25 INFO mapreduce.Job:  map 97% reduce 29%
16/12/15 11:19:26 INFO mapreduce.Job:  map 98% reduce 30%
16/12/15 11:19:27 INFO mapreduce.Job:  map 99% reduce 31%
16/12/15 11:19:29 INFO mapreduce.Job:  map 100% reduce 31%
16/12/15 11:19:30 INFO mapreduce.Job:  map 100% reduce 32%
16/12/15 11:19:31 INFO mapreduce.Job:  map 100% reduce 33%
16/12/15 11:19:32 INFO mapreduce.Job:  map 100% reduce 53%
16/12/15 11:19:33 INFO mapreduce.Job:  map 100% reduce 59%
16/12/15 11:19:34 INFO mapreduce.Job:  map 100% reduce 64%
16/12/15 11:19:35 INFO mapreduce.Job:  map 100% reduce 76%
16/12/15 11:19:36 INFO mapreduce.Job:  map 100% reduce 79%
16/12/15 11:19:37 INFO mapreduce.Job:  map 100% reduce 81%
16/12/15 11:19:38 INFO mapreduce.Job:  map 100% reduce 93%
16/12/15 11:19:40 INFO mapreduce.Job:  map 100% reduce 95%
16/12/15 11:19:41 INFO mapreduce.Job:  map 100% reduce 99%
16/12/15 11:19:46 INFO mapreduce.Job:  map 100% reduce 100%
16/12/15 11:19:50 INFO mapreduce.Job: Job job_1480588584072_8696 completed successfully
16/12/15 11:19:50 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=900174512
		FILE: Number of bytes written=1832730989
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=761340969
		WASB: Number of bytes written=508398998
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=4337336
		Total time spent by all reduces in occupied slots (ms)=2606794
		Total time spent by all map tasks (ms)=2168668
		Total time spent by all reduce tasks (ms)=1303397
		Total vcore-seconds taken by all map tasks=2168668
		Total vcore-seconds taken by all reduce tasks=1303397
		Total megabyte-seconds taken by all map tasks=2220716032
		Total megabyte-seconds taken by all reduce tasks=1334678528
	Map-Reduce Framework
		Map input records=2388993
		Map output records=2165245
		Map output bytes=891807707
		Map output materialized bytes=900198032
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1917691
		Reduce shuffle bytes=900198032
		Reduce input records=2165245
		Reduce output records=1487988
		Spilled Records=4330490
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=26849
		CPU time spent (ms)=903310
		Physical memory (bytes) snapshot=324673695744
		Virtual memory (bytes) snapshot=744293572608
		Total committed heap usage (bytes)=574541004800
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=758644965
	File Output Format Counters 
		Bytes Written=508398998
16/12/15 11:19:50 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/1200
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/12.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/12/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130500
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130500 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130900 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/1300 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/12/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130500,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130900
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/1300': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob8748688397987001133.jar tmpDir=null
16/12/15 11:20:29 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/15 11:20:30 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/15 11:20:30 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/15 11:20:32 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/15 11:20:32 INFO mapreduce.JobSubmitter: number of splits:197
16/12/15 11:20:33 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_8699
16/12/15 11:20:34 INFO impl.YarnClientImpl: Submitted application application_1480588584072_8699
16/12/15 11:20:34 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_8699/
16/12/15 11:20:34 INFO mapreduce.Job: Running job: job_1480588584072_8699
16/12/15 11:24:34 INFO mapreduce.Job: Job job_1480588584072_8699 running in uber mode : false
16/12/15 11:24:34 INFO mapreduce.Job:  map 0% reduce 0%
16/12/15 11:24:45 INFO mapreduce.Job:  map 1% reduce 0%
16/12/15 11:24:58 INFO mapreduce.Job:  map 4% reduce 0%
16/12/15 11:24:59 INFO mapreduce.Job:  map 5% reduce 0%
16/12/15 11:25:11 INFO mapreduce.Job:  map 6% reduce 0%
16/12/15 11:25:13 INFO mapreduce.Job:  map 7% reduce 0%
16/12/15 11:25:14 INFO mapreduce.Job:  map 9% reduce 0%
16/12/15 11:25:20 INFO mapreduce.Job:  map 10% reduce 0%
16/12/15 11:25:28 INFO mapreduce.Job:  map 11% reduce 0%
16/12/15 11:25:29 INFO mapreduce.Job:  map 13% reduce 0%
16/12/15 11:25:30 INFO mapreduce.Job:  map 14% reduce 0%
16/12/15 11:25:42 INFO mapreduce.Job:  map 16% reduce 0%
16/12/15 11:25:43 INFO mapreduce.Job:  map 17% reduce 0%
16/12/15 11:25:45 INFO mapreduce.Job:  map 18% reduce 0%
16/12/15 11:25:53 INFO mapreduce.Job:  map 19% reduce 0%
16/12/15 11:25:55 INFO mapreduce.Job:  map 20% reduce 0%
16/12/15 11:25:56 INFO mapreduce.Job:  map 21% reduce 0%
16/12/15 11:26:04 INFO mapreduce.Job:  map 23% reduce 0%
16/12/15 11:26:09 INFO mapreduce.Job:  map 24% reduce 0%
16/12/15 11:26:14 INFO mapreduce.Job:  map 25% reduce 0%
16/12/15 11:26:16 INFO mapreduce.Job:  map 26% reduce 0%
16/12/15 11:26:21 INFO mapreduce.Job:  map 27% reduce 0%
16/12/15 11:26:24 INFO mapreduce.Job:  map 28% reduce 0%
16/12/15 11:26:28 INFO mapreduce.Job:  map 29% reduce 1%
16/12/15 11:26:31 INFO mapreduce.Job:  map 30% reduce 1%
16/12/15 11:26:34 INFO mapreduce.Job:  map 31% reduce 1%
16/12/15 11:26:38 INFO mapreduce.Job:  map 32% reduce 1%
16/12/15 11:26:42 INFO mapreduce.Job:  map 33% reduce 1%
16/12/15 11:26:43 INFO mapreduce.Job:  map 34% reduce 1%
16/12/15 11:26:48 INFO mapreduce.Job:  map 35% reduce 1%
16/12/15 11:26:49 INFO mapreduce.Job:  map 36% reduce 1%
16/12/15 11:26:53 INFO mapreduce.Job:  map 37% reduce 1%
16/12/15 11:26:59 INFO mapreduce.Job:  map 39% reduce 1%
16/12/15 11:27:05 INFO mapreduce.Job:  map 39% reduce 2%
16/12/15 11:27:06 INFO mapreduce.Job:  map 40% reduce 2%
16/12/15 11:27:09 INFO mapreduce.Job:  map 41% reduce 2%
16/12/15 11:27:12 INFO mapreduce.Job:  map 42% reduce 2%
16/12/15 11:27:18 INFO mapreduce.Job:  map 44% reduce 2%
16/12/15 11:27:25 INFO mapreduce.Job:  map 45% reduce 2%
16/12/15 11:27:27 INFO mapreduce.Job:  map 46% reduce 2%
16/12/15 11:27:30 INFO mapreduce.Job:  map 47% reduce 2%
16/12/15 11:27:36 INFO mapreduce.Job:  map 48% reduce 2%
16/12/15 11:27:39 INFO mapreduce.Job:  map 49% reduce 2%
16/12/15 11:27:43 INFO mapreduce.Job:  map 50% reduce 2%
16/12/15 11:27:47 INFO mapreduce.Job:  map 51% reduce 3%
16/12/15 11:27:52 INFO mapreduce.Job:  map 52% reduce 3%
16/12/15 11:27:56 INFO mapreduce.Job:  map 53% reduce 3%
16/12/15 11:27:57 INFO mapreduce.Job:  map 53% reduce 4%
16/12/15 11:27:59 INFO mapreduce.Job:  map 54% reduce 4%
16/12/15 11:28:04 INFO mapreduce.Job:  map 55% reduce 4%
16/12/15 11:28:08 INFO mapreduce.Job:  map 56% reduce 4%
16/12/15 11:28:12 INFO mapreduce.Job:  map 57% reduce 4%
16/12/15 11:28:15 INFO mapreduce.Job:  map 58% reduce 4%
16/12/15 11:28:20 INFO mapreduce.Job:  map 59% reduce 4%
16/12/15 11:28:24 INFO mapreduce.Job:  map 60% reduce 4%
16/12/15 11:28:28 INFO mapreduce.Job:  map 61% reduce 4%
16/12/15 11:28:32 INFO mapreduce.Job:  map 62% reduce 4%
16/12/15 11:28:35 INFO mapreduce.Job:  map 63% reduce 4%
16/12/15 11:28:40 INFO mapreduce.Job:  map 64% reduce 4%
16/12/15 11:28:44 INFO mapreduce.Job:  map 65% reduce 4%
16/12/15 11:28:48 INFO mapreduce.Job:  map 66% reduce 4%
16/12/15 11:28:51 INFO mapreduce.Job:  map 67% reduce 4%
16/12/15 11:28:52 INFO mapreduce.Job:  map 68% reduce 4%
16/12/15 11:28:56 INFO mapreduce.Job:  map 69% reduce 5%
16/12/15 11:29:00 INFO mapreduce.Job:  map 70% reduce 5%
16/12/15 11:29:04 INFO mapreduce.Job:  map 71% reduce 5%
16/12/15 11:29:09 INFO mapreduce.Job:  map 72% reduce 5%
16/12/15 11:29:13 INFO mapreduce.Job:  map 73% reduce 5%
16/12/15 11:29:16 INFO mapreduce.Job:  map 74% reduce 5%
16/12/15 11:29:21 INFO mapreduce.Job:  map 75% reduce 5%
16/12/15 11:29:24 INFO mapreduce.Job:  map 76% reduce 5%
16/12/15 11:29:28 INFO mapreduce.Job:  map 77% reduce 5%
16/12/15 11:29:33 INFO mapreduce.Job:  map 78% reduce 5%
16/12/15 11:29:36 INFO mapreduce.Job:  map 79% reduce 5%
16/12/15 11:29:43 INFO mapreduce.Job:  map 80% reduce 5%
16/12/15 11:29:44 INFO mapreduce.Job:  map 81% reduce 5%
16/12/15 11:29:52 INFO mapreduce.Job:  map 82% reduce 5%
16/12/15 11:29:53 INFO mapreduce.Job:  map 83% reduce 5%
16/12/15 11:29:57 INFO mapreduce.Job:  map 83% reduce 6%
16/12/15 11:30:01 INFO mapreduce.Job:  map 85% reduce 6%
16/12/15 11:30:08 INFO mapreduce.Job:  map 86% reduce 6%
16/12/15 11:30:10 INFO mapreduce.Job:  map 87% reduce 6%
16/12/15 11:30:16 INFO mapreduce.Job:  map 88% reduce 6%
16/12/15 11:30:17 INFO mapreduce.Job:  map 89% reduce 6%
16/12/15 11:30:24 INFO mapreduce.Job:  map 90% reduce 6%
16/12/15 11:30:25 INFO mapreduce.Job:  map 91% reduce 6%
16/12/15 11:30:33 INFO mapreduce.Job:  map 93% reduce 6%
16/12/15 11:30:41 INFO mapreduce.Job:  map 94% reduce 6%
16/12/15 11:30:42 INFO mapreduce.Job:  map 95% reduce 6%
16/12/15 11:30:49 INFO mapreduce.Job:  map 96% reduce 6%
16/12/15 11:30:51 INFO mapreduce.Job:  map 97% reduce 6%
16/12/15 11:30:57 INFO mapreduce.Job:  map 98% reduce 6%
16/12/15 11:30:59 INFO mapreduce.Job:  map 99% reduce 7%
16/12/15 11:31:04 INFO mapreduce.Job:  map 100% reduce 7%
16/12/15 11:31:05 INFO mapreduce.Job:  map 100% reduce 8%
16/12/15 11:31:06 INFO mapreduce.Job:  map 100% reduce 10%
16/12/15 11:31:08 INFO mapreduce.Job:  map 100% reduce 14%
16/12/15 11:31:10 INFO mapreduce.Job:  map 100% reduce 19%
16/12/15 11:31:11 INFO mapreduce.Job:  map 100% reduce 25%
16/12/15 11:31:12 INFO mapreduce.Job:  map 100% reduce 26%
16/12/15 11:31:13 INFO mapreduce.Job:  map 100% reduce 28%
16/12/15 11:31:14 INFO mapreduce.Job:  map 100% reduce 30%
16/12/15 11:31:15 INFO mapreduce.Job:  map 100% reduce 34%
16/12/15 11:31:16 INFO mapreduce.Job:  map 100% reduce 38%
16/12/15 11:31:18 INFO mapreduce.Job:  map 100% reduce 39%
16/12/15 11:31:19 INFO mapreduce.Job:  map 100% reduce 40%
16/12/15 11:31:22 INFO mapreduce.Job:  map 100% reduce 44%
16/12/15 11:31:24 INFO mapreduce.Job:  map 100% reduce 48%
16/12/15 11:31:25 INFO mapreduce.Job:  map 100% reduce 53%
16/12/15 11:31:26 INFO mapreduce.Job:  map 100% reduce 61%
16/12/15 11:31:27 INFO mapreduce.Job:  map 100% reduce 66%
16/12/15 11:31:28 INFO mapreduce.Job:  map 100% reduce 67%
16/12/15 11:31:29 INFO mapreduce.Job:  map 100% reduce 69%
16/12/15 11:31:30 INFO mapreduce.Job:  map 100% reduce 70%
16/12/15 11:31:31 INFO mapreduce.Job:  map 100% reduce 78%
16/12/15 11:31:34 INFO mapreduce.Job:  map 100% reduce 80%
16/12/15 11:31:36 INFO mapreduce.Job:  map 100% reduce 84%
16/12/15 11:31:39 INFO mapreduce.Job:  map 100% reduce 93%
16/12/15 11:31:40 INFO mapreduce.Job:  map 100% reduce 98%
16/12/15 11:31:41 INFO mapreduce.Job:  map 100% reduce 99%
16/12/15 11:31:42 INFO mapreduce.Job:  map 100% reduce 100%
16/12/15 11:31:45 INFO mapreduce.Job: Job job_1480588584072_8699 completed successfully
16/12/15 11:31:46 INFO mapreduce.Job: Counters: 49
	File System Counters
		FILE: Number of bytes read=828828618
		FILE: Number of bytes written=1690039201
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		WASB: Number of bytes read=709380849
		WASB: Number of bytes written=440542014
		WASB: Number of read operations=0
		WASB: Number of large read operations=0
		WASB: Number of write operations=0
	Job Counters 
		Launched map tasks=197
		Launched reduce tasks=20
		Rack-local map tasks=197
		Total time spent by all maps in occupied slots (ms)=3696962
		Total time spent by all reduces in occupied slots (ms)=2672322
		Total time spent by all map tasks (ms)=1848481
		Total time spent by all reduce tasks (ms)=1336161
		Total vcore-seconds taken by all map tasks=1848481
		Total vcore-seconds taken by all reduce tasks=1336161
		Total megabyte-seconds taken by all map tasks=1892844544
		Total megabyte-seconds taken by all reduce tasks=1368228864
	Map-Reduce Framework
		Map input records=2241750
		Map output records=1997540
		Map output bytes=821093891
		Map output materialized bytes=828852138
		Input split bytes=27356
		Combine input records=0
		Combine output records=0
		Reduce input groups=1745957
		Reduce shuffle bytes=828852138
		Reduce input records=1997540
		Reduce output records=1287909
		Spilled Records=3995080
		Shuffled Maps =3940
		Failed Shuffles=0
		Merged Map outputs=3940
		GC time elapsed (ms)=24808
		CPU time spent (ms)=853580
		Physical memory (bytes) snapshot=324305510400
		Virtual memory (bytes) snapshot=745208553472
		Total committed heap usage (bytes)=574376902656
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=706684845
	File Output Format Counters 
		Bytes Written=440542014
16/12/15 11:31:46 INFO streaming.StreamJob: Output directory: wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/1300
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/13.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/13/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/14.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/14/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/15.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/15/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/16.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/16/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/17.done
wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/17/* ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130600
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130600 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130700
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130700 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130800
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130800 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130900
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130900 ready
hdfs dfs -test -e wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612131000
wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612131000 ready
date +%Y-%m-%d %H:%M yarn jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -D mapred.job.name='click_show_zan_join' -D mapred.reduce.tasks=20 -D mapreduce.map.memory.mb=1024 -D mapreduce.reduce.memory.mb=1024 -D mapred.map.tasks=50 -D mapred.job.map.capacity=30 -D mapred.job.reduce.capacity=15 -D mapred.job.priority=NORMAL -D stream.num.map.output.key.fields=4 -D mapred.text.key.partitioner.options="-k1,2" -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D mapred.text.key.comparator.options="-k1,4" -files join_script -reducer "python join_script/reducer.py " -mapper "python join_script/mapper.py" -output wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/1400 -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner -input wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsImpressionSummary-20161213/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/13/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/14/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/15/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/16/*,wasb://niphdid@nipspark.blob.core.windows.net/dailyCtr/NewsClickSummary-20161213/17/*,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130600,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130700,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130800,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612130900,wasb://niphdid@nipspark.blob.core.windows.net/dashboard_offline_dt/20161213/201612131000
rm: `wasb://niphdid@nipspark.blob.core.windows.net/user/zhangrn/click_show_join/20161213/1400': No such file or directory
packageJobJar: [] [/usr/hdp/2.4.2.4-5/hadoop-mapreduce/hadoop-streaming-2.7.1.2.4.2.4-5.jar] /tmp/streamjob5148796351358139469.jar tmpDir=null
16/12/15 11:32:25 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/15 11:32:26 INFO impl.TimelineClientImpl: Timeline service address: http://headnodehost:8188/ws/v1/timeline/
16/12/15 11:32:26 INFO client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
16/12/15 11:32:28 INFO mapred.FileInputFormat: Total input paths to process : 197
16/12/15 11:32:28 INFO mapreduce.JobSubmitter: number of splits:197
16/12/15 11:32:28 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1480588584072_8702
16/12/15 11:32:29 INFO impl.YarnClientImpl: Submitted application application_1480588584072_8702
16/12/15 11:32:29 INFO mapreduce.Job: The url to track the job: http://hn1-niphdi.3hn3hhbhgj5u3gz1ui4p1tbyaa.mx.internal.cloudapp.net:8088/proxy/application_1480588584072_8702/
16/12/15 11:32:29 INFO mapreduce.Job: Running job: job_1480588584072_8702
16/12/15 11:36:37 INFO mapreduce.Job: Job job_1480588584072_8702 running in uber mode : false
16/12/15 11:36:37 INFO mapreduce.Job:  map 0% reduce 0%
16/12/15 11:36:53 INFO mapreduce.Job:  map 4% reduce 0%
16/12/15 11:37:02 INFO mapreduce.Job:  map 5% reduce 0%
16/12/15 11:37:06 INFO mapreduce.Job:  map 7% reduce 0%
16/12/15 11:37:07 INFO mapreduce.Job:  map 8% reduce 0%
16/12/15 11:37:11 INFO mapreduce.Job:  map 9% reduce 0%
16/12/15 11:37:19 INFO mapreduce.Job:  map 10% reduce 0%
16/12/15 11:37:20 INFO mapreduce.Job:  map 11% reduce 0%
16/12/15 11:37:21 INFO mapreduce.Job:  map 12% reduce 0%
16/12/15 11:37:23 INFO mapreduce.Job:  map 13% reduce 0%
16/12/15 11:37:29 INFO mapreduce.Job:  map 14% reduce 0%
16/12/15 11:37:32 INFO mapreduce.Job:  map 15% reduce 0%
16/12/15 11:37:33 INFO mapreduce.Job:  map 16% reduce 0%
16/12/15 11:37:34 INFO mapreduce.Job:  map 17% reduce 0%
16/12/15 11:37:42 INFO mapreduce.Job:  map 18% reduce 0%
16/12/15 11:37:43 INFO mapreduce.Job:  map 20% reduce 0%
16/12/15 11:37:45 INFO mapreduce.Job:  map 21% reduce 0%
16/12/15 11:37:54 INFO mapreduce.Job:  map 22% reduce 0%
16/12/15 11:37:55 INFO mapreduce.Job:  map 24% reduce 0%
16/12/15 11:37:58 INFO mapreduce.Job:  map 25% reduce 0%
16/12/15 11:38:05 INFO mapreduce.Job:  map 26% reduce 0%
16/12/15 11:38:06 INFO mapreduce.Job:  map 27% reduce 0%
16/12/15 11:38:07 INFO mapreduce.Job:  map 28% reduce 0%
16/12/15 11:38:09 INFO mapreduce.Job:  map 28% reduce 1%
16/12/15 11:38:14 INFO mapreduce.Job:  map 29% reduce 1%
16/12/15 11:38:16 INFO mapreduce.Job:  map 30% reduce 1%
16/12/15 11:38:18 INFO mapreduce.Job:  map 31% reduce 1%
16/12/15 11:38:24 INFO mapreduce.Job:  map 32% reduce 1%
